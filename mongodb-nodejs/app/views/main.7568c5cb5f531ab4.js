var z$=Object.defineProperty,G$=Object.defineProperties,j$=Object.getOwnPropertyDescriptors,H3=Object.getOwnPropertySymbols,W$=Object.prototype.hasOwnProperty,$$=Object.prototype.propertyIsEnumerable,z3=(hn,Ze,K)=>Ze in hn?z$(hn,Ze,{enumerable:!0,configurable:!0,writable:!0,value:K}):hn[Ze]=K,Si=(hn,Ze)=>{for(var K in Ze||(Ze={}))W$.call(Ze,K)&&z3(hn,K,Ze[K]);if(H3)for(var K of H3(Ze))$$.call(Ze,K)&&z3(hn,K,Ze[K]);return hn},ES=(hn,Ze)=>G$(hn,j$(Ze));(self.webpackChunkmodelapp=self.webpackChunkmodelapp||[]).push([[179],{2011:(hn,Ze,K)=>{"use strict";K.d(Ze,{hO:()=>Gt,xv:()=>Be,Dh:()=>Ne,GT:()=>Ve,cc:()=>tt,on:()=>ue,pX:()=>Ae});var w=K(5e3),be=K(127),Y=K(5813);hn=K.hmd(hn);const Oe=["ngOnDestroy"],Ae=(at,qt,nn,lt={})=>new Proxy(at,{get:(Ye,st)=>nn.runOutsideAngular(()=>{var Bt;if(at[st])return(null===(Bt=null==lt?void 0:lt.spy)||void 0===Bt?void 0:Bt.get)&&lt.spy.get(st,at[st]),at[st];if(Oe.indexOf(st)>-1)return()=>{};const Ut=qt.toPromise().then(ce=>{const Xe=ce&&ce[st];return"function"==typeof Xe?Xe.bind(ce):Xe&&Xe.then?Xe.then(ve=>nn.run(()=>ve)):nn.run(()=>Xe)});return new Proxy(()=>{},{get:(ce,Xe)=>Ut[Xe],apply:(ce,Xe,ve)=>Ut.then(Re=>{var Te;const We=Re&&Re(...ve);return(null===(Te=null==lt?void 0:lt.spy)||void 0===Te?void 0:Te.apply)&&lt.spy.apply(st,ve,We),We})})})}),Ve=(at,qt)=>{qt.forEach(nn=>{Object.getOwnPropertyNames(nn.prototype||nn).forEach(lt=>{Object.defineProperty(at.prototype,lt,Object.getOwnPropertyDescriptor(nn.prototype||nn,lt))})})};class Fe{constructor(qt){return qt}}const Ne=new w.OlP("angularfire2.app.options"),Be=new w.OlP("angularfire2.app.name");function ue(at,qt,nn){const Ye="object"==typeof nn&&nn||{};Ye.name=Ye.name||"string"==typeof nn&&nn||"[DEFAULT]";const Bt=be.Z.apps.filter(Ut=>Ut&&Ut.name===Ye.name)[0]||qt.runOutsideAngular(()=>be.Z.initializeApp(at,Ye));try{JSON.stringify(at)!==JSON.stringify(Bt.options)&&le("error",`${Bt.name} Firebase App already initialized with different options${hn.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch(Ut){}return new Fe(Bt)}const le=(at,...qt)=>{(0,w.X6Q)()&&"undefined"!=typeof console&&console[at](...qt)},Ce={provide:Fe,useFactory:ue,deps:[Ne,w.R0b,[new w.FiY,Be]]};let Gt=(()=>{class at{constructor(nn){be.Z.registerVersion("angularfire",Y.q4.full,"core"),be.Z.registerVersion("angularfire",Y.q4.full,"app-compat"),be.Z.registerVersion("angular",w.q4F.full,nn.toString())}static initializeApp(nn,lt){return{ngModule:at,providers:[{provide:Ne,useValue:nn},{provide:Be,useValue:lt}]}}}return at.\u0275fac=function(nn){return new(nn||at)(w.LFG(w.Lbi))},at.\u0275mod=w.oAB({type:at}),at.\u0275inj=w.cJS({providers:[Ce]}),at})();function tt(at,qt,nn,lt,Ye){const[,st,Bt]=globalThis.\u0275AngularfireInstanceCache.find(Ut=>Ut[0]===at)||[];if(st)return function pt(at,qt){try{return at.toString()===qt.toString()}catch(nn){return at===qt}}(Ye,Bt)||(ze("error",`${qt} was already initialized on the ${nn} Firebase App with different settings.${Ot?" You may need to reload as Firebase is not HMR aware.":""}`),ze("warn",{is:Ye,was:Bt})),st;{const Ut=lt();return globalThis.\u0275AngularfireInstanceCache.push([at,Ut,Ye]),Ut}}const Ot=!!hn.hot,ze=(at,...qt)=>{(0,w.X6Q)()&&"undefined"!=typeof console&&console[at](...qt)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(hn,Ze,K)=>{"use strict";K.d(Ze,{q4:()=>fl,iC:()=>gl,HU:()=>fi,vb:()=>Ke,JM:()=>w_});var w=K(5e3),be=K(5867),Y=K(5861),Oe=K(9681),Ae=K(2090),Ve=K(4859),Fe=K(1877),Ne=K(8766);const Be="@firebase/installations",ue="0.5.10",Ce=`w:${ue}`,Gt="FIS_v2",qt=new Ae.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function nn(P){return P instanceof Ae.ZR&&P.code.includes("request-failed")}function lt({projectId:P}){return`https://firebaseinstallations.googleapis.com/v1/projects/${P}/installations`}function Ye(P){return{token:P.token,requestStatus:2,expiresIn:Re(P.expiresIn),creationTime:Date.now()}}function st(P,O){return Bt.apply(this,arguments)}function Bt(){return(Bt=(0,Y.Z)(function*(P,O){const te=(yield O.json()).error;return qt.create("request-failed",{requestName:P,serverCode:te.code,serverMessage:te.message,serverStatus:te.status})})).apply(this,arguments)}function Ut({apiKey:P}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":P})}function ce(P,{refreshToken:O}){const G=Ut(P);return G.append("Authorization",function Te(P){return`${Gt} ${P}`}(O)),G}function Xe(P){return ve.apply(this,arguments)}function ve(){return(ve=(0,Y.Z)(function*(P){const O=yield P();return O.status>=500&&O.status<600?P():O})).apply(this,arguments)}function Re(P){return Number(P.replace("s","000"))}function We(P,O){return ke.apply(this,arguments)}function ke(){return(ke=(0,Y.Z)(function*({appConfig:P,heartbeatServiceProvider:O},{fid:G}){const te=lt(P),ge=Ut(P),Ie=O.getImmediate({optional:!0});if(Ie){const ui=yield Ie.getHeartbeatsHeader();ui&&ge.append("x-firebase-client",ui)}const Pt={method:"POST",headers:ge,body:JSON.stringify({fid:G,authVersion:Gt,appId:P.appId,sdkVersion:Ce})},jn=yield Xe(()=>fetch(te,Pt));if(jn.ok){const ui=yield jn.json();return{fid:ui.fid||G,registrationStatus:2,refreshToken:ui.refreshToken,authToken:Ye(ui.authToken)}}throw yield st("Create Installation",jn)})).apply(this,arguments)}function It(P){return new Promise(O=>{setTimeout(O,P)})}const ni=/^[cdef][\w-]{21}$/;function Ht(){try{const P=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(P),P[0]=112+P[0]%16;const G=function Ci(P){return function Pe(P){return btoa(String.fromCharCode(...P)).replace(/\+/g,"-").replace(/\//g,"_")}(P).substr(0,22)}(P);return ni.test(G)?G:""}catch(P){return""}}function nr(P){return`${P.appName}!${P.appId}`}const $i=new Map;function _i(P,O){const G=nr(P);An(G,O),function Tn(P,O){const G=function as(){return!Ys&&"BroadcastChannel"in self&&(Ys=new BroadcastChannel("[Firebase] FID Change"),Ys.onmessage=P=>{An(P.data.key,P.data.fid)}),Ys}();G&&G.postMessage({key:P,fid:O}),function Ls(){0===$i.size&&Ys&&(Ys.close(),Ys=null)}()}(G,O)}function An(P,O){const G=$i.get(P);if(G)for(const te of G)te(O)}let Ys=null;const Br="firebase-installations-store";let Es=null;function Pn(){return Es||(Es=(0,Ne.X3)("firebase-installations-database",1,{upgrade:(P,O)=>{0===O&&P.createObjectStore(Br)}})),Es}function Xs(P,O){return qi.apply(this,arguments)}function qi(){return(qi=(0,Y.Z)(function*(P,O){const G=nr(P),ge=(yield Pn()).transaction(Br,"readwrite"),Ie=ge.objectStore(Br),nt=yield Ie.get(G);return yield Ie.put(O,G),yield ge.done,(!nt||nt.fid!==O.fid)&&_i(P,O.fid),O})).apply(this,arguments)}function ar(P){return cs.apply(this,arguments)}function cs(){return(cs=(0,Y.Z)(function*(P){const O=nr(P),te=(yield Pn()).transaction(Br,"readwrite");yield te.objectStore(Br).delete(O),yield te.done})).apply(this,arguments)}function Js(P,O){return Hr.apply(this,arguments)}function Hr(){return(Hr=(0,Y.Z)(function*(P,O){const G=nr(P),ge=(yield Pn()).transaction(Br,"readwrite"),Ie=ge.objectStore(Br),nt=yield Ie.get(G),Pt=O(nt);return void 0===Pt?yield Ie.delete(G):yield Ie.put(Pt,G),yield ge.done,Pt&&(!nt||nt.fid!==Pt.fid)&&_i(P,Pt.fid),Pt})).apply(this,arguments)}function Pr(P){return Qs.apply(this,arguments)}function Qs(){return(Qs=(0,Y.Z)(function*(P){let O;const G=yield Js(P.appConfig,te=>{const ge=da(te),Ie=gi(P,ge);return O=Ie.registrationPromise,Ie.installationEntry});return""===G.fid?{installationEntry:yield O}:{installationEntry:G,registrationPromise:O}})).apply(this,arguments)}function da(P){return Nr(P||{fid:Ht(),registrationStatus:0})}function gi(P,O){if(0===O.registrationStatus){if(!navigator.onLine)return{installationEntry:O,registrationPromise:Promise.reject(qt.create("app-offline"))};const G={fid:O.fid,registrationStatus:1,registrationTime:Date.now()},te=function _n(P,O){return On.apply(this,arguments)}(P,G);return{installationEntry:G,registrationPromise:te}}return 1===O.registrationStatus?{installationEntry:O,registrationPromise:Jr(P)}:{installationEntry:O}}function On(){return(On=(0,Y.Z)(function*(P,O){try{const G=yield We(P,O);return Xs(P.appConfig,G)}catch(G){throw nn(G)&&409===G.customData.serverCode?yield ar(P.appConfig):yield Xs(P.appConfig,{fid:O.fid,registrationStatus:0}),G}})).apply(this,arguments)}function Jr(P){return zr.apply(this,arguments)}function zr(){return(zr=(0,Y.Z)(function*(P){let O=yield kn(P.appConfig);for(;1===O.registrationStatus;)yield It(100),O=yield kn(P.appConfig);if(0===O.registrationStatus){const{installationEntry:G,registrationPromise:te}=yield Pr(P);return te||G}return O})).apply(this,arguments)}function kn(P){return Js(P,O=>{if(!O)throw qt.create("installation-not-found");return Nr(O)})}function Nr(P){return function Ki(P){return 1===P.registrationStatus&&P.registrationTime+1e4<Date.now()}(P)?{fid:P.fid,registrationStatus:0}:P}function Hi(P,O){return oe.apply(this,arguments)}function oe(){return(oe=(0,Y.Z)(function*({appConfig:P,heartbeatServiceProvider:O},G){const te=fe(P,G),ge=ce(P,G),Ie=O.getImmediate({optional:!0});if(Ie){const ui=yield Ie.getHeartbeatsHeader();ui&&ge.append("x-firebase-client",ui)}const Pt={method:"POST",headers:ge,body:JSON.stringify({installation:{sdkVersion:Ce,appId:P.appId}})},jn=yield Xe(()=>fetch(te,Pt));if(jn.ok)return Ye(yield jn.json());throw yield st("Generate Auth Token",jn)})).apply(this,arguments)}function fe(P,{fid:O}){return`${lt(P)}/${O}/authTokens:generate`}function pe(P){return et.apply(this,arguments)}function et(){return(et=(0,Y.Z)(function*(P,O=!1){let G;const te=yield Js(P.appConfig,Ie=>{if(!Ln(Ie))throw qt.create("not-registered");const nt=Ie.authToken;if(!O&&Ji(nt))return Ie;if(1===nt.requestStatus)return G=he(P,O),Ie;{if(!navigator.onLine)throw qt.create("app-offline");const Pt=Or(Ie);return G=sn(P,Pt),Pt}});return G?yield G:te.authToken})).apply(this,arguments)}function he(P,O){return Ee.apply(this,arguments)}function Ee(){return(Ee=(0,Y.Z)(function*(P,O){let G=yield ct(P.appConfig);for(;1===G.authToken.requestStatus;)yield It(100),G=yield ct(P.appConfig);const te=G.authToken;return 0===te.requestStatus?pe(P,O):te})).apply(this,arguments)}function ct(P){return Js(P,O=>{if(!Ln(O))throw qt.create("not-registered");return function Ss(P){return 1===P.requestStatus&&P.requestTime+1e4<Date.now()}(O.authToken)?Object.assign(Object.assign({},O),{authToken:{requestStatus:0}}):O})}function sn(P,O){return wn.apply(this,arguments)}function wn(){return(wn=(0,Y.Z)(function*(P,O){try{const G=yield Hi(P,O),te=Object.assign(Object.assign({},O),{authToken:G});return yield Xs(P.appConfig,te),G}catch(G){if(!nn(G)||401!==G.customData.serverCode&&404!==G.customData.serverCode){const te=Object.assign(Object.assign({},O),{authToken:{requestStatus:0}});yield Xs(P.appConfig,te)}else yield ar(P.appConfig);throw G}})).apply(this,arguments)}function Ln(P){return void 0!==P&&2===P.registrationStatus}function Ji(P){return 2===P.requestStatus&&!function Fn(P){const O=Date.now();return O<P.creationTime||P.creationTime+P.expiresIn<O+36e5}(P)}function Or(P){const O={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},P),{authToken:O})}function Ll(){return(Ll=(0,Y.Z)(function*(P){const O=P,{installationEntry:G,registrationPromise:te}=yield Pr(O);return te?te.catch(console.error):pe(O).catch(console.error),G.fid})).apply(this,arguments)}function kl(){return(kl=(0,Y.Z)(function*(P,O=!1){const G=P;return yield Lr(G),(yield pe(G,O)).token})).apply(this,arguments)}function Lr(P){return Ts.apply(this,arguments)}function Ts(){return(Ts=(0,Y.Z)(function*(P){const{registrationPromise:O}=yield Pr(P);O&&(yield O)})).apply(this,arguments)}function Ra(P){return qt.create("missing-app-config-values",{valueName:P})}const Fs="installations",xn=P=>{const O=P.getProvider("app").getImmediate(),G=function wr(P){if(!P||!P.options)throw Ra("App Configuration");if(!P.name)throw Ra("App Name");const O=["projectId","apiKey","appId"];for(const G of O)if(!P.options[G])throw Ra(G);return{appName:P.name,projectId:P.options.projectId,apiKey:P.options.apiKey,appId:P.options.appId}}(O);return{app:O,appConfig:G,heartbeatServiceProvider:(0,Oe._getProvider)(O,"heartbeat"),_delete:()=>Promise.resolve()}},yi=P=>{const O=P.getProvider("app").getImmediate(),G=(0,Oe._getProvider)(O,Fs).getImmediate();return{getId:()=>function pc(P){return Ll.apply(this,arguments)}(G),getToken:ge=>function mc(P){return kl.apply(this,arguments)}(G,ge)}};(function us(){(0,Oe._registerComponent)(new Ve.wA(Fs,xn,"PUBLIC")),(0,Oe._registerComponent)(new Ve.wA("installations-internal",yi,"PRIVATE"))})(),(0,Oe.registerVersion)(Be,ue),(0,Oe.registerVersion)(Be,ue,"esm2017");const Lo="@firebase/remote-config",cr=new Ae.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Cd{constructor(O,G,te,ge){this.client=O,this.storage=G,this.storageCache=te,this.logger=ge}isCachedDataFresh(O,G){if(!G)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const te=Date.now()-G,ge=te<=O;return this.logger.debug(`Config fetch cache check. Cache age millis: ${te}. Cache max age millis (minimumFetchIntervalMillis setting): ${O}. Is cache hit: ${ge}.`),ge}fetch(O){var G=this;return(0,Y.Z)(function*(){const[te,ge]=yield Promise.all([G.storage.getLastSuccessfulFetchTimestampMillis(),G.storage.getLastSuccessfulFetchResponse()]);if(ge&&G.isCachedDataFresh(O.cacheMaxAgeMillis,te))return ge;O.eTag=ge&&ge.eTag;const Ie=yield G.client.fetch(O),nt=[G.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===Ie.status&&nt.push(G.storage.setLastSuccessfulFetchResponse(Ie)),yield Promise.all(nt),Ie})()}}function ku(P=navigator){return P.languages&&P.languages[0]||P.language}class ds{constructor(O,G,te,ge,Ie,nt){this.firebaseInstallations=O,this.sdkVersion=G,this.namespace=te,this.projectId=ge,this.apiKey=Ie,this.appId=nt}fetch(O){var G=this;return(0,Y.Z)(function*(){var te,ge,Ie;const[nt,Pt]=yield Promise.all([G.firebaseInstallations.getId(),G.firebaseInstallations.getToken()]),ui=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${G.projectId}/namespaces/${G.namespace}:fetch?key=${G.apiKey}`,Ti={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":O.eTag||"*"},Rn={sdk_version:G.sdkVersion,app_instance_id:nt,app_instance_id_token:Pt,app_id:G.appId,language_code:ku()},so={method:"POST",headers:Ti,body:JSON.stringify(Rn)},xo=fetch(ui,so),sc=new Promise((ja,Wa)=>{O.signal.addEventListener(()=>{const oc=new Error("The operation was aborted.");oc.name="AbortError",Wa(oc)})});let Eo;try{yield Promise.race([xo,sc]),Eo=yield xo}catch(ja){let Wa="fetch-client-network";throw"AbortError"===(null===(te=ja)||void 0===te?void 0:te.name)&&(Wa="fetch-timeout"),cr.create(Wa,{originalErrorMessage:null===(ge=ja)||void 0===ge?void 0:ge.message})}let zo=Eo.status;const Is=Eo.headers.get("ETag")||void 0;let wa,rs;if(200===Eo.status){let ja;try{ja=yield Eo.json()}catch(Wa){throw cr.create("fetch-client-parse",{originalErrorMessage:null===(Ie=Wa)||void 0===Ie?void 0:Ie.message})}wa=ja.entries,rs=ja.state}if("INSTANCE_STATE_UNSPECIFIED"===rs?zo=500:"NO_CHANGE"===rs?zo=304:("NO_TEMPLATE"===rs||"EMPTY_CONFIG"===rs)&&(wa={}),304!==zo&&200!==zo)throw cr.create("fetch-status",{httpStatus:zo});return{status:zo,eTag:Is,config:wa}})()}}class Ih{constructor(O,G){this.client=O,this.storage=G}fetch(O){var G=this;return(0,Y.Z)(function*(){const te=(yield G.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return G.attemptFetch(O,te)})()}attemptFetch(O,{throttleEndTimeMillis:G,backoffCount:te}){var ge=this;return(0,Y.Z)(function*(){yield function io(P,O){return new Promise((G,te)=>{const ge=Math.max(O-Date.now(),0),Ie=setTimeout(G,ge);P.addEventListener(()=>{clearTimeout(Ie),te(cr.create("fetch-throttle",{throttleEndTimeMillis:O}))})})}(O.signal,G);try{const Ie=yield ge.client.fetch(O);return yield ge.storage.deleteThrottleMetadata(),Ie}catch(Ie){if(!function Ad(P){if(!(P instanceof Ae.ZR&&P.customData))return!1;const O=Number(P.customData.httpStatus);return 429===O||500===O||503===O||504===O}(Ie))throw Ie;const nt={throttleEndTimeMillis:Date.now()+(0,Ae.$s)(te),backoffCount:te+1};return yield ge.storage.setThrottleMetadata(nt),ge.attemptFetch(O,nt)}})()}}class Fu{constructor(O,G,te,ge,Ie){this.app=O,this._client=G,this._storageCache=te,this._storage=ge,this._logger=Ie,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function eu(P,O){var G;const te=P.target.error||void 0;return cr.create(O,{originalErrorMessage:te&&(null===(G=te)||void 0===G?void 0:G.message)})}const Jo="app_namespace_store";class Ph{constructor(O,G,te,ge=function Jf(){return new Promise((P,O)=>{var G;try{const te=indexedDB.open("firebase_remote_config",1);te.onerror=ge=>{O(eu(ge,"storage-open"))},te.onsuccess=ge=>{P(ge.target.result)},te.onupgradeneeded=ge=>{0===ge.oldVersion&&ge.target.result.createObjectStore(Jo,{keyPath:"compositeKey"})}}catch(te){O(cr.create("storage-open",{originalErrorMessage:null===(G=te)||void 0===G?void 0:G.message}))}})}()){this.appId=O,this.appName=G,this.namespace=te,this.openDbPromise=ge}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(O){return this.set("last_fetch_status",O)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(O){return this.set("last_successful_fetch_timestamp_millis",O)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(O){return this.set("last_successful_fetch_response",O)}getActiveConfig(){return this.get("active_config")}setActiveConfig(O){return this.set("active_config",O)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(O){return this.set("active_config_etag",O)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(O){return this.set("throttle_metadata",O)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(O){var G=this;return(0,Y.Z)(function*(){const te=yield G.openDbPromise;return new Promise((ge,Ie)=>{var nt;const jn=te.transaction([Jo],"readonly").objectStore(Jo),ui=G.createCompositeKey(O);try{const Ti=jn.get(ui);Ti.onerror=Rn=>{Ie(eu(Rn,"storage-get"))},Ti.onsuccess=Rn=>{const so=Rn.target.result;ge(so?so.value:void 0)}}catch(Ti){Ie(cr.create("storage-get",{originalErrorMessage:null===(nt=Ti)||void 0===nt?void 0:nt.message}))}})})()}set(O,G){var te=this;return(0,Y.Z)(function*(){const ge=yield te.openDbPromise;return new Promise((Ie,nt)=>{var Pt;const ui=ge.transaction([Jo],"readwrite").objectStore(Jo),Ti=te.createCompositeKey(O);try{const Rn=ui.put({compositeKey:Ti,value:G});Rn.onerror=so=>{nt(eu(so,"storage-set"))},Rn.onsuccess=()=>{Ie()}}catch(Rn){nt(cr.create("storage-set",{originalErrorMessage:null===(Pt=Rn)||void 0===Pt?void 0:Pt.message}))}})})()}delete(O){var G=this;return(0,Y.Z)(function*(){const te=yield G.openDbPromise;return new Promise((ge,Ie)=>{var nt;const jn=te.transaction([Jo],"readwrite").objectStore(Jo),ui=G.createCompositeKey(O);try{const Ti=jn.delete(ui);Ti.onerror=Rn=>{Ie(eu(Rn,"storage-delete"))},Ti.onsuccess=()=>{ge()}}catch(Ti){Ie(cr.create("storage-delete",{originalErrorMessage:null===(nt=Ti)||void 0===nt?void 0:nt.message}))}})})()}createCompositeKey(O){return[this.appId,this.appName,this.namespace,O].join()}}class Vu{constructor(O){this.storage=O}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var O=this;return(0,Y.Z)(function*(){const G=O.storage.getLastFetchStatus(),te=O.storage.getLastSuccessfulFetchTimestampMillis(),ge=O.storage.getActiveConfig(),Ie=yield G;Ie&&(O.lastFetchStatus=Ie);const nt=yield te;nt&&(O.lastSuccessfulFetchTimestampMillis=nt);const Pt=yield ge;Pt&&(O.activeConfig=Pt)})()}setLastFetchStatus(O){return this.lastFetchStatus=O,this.storage.setLastFetchStatus(O)}setLastSuccessfulFetchTimestampMillis(O){return this.lastSuccessfulFetchTimestampMillis=O,this.storage.setLastSuccessfulFetchTimestampMillis(O)}setActiveConfig(O){return this.activeConfig=O,this.storage.setActiveConfig(O)}}function Vl(){return Uu.apply(this,arguments)}function Uu(){return(Uu=(0,Y.Z)(function*(){if(!(0,Ae.hl)())return!1;try{return yield(0,Ae.eu)()}catch(P){return!1}})).apply(this,arguments)}!function fa(){(0,Oe._registerComponent)(new Ve.wA("remote-config",function P(O,{instanceIdentifier:G}){const te=O.getProvider("app").getImmediate(),ge=O.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw cr.create("registration-window");if(!(0,Ae.hl)())throw cr.create("indexed-db-unavailable");const{projectId:Ie,apiKey:nt,appId:Pt}=te.options;if(!Ie)throw cr.create("registration-project-id");if(!nt)throw cr.create("registration-api-key");if(!Pt)throw cr.create("registration-app-id");const jn=new Ph(Pt,te.name,G=G||"firebase"),ui=new Vu(jn),Ti=new Fe.Yd(Lo);Ti.logLevel=Fe.in.ERROR;const Rn=new ds(ge,Oe.SDK_VERSION,G,Ie,nt,Pt),so=new Ih(Rn,jn),xo=new Cd(so,jn,ui,Ti),sc=new Fu(te,xo,ui,jn,Ti);return function Gi(P){const O=(0,Ae.m9)(P);O._initializePromise||(O._initializePromise=O._storageCache.loadFromStorage().then(()=>{O._isInitializationComplete=!0}))}(sc),sc},"PUBLIC").setMultipleInstances(!0)),(0,Oe.registerVersion)(Lo,"0.3.9"),(0,Oe.registerVersion)(Lo,"0.3.9","esm2017")}();const tu="/firebase-messaging-sw.js",ns="/firebase-cloud-messaging-push-scope",Oa="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",La="google.c.a.c_id",Dd="google.c.a.c_l",Rd="google.c.a.ts",nu="google.c.a.e";var Qo=(()=>{return(P=Qo||(Qo={})).PUSH_RECEIVED="push-received",P.NOTIFICATION_CLICKED="notification-clicked",Qo;var P})();function hs(P){const O=new Uint8Array(P);return btoa(String.fromCharCode(...O)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Pd(P){const G=(P+"=".repeat((4-P.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),te=atob(G),ge=new Uint8Array(te.length);for(let Ie=0;Ie<te.length;++Ie)ge[Ie]=te.charCodeAt(Ie);return ge}const Vs="fcm_token_details_db",yo="fcm_token_object_Store";function Bu(P){return Nd.apply(this,arguments)}function Nd(){return Nd=(0,Y.Z)(function*(P){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(Ie=>Ie.name).includes(Vs))return null;let O=null;return(yield(0,Ne.X3)(Vs,5,{upgrade:(te=(0,Y.Z)(function*(ge,Ie,nt,Pt){var jn;if(Ie<2||!ge.objectStoreNames.contains(yo))return;const ui=Pt.objectStore(yo),Ti=yield ui.index("fcmSenderId").get(P);if(yield ui.clear(),Ti)if(2===Ie){const Rn=Ti;if(!Rn.auth||!Rn.p256dh||!Rn.endpoint)return;O={token:Rn.fcmToken,createTime:null!==(jn=Rn.createTime)&&void 0!==jn?jn:Date.now(),subscriptionOptions:{auth:Rn.auth,p256dh:Rn.p256dh,endpoint:Rn.endpoint,swScope:Rn.swScope,vapidKey:"string"==typeof Rn.vapidKey?Rn.vapidKey:hs(Rn.vapidKey)}}}else if(3===Ie){const Rn=Ti;O={token:Rn.fcmToken,createTime:Rn.createTime,subscriptionOptions:{auth:hs(Rn.auth),p256dh:hs(Rn.p256dh),endpoint:Rn.endpoint,swScope:Rn.swScope,vapidKey:hs(Rn.vapidKey)}}}else if(4===Ie){const Rn=Ti;O={token:Rn.fcmToken,createTime:Rn.createTime,subscriptionOptions:{auth:hs(Rn.auth),p256dh:hs(Rn.p256dh),endpoint:Rn.endpoint,swScope:Rn.swScope,vapidKey:hs(Rn.vapidKey)}}}}),function(Ie,nt,Pt,jn){return te.apply(this,arguments)})})).close(),yield(0,Ne.Lj)(Vs),yield(0,Ne.Lj)("fcm_vapid_details_db"),yield(0,Ne.Lj)("undefined"),Hu(O)?O:null;var te}),Nd.apply(this,arguments)}function Hu(P){if(!P||!P.subscriptionOptions)return!1;const{subscriptionOptions:O}=P;return"number"==typeof P.createTime&&P.createTime>0&&"string"==typeof P.token&&P.token.length>0&&"string"==typeof O.auth&&O.auth.length>0&&"string"==typeof O.p256dh&&O.p256dh.length>0&&"string"==typeof O.endpoint&&O.endpoint.length>0&&"string"==typeof O.swScope&&O.swScope.length>0&&"string"==typeof O.vapidKey&&O.vapidKey.length>0}const Uo="firebase-messaging-store";let Od=null;function Fi(){return Od||(Od=(0,Ne.X3)("firebase-messaging-database",1,{upgrade:(P,O)=>{0===O&&P.createObjectStore(Uo)}})),Od}function _c(P){return nl.apply(this,arguments)}function nl(){return(nl=(0,Y.Z)(function*(P){const O=fs(P),te=yield(yield Fi()).transaction(Uo).objectStore(Uo).get(O);if(te)return te;{const ge=yield Bu(P.appConfig.senderId);if(ge)return yield Ri(P,ge),ge}})).apply(this,arguments)}function Ri(P,O){return Hl.apply(this,arguments)}function Hl(){return(Hl=(0,Y.Z)(function*(P,O){const G=fs(P),ge=(yield Fi()).transaction(Uo,"readwrite");return yield ge.objectStore(Uo).put(O,G),yield ge.done,O})).apply(this,arguments)}function vc(P){return ka.apply(this,arguments)}function ka(){return(ka=(0,Y.Z)(function*(P){const O=fs(P),te=(yield Fi()).transaction(Uo,"readwrite");yield te.objectStore(Uo).delete(O),yield te.done})).apply(this,arguments)}function fs({appConfig:P}){return P.appId}const ur=new Ae.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function Bo(P,O){return is.apply(this,arguments)}function is(){return(is=(0,Y.Z)(function*(P,O){const G=yield il(P),te=rl(O),ge={method:"POST",headers:G,body:JSON.stringify(te)};let Ie;try{Ie=yield(yield fetch(Ho(P.appConfig),ge)).json()}catch(nt){throw ur.create("token-subscribe-failed",{errorInfo:nt})}if(Ie.error)throw ur.create("token-subscribe-failed",{errorInfo:Ie.error.message});if(!Ie.token)throw ur.create("token-subscribe-no-token");return Ie.token})).apply(this,arguments)}function Fa(P,O){return ea.apply(this,arguments)}function ea(){return(ea=(0,Y.Z)(function*(P,O){const G=yield il(P),te=rl(O.subscriptionOptions),ge={method:"PATCH",headers:G,body:JSON.stringify(te)};let Ie;try{Ie=yield(yield fetch(`${Ho(P.appConfig)}/${O.token}`,ge)).json()}catch(nt){throw ur.create("token-update-failed",{errorInfo:nt})}if(Ie.error)throw ur.create("token-update-failed",{errorInfo:Ie.error.message});if(!Ie.token)throw ur.create("token-update-no-token");return Ie.token})).apply(this,arguments)}function wc(P,O){return _o.apply(this,arguments)}function _o(){return(_o=(0,Y.Z)(function*(P,O){const te={method:"DELETE",headers:yield il(P)};try{const Ie=yield(yield fetch(`${Ho(P.appConfig)}/${O}`,te)).json();if(Ie.error)throw ur.create("token-unsubscribe-failed",{errorInfo:Ie.error.message})}catch(ge){throw ur.create("token-unsubscribe-failed",{errorInfo:ge})}})).apply(this,arguments)}function Ho({projectId:P}){return`https://fcmregistrations.googleapis.com/v1/projects/${P}/registrations`}function il(P){return Cn.apply(this,arguments)}function Cn(){return(Cn=(0,Y.Z)(function*({appConfig:P,installations:O}){const G=yield O.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":P.apiKey,"x-goog-firebase-installations-auth":`FIS ${G}`})})).apply(this,arguments)}function rl({p256dh:P,auth:O,endpoint:G,vapidKey:te}){const ge={web:{endpoint:G,auth:O,p256dh:P}};return te!==Oa&&(ge.web.applicationPubKey=te),ge}const bc=6048e5;function zl(P){return ru.apply(this,arguments)}function ru(){return(ru=(0,Y.Z)(function*(P){const O=yield ir(P.swRegistration,P.vapidKey),G={vapidKey:P.vapidKey,swScope:P.swRegistration.scope,endpoint:O.endpoint,auth:hs(O.getKey("auth")),p256dh:hs(O.getKey("p256dh"))},te=yield _c(P.firebaseDependencies);if(te){if(Us(te.subscriptionOptions,G))return Date.now()>=te.createTime+bc?su(P,{token:te.token,createTime:Date.now(),subscriptionOptions:G}):te.token;try{yield wc(P.firebaseDependencies,te.token)}catch(ge){console.warn(ge)}return ai(P.firebaseDependencies,G)}return ai(P.firebaseDependencies,G)})).apply(this,arguments)}function sl(P){return pa.apply(this,arguments)}function pa(){return(pa=(0,Y.Z)(function*(P){const O=yield _c(P.firebaseDependencies);O&&(yield wc(P.firebaseDependencies,O.token),yield vc(P.firebaseDependencies));const G=yield P.swRegistration.pushManager.getSubscription();return!G||G.unsubscribe()})).apply(this,arguments)}function su(P,O){return ut.apply(this,arguments)}function ut(){return(ut=(0,Y.Z)(function*(P,O){try{const G=yield Fa(P.firebaseDependencies,O),te=Object.assign(Object.assign({},O),{token:G,createTime:Date.now()});return yield Ri(P.firebaseDependencies,te),G}catch(G){throw yield sl(P),G}})).apply(this,arguments)}function ai(P,O){return xc.apply(this,arguments)}function xc(){return(xc=(0,Y.Z)(function*(P,O){const te={token:yield Bo(P,O),createTime:Date.now(),subscriptionOptions:O};return yield Ri(P,te),te.token})).apply(this,arguments)}function ir(P,O){return ol.apply(this,arguments)}function ol(){return(ol=(0,Y.Z)(function*(P,O){return(yield P.pushManager.getSubscription())||P.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Pd(O)})})).apply(this,arguments)}function Us(P,O){return O.vapidKey===P.vapidKey&&O.endpoint===P.endpoint&&O.auth===P.auth&&O.p256dh===P.p256dh}function vo(P){const O={from:P.from,collapseKey:P.collapse_key,messageId:P.fcmMessageId};return function Ec(P,O){if(!O.notification)return;P.notification={};const G=O.notification.title;G&&(P.notification.title=G);const te=O.notification.body;te&&(P.notification.body=te);const ge=O.notification.image;ge&&(P.notification.image=ge)}(O,P),function zu(P,O){!O.data||(P.data=O.data)}(O,P),function Qf(P,O){var G,te,ge,Ie,nt;if(!O.fcmOptions&&!(null===(G=O.notification)||void 0===G?void 0:G.click_action))return;P.fcmOptions={};const Pt=null!==(ge=null===(te=O.fcmOptions)||void 0===te?void 0:te.link)&&void 0!==ge?ge:null===(Ie=O.notification)||void 0===Ie?void 0:Ie.click_action;Pt&&(P.fcmOptions.link=Pt);const jn=null===(nt=O.fcmOptions)||void 0===nt?void 0:nt.analytics_label;jn&&(P.fcmOptions.analyticsLabel=jn)}(O,P),O}function Sc(P){return"object"==typeof P&&!!P&&La in P}function Gl(P,O){const G=[];for(let te=0;te<P.length;te++)G.push(P.charAt(te)),te<O.length&&G.push(O.charAt(te));return G.join("")}function Ir(P){return ur.create("missing-app-config-values",{valueName:P})}Gl("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),Gl("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class ma{constructor(O,G,te){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const ge=function ou(P){if(!P||!P.options)throw Ir("App Configuration Object");if(!P.name)throw Ir("App Name");const O=["projectId","apiKey","appId","messagingSenderId"],{options:G}=P;for(const te of O)if(!G[te])throw Ir(te);return{appName:P.name,projectId:G.projectId,apiKey:G.apiKey,appId:G.appId,senderId:G.messagingSenderId}}(O);this.firebaseDependencies={app:O,appConfig:ge,installations:G,analyticsProvider:te}}_delete(){return Promise.resolve()}}function Tc(P){return Va.apply(this,arguments)}function Va(){return(Va=(0,Y.Z)(function*(P){var O;try{P.swRegistration=yield navigator.serviceWorker.register(tu,{scope:ns}),P.swRegistration.update().catch(()=>{})}catch(G){throw ur.create("failed-service-worker-registration",{browserErrorMessage:null===(O=G)||void 0===O?void 0:O.message})}})).apply(this,arguments)}function Bs(P,O){return al.apply(this,arguments)}function al(){return(al=(0,Y.Z)(function*(P,O){if(!O&&!P.swRegistration&&(yield Tc(P)),O||!P.swRegistration){if(!(O instanceof ServiceWorkerRegistration))throw ur.create("invalid-sw-registration");P.swRegistration=O}})).apply(this,arguments)}function Ua(P,O){return Mc.apply(this,arguments)}function Mc(){return(Mc=(0,Y.Z)(function*(P,O){O?P.vapidKey=O:P.vapidKey||(P.vapidKey=Oa)})).apply(this,arguments)}function jl(){return(jl=(0,Y.Z)(function*(P,O){if(!navigator)throw ur.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw ur.create("permission-blocked");return yield Ua(P,null==O?void 0:O.vapidKey),yield Bs(P,null==O?void 0:O.serviceWorkerRegistration),zl(P)})).apply(this,arguments)}function Wl(P,O,G){return $l.apply(this,arguments)}function $l(){return($l=(0,Y.Z)(function*(P,O,G){const te=ql(O);(yield P.firebaseDependencies.analyticsProvider.get()).logEvent(te,{message_id:G[La],message_name:G[Dd],message_time:G[Rd],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function ql(P){switch(P){case Qo.NOTIFICATION_CLICKED:return"notification_open";case Qo.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function Gu(){return(Gu=(0,Y.Z)(function*(P,O){const G=O.data;if(!G.isFirebaseMessaging)return;P.onMessageHandler&&G.messageType===Qo.PUSH_RECEIVED&&("function"==typeof P.onMessageHandler?P.onMessageHandler(vo(G)):P.onMessageHandler.next(vo(G)));const te=G.data;Sc(te)&&"1"===te[nu]&&(yield Wl(P,G.messageType,te))})).apply(this,arguments)}const Zl="@firebase/messaging",Ic=P=>{const O=new ma(P.getProvider("app").getImmediate(),P.getProvider("installations-internal").getImmediate(),P.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",G=>function Kl(P,O){return Gu.apply(this,arguments)}(O,G)),O},ll=P=>{const O=P.getProvider("messaging").getImmediate();return{getToken:te=>function Cc(P,O){return jl.apply(this,arguments)}(O,te)}};function Yl(){return As.apply(this,arguments)}function As(){return(As=(0,Y.Z)(function*(){try{yield(0,Ae.eu)()}catch(P){return!1}return"undefined"!=typeof window&&(0,Ae.hl)()&&(0,Ae.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function ju(){(0,Oe._registerComponent)(new Ve.wA("messaging",Ic,"PUBLIC")),(0,Oe._registerComponent)(new Ve.wA("messaging-internal",ll,"PRIVATE")),(0,Oe.registerVersion)(Zl,"0.9.14"),(0,Oe.registerVersion)(Zl,"0.9.14","esm2017")}();const Xl="analytics",Oh="firebase_id",wo="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Jl="https://www.googletagmanager.com/gtag/js",$r=new Fe.Yd("@firebase/analytics");function Dc(P){return Promise.all(P.map(O=>O.catch(G=>G)))}function H(P,O){const G=document.createElement("script");G.src=`${Jl}?l=${P}&id=${O}`,G.async=!0,document.head.appendChild(G)}function N(P,O,G,te,ge,Ie){return q.apply(this,arguments)}function q(){return(q=(0,Y.Z)(function*(P,O,G,te,ge,Ie){const nt=te[ge];try{if(nt)yield O[nt];else{const jn=(yield Dc(G)).find(ui=>ui.measurementId===ge);jn&&(yield O[jn.appId])}}catch(Pt){$r.error(Pt)}P("config",ge,Ie)})).apply(this,arguments)}function re(P,O,G,te,ge){return me.apply(this,arguments)}function me(){return(me=(0,Y.Z)(function*(P,O,G,te,ge){try{let Ie=[];if(ge&&ge.send_to){let nt=ge.send_to;Array.isArray(nt)||(nt=[nt]);const Pt=yield Dc(G);for(const jn of nt){const ui=Pt.find(Rn=>Rn.measurementId===jn),Ti=ui&&O[ui.appId];if(!Ti){Ie=[];break}Ie.push(Ti)}}0===Ie.length&&(Ie=Object.values(O)),yield Promise.all(Ie),P("event",te,ge||{})}catch(Ie){$r.error(Ie)}})).apply(this,arguments)}function Nt(){const P=window.document.getElementsByTagName("script");for(const O of Object.values(P))if(O.src&&O.src.includes(Jl))return O;return null}const qe=new Ae.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),bn=new class mn{constructor(O={},G=1e3){this.throttleMetadata=O,this.intervalMillis=G}getThrottleMetadata(O){return this.throttleMetadata[O]}setThrottleMetadata(O,G){this.throttleMetadata[O]=G}deleteThrottleMetadata(O){delete this.throttleMetadata[O]}};function vn(P){return new Headers({Accept:"application/json","x-goog-api-key":P})}function cn(P){return ri.apply(this,arguments)}function ri(){return(ri=(0,Y.Z)(function*(P){var O;const{appId:G,apiKey:te}=P,ge={method:"GET",headers:vn(te)},Ie=wo.replace("{app-id}",G),nt=yield fetch(Ie,ge);if(200!==nt.status&&304!==nt.status){let Pt="";try{const jn=yield nt.json();(null===(O=jn.error)||void 0===O?void 0:O.message)&&(Pt=jn.error.message)}catch(jn){}throw qe.create("config-fetch-failed",{httpStatus:nt.status,responseMessage:Pt})}return nt.json()})).apply(this,arguments)}function St(P){return Gn.apply(this,arguments)}function Gn(){return(Gn=(0,Y.Z)(function*(P,O=bn,G){const{appId:te,apiKey:ge,measurementId:Ie}=P.options;if(!te)throw qe.create("no-app-id");if(!ge){if(Ie)return{measurementId:Ie,appId:te};throw qe.create("no-api-key")}const nt=O.getThrottleMetadata(te)||{backoffCount:0,throttleEndTimeMillis:Date.now()},Pt=new Pi;return setTimeout((0,Y.Z)(function*(){Pt.abort()}),void 0!==G?G:6e4),Qn({appId:te,apiKey:ge,measurementId:Ie},nt,Pt,O)})).apply(this,arguments)}function Qn(P,O,G){return qn.apply(this,arguments)}function qn(){return(qn=(0,Y.Z)(function*(P,{throttleEndTimeMillis:O,backoffCount:G},te,ge=bn){const{appId:Ie,measurementId:nt}=P;try{yield li(te,O)}catch(Pt){if(nt)return $r.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${nt} provided in the "measurementId" field in the local Firebase config. [${Pt.message}]`),{appId:Ie,measurementId:nt};throw Pt}try{const Pt=yield cn(P);return ge.deleteThrottleMetadata(Ie),Pt}catch(Pt){if(!Ii(Pt)){if(ge.deleteThrottleMetadata(Ie),nt)return $r.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${nt} provided in the "measurementId" field in the local Firebase config. [${Pt.message}]`),{appId:Ie,measurementId:nt};throw Pt}const jn=503===Number(Pt.customData.httpStatus)?(0,Ae.$s)(G,ge.intervalMillis,30):(0,Ae.$s)(G,ge.intervalMillis),ui={throttleEndTimeMillis:Date.now()+jn,backoffCount:G+1};return ge.setThrottleMetadata(Ie,ui),$r.debug(`Calling attemptFetch again in ${jn} millis`),Qn(P,ui,te,ge)}})).apply(this,arguments)}function li(P,O){return new Promise((G,te)=>{const ge=Math.max(O-Date.now(),0),Ie=setTimeout(G,ge);P.addEventListener(()=>{clearTimeout(Ie),te(qe.create("fetch-throttle",{throttleEndTimeMillis:O}))})})}function Ii(P){if(!(P instanceof Ae.ZR&&P.customData))return!1;const O=Number(P.customData.httpStatus);return 429===O||500===O||503===O||504===O}class Pi{constructor(){this.listeners=[]}addEventListener(O){this.listeners.push(O)}abort(){this.listeners.forEach(O=>O())}}function Xi(){return dr.apply(this,arguments)}function dr(){return(dr=(0,Y.Z)(function*(){if(!(0,Ae.hl)())return $r.warn(qe.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,Ae.eu)()}catch(P){return $r.warn(qe.create("indexeddb-unavailable",{errorInfo:P}).message),!1}return!0})).apply(this,arguments)}function rr(){return(rr=(0,Y.Z)(function*(P,O,G,te,ge,Ie,nt){var Pt;const jn=St(P);jn.then(xo=>{G[xo.measurementId]=xo.appId,P.options.measurementId&&xo.measurementId!==P.options.measurementId&&$r.warn(`The measurement ID in the local Firebase config (${P.options.measurementId}) does not match the measurement ID fetched from the server (${xo.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(xo=>$r.error(xo)),O.push(jn);const ui=Xi().then(xo=>{if(xo)return te.getId()}),[Ti,Rn]=yield Promise.all([jn,ui]);Nt()||H(Ie,Ti.measurementId),ge("js",new Date);const so=null!==(Pt=null==nt?void 0:nt.config)&&void 0!==Pt?Pt:{};return so.origin="firebase",so.update=!0,null!=Rn&&(so[Oh]=Rn),ge("config",Ti.measurementId,so),Ti.measurementId})).apply(this,arguments)}class Zi{constructor(O){this.app=O}_delete(){return delete xr[this.app.options.appId],Promise.resolve()}}let xr={},ta=[];const zs={};let ya,sr,mr="dataLayer",ci=!1;function cl(P,O,G){!function na(){const P=[];if((0,Ae.ru)()&&P.push("This is a browser extension environment."),(0,Ae.zI)()||P.push("Cookies are not available."),P.length>0){const O=P.map((te,ge)=>`(${ge+1}) ${te}`).join(" "),G=qe.create("invalid-analytics-context",{errorInfo:O});$r.warn(G.message)}}();const te=P.options.appId;if(!te)throw qe.create("no-app-id");if(!P.options.apiKey){if(!P.options.measurementId)throw qe.create("no-api-key");$r.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${P.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=xr[te])throw qe.create("already-exists",{id:te});if(!ci){!function T(P){let O=[];Array.isArray(window[P])?O=window[P]:window[P]=O}(mr);const{wrappedGtag:Ie,gtagCore:nt}=function yt(P,O,G,te,ge){let Ie=function(...nt){window[te].push(arguments)};return window[ge]&&"function"==typeof window[ge]&&(Ie=window[ge]),window[ge]=function De(P,O,G,te){function Ie(){return(Ie=(0,Y.Z)(function*(nt,Pt,jn){try{"event"===nt?yield re(P,O,G,Pt,jn):"config"===nt?yield N(P,O,G,te,Pt,jn):P("set",Pt)}catch(ui){$r.error(ui)}})).apply(this,arguments)}return function ge(nt,Pt,jn){return Ie.apply(this,arguments)}}(Ie,P,O,G),{gtagCore:Ie,wrappedGtag:window[ge]}}(xr,ta,zs,mr,"gtag");sr=Ie,ya=nt,ci=!0}return xr[te]=function br(P,O,G,te,ge,Ie,nt){return rr.apply(this,arguments)}(P,ta,zs,O,ya,mr,G),new Zi(P)}function Ql(){return(Ql=(0,Y.Z)(function*(P,O,G,te,ge){if(ge&&ge.global)P("event",G,te);else{const Ie=yield O;P("event",G,Object.assign(Object.assign({},te),{send_to:Ie}))}})).apply(this,arguments)}function tp(){return Ku.apply(this,arguments)}function Ku(){return(Ku=(0,Y.Z)(function*(){if((0,Ae.ru)()||!(0,Ae.zI)()||!(0,Ae.hl)())return!1;try{return yield(0,Ae.eu)()}catch(P){return!1}})).apply(this,arguments)}const ip="@firebase/analytics";!function sp(){(0,Oe._registerComponent)(new Ve.wA(Xl,(O,{options:G})=>cl(O.getProvider("app").getImmediate(),O.getProvider("installations-internal").getImmediate(),G),"PUBLIC")),(0,Oe._registerComponent)(new Ve.wA("analytics-internal",function P(O){try{const G=O.getProvider(Xl).getImmediate();return{logEvent:(te,ge,Ie)=>function np(P,O,G,te){P=(0,Ae.m9)(P),function ro(P,O,G,te,ge){return Ql.apply(this,arguments)}(sr,xr[P.app.options.appId],O,G,te).catch(ge=>$r.error(ge))}(G,te,ge,Ie)}}catch(G){throw qe.create("interop-component-reg-failed",{reason:G})}},"PRIVATE")),(0,Oe.registerVersion)(ip,"0.7.10"),(0,Oe.registerVersion)(ip,"0.7.10","esm2017")}();var Zu=K(4408),qr=K(7565);const Rc=new class Lh extends qr.v{}(class bw extends Zu.o{constructor(O,G){super(O,G),this.scheduler=O,this.work=G}schedule(O,G=0){return G>0?super.schedule(O,G):(this.delay=G,this.state=O,this.scheduler.flush(this),this)}execute(O,G){return G>0||this.closed?super.execute(O,G):this._execute(O,G)}requestAsyncId(O,G,te=0){return null!=te&&te>0||null==te&&this.delay>0?super.requestAsyncId(O,G,te):O.flush(this)}});var op=K(4986),Dr=K(8505),ia=K(9468),kr=K(5363);const fl=new w.GfV("7.4.1"),Pc="__angularfire_symbol__analyticsIsSupportedValue",ic="__angularfire_symbol__analyticsIsSupported",Ha="__angularfire_symbol__remoteConfigIsSupportedValue",va="__angularfire_symbol__remoteConfigIsSupported",kd="__angularfire_symbol__messagingIsSupportedValue",lu="__angularfire_symbol__messagingIsSupported";function w_(P,O,G){if(O){if(1===O.length)return O[0];const Ie=O.filter(nt=>nt.app===G);if(1===Ie.length)return Ie[0]}return G.container.getProvider(P).getImmediate({optional:!0})}globalThis[ic]||(globalThis[ic]=tp().then(P=>globalThis[Pc]=P).catch(()=>globalThis[Pc]=!1)),globalThis[lu]||(globalThis[lu]=Yl().then(P=>globalThis[kd]=P).catch(()=>globalThis[kd]=!1)),globalThis[va]||(globalThis[va]=Vl().then(P=>globalThis[Ha]=P).catch(()=>globalThis[Ha]=!1));const Ke=(P,O)=>{const G=O?[O]:(0,be.C6)(),te=[];return G.forEach(ge=>{ge.container.getProvider(P).instances.forEach(nt=>{te.includes(nt)||te.push(nt)})}),te};function bo(){}class Xu{constructor(O,G=Rc){this.zone=O,this.delegate=G}now(){return this.delegate.now()}schedule(O,G,te){const ge=this.zone;return this.delegate.schedule(function(nt){ge.runGuarded(()=>{O.apply(this,[nt])})},G,te)}}class za{constructor(O){this.zone=O,this.task=null}call(O,G){const te=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",bo,{},bo,bo)),G.pipe((0,Dr.b)({next:te,complete:te,error:te})).subscribe(O).add(te)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let fi=(()=>{class P{constructor(G){this.ngZone=G,this.outsideAngular=G.runOutsideAngular(()=>new Xu(Zone.current)),this.insideAngular=G.run(()=>new Xu(Zone.current,op.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return P.\u0275fac=function(G){return new(G||P)(w.LFG(w.R0b))},P.\u0275prov=w.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})();function pl(){const P=globalThis.\u0275AngularFireScheduler;if(!P)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return P}function gl(P){return pl(),function Nc(P){return function(G){return(G=G.lift(new za(P.ngZone))).pipe((0,ia.R)(P.outsideAngular),(0,kr.Q)(P.insideAngular))}}(pl())(P)}},2090:(hn,Ze,K)=>{"use strict";K.d(Ze,{BH:()=>Gt,LL:()=>ke,ZR:()=>We,zI:()=>ve,US:()=>Ve,tV:()=>Be,L:()=>Ne,$s:()=>kn,r3:()=>xs,Sg:()=>tt,ne:()=>Es,vZ:()=>Ys,ZB:()=>le,pd:()=>ks,m9:()=>Hi,z$:()=>pt,jU:()=>at,ru:()=>qt,d:()=>lt,xb:()=>An,w1:()=>Ye,hl:()=>ce,uI:()=>Ot,UG:()=>ze,b$:()=>nn,G6:()=>Ut,Mn:()=>st,xO:()=>Ls,zd:()=>ls,eu:()=>Xe});const Oe=function(oe){const fe=[];let pe=0;for(let et=0;et<oe.length;et++){let he=oe.charCodeAt(et);he<128?fe[pe++]=he:he<2048?(fe[pe++]=he>>6|192,fe[pe++]=63&he|128):55296==(64512&he)&&et+1<oe.length&&56320==(64512&oe.charCodeAt(et+1))?(he=65536+((1023&he)<<10)+(1023&oe.charCodeAt(++et)),fe[pe++]=he>>18|240,fe[pe++]=he>>12&63|128,fe[pe++]=he>>6&63|128,fe[pe++]=63&he|128):(fe[pe++]=he>>12|224,fe[pe++]=he>>6&63|128,fe[pe++]=63&he|128)}return fe},Ve={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(oe,fe){if(!Array.isArray(oe))throw Error("encodeByteArray takes an array as a parameter");this.init_();const pe=fe?this.byteToCharMapWebSafe_:this.byteToCharMap_,et=[];for(let he=0;he<oe.length;he+=3){const Ee=oe[he],ct=he+1<oe.length,sn=ct?oe[he+1]:0,wn=he+2<oe.length,Ln=wn?oe[he+2]:0;let Or=(15&sn)<<2|Ln>>6,Ss=63&Ln;wn||(Ss=64,ct||(Or=64)),et.push(pe[Ee>>2],pe[(3&Ee)<<4|sn>>4],pe[Or],pe[Ss])}return et.join("")},encodeString(oe,fe){return this.HAS_NATIVE_SUPPORT&&!fe?btoa(oe):this.encodeByteArray(Oe(oe),fe)},decodeString(oe,fe){return this.HAS_NATIVE_SUPPORT&&!fe?atob(oe):function(oe){const fe=[];let pe=0,et=0;for(;pe<oe.length;){const he=oe[pe++];if(he<128)fe[et++]=String.fromCharCode(he);else if(he>191&&he<224){const Ee=oe[pe++];fe[et++]=String.fromCharCode((31&he)<<6|63&Ee)}else if(he>239&&he<365){const wn=((7&he)<<18|(63&oe[pe++])<<12|(63&oe[pe++])<<6|63&oe[pe++])-65536;fe[et++]=String.fromCharCode(55296+(wn>>10)),fe[et++]=String.fromCharCode(56320+(1023&wn))}else{const Ee=oe[pe++],ct=oe[pe++];fe[et++]=String.fromCharCode((15&he)<<12|(63&Ee)<<6|63&ct)}}return fe.join("")}(this.decodeStringToByteArray(oe,fe))},decodeStringToByteArray(oe,fe){this.init_();const pe=fe?this.charToByteMapWebSafe_:this.charToByteMap_,et=[];for(let he=0;he<oe.length;){const Ee=pe[oe.charAt(he++)],sn=he<oe.length?pe[oe.charAt(he)]:0;++he;const Ln=he<oe.length?pe[oe.charAt(he)]:64;++he;const Fn=he<oe.length?pe[oe.charAt(he)]:64;if(++he,null==Ee||null==sn||null==Ln||null==Fn)throw Error();et.push(Ee<<2|sn>>4),64!==Ln&&(et.push(sn<<4&240|Ln>>2),64!==Fn&&et.push(Ln<<6&192|Fn))}return et},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let oe=0;oe<this.ENCODED_VALS.length;oe++)this.byteToCharMap_[oe]=this.ENCODED_VALS.charAt(oe),this.charToByteMap_[this.byteToCharMap_[oe]]=oe,this.byteToCharMapWebSafe_[oe]=this.ENCODED_VALS_WEBSAFE.charAt(oe),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[oe]]=oe,oe>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(oe)]=oe,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(oe)]=oe)}}},Ne=function(oe){return function(oe){const fe=Oe(oe);return Ve.encodeByteArray(fe,!0)}(oe).replace(/\./g,"")},Be=function(oe){try{return Ve.decodeString(oe,!0)}catch(fe){console.error("base64Decode failed: ",fe)}return null};function le(oe,fe){if(!(fe instanceof Object))return fe;switch(fe.constructor){case Date:return new Date(fe.getTime());case Object:void 0===oe&&(oe={});break;case Array:oe=[];break;default:return fe}for(const pe in fe)!fe.hasOwnProperty(pe)||!Ce(pe)||(oe[pe]=le(oe[pe],fe[pe]));return oe}function Ce(oe){return"__proto__"!==oe}class Gt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((fe,pe)=>{this.resolve=fe,this.reject=pe})}wrapCallback(fe){return(pe,et)=>{pe?this.reject(pe):this.resolve(et),"function"==typeof fe&&(this.promise.catch(()=>{}),1===fe.length?fe(pe):fe(pe,et))}}}function tt(oe,fe){if(oe.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const et=fe||"demo-project",he=oe.iat||0,Ee=oe.sub||oe.user_id;if(!Ee)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ct=Object.assign({iss:`https://securetoken.google.com/${et}`,aud:et,iat:he,exp:he+3600,auth_time:he,sub:Ee,user_id:Ee,firebase:{sign_in_provider:"custom",identities:{}}},oe);return[Ne(JSON.stringify({alg:"none",type:"JWT"})),Ne(JSON.stringify(ct)),""].join(".")}function pt(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ot(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pt())}function ze(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(oe){return!1}}function at(){return"object"==typeof self&&self.self===self}function qt(){const oe="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof oe&&void 0!==oe.id}function nn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function lt(){return pt().indexOf("Electron/")>=0}function Ye(){const oe=pt();return oe.indexOf("MSIE ")>=0||oe.indexOf("Trident/")>=0}function st(){return pt().indexOf("MSAppHost/")>=0}function Ut(){return!ze()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ce(){return"object"==typeof indexedDB}function Xe(){return new Promise((oe,fe)=>{try{let pe=!0;const et="validate-browser-context-for-indexeddb-analytics-module",he=self.indexedDB.open(et);he.onsuccess=()=>{he.result.close(),pe||self.indexedDB.deleteDatabase(et),oe(!0)},he.onupgradeneeded=()=>{pe=!1},he.onerror=()=>{var Ee;fe((null===(Ee=he.error)||void 0===Ee?void 0:Ee.message)||"")}}catch(pe){fe(pe)}})}function ve(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class We extends Error{constructor(fe,pe,et){super(pe),this.code=fe,this.customData=et,this.name="FirebaseError",Object.setPrototypeOf(this,We.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ke.prototype.create)}}class ke{constructor(fe,pe,et){this.service=fe,this.serviceName=pe,this.errors=et}create(fe,...pe){const et=pe[0]||{},he=`${this.service}/${fe}`,Ee=this.errors[fe],ct=Ee?function It(oe,fe){return oe.replace(Pe,(pe,et)=>{const he=fe[et];return null!=he?String(he):`<${et}?>`})}(Ee,et):"Error";return new We(he,`${this.serviceName}: ${ct} (${he}).`,et)}}const Pe=/\{\$([^}]+)}/g;function xs(oe,fe){return Object.prototype.hasOwnProperty.call(oe,fe)}function An(oe){for(const fe in oe)if(Object.prototype.hasOwnProperty.call(oe,fe))return!1;return!0}function Ys(oe,fe){if(oe===fe)return!0;const pe=Object.keys(oe),et=Object.keys(fe);for(const he of pe){if(!et.includes(he))return!1;const Ee=oe[he],ct=fe[he];if(as(Ee)&&as(ct)){if(!Ys(Ee,ct))return!1}else if(Ee!==ct)return!1}for(const he of et)if(!pe.includes(he))return!1;return!0}function as(oe){return null!==oe&&"object"==typeof oe}function Ls(oe){const fe=[];for(const[pe,et]of Object.entries(oe))Array.isArray(et)?et.forEach(he=>{fe.push(encodeURIComponent(pe)+"="+encodeURIComponent(he))}):fe.push(encodeURIComponent(pe)+"="+encodeURIComponent(et));return fe.length?"&"+fe.join("&"):""}function ls(oe){const fe={};return oe.replace(/^\?/,"").split("&").forEach(et=>{if(et){const[he,Ee]=et.split("=");fe[decodeURIComponent(he)]=decodeURIComponent(Ee)}}),fe}function ks(oe){const fe=oe.indexOf("?");if(!fe)return"";const pe=oe.indexOf("#",fe);return oe.substring(fe,pe>0?pe:void 0)}function Es(oe,fe){const pe=new Pn(oe,fe);return pe.subscribe.bind(pe)}class Pn{constructor(fe,pe){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=pe,this.task.then(()=>{fe(this)}).catch(et=>{this.error(et)})}next(fe){this.forEachObserver(pe=>{pe.next(fe)})}error(fe){this.forEachObserver(pe=>{pe.error(fe)}),this.close(fe)}complete(){this.forEachObserver(fe=>{fe.complete()}),this.close()}subscribe(fe,pe,et){let he;if(void 0===fe&&void 0===pe&&void 0===et)throw new Error("Missing Observer.");he=function qi(oe,fe){if("object"!=typeof oe||null===oe)return!1;for(const pe of fe)if(pe in oe&&"function"==typeof oe[pe])return!0;return!1}(fe,["next","error","complete"])?fe:{next:fe,error:pe,complete:et},void 0===he.next&&(he.next=ar),void 0===he.error&&(he.error=ar),void 0===he.complete&&(he.complete=ar);const Ee=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?he.error(this.finalError):he.complete()}catch(ct){}}),this.observers.push(he),Ee}unsubscribeOne(fe){void 0===this.observers||void 0===this.observers[fe]||(delete this.observers[fe],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(fe){if(!this.finalized)for(let pe=0;pe<this.observers.length;pe++)this.sendOne(pe,fe)}sendOne(fe,pe){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[fe])try{pe(this.observers[fe])}catch(et){"undefined"!=typeof console&&console.error&&console.error(et)}})}close(fe){this.finalized||(this.finalized=!0,void 0!==fe&&(this.finalError=fe),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ar(){}function kn(oe,fe=1e3,pe=2){const et=fe*Math.pow(pe,oe),he=Math.round(.5*et*(Math.random()-.5)*2);return Math.min(144e5,et+he)}function Hi(oe){return oe&&oe._delegate?oe._delegate:oe}},5097:(hn,Ze,K)=>{"use strict";var w=K(5e3);let be=null;function Y(){return be}const Fe=new w.OlP("DocumentToken");let Ne=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=w.Yz7({token:i,factory:function(){return function Be(){return(0,w.LFG)(le)}()},providedIn:"platform"}),i})();const ue=new w.OlP("Location Initialized");let le=(()=>{class i extends Ne{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Y().getBaseHref(this._doc)}onPopState(t){const n=Y().getGlobalEventTarget(this._doc,"window");return n.addEventListener("popstate",t,!1),()=>n.removeEventListener("popstate",t)}onHashChange(t){const n=Y().getGlobalEventTarget(this._doc,"window");return n.addEventListener("hashchange",t,!1),()=>n.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,n,r){Ce()?this._history.pushState(t,n,r):this.location.hash=r}replaceState(t,n,r){Ce()?this._history.replaceState(t,n,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Fe))},i.\u0275prov=w.Yz7({token:i,factory:function(){return function Gt(){return new le((0,w.LFG)(Fe))}()},providedIn:"platform"}),i})();function Ce(){return!!window.history.pushState}function tt(i,e){if(0==i.length)return e;if(0==e.length)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?i+e.substring(1):1==t?i+e:i+"/"+e}function pt(i){const e=i.match(/#|\?|$/),t=e&&e.index||i.length;return i.slice(0,t-("/"===i[t-1]?1:0))+i.slice(t)}function Ot(i){return i&&"?"!==i[0]?"?"+i:i}let ze=(()=>{class i{historyGo(t){throw new Error("Not implemented")}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=w.Yz7({token:i,factory:function(){return function at(i){const e=(0,w.LFG)(Fe).location;return new nn((0,w.LFG)(Ne),e&&e.origin||"")}()},providedIn:"root"}),i})();const qt=new w.OlP("appBaseHref");let nn=(()=>{class i extends ze{constructor(t,n){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==n&&(n=this._platformLocation.getBaseHrefFromDOM()),null==n)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=n}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return tt(this._baseHref,t)}path(t=!1){const n=this._platformLocation.pathname+Ot(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${n}${r}`:n}pushState(t,n,r,s){const a=this.prepareExternalUrl(r+Ot(s));this._platformLocation.pushState(t,n,a)}replaceState(t,n,r,s){const a=this.prepareExternalUrl(r+Ot(s));this._platformLocation.replaceState(t,n,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,t)}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Ne),w.LFG(qt,8))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})(),lt=(()=>{class i extends ze{constructor(t,n){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=n&&(this._baseHref=n)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let n=this._platformLocation.hash;return null==n&&(n="#"),n.length>0?n.substring(1):n}prepareExternalUrl(t){const n=tt(this._baseHref,t);return n.length>0?"#"+n:n}pushState(t,n,r,s){let a=this.prepareExternalUrl(r+Ot(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(t,n,a)}replaceState(t,n,r,s){let a=this.prepareExternalUrl(r+Ot(s));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(t,n,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(t=0){var n,r;null===(r=(n=this._platformLocation).historyGo)||void 0===r||r.call(n,t)}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Ne),w.LFG(qt,8))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})(),Ye=(()=>{class i{constructor(t,n){this._subject=new w.vpe,this._urlChangeListeners=[],this._platformStrategy=t;const r=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=pt(Ut(r)),this._platformStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}path(t=!1){return this.normalize(this._platformStrategy.path(t))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(t,n=""){return this.path()==this.normalize(t+Ot(n))}normalize(t){return i.stripTrailingSlash(function Bt(i,e){return i&&e.startsWith(i)?e.substring(i.length):e}(this._baseHref,Ut(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._platformStrategy.prepareExternalUrl(t)}go(t,n="",r=null){this._platformStrategy.pushState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ot(n)),r)}replaceState(t,n="",r=null){this._platformStrategy.replaceState(r,"",t,n),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Ot(n)),r)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(t=0){var n,r;null===(r=(n=this._platformStrategy).historyGo)||void 0===r||r.call(n,t)}onUrlChange(t){this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(n=>{this._notifyUrlChangeListeners(n.url,n.state)}))}_notifyUrlChangeListeners(t="",n){this._urlChangeListeners.forEach(r=>r(t,n))}subscribe(t,n,r){return this._subject.subscribe({next:t,error:n,complete:r})}}return i.normalizeQueryParams=Ot,i.joinWithSlash=tt,i.stripTrailingSlash=pt,i.\u0275fac=function(t){return new(t||i)(w.LFG(ze),w.LFG(Ne))},i.\u0275prov=w.Yz7({token:i,factory:function(){return function st(){return new Ye((0,w.LFG)(ze),(0,w.LFG)(Ne))}()},providedIn:"root"}),i})();function Ut(i){return i.replace(/\/index.html$/,"")}function el(i,e){e=encodeURIComponent(e);for(const t of i.split(";")){const n=t.indexOf("="),[r,s]=-1==n?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}class to{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ts=(()=>{class i{constructor(t,n,r){this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const n=this._viewContainer;t.forEachOperation((r,s,a)=>{if(null==r.previousIndex)n.createEmbeddedView(this._template,new to(r.item,this._ngForOf,-1,-1),null===a?void 0:a);else if(null==a)n.remove(null===s?void 0:s);else if(null!==s){const c=n.get(s);n.move(c,a),Pa(c,r)}});for(let r=0,s=n.length;r<s;r++){const c=n.get(r).context;c.index=r,c.count=s,c.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{Pa(n.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,n){return!0}}return i.\u0275fac=function(t){return new(t||i)(w.Y36(w.s_b),w.Y36(w.Rgc),w.Y36(w.ZZ4))},i.\u0275dir=w.lG2({type:i,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),i})();function Pa(i,e){i.context.$implicit=e.item}let nu=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({}),i})();function Ul(i){return"server"===i}let Hu=(()=>{class i{}return i.\u0275prov=(0,w.Yz7)({token:i,providedIn:"root",factory:()=>new Bl((0,w.LFG)(Fe),window)}),i})();class Bl{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function Uo(i,e){const t=i.getElementById(e)||i.getElementsByName(e)[0];if(t)return t;if("function"==typeof i.createTreeWalker&&i.body&&(i.body.createShadowRoot||i.body.attachShadow)){const n=i.createTreeWalker(i.body,NodeFilter.SHOW_ELEMENT);let r=n.currentNode;for(;r;){const s=r.shadowRoot;if(s){const a=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(a)return a}r=n.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(n-s[0],r-s[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=Cs(this.window.history)||Cs(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function Cs(i){return Object.getOwnPropertyDescriptor(i,"scrollRestoration")}class Fi{}class nl extends class _c extends class Ve{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function Ae(i){be||(be=i)}(new nl)}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Hl(){return Ri=Ri||document.querySelector("base"),Ri?Ri.getAttribute("href"):null}();return null==t?null:function ka(i){vc=vc||document.createElement("a"),vc.setAttribute("href",i);const e=vc.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){Ri=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return el(document.cookie,e)}}let vc,Ri=null;const fs=new w.OlP("TRANSITION_ID"),ur=[{provide:w.ip1,useFactory:function iu(i,e,t){return()=>{t.get(w.CZH).donePromise.then(()=>{const n=Y(),r=e.querySelectorAll(`style[ng-transition="${i}"]`);for(let s=0;s<r.length;s++)n.remove(r[s])})}},deps:[fs,Fe,w.zs3],multi:!0}];class Bo{static init(){(0,w.VLi)(new Bo)}addToWindow(e){w.dqk.getAngularTestability=(n,r=!0)=>{const s=e.findTestabilityInTree(n,r);if(null==s)throw new Error("Could not find testability for element.");return s},w.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),w.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),w.dqk.frameworkStabilizers||(w.dqk.frameworkStabilizers=[]),w.dqk.frameworkStabilizers.push(n=>{const r=w.dqk.getAllAngularTestabilities();let s=r.length,a=!1;const c=function(d){a=a||d,s--,0==s&&n(a)};r.forEach(function(d){d.whenStable(c)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:n?Y().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}let is=(()=>{class i{build(){return new XMLHttpRequest}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();const Fa=new w.OlP("EventManagerPlugins");let ea=(()=>{class i{constructor(t,n){this._zone=n,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,n,r){return this._findPluginFor(n).addEventListener(t,n,r)}addGlobalEventListener(t,n,r){return this._findPluginFor(n).addGlobalEventListener(t,n,r)}getZone(){return this._zone}_findPluginFor(t){const n=this._eventNameToPlugin.get(t);if(n)return n;const r=this._plugins;for(let s=0;s<r.length;s++){const a=r[s];if(a.supports(t))return this._eventNameToPlugin.set(t,a),a}throw new Error(`No event manager plugin found for event ${t}`)}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Fa),w.LFG(w.R0b))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();class wc{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const r=Y().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,n)}}let _o=(()=>{class i{constructor(){this._stylesSet=new Set}addStyles(t){const n=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),n.add(r))}),this.onStylesAdded(n)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})(),Ho=(()=>{class i extends _o{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,n,r){t.forEach(s=>{const a=this._doc.createElement("style");a.textContent=s,r.push(n.appendChild(a))})}addHost(t){const n=[];this._addStylesToHost(this._stylesSet,t,n),this._hostNodes.set(t,n)}removeHost(t){const n=this._hostNodes.get(t);n&&n.forEach(il),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((n,r)=>{this._addStylesToHost(t,r,n)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(il))}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Fe))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();function il(i){Y().remove(i)}const Cn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},rl=/%COMP%/g;function ut(i,e,t){for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)?ut(i,r,t):(r=r.replace(rl,i),t.push(r))}return t}function ai(i){return e=>{if("__ngUnwrap__"===e)return i;!1===i(e)&&(e.preventDefault(),e.returnValue=!1)}}let ir=(()=>{class i{constructor(t,n,r){this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new ol(t)}createRenderer(t,n){if(!t||!n)return this.defaultRenderer;switch(n.encapsulation){case w.ifc.Emulated:{let r=this.rendererByCompId.get(n.id);return r||(r=new Ec(this.eventManager,this.sharedStylesHost,n,this.appId),this.rendererByCompId.set(n.id,r)),r.applyToHost(t),r}case 1:case w.ifc.ShadowDom:return new zu(this.eventManager,this.sharedStylesHost,t,n);default:if(!this.rendererByCompId.has(n.id)){const r=ut(n.id,n.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(n.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(ea),w.LFG(Ho),w.LFG(w.AFp))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();class ol{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Cn[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;const s=Cn[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const r=Cn[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(w.JOm.DashCase|w.JOm.Important)?e.style.setProperty(t,n,r&w.JOm.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&w.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,ai(n)):this.eventManager.addEventListener(e,t,ai(n))}}class Ec extends ol{constructor(e,t,n,r){super(e),this.component=n;const s=ut(r+"-"+n.id,n.styles,[]);t.addStyles(s),this.contentAttr=function pa(i){return"_ngcontent-%COMP%".replace(rl,i)}(r+"-"+n.id),this.hostAttr=function su(i){return"_nghost-%COMP%".replace(rl,i)}(r+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class zu extends ol{constructor(e,t,n,r){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=ut(r.id,r.styles,[]);for(let a=0;a<s.length;a++){const c=document.createElement("style");c.textContent=s[a],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Qf=(()=>{class i extends wc{constructor(t){super(t)}supports(t){return!0}addEventListener(t,n,r){return t.addEventListener(n,r,!1),()=>this.removeEventListener(t,n,r)}removeEventListener(t,n,r){return t.removeEventListener(n,r)}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Fe))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();const Sc=["alt","control","meta","shift"],ou={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ir={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},ma={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey};let Tc=(()=>{class i extends wc{constructor(t){super(t)}supports(t){return null!=i.parseEventName(t)}addEventListener(t,n,r){const s=i.parseEventName(n),a=i.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Y().onAndCancel(t,s.domEventName,a))}static parseEventName(t){const n=t.toLowerCase().split("."),r=n.shift();if(0===n.length||"keydown"!==r&&"keyup"!==r)return null;const s=i._normalizeKey(n.pop());let a="";if(Sc.forEach(d=>{const f=n.indexOf(d);f>-1&&(n.splice(f,1),a+=d+".")}),a+=s,0!=n.length||0===s.length)return null;const c={};return c.domEventName=r,c.fullKey=a,c}static getEventFullKey(t){let n="",r=function Va(i){let e=i.key;if(null==e){if(e=i.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===i.location&&Ir.hasOwnProperty(e)&&(e=Ir[e]))}return ou[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),Sc.forEach(s=>{s!=r&&ma[s](t)&&(n+=s+".")}),n+=r,n}static eventCallback(t,n,r){return s=>{i.getEventFullKey(s)===t&&r.runGuarded(()=>n(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Fe))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();const Cc=(0,w.eFA)(w._c5,"browser",[{provide:w.Lbi,useValue:"browser"},{provide:w.g9A,useValue:function Bs(){nl.makeCurrent(),Bo.init()},multi:!0},{provide:Fe,useFactory:function Ua(){return(0,w.RDi)(document),document},deps:[]}]),jl=[{provide:w.zSh,useValue:"root"},{provide:w.qLn,useFactory:function al(){return new w.qLn},deps:[]},{provide:Fa,useClass:Qf,multi:!0,deps:[Fe,w.R0b,w.Lbi]},{provide:Fa,useClass:Tc,multi:!0,deps:[Fe]},{provide:ir,useClass:ir,deps:[ea,Ho,w.AFp]},{provide:w.FYo,useExisting:ir},{provide:_o,useExisting:Ho},{provide:Ho,useClass:Ho,deps:[Fe]},{provide:w.dDg,useClass:w.dDg,deps:[w.R0b]},{provide:ea,useClass:ea,deps:[Fa,w.R0b]},{provide:Fi,useClass:is,deps:[]}];let Wl=(()=>{class i{constructor(t){if(t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:i,providers:[{provide:w.AFp,useValue:t.appId},{provide:fs,useExisting:w.AFp},ur]}}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(i,12))},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({providers:jl,imports:[nu,w.hGG]}),i})();"undefined"!=typeof window&&window;var Nt=K(7669),Rt=K(8996);function qe(...i){const e=(0,Nt.yG)(i);return(0,Rt.D)(i,e)}var Tt=K(8306),En=K(5577),mn=K(576);function bn(i,e){return(0,mn.m)(e)?(0,En.z)(i,e,1):(0,En.z)(i,1)}var vn=K(4482),cn=K(5403);function ri(i,e){return(0,vn.e)((t,n)=>{let r=0;t.subscribe((0,cn.x)(n,s=>i.call(e,s,r++)&&n.next(s)))})}var St=K(4004);class Gn{}class Qn{}class qn{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const n=t.indexOf(":");if(n>0){const r=t.slice(0,n),s=r.toLowerCase(),a=t.slice(n+1).trim();this.maybeSetNormalizedName(r,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let n=e[t];const r=t.toLowerCase();"string"==typeof n&&(n=[n]),n.length>0&&(this.headers.set(r,n),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof qn?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new qn;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof qn?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if("string"==typeof n&&(n=[n]),0===n.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...n),this.headers.set(t,r);break;case"d":const s=e.value;if(s){let a=this.headers.get(t);if(!a)return;a=a.filter(c=>-1===s.indexOf(c)),0===a.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class li{encodeKey(e){return dr(e)}encodeValue(e){return dr(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Pi=/%(\d[a-f0-9])/gi,Xi={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function dr(i){return encodeURIComponent(i).replace(Pi,(e,t)=>{var n;return null!==(n=Xi[t])&&void 0!==n?n:e})}function br(i){return`${i}`}class rr{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new li,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Ii(i,e){const t=new Map;return i.length>0&&i.replace(/^\?/,"").split("&").forEach(r=>{const s=r.indexOf("="),[a,c]=-1==s?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,s)),e.decodeValue(r.slice(s+1))],d=t.get(a)||[];d.push(c),t.set(a,d)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const n=e.fromObject[t];this.map.set(t,Array.isArray(n)?n:[n])})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(n=>{const r=e[n];Array.isArray(r)?r.forEach(s=>{t.push({param:n,value:s,op:"a"})}):t.push({param:n,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(n=>t+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new rr({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(br(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let n=this.map.get(e.param)||[];const r=n.indexOf(br(e.value));-1!==r&&n.splice(r,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class xr{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function zs(i){return"undefined"!=typeof ArrayBuffer&&i instanceof ArrayBuffer}function mr(i){return"undefined"!=typeof Blob&&i instanceof Blob}function Yi(i){return"undefined"!=typeof FormData&&i instanceof FormData}class sr{constructor(e,t,n,r){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function ta(i){switch(i){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==n?n:null,s=r):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new qn),this.context||(this.context=new xr),this.params){const a=this.params.toString();if(0===a.length)this.urlWithParams=t;else{const c=t.indexOf("?");this.urlWithParams=t+(-1===c?"?":c<t.length-1?"&":"")+a}}else this.params=new rr,this.urlWithParams=t}serializeBody(){return null===this.body?null:zs(this.body)||mr(this.body)||Yi(this.body)||function ya(i){return"undefined"!=typeof URLSearchParams&&i instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof rr?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Yi(this.body)?null:mr(this.body)?this.body.type||null:zs(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof rr?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const n=e.method||this.method,r=e.url||this.url,s=e.responseType||this.responseType,a=void 0!==e.body?e.body:this.body,c=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,d=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let f=e.headers||this.headers,g=e.params||this.params;const v=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(f=Object.keys(e.setHeaders).reduce((b,x)=>b.set(x,e.setHeaders[x]),f)),e.setParams&&(g=Object.keys(e.setParams).reduce((b,x)=>b.set(x,e.setParams[x]),g)),new sr(n,r,a,{params:g,headers:f,context:v,reportProgress:d,responseType:s,withCredentials:c})}}var ci=(()=>((ci=ci||{})[ci.Sent=0]="Sent",ci[ci.UploadProgress=1]="UploadProgress",ci[ci.ResponseHeader=2]="ResponseHeader",ci[ci.DownloadProgress=3]="DownloadProgress",ci[ci.Response=4]="Response",ci[ci.User=5]="User",ci))();class ps{constructor(e,t=200,n="OK"){this.headers=e.headers||new qn,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class na extends ps{constructor(e={}){super(e),this.type=ci.ResponseHeader}clone(e={}){return new na({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class cl extends ps{constructor(e={}){super(e),this.type=ci.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new cl({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class ro extends ps{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Ql(i,e){return{body:e,headers:i.headers,context:i.context,observe:i.observe,params:i.params,reportProgress:i.reportProgress,responseType:i.responseType,withCredentials:i.withCredentials}}let ul=(()=>{class i{constructor(t){this.handler=t}request(t,n,r={}){let s;if(t instanceof sr)s=t;else{let d,f;d=r.headers instanceof qn?r.headers:new qn(r.headers),r.params&&(f=r.params instanceof rr?r.params:new rr({fromObject:r.params})),s=new sr(t,n,void 0!==r.body?r.body:null,{headers:d,context:r.context,params:f,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const a=qe(s).pipe(bn(d=>this.handler.handle(d)));if(t instanceof sr||"events"===r.observe)return a;const c=a.pipe(ri(d=>d instanceof cl));switch(r.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe((0,St.U)(d=>{if(null!==d.body&&!(d.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return d.body}));case"blob":return c.pipe((0,St.U)(d=>{if(null!==d.body&&!(d.body instanceof Blob))throw new Error("Response is not a Blob.");return d.body}));case"text":return c.pipe((0,St.U)(d=>{if(null!==d.body&&"string"!=typeof d.body)throw new Error("Response is not a string.");return d.body}));default:return c.pipe((0,St.U)(d=>d.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,n={}){return this.request("DELETE",t,n)}get(t,n={}){return this.request("GET",t,n)}head(t,n={}){return this.request("HEAD",t,n)}jsonp(t,n){return this.request("JSONP",t,{params:(new rr).append(n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,n={}){return this.request("OPTIONS",t,n)}patch(t,n,r={}){return this.request("PATCH",t,Ql(r,n))}post(t,n,r={}){return this.request("POST",t,Ql(r,n))}put(t,n,r={}){return this.request("PUT",t,Ql(r,n))}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Gn))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();class dl{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const ec=new w.OlP("HTTP_INTERCEPTORS");let tc=(()=>{class i{intercept(t,n){return n.handle(t)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();const hr=/^\)\]\}',?\n/;let v_=(()=>{class i{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Tt.y(n=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((x,C)=>r.setRequestHeader(x,C.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const x=t.detectContentTypeHeader();null!==x&&r.setRequestHeader("Content-Type",x)}if(t.responseType){const x=t.responseType.toLowerCase();r.responseType="json"!==x?x:"text"}const s=t.serializeBody();let a=null;const c=()=>{if(null!==a)return a;const x=r.statusText||"OK",C=new qn(r.getAllResponseHeaders()),I=function __(i){return"responseURL"in i&&i.responseURL?i.responseURL:/^X-Request-URL:/m.test(i.getAllResponseHeaders())?i.getResponseHeader("X-Request-URL"):null}(r)||t.url;return a=new na({headers:C,status:r.status,statusText:x,url:I}),a},d=()=>{let{headers:x,status:C,statusText:I,url:D}=c(),L=null;204!==C&&(L=void 0===r.response?r.responseText:r.response),0===C&&(C=L?200:0);let V=C>=200&&C<300;if("json"===t.responseType&&"string"==typeof L){const z=L;L=L.replace(hr,"");try{L=""!==L?JSON.parse(L):null}catch(U){L=z,V&&(V=!1,L={error:U,text:L})}}V?(n.next(new cl({body:L,headers:x,status:C,statusText:I,url:D||void 0})),n.complete()):n.error(new ro({error:L,headers:x,status:C,statusText:I,url:D||void 0}))},f=x=>{const{url:C}=c(),I=new ro({error:x,status:r.status||0,statusText:r.statusText||"Unknown Error",url:C||void 0});n.error(I)};let g=!1;const v=x=>{g||(n.next(c()),g=!0);let C={type:ci.DownloadProgress,loaded:x.loaded};x.lengthComputable&&(C.total=x.total),"text"===t.responseType&&!!r.responseText&&(C.partialText=r.responseText),n.next(C)},b=x=>{let C={type:ci.UploadProgress,loaded:x.loaded};x.lengthComputable&&(C.total=x.total),n.next(C)};return r.addEventListener("load",d),r.addEventListener("error",f),r.addEventListener("timeout",f),r.addEventListener("abort",f),t.reportProgress&&(r.addEventListener("progress",v),null!==s&&r.upload&&r.upload.addEventListener("progress",b)),r.send(s),n.next({type:ci.Sent}),()=>{r.removeEventListener("error",f),r.removeEventListener("abort",f),r.removeEventListener("load",d),r.removeEventListener("timeout",f),t.reportProgress&&(r.removeEventListener("progress",v),null!==s&&r.upload&&r.upload.removeEventListener("progress",b)),r.readyState!==r.DONE&&r.abort()}})}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Fi))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();const Wm=new w.OlP("XSRF_COOKIE_NAME"),np=new w.OlP("XSRF_HEADER_NAME");class ip{}let rp=(()=>{class i{constructor(t,n,r){this.doc=t,this.platform=n,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=el(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Fe),w.LFG(w.Lbi),w.LFG(Wm))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})(),sp=(()=>{class i{constructor(t,n){this.tokenService=t,this.headerName=n}intercept(t,n){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return n.handle(t);const s=this.tokenService.getToken();return null!==s&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,s)})),n.handle(t)}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(ip),w.LFG(np))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})(),Zu=(()=>{class i{constructor(t,n){this.backend=t,this.injector=n,this.chain=null}handle(t){if(null===this.chain){const n=this.injector.get(ec,[]);this.chain=n.reduceRight((r,s)=>new dl(r,s),this.backend)}return this.chain.handle(t)}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Qn),w.LFG(w.zs3))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})(),Lh=(()=>{class i{static disable(){return{ngModule:i,providers:[{provide:sp,useClass:tc}]}}static withOptions(t={}){return{ngModule:i,providers:[t.cookieName?{provide:Wm,useValue:t.cookieName}:[],t.headerName?{provide:np,useValue:t.headerName}:[]]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({providers:[sp,{provide:ec,useExisting:sp,multi:!0},{provide:ip,useClass:rp},{provide:Wm,useValue:"XSRF-TOKEN"},{provide:np,useValue:"X-XSRF-TOKEN"}]}),i})(),Rc=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({providers:[ul,{provide:Gn,useClass:Zu},v_,{provide:Qn,useExisting:v_}],imports:[[Lh.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),i})();var Dr=K(2011),ia=K(4986),kr=K(5813),fl=K(8189);function ic(...i){return function Pc(){return(0,fl.J)(1)}()((0,Rt.D)(i,(0,Nt.yG)(i)))}function Ha(...i){const e=(0,Nt.yG)(i);return(0,vn.e)((t,n)=>{(e?ic(i,t,e):ic(i,t)).subscribe(n)})}function va(){return(0,vn.e)((i,e)=>{let t,n=!1;i.subscribe((0,cn.x)(e,r=>{const s=t;t=r,n&&e.next([s,r]),n=!0}))})}function kd(i,e,t,n,r){return(s,a)=>{let c=t,d=e,f=0;s.subscribe((0,cn.x)(a,g=>{const v=f++;d=c?i(d,g,v):(c=!0,g),n&&a.next(d)},r&&(()=>{c&&a.next(d),a.complete()})))}}function lu(i,e){return(0,vn.e)(kd(i,e,arguments.length>=2,!0))}var rc=K(4671);function Fd(i,e){return i===e}K(9916);var en,w_=K(3942),Ke=K(5861),bo=K(9681),Xu=K(4859),za=K(1877),fi=K(2090),pl="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},sa={},ml=ml||{},Zn=pl||self;function gl(){}function Nc(i){var e=typeof i;return"array"==(e="object"!=e?e:i?Array.isArray(i)?"array":e:"null")||"object"==e&&"number"==typeof i.length}function Ga(i){var e=typeof i;return"object"==e&&null!=i||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),O=0;function G(i,e,t){return i.call.apply(i.bind,arguments)}function te(i,e,t){if(!i)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),i.apply(e,r)}}return function(){return i.apply(e,arguments)}}function ge(i,e,t){return(ge=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?G:te).apply(null,arguments)}function Ie(i,e){var t=Array.prototype.slice.call(arguments,1);return function(){var n=t.slice();return n.push.apply(n,arguments),i.apply(this,n)}}function nt(i,e){function t(){}t.prototype=e.prototype,i.Z=e.prototype,i.prototype=new t,i.prototype.constructor=i,i.Vb=function(n,r,s){for(var a=Array(arguments.length-2),c=2;c<arguments.length;c++)a[c-2]=arguments[c];return e.prototype[r].apply(n,a)}}function Pt(){this.s=this.s,this.o=this.o}var ui={};Pt.prototype.s=!1,Pt.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var i=function ap(i){return Object.prototype.hasOwnProperty.call(i,P)&&i[P]||(i[P]=++O)}(this);delete ui[i]}},Pt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ti=Array.prototype.indexOf?function(i,e){return Array.prototype.indexOf.call(i,e,void 0)}:function(i,e){if("string"==typeof i)return"string"!=typeof e||1!=e.length?-1:i.indexOf(e,0);for(let t=0;t<i.length;t++)if(t in i&&i[t]===e)return t;return-1},Rn=Array.prototype.forEach?function(i,e,t){Array.prototype.forEach.call(i,e,t)}:function(i,e,t){const n=i.length,r="string"==typeof i?i.split(""):i;for(let s=0;s<n;s++)s in r&&e.call(t,r[s],s,i)};function xo(i){return Array.prototype.concat.apply([],arguments)}function sc(i){const e=i.length;if(0<e){const t=Array(e);for(let n=0;n<e;n++)t[n]=i[n];return t}return[]}function Eo(i){return/^[\s\xa0]*$/.test(i)}var rs,zo=String.prototype.trim?function(i){return i.trim()}:function(i){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(i)[1]};function Is(i,e){return-1!=i.indexOf(e)}function wa(i,e){return i<e?-1:i>e?1:0}e:{var ja=Zn.navigator;if(ja){var Wa=ja.userAgent;if(Wa){rs=Wa;break e}}rs=""}function oc(i,e,t){for(const n in i)e.call(t,i[n],n,i)}function $m(i){const e={};for(const t in i)e[t]=i[t];return e}var qm="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function lp(i,e){let t,n;for(let r=1;r<arguments.length;r++){for(t in n=arguments[r],n)i[t]=n[t];for(let s=0;s<qm.length;s++)t=qm[s],Object.prototype.hasOwnProperty.call(n,t)&&(i[t]=n[t])}}function cu(i){return cu[" "](i),i}cu[" "]=gl;var cp,i,xw=Is(rs,"Opera"),Ju=Is(rs,"Trident")||Is(rs,"MSIE"),Km=Is(rs,"Edge"),Zm=Km||Ju,b_=Is(rs,"Gecko")&&!(Is(rs.toLowerCase(),"webkit")&&!Is(rs,"Edge"))&&!(Is(rs,"Trident")||Is(rs,"MSIE"))&&!Is(rs,"Edge"),Ew=Is(rs.toLowerCase(),"webkit")&&!Is(rs,"Edge");function Fh(){var i=Zn.document;return i?i.documentMode:void 0}e:{var Vd="",Vh=(i=rs,b_?/rv:([^\);]+)(\)|;)/.exec(i):Km?/Edge\/([\d\.]+)/.exec(i):Ju?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(i):Ew?/WebKit\/(\S+)/.exec(i):xw?/(?:Version)[ \/]?(\S+)/.exec(i):void 0);if(Vh&&(Vd=Vh?Vh[1]:""),Ju){var uu=Fh();if(null!=uu&&uu>parseFloat(Vd)){cp=String(uu);break e}}cp=Vd}var Sw={};var Bh=Zn.document&&Ju&&(Fh()||parseInt(cp,10))||void 0,E_=function(){if(!Zn.addEventListener||!Object.defineProperty)return!1;var i=!1,e=Object.defineProperty({},"passive",{get:function(){i=!0}});try{Zn.addEventListener("test",gl,e),Zn.removeEventListener("test",gl,e)}catch(t){}return i}();function oo(i,e){this.type=i,this.g=this.target=e,this.defaultPrevented=!1}function Ud(i,e){if(oo.call(this,i?i.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,i){var t=this.type=i.type,n=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.g=e,e=i.relatedTarget){if(b_){e:{try{cu(e.nodeName);var r=!0;break e}catch(s){}r=!1}r||(e=null)}}else"mouseover"==t?e=i.fromElement:"mouseout"==t&&(e=i.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType="string"==typeof i.pointerType?i.pointerType:S_[i.pointerType]||"",this.state=i.state,this.i=i,i.defaultPrevented&&Ud.Z.h.call(this)}}oo.prototype.h=function(){this.defaultPrevented=!0},nt(Ud,oo);var S_={2:"touch",3:"pen",4:"mouse"};Ud.prototype.h=function(){Ud.Z.h.call(this);var i=this.i;i.preventDefault?i.preventDefault():i.returnValue=!1};var Hh="closure_listenable_"+(1e6*Math.random()|0),T_=0;function Mw(i,e,t,n,r){this.listener=i,this.proxy=null,this.src=e,this.type=t,this.capture=!!n,this.ia=r,this.key=++T_,this.ca=this.fa=!1}function up(i){i.ca=!0,i.listener=null,i.proxy=null,i.src=null,i.ia=null}function dp(i){this.src=i,this.g={},this.h=0}function ac(i,e){var t=e.type;if(t in i.g){var s,n=i.g[t],r=Ti(n,e);(s=0<=r)&&Array.prototype.splice.call(n,r,1),s&&(up(e),0==i.g[t].length&&(delete i.g[t],i.h--))}}function Oc(i,e,t,n){for(var r=0;r<i.length;++r){var s=i[r];if(!s.ca&&s.listener==e&&s.capture==!!t&&s.ia==n)return r}return-1}dp.prototype.add=function(i,e,t,n,r){var s=i.toString();(i=this.g[s])||(i=this.g[s]=[],this.h++);var a=Oc(i,e,n,r);return-1<a?(e=i[a],t||(e.fa=!1)):((e=new Mw(e,this.src,s,!!n,r)).fa=t,i.push(e)),e};var Ym="closure_lm_"+(1e6*Math.random()|0),hp={};function Cw(i,e,t,n,r){if(n&&n.once)return Xm(i,e,t,n,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Cw(i,e[s],t,n,r);return null}return t=A_(t),i&&i[Hh]?i.N(e,t,Ga(n)?!!n.capture:!!n,r):M_(i,e,t,!1,n,r)}function M_(i,e,t,n,r,s){if(!e)throw Error("Invalid event type");var a=Ga(r)?!!r.capture:!!r,c=eg(i);if(c||(i[Ym]=c=new dp(i)),(t=c.add(e,t,n,a,s)).proxy)return t;if(n=function TS(){var e=Aw;return function i(t){return e.call(i.src,i.listener,t)}}(),t.proxy=n,n.src=i,n.listener=t,i.addEventListener)E_||(r=a),void 0===r&&(r=!1),i.addEventListener(e.toString(),n,r);else if(i.attachEvent)i.attachEvent(Qm(e.toString()),n);else{if(!i.addListener||!i.removeListener)throw Error("addEventListener and attachEvent are unavailable.");i.addListener(n)}return t}function Xm(i,e,t,n,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Xm(i,e[s],t,n,r);return null}return t=A_(t),i&&i[Hh]?i.O(e,t,Ga(n)?!!n.capture:!!n,r):M_(i,e,t,!0,n,r)}function Jm(i,e,t,n,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)Jm(i,e[s],t,n,r);else n=Ga(n)?!!n.capture:!!n,t=A_(t),i&&i[Hh]?(i=i.i,(e=String(e).toString())in i.g&&-1<(t=Oc(s=i.g[e],t,n,r))&&(up(s[t]),Array.prototype.splice.call(s,t,1),0==s.length&&(delete i.g[e],i.h--))):i&&(i=eg(i))&&(e=i.g[e.toString()],i=-1,e&&(i=Oc(e,t,n,r)),(t=-1<i?e[i]:null)&&fp(t))}function fp(i){if("number"!=typeof i&&i&&!i.ca){var e=i.src;if(e&&e[Hh])ac(e.i,i);else{var t=i.type,n=i.proxy;e.removeEventListener?e.removeEventListener(t,n,i.capture):e.detachEvent?e.detachEvent(Qm(t),n):e.addListener&&e.removeListener&&e.removeListener(n),(t=eg(e))?(ac(t,i),0==t.h&&(t.src=null,e[Ym]=null)):up(i)}}}function Qm(i){return i in hp?hp[i]:hp[i]="on"+i}function Aw(i,e){if(i.ca)i=!0;else{e=new Ud(e,this);var t=i.listener,n=i.ia||i.src;i.fa&&fp(i),i=t.call(n,e)}return i}function eg(i){return(i=i[Ym])instanceof dp?i:null}var C_="__closure_events_fn_"+(1e9*Math.random()>>>0);function A_(i){return"function"==typeof i?i:(i[C_]||(i[C_]=function(e){return i.handleEvent(e)}),i[C_])}function fr(){Pt.call(this),this.i=new dp(this),this.P=this,this.I=null}function Gs(i,e){var t,n=i.I;if(n)for(t=[];n;n=n.I)t.push(n);if(i=i.P,n=e.type||e,"string"==typeof e)e=new oo(e,i);else if(e instanceof oo)e.target=e.target||i;else{var r=e;lp(e=new oo(n,i),r)}if(r=!0,t)for(var s=t.length-1;0<=s;s--){var a=e.g=t[s];r=ba(a,n,!0,e)&&r}if(r=ba(a=e.g=i,n,!0,e)&&r,r=ba(a,n,!1,e)&&r,t)for(s=0;s<t.length;s++)r=ba(a=e.g=t[s],n,!1,e)&&r}function ba(i,e,t,n){if(!(e=i.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var a=e[s];if(a&&!a.ca&&a.capture==t){var c=a.listener,d=a.ia||a.src;a.fa&&ac(i.i,a),r=!1!==c.call(d,n)&&r}}return r&&!n.defaultPrevented}nt(fr,Pt),fr.prototype[Hh]=!0,fr.prototype.removeEventListener=function(i,e,t,n){Jm(this,i,e,t,n)},fr.prototype.M=function(){if(fr.Z.M.call(this),this.i){var e,i=this.i;for(e in i.g){for(var t=i.g[e],n=0;n<t.length;n++)up(t[n]);delete i.g[e],i.h--}}this.I=null},fr.prototype.N=function(i,e,t,n){return this.i.add(String(i),e,!1,t,n)},fr.prototype.O=function(i,e,t,n){return this.i.add(String(i),e,!0,t,n)};var Lc=Zn.JSON.stringify;function I_(){var i=Iw;let e=null;return i.g&&(e=i.g,i.g=i.g.next,i.g||(i.h=null),e.next=null),e}var zh,tg=new class{constructor(i,e){this.i=i,this.j=e,this.h=0,this.g=null}get(){let i;return 0<this.h?(this.h--,i=this.g,this.g=i.next,i.next=null):i=this.i(),i}}(()=>new MS,i=>i.reset());class MS{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function D_(i){Zn.setTimeout(()=>{throw i},0)}function R_(i,e){zh||function Gh(){var i=Zn.Promise.resolve(void 0);zh=function(){i.then(CS)}}(),jh||(zh(),jh=!0),Iw.add(i,e)}var jh=!1,Iw=new class pp{constructor(){this.h=this.g=null}add(e,t){const n=tg.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function CS(){for(var i;i=I_();){try{i.h.call(i.g)}catch(t){D_(t)}var e=tg;e.j(i),100>e.h&&(e.h++,i.next=e.g,e.g=i)}jh=!1}function Wh(i,e){fr.call(this),this.h=i||1,this.g=e||Zn,this.j=ge(this.kb,this),this.l=Date.now()}function ng(i){i.da=!1,i.S&&(i.g.clearTimeout(i.S),i.S=null)}function mp(i,e,t){if("function"==typeof i)t&&(i=ge(i,t));else{if(!i||"function"!=typeof i.handleEvent)throw Error("Invalid listener argument");i=ge(i.handleEvent,i)}return 2147483647<Number(e)?-1:Zn.setTimeout(i,e||0)}function gp(i){i.g=mp(()=>{i.g=null,i.i&&(i.i=!1,gp(i))},i.j);const e=i.h;i.h=null,i.m.apply(null,e)}nt(Wh,fr),(en=Wh.prototype).da=!1,en.S=null,en.kb=function(){if(this.da){var i=Date.now()-this.l;0<i&&i<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-i):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Gs(this,"tick"),this.da&&(ng(this),this.start()))}},en.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},en.M=function(){Wh.Z.M.call(this),ng(this),delete this.g};class Dw extends Pt{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:gp(this)}M(){super.M(),this.g&&(Zn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bd(i){Pt.call(this),this.h=i,this.g={}}nt(Bd,Pt);var Qu=[];function yp(i,e,t,n){Array.isArray(t)||(t&&(Qu[0]=t.toString()),t=Qu);for(var r=0;r<t.length;r++){var s=Cw(e,t[r],n||i.handleEvent,!1,i.h||i);if(!s)break;i.g[s.key]=s}}function _p(i){oc(i.g,function(e,t){this.g.hasOwnProperty(t)&&fp(e)},i),i.g={}}function vp(){this.g=!0}function Hd(i,e,t,n){i.info(function(){return"XMLHTTP TEXT ("+e+"): "+function rg(i,e){if(!i.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(i=0;i<t.length;i++)if(Array.isArray(t[i])){var n=t[i];if(!(2>n.length)){var r=n[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<r.length;a++)r[a]=""}}}return Lc(t)}catch(c){return e}}(i,t)+(n?" "+n:"")})}Bd.prototype.M=function(){Bd.Z.M.call(this),_p(this)},Bd.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},vp.prototype.Aa=function(){this.g=!1},vp.prototype.info=function(){};var ed={},P_=null;function wp(){return P_=P_||new fr}function N_(i){oo.call(this,ed.Ma,i)}function kc(i){const e=wp();Gs(e,new N_(e,i))}function Pw(i,e){oo.call(this,ed.STAT_EVENT,i),this.stat=e}function Go(i){const e=wp();Gs(e,new Pw(e,i))}function zd(i,e){oo.call(this,ed.Na,i),this.size=e}function Ds(i,e){if("function"!=typeof i)throw Error("Fn must not be null and must be a function");return Zn.setTimeout(function(){i()},e)}ed.Ma="serverreachability",nt(N_,oo),ed.STAT_EVENT="statevent",nt(Pw,oo),ed.Na="timingevent",nt(zd,oo);var Gd={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},sg={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function $h(){}function du(){}$h.prototype.h=null;var bp,hu={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function og(){oo.call(this,"d")}function qh(){oo.call(this,"c")}function So(){}function lc(i,e,t,n){this.l=i,this.j=e,this.m=t,this.X=n||1,this.V=new Bd(this),this.P=O_,this.W=new Wh(i=Zm?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ag}function ag(){this.i=null,this.g="",this.h=!1}nt(og,oo),nt(qh,oo),nt(So,$h),So.prototype.g=function(){return new XMLHttpRequest},So.prototype.i=function(){return{}},bp=new So;var O_=45e3,Kh={},jd={};function Zh(i,e,t){i.K=1,i.v=_(Vc(e)),i.s=t,i.U=!0,lg(i,null)}function lg(i,e){i.F=Date.now(),Yh(i),i.A=Vc(i.v);var t=i.A,n=i.X;Array.isArray(n)||(n=[String(n)]),Qh(t.h,"t",n),i.C=0,t=i.l.H,i.h=new ag,i.g=si(i.l,t?e:null,!i.s),0<i.O&&(i.L=new Dw(ge(i.Ia,i,i.g),i.O)),yp(i.V,i.g,"readystatechange",i.gb),e=i.H?$m(i.H):{},i.s?(i.u||(i.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",i.g.ea(i.A,i.u,i.s,e)):(i.u="GET",i.g.ea(i.A,i.u,null,e)),kc(1),function Fr(i,e,t,n,r,s){i.info(function(){if(i.g)if(s)for(var a="",c=s.split("&"),d=0;d<c.length;d++){var f=c[d].split("=");if(1<f.length){var g=f[0];f=f[1];var v=g.split("_");a=2<=v.length&&"type"==v[1]?a+(g+"=")+f+"&":a+(g+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+e+"\n"+t+"\n"+a})}(i.j,i.u,i.A,i.m,i.X,i.s)}function L_(i){return!!i.g&&"GET"==i.u&&2!=i.K&&i.l.Ba}function yl(i,e,t){let r,n=!0;for(;!i.I&&i.C<t.length;){if(r=k_(i,t),r==jd){4==e&&(i.o=4,Go(14),n=!1),Hd(i.j,i.m,null,"[Incomplete Response]");break}if(r==Kh){i.o=4,Go(15),Hd(i.j,i.m,t,"[Invalid Chunk]"),n=!1;break}Hd(i.j,i.m,r,null),Jh(i,r)}L_(i)&&r!=jd&&r!=Kh&&(i.h.g="",i.C=0),4!=e||0!=t.length||i.h.h||(i.o=1,Go(16),n=!1),i.i=i.i&&n,n?0<t.length&&!i.aa&&(i.aa=!0,(e=i.l).g==i&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),zw(e),e.L=!0,Go(11))):(Hd(i.j,i.m,t,"[Invalid Chunked Response]"),ms(i),Wd(i))}function k_(i,e){var t=i.C,n=e.indexOf("\n",t);return-1==n?jd:(t=Number(e.substring(t,n)),isNaN(t)?Kh:(n+=1)+t>e.length?jd:(e=e.substr(n,t),i.C=n+t,e))}function Yh(i){i.Y=Date.now()+i.P,Xh(i,i.P)}function Xh(i,e){if(null!=i.B)throw Error("WatchDog timer not null");i.B=Ds(ge(i.eb,i),e)}function xp(i){i.B&&(Zn.clearTimeout(i.B),i.B=null)}function Wd(i){0==i.l.G||i.I||kS(i.l,i)}function ms(i){xp(i);var e=i.L;e&&"function"==typeof e.na&&e.na(),i.L=null,ng(i.W),_p(i.V),i.g&&(e=i.g,i.g=null,e.abort(),e.na())}function Jh(i,e){try{var t=i.l;if(0!=t.G&&(t.g==i||ef(t.i,i)))if(t.I=i.N,!i.J&&ef(t.i,i)&&3==t.G){try{var n=t.Ca.g.parse(e)}catch(f){n=null}if(Array.isArray(n)&&3==n.length){var r=n;if(0==r[0])e:if(t.u)t.ta=r[1],0<t.ta-t.U&&37500>r[2]&&t.N&&0==t.A&&!t.v&&(t.v=Ds(ge(t.ab,t),6e3));else{if(t.g){if(!(t.g.F+3e3<i.F))break e;K_(t),xg(t)}q_(t),Go(18)}if(1>=V_(t.i)&&t.ka){try{t.ka()}catch(f){}t.ka=void 0}}else tf(t,11)}else if((i.J||t.g==i)&&K_(t),!Eo(e))for(r=t.Ca.g.parse(e),e=0;e<r.length;e++){let f=r[e];if(t.U=f[0],f=f[1],2==t.G)if("c"==f[0]){t.J=f[1],t.la=f[2];const g=f[3];null!=g&&(t.ma=g,t.h.info("VER="+t.ma));const v=f[4];null!=v&&(t.za=v,t.h.info("SVER="+t.za));const b=f[5];null!=b&&"number"==typeof b&&0<b&&(t.K=n=1.5*b,t.h.info("backChannelRequestTimeoutMs_="+n)),n=t;const x=i.g;if(x){const C=x.g?x.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(C){var s=n.i;!s.g&&(Is(C,"spdy")||Is(C,"quic")||Is(C,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(mg(s,s.h),s.h=null))}if(n.D){const I=x.g?x.g.getResponseHeader("X-HTTP-Session-Id"):null;I&&(n.sa=I,m(n.F,n.D,I))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-i.F,t.h.info("Handshake RTT: "+t.O+"ms"));var a=i;if((n=t).oa=VS(n,n.H?n.la:null,n.W),a.J){Ow(n.i,a);var c=a,d=n.K;d&&c.setTimeout(d),c.B&&(xp(c),Yh(c)),n.g=a}else OS(n);0<t.l.length&&$_(t)}else"stop"!=f[0]&&"close"!=f[0]||tf(t,7);else 3==t.G&&("stop"==f[0]||"close"==f[0]?"stop"==f[0]?tf(t,7):bg(t):"noop"!=f[0]&&t.j&&t.j.wa(f),t.A=0)}kc(4)}catch(f){}}function Ep(i,e){if(i.forEach&&"function"==typeof i.forEach)i.forEach(e,void 0);else if(Nc(i)||"string"==typeof i)Rn(i,e,void 0);else{if(i.T&&"function"==typeof i.T)var t=i.T();else if(i.R&&"function"==typeof i.R)t=void 0;else if(Nc(i)||"string"==typeof i){t=[];for(var n=i.length,r=0;r<n;r++)t.push(r)}else for(r in t=[],n=0,i)t[n++]=r;n=function cg(i){if(i.R&&"function"==typeof i.R)return i.R();if("string"==typeof i)return i.split("");if(Nc(i)){for(var e=[],t=i.length,n=0;n<t;n++)e.push(i[n]);return e}for(n in e=[],t=0,i)e[t++]=i[n];return e}(i),r=n.length;for(var s=0;s<r;s++)e.call(void 0,n[s],t&&t[s],i)}}function oa(i,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var n=0;n<t;n+=2)this.set(arguments[n],arguments[n+1])}else if(i)if(i instanceof oa)for(t=i.T(),n=0;n<t.length;n++)this.set(t[n],i.get(t[n]));else for(n in i)this.set(n,i[n])}function td(i){if(i.i!=i.g.length){for(var e=0,t=0;e<i.g.length;){var n=i.g[e];fu(i.h,n)&&(i.g[t++]=n),e++}i.g.length=t}if(i.i!=i.g.length){var r={};for(t=e=0;e<i.g.length;)fu(r,n=i.g[e])||(i.g[t++]=n,r[n]=1),e++;i.g.length=t}}function fu(i,e){return Object.prototype.hasOwnProperty.call(i,e)}(en=lc.prototype).setTimeout=function(i){this.P=i},en.gb=function(i){i=i.target;const e=this.L;e&&3==_l(i)?e.l():this.Ia(i)},en.Ia=function(i){try{if(i==this.g)e:{const g=_l(this.g);var e=this.g.Da();const v=this.g.ba();if(!(3>g)&&(3!=g||Zm||this.g&&(this.h.h||this.g.ga()||DS(this.g)))){this.I||4!=g||7==e||kc(8==e||0>=v?3:2),xp(this);var t=this.g.ba();this.N=t;t:if(L_(this)){var n=DS(this.g);i="";var r=n.length,s=4==_l(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){ms(this),Wd(this);var a="";break t}this.h.i=new Zn.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,i+=this.h.i.decode(n[e],{stream:s&&e==r-1});n.splice(0,r),this.h.g+=i,this.C=0,a=this.h.g}else a=this.g.ga();if(this.i=200==t,function Rw(i,e,t,n,r,s,a){i.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+e+"\n"+t+"\n"+s+" "+a})}(this.j,this.u,this.A,this.m,this.X,g,t),this.i){if(this.$&&!this.J){t:{if(this.g){var c,d=this.g;if((c=d.g?d.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Eo(c)){var f=c;break t}}f=null}if(!(t=f)){this.i=!1,this.o=3,Go(12),ms(this),Wd(this);break e}Hd(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Jh(this,t)}this.U?(yl(this,g,a),Zm&&this.i&&3==g&&(yp(this.V,this.W,"tick",this.fb),this.W.start())):(Hd(this.j,this.m,a,null),Jh(this,a)),4==g&&ms(this),this.i&&!this.I&&(4==g?kS(this.l,this):(this.i=!1,Yh(this)))}else 400==t&&0<a.indexOf("Unknown SID")?(this.o=3,Go(12)):(this.o=0,Go(13)),ms(this),Wd(this)}}}catch(g){}},en.fb=function(){if(this.g){var i=_l(this.g),e=this.g.ga();this.C<e.length&&(xp(this),yl(this,i,e),this.i&&4!=i&&Yh(this))}},en.cancel=function(){this.I=!0,ms(this)},en.eb=function(){this.B=null;const i=Date.now();0<=i-this.Y?(function ig(i,e){i.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(kc(3),Go(17)),ms(this),this.o=2,Wd(this)):Xh(this,this.Y-i)},(en=oa.prototype).R=function(){td(this);for(var i=[],e=0;e<this.g.length;e++)i.push(this.h[this.g[e]]);return i},en.T=function(){return td(this),this.g.concat()},en.get=function(i,e){return fu(this.h,i)?this.h[i]:e},en.set=function(i,e){fu(this.h,i)||(this.i++,this.g.push(i)),this.h[i]=e},en.forEach=function(i,e){for(var t=this.T(),n=0;n<t.length;n++){var r=t[n],s=this.get(r);i.call(e,s,r,this)}};var ug=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Fc(i,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,i instanceof Fc){this.g=void 0!==e?e:i.g,Sp(this,i.j),this.s=i.s,Uc(this,i.i),xa(this,i.m),this.l=i.l,e=i.h;var t=new ao;t.i=e.i,e.g&&(t.g=new oa(e.g),t.h=e.h),E(this,t),this.o=i.o}else i&&(t=String(i).match(ug))?(this.g=!!e,Sp(this,t[1]||"",!0),this.s=W(t[2]||""),Uc(this,t[3]||"",!0),xa(this,t[4]),this.l=W(t[5]||"",!0),E(this,t[6]||"",!0),this.o=W(t[7]||"")):(this.g=!!e,this.h=new ao(null,this.g))}function Vc(i){return new Fc(i)}function Sp(i,e,t){i.j=t?W(e,!0):e,i.j&&(i.j=i.j.replace(/:$/,""))}function Uc(i,e,t){i.i=t?W(e,!0):e}function xa(i,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);i.m=e}else i.m=null}function E(i,e,t){e instanceof ao?(i.h=e,function dg(i,e){e&&!i.j&&($a(i),i.i=null,i.g.forEach(function(t,n){var r=n.toLowerCase();n!=r&&(F_(this,n),Qh(this,r,t))},i)),i.j=e}(i.h,i.g)):(t||(e=ye(e,In)),i.h=new ao(e,i.g))}function m(i,e,t){i.h.set(e,t)}function _(i){return m(i,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),i}function W(i,e){return i?e?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function ye(i,e,t){return"string"==typeof i?(i=encodeURI(i).replace(e,je),t&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function je(i){return"%"+((i=i.charCodeAt(0))>>4&15).toString(16)+(15&i).toString(16)}Fc.prototype.toString=function(){var i=[],e=this.j;e&&i.push(ye(e,kt,!0),":");var t=this.i;return(t||"file"==e)&&(i.push("//"),(e=this.s)&&i.push(ye(e,kt,!0),"@"),i.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&i.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&i.push("/"),i.push(ye(t,"/"==t.charAt(0)?Vn:on,!0))),(t=this.h.toString())&&i.push("?",t),(t=this.o)&&i.push("#",ye(t,ss)),i.join("")};var kt=/[#\/\?@]/g,on=/[#\?:]/g,Vn=/[#\?]/g,In=/[#\?@]/g,ss=/#/g;function ao(i,e){this.h=this.g=null,this.i=i||null,this.j=!!e}function $a(i){i.g||(i.g=new oa,i.h=0,i.i&&function Nw(i,e){if(i){i=i.split("&");for(var t=0;t<i.length;t++){var n=i[t].indexOf("="),r=null;if(0<=n){var s=i[t].substring(0,n);r=i[t].substring(n+1)}else s=i[t];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(i.i,function(e,t){i.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function F_(i,e){$a(i),e=pu(i,e),fu(i.g.h,e)&&(i.i=null,i.h-=i.g.get(e).length,fu((i=i.g).h,e)&&(delete i.h[e],i.i--,i.g.length>2*i.i&&td(i)))}function Bc(i,e){return $a(i),e=pu(i,e),fu(i.g.h,e)}function Qh(i,e,t){F_(i,e),0<t.length&&(i.i=null,i.g.set(pu(i,e),sc(t)),i.h+=t.length)}function pu(i,e){return e=String(e),i.j&&(e=e.toLowerCase()),e}function hg(i){this.l=i||fg,i=Zn.PerformanceNavigationTiming?0<(i=Zn.performance.getEntriesByType("navigation")).length&&("hq"==i[0].nextHopProtocol||"h2"==i[0].nextHopProtocol):!!(Zn.g&&Zn.g.Ea&&Zn.g.Ea()&&Zn.g.Ea().Zb),this.j=i?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(en=ao.prototype).add=function(i,e){$a(this),this.i=null,i=pu(this,i);var t=this.g.get(i);return t||this.g.set(i,t=[]),t.push(e),this.h+=1,this},en.forEach=function(i,e){$a(this),this.g.forEach(function(t,n){Rn(t,function(r){i.call(e,r,n,this)},this)},this)},en.T=function(){$a(this);for(var i=this.g.R(),e=this.g.T(),t=[],n=0;n<e.length;n++)for(var r=i[n],s=0;s<r.length;s++)t.push(e[n]);return t},en.R=function(i){$a(this);var e=[];if("string"==typeof i)Bc(this,i)&&(e=xo(e,this.g.get(pu(this,i))));else{i=this.g.R();for(var t=0;t<i.length;t++)e=xo(e,i[t])}return e},en.set=function(i,e){return $a(this),this.i=null,Bc(this,i=pu(this,i))&&(this.h-=this.g.get(i).length),this.g.set(i,[e]),this.h+=1,this},en.get=function(i,e){return i&&0<(i=this.R(i)).length?String(i[0]):e},en.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var i=[],e=this.g.T(),t=0;t<e.length;t++){var n=e[t],r=encodeURIComponent(String(n));n=this.R(n);for(var s=0;s<n.length;s++){var a=r;""!==n[s]&&(a+="="+encodeURIComponent(String(n[s]))),i.push(a)}}return this.i=i.join("&")};var fg=10;function pg(i){return!!i.h||!!i.g&&i.g.size>=i.j}function V_(i){return i.h?1:i.g?i.g.size:0}function ef(i,e){return i.h?i.h==e:!!i.g&&i.g.has(e)}function mg(i,e){i.g?i.g.add(e):i.h=e}function Ow(i,e){i.h&&i.h==e?i.h=null:i.g&&i.g.has(e)&&i.g.delete(e)}function U_(i){if(null!=i.h)return i.i.concat(i.h.D);if(null!=i.g&&0!==i.g.size){let e=i.i;for(const t of i.g.values())e=e.concat(t.D);return e}return sc(i.i)}function B_(){}function Lw(){this.g=new B_}function iI(i,e,t){const n=t||"";try{Ep(i,function(r,s){let a=r;Ga(r)&&(a=Lc(r)),e.push(n+s+"="+encodeURIComponent(a))})}catch(r){throw e.push(n+"type="+encodeURIComponent("_badmap")),r}}function gg(i,e,t,n,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(n)}catch(s){}}function Mp(i){this.l=i.$b||null,this.j=i.ib||!1}function mu(i,e){fr.call(this),this.D=i,this.u=e,this.m=void 0,this.readyState=H_,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}hg.prototype.cancel=function(){if(this.i=U_(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const i of this.g.values())i.cancel();this.g.clear()}},B_.prototype.stringify=function(i){return Zn.JSON.stringify(i,void 0)},B_.prototype.parse=function(i){return Zn.JSON.parse(i,void 0)},nt(Mp,$h),Mp.prototype.g=function(){return new mu(this.l,this.j)},Mp.prototype.i=function(i){return function(){return i}}({}),nt(mu,fr);var H_=0;function kw(i){i.j.read().then(i.Sa.bind(i)).catch(i.ha.bind(i))}function yg(i){i.readyState=4,i.l=null,i.j=null,i.A=null,$d(i)}function $d(i){i.onreadystatechange&&i.onreadystatechange.call(i)}(en=mu.prototype).open=function(i,e){if(this.readyState!=H_)throw this.abort(),Error("Error reopening a connection");this.C=i,this.B=e,this.readyState=1,$d(this)},en.send=function(i){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};i&&(e.body=i),(this.D||Zn).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},en.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,yg(this)),this.readyState=H_},en.Va=function(i){if(this.g&&(this.l=i,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=i.headers,this.readyState=2,$d(this)),this.g&&(this.readyState=3,$d(this),this.g)))if("arraybuffer"===this.responseType)i.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==Zn.ReadableStream&&"body"in i){if(this.j=i.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;kw(this)}else i.text().then(this.Ua.bind(this),this.ha.bind(this))},en.Sa=function(i){if(this.g){if(this.u&&i.value)this.response.push(i.value);else if(!this.u){var e=i.value?i.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!i.done}))&&(this.response=this.responseText+=e)}i.done?yg(this):$d(this),3==this.readyState&&kw(this)}},en.Ua=function(i){this.g&&(this.response=this.responseText=i,yg(this))},en.Ta=function(i){this.g&&(this.response=i,yg(this))},en.ha=function(){this.g&&yg(this)},en.setRequestHeader=function(i,e){this.v.append(i,e)},en.getResponseHeader=function(i){return this.h&&this.h.get(i.toLowerCase())||""},en.getAllResponseHeaders=function(){if(!this.h)return"";const i=[],e=this.h.entries();for(var t=e.next();!t.done;)i.push((t=t.value)[0]+": "+t[1]),t=e.next();return i.join("\r\n")},Object.defineProperty(mu.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(i){this.m=i?"include":"same-origin"}});var sI=Zn.JSON.parse;function Ps(i){fr.call(this),this.headers=new oa,this.u=i||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Fw,this.K=this.L=!1}nt(Ps,fr);var Fw="",AS=/^https?$/i,Vw=["POST","PUT"];function z_(i){return"content-type"==i.toLowerCase()}function _g(i,e){i.h=!1,i.g&&(i.l=!0,i.g.abort(),i.l=!1),i.j=e,i.m=5,Uw(i),vg(i)}function Uw(i){i.D||(i.D=!0,Gs(i,"complete"),Gs(i,"error"))}function G_(i){if(i.h&&void 0!==ml&&(!i.C[1]||4!=_l(i)||2!=i.ba()))if(i.v&&4==_l(i))mp(i.Fa,0,i);else if(Gs(i,"readystatechange"),4==_l(i)){i.h=!1;try{const c=i.ba();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var n;if(n=0===c){var r=String(i.H).match(ug)[1]||null;if(!r&&Zn.self&&Zn.self.location){var s=Zn.self.location.protocol;r=s.substr(0,s.length-1)}n=!AS.test(r?r.toLowerCase():"")}t=n}if(t)Gs(i,"complete"),Gs(i,"success");else{i.m=6;try{var a=2<_l(i)?i.g.statusText:""}catch(d){a=""}i.j=a+" ["+i.ba()+"]",Uw(i)}}finally{vg(i)}}}function vg(i,e){if(i.g){j_(i);const t=i.g,n=i.C[0]?gl:null;i.g=null,i.C=null,e||Gs(i,"ready");try{t.onreadystatechange=n}catch(r){}}}function j_(i){i.g&&i.K&&(i.g.ontimeout=null),i.A&&(Zn.clearTimeout(i.A),i.A=null)}function _l(i){return i.g?i.g.readyState:0}function DS(i){try{if(!i.g)return null;if("response"in i.g)return i.g.response;switch(i.J){case Fw:case"text":return i.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in i.g)return i.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Bw(i,e,t){e:{for(n in t){var n=!1;break e}n=!0}n||(t=function RS(i){let e="";return oc(i,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof i?null!=t&&encodeURIComponent(String(t)):m(i,e,t))}function wg(i,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[i]||e}function Hw(i){this.za=0,this.l=[],this.h=new vp,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=wg("failFast",!1,i),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=wg("baseRetryDelayMs",5e3,i),this.$a=wg("retryDelaySeedMs",1e4,i),this.Ya=wg("forwardChannelMaxRetries",2,i),this.ra=wg("forwardChannelRequestTimeoutMs",2e4,i),this.qa=i&&i.xmlHttpFactory||void 0,this.Ba=i&&i.Yb||!1,this.K=void 0,this.H=i&&i.supportsCrossDomainXhr||!1,this.J="",this.i=new hg(i&&i.concurrentRequestLimit),this.Ca=new Lw,this.ja=i&&i.fastHandshake||!1,this.Ra=i&&i.Wb||!1,i&&i.Aa&&this.h.Aa(),i&&i.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&i&&i.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!i||!1!==i.Xb}function bg(i){if(oI(i),3==i.G){var e=i.V++,t=Vc(i.F);m(t,"SID",i.J),m(t,"RID",e),m(t,"TYPE","terminate"),Eg(i,t),(e=new lc(i,i.h,e,void 0)).K=2,e.v=_(Vc(t)),t=!1,Zn.navigator&&Zn.navigator.sendBeacon&&(t=Zn.navigator.sendBeacon(e.v.toString(),"")),!t&&Zn.Image&&((new Image).src=e.v,t=!0),t||(e.g=si(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Yh(e)}FS(i)}function xg(i){i.g&&(zw(i),i.g.cancel(),i.g=null)}function oI(i){xg(i),i.u&&(Zn.clearTimeout(i.u),i.u=null),K_(i),i.i.cancel(),i.m&&("number"==typeof i.m&&Zn.clearTimeout(i.m),i.m=null)}function W_(i,e){i.l.push(new class{constructor(i,e){this.h=i,this.g=e}}(i.Za++,e)),3==i.G&&$_(i)}function $_(i){pg(i.i)||i.m||(i.m=!0,R_(i.Ha,i),i.C=0)}function NS(i,e){var t;t=e?e.m:i.V++;const n=Vc(i.F);m(n,"SID",i.J),m(n,"RID",t),m(n,"AID",i.U),Eg(i,n),i.o&&i.s&&Bw(n,i.o,i.s),t=new lc(i,i.h,t,i.C+1),null===i.o&&(t.H=i.s),e&&(i.l=e.D.concat(i.l)),e=cc(i,t,1e3),t.setTimeout(Math.round(.5*i.ra)+Math.round(.5*i.ra*Math.random())),mg(i.i,t),Zh(t,n,e)}function Eg(i,e){i.j&&Ep({},function(t,n){m(e,n,t)})}function cc(i,e,t){t=Math.min(i.l.length,t);var n=i.j?ge(i.j.Oa,i.j,i):null;e:{var r=i.l;let s=-1;for(;;){const a=["count="+t];-1==s?0<t?(s=r[0].h,a.push("ofs="+s)):s=0:a.push("ofs="+s);let c=!0;for(let d=0;d<t;d++){let f=r[d].h;const g=r[d].g;if(f-=s,0>f)s=Math.max(0,r[d].h-100),c=!1;else try{iI(g,a,"req"+f+"_")}catch(v){n&&n(g)}}if(c){n=a.join("&");break e}}}return i=i.l.splice(0,t),e.D=i,n}function OS(i){i.g||i.u||(i.Y=1,R_(i.Ga,i),i.A=0)}function q_(i){return!(i.g||i.u||3<=i.A||(i.Y++,i.u=Ds(ge(i.Ga,i),Gw(i,i.A)),i.A++,0))}function zw(i){null!=i.B&&(Zn.clearTimeout(i.B),i.B=null)}function LS(i){i.g=new lc(i,i.h,"rpc",i.Y),null===i.o&&(i.g.H=i.s),i.g.O=0;var e=Vc(i.oa);m(e,"RID","rpc"),m(e,"SID",i.J),m(e,"CI",i.N?"0":"1"),m(e,"AID",i.U),Eg(i,e),m(e,"TYPE","xmlhttp"),i.o&&i.s&&Bw(e,i.o,i.s),i.K&&i.g.setTimeout(i.K);var t=i.g;i=i.la,t.K=1,t.v=_(Vc(e)),t.s=null,t.U=!0,lg(t,i)}function K_(i){null!=i.v&&(Zn.clearTimeout(i.v),i.v=null)}function kS(i,e){var t=null;if(i.g==e){K_(i),zw(i),i.g=null;var n=2}else{if(!ef(i.i,e))return;t=e.D,Ow(i.i,e),n=1}if(i.I=e.N,0!=i.G)if(e.i)if(1==n){t=e.s?e.s.length:0,e=Date.now()-e.F;var r=i.C;Gs(n=wp(),new zd(n,t,e,r)),$_(i)}else OS(i);else if(3==(r=e.o)||0==r&&0<i.I||!(1==n&&function PS(i,e){return!(V_(i.i)>=i.i.j-(i.m?1:0)||(i.m?(i.l=e.D.concat(i.l),0):1==i.G||2==i.G||i.C>=(i.Xa?0:i.Ya)||(i.m=Ds(ge(i.Ha,i,e),Gw(i,i.C)),i.C++,0)))}(i,e)||2==n&&q_(i)))switch(t&&0<t.length&&(e=i.i,e.i=e.i.concat(t)),r){case 1:tf(i,5);break;case 4:tf(i,10);break;case 3:tf(i,6);break;default:tf(i,2)}}function Gw(i,e){let t=i.Pa+Math.floor(Math.random()*i.$a);return i.j||(t*=2),t*e}function tf(i,e){if(i.h.info("Error code "+e),2==e){var t=null;i.j&&(t=null);var n=ge(i.jb,i);t||(t=new Fc("//www.google.com/images/cleardot.gif"),Zn.location&&"http"==Zn.location.protocol||Sp(t,"https"),_(t)),function rI(i,e){const t=new vp;if(Zn.Image){const n=new Image;n.onload=Ie(gg,t,n,"TestLoadImage: loaded",!0,e),n.onerror=Ie(gg,t,n,"TestLoadImage: error",!1,e),n.onabort=Ie(gg,t,n,"TestLoadImage: abort",!1,e),n.ontimeout=Ie(gg,t,n,"TestLoadImage: timeout",!1,e),Zn.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=i}else e(!1)}(t.toString(),n)}else Go(2);i.G=0,i.j&&i.j.va(e),FS(i),oI(i)}function FS(i){i.G=0,i.I=-1,i.j&&((0!=U_(i.i).length||0!=i.l.length)&&(i.i.i.length=0,sc(i.l),i.l.length=0),i.j.ua())}function VS(i,e,t){let n=function M(i){return i instanceof Fc?Vc(i):new Fc(i,void 0)}(t);if(""!=n.i)e&&Uc(n,e+"."+n.i),xa(n,n.m);else{const r=Zn.location;n=function k(i,e,t,n){var r=new Fc(null,void 0);return i&&Sp(r,i),e&&Uc(r,e),t&&xa(r,t),n&&(r.l=n),r}(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,t)}return i.aa&&oc(i.aa,function(r,s){m(n,s,r)}),t=i.sa,(e=i.D)&&t&&m(n,e,t),m(n,"VER",i.ma),Eg(i,n),n}function si(i,e,t){if(e&&!i.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ps(t&&i.Ba&&!i.qa?new Mp({ib:!0}):i.qa)).L=i.H,e}function jw(){}function Sg(){if(Ju&&!(10<=Number(Bh)))throw Error("Environmental error: no available transport.")}function qa(i,e){fr.call(this),this.g=new Hw(e),this.l=i,this.h=e&&e.messageUrlParams||null,i=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(i?i["X-Client-Protocol"]="webchannel":i={"X-Client-Protocol":"webchannel"}),this.g.s=i,i=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(i?i["X-WebChannel-Content-Type"]=e.messageContentType:i={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(i?i["X-WebChannel-Client-Profile"]=e.ya:i={"X-WebChannel-Client-Profile":e.ya}),this.g.P=i,(i=e&&e.httpHeadersOverwriteParam)&&!Eo(i)&&(this.g.o=i),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Eo(e)&&(this.g.D=e,null!==(i=this.h)&&e in i&&e in(i=this.h)&&delete i[e]),this.j=new nf(this)}function Tg(i){og.call(this);var e=i.__sm__;if(e){e:{for(const t in e){i=t;break e}i=void 0}(this.i=i)&&(i=this.i,e=null!==e&&i in e?e[i]:void 0),this.data=e}else this.data=i}function uc(){qh.call(this),this.status=1}function nf(i){this.g=i}(en=Ps.prototype).ea=function(i,e,t,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+i);e=e?e.toUpperCase():"GET",this.H=i,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():bp.g(),this.C=function Rs(i){return i.h||(i.h=i.i())}(this.u?this.u:bp),this.g.onreadystatechange=ge(this.Fa,this);try{this.F=!0,this.g.open(e,String(i),!0),this.F=!1}catch(s){return void _g(this,s)}i=t||"";const r=new oa(this.headers);n&&Ep(n,function(s,a){r.set(a,s)}),n=function so(i){e:{var e=z_;const t=i.length,n="string"==typeof i?i.split(""):i;for(let r=0;r<t;r++)if(r in n&&e.call(void 0,n[r],r,i)){e=r;break e}e=-1}return 0>e?null:"string"==typeof i?i.charAt(e):i[e]}(r.T()),t=Zn.FormData&&i instanceof Zn.FormData,!(0<=Ti(Vw,e))||n||t||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(s,a){this.g.setRequestHeader(a,s)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{j_(this),0<this.B&&((this.K=function IS(i){return Ju&&function Tw(){return function kh(i){var e=Sw;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=i(9)}(function(){let i=0;const e=zo(String(cp)).split("."),t=zo("9").split("."),n=Math.max(e.length,t.length);for(let a=0;0==i&&a<n;a++){var r=e[a]||"",s=t[a]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;i=wa(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||wa(0==r[2].length,0==s[2].length)||wa(r[2],s[2]),r=r[3],s=s[3]}while(0==i)}return 0<=i})}()&&"number"==typeof i.timeout&&void 0!==i.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ge(this.pa,this)):this.A=mp(this.pa,this.B,this)),this.v=!0,this.g.send(i),this.v=!1}catch(s){_g(this,s)}},en.pa=function(){void 0!==ml&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Gs(this,"timeout"),this.abort(8))},en.abort=function(i){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=i||7,Gs(this,"complete"),Gs(this,"abort"),vg(this))},en.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vg(this,!0)),Ps.Z.M.call(this)},en.Fa=function(){this.s||(this.F||this.v||this.l?G_(this):this.cb())},en.cb=function(){G_(this)},en.ba=function(){try{return 2<_l(this)?this.g.status:-1}catch(i){return-1}},en.ga=function(){try{return this.g?this.g.responseText:""}catch(i){return""}},en.Qa=function(i){if(this.g){var e=this.g.responseText;return i&&0==e.indexOf(i)&&(e=e.substring(i.length)),sI(e)}},en.Da=function(){return this.m},en.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(en=Hw.prototype).ma=8,en.G=1,en.hb=function(i){try{this.h.info("Origin Trials invoked: "+i)}catch(e){}},en.Ha=function(i){if(this.m)if(this.m=null,1==this.G){if(!i){this.V=Math.floor(1e5*Math.random()),i=this.V++;const r=new lc(this,this.h,i,void 0);let s=this.s;if(this.P&&(s?(s=$m(s),lp(s,this.P)):s=this.P),null===this.o&&(r.H=s),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var n=this.l[t];if(void 0===(n="__data__"in n.g&&"string"==typeof(n=n.g.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=cc(this,r,e),m(t=Vc(this.F),"RID",i),m(t,"CVER",22),this.D&&m(t,"X-HTTP-Session-Id",this.D),Eg(this,t),this.o&&s&&Bw(t,this.o,s),mg(this.i,r),this.Ra&&m(t,"TYPE","init"),this.ja?(m(t,"$req",e),m(t,"SID","null"),r.$=!0,Zh(r,t,null)):Zh(r,t,e),this.G=2}}else 3==this.G&&(i?NS(this,i):0==this.l.length||pg(this.i)||NS(this))},en.Ga=function(){if(this.u=null,LS(this),this.$&&!(this.L||null==this.g||0>=this.O)){var i=2*this.O;this.h.info("BP detection timer enabled: "+i),this.B=Ds(ge(this.bb,this),i)}},en.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Go(10),xg(this),LS(this))},en.ab=function(){null!=this.v&&(this.v=null,xg(this),q_(this),Go(19))},en.jb=function(i){i?(this.h.info("Successfully pinged google.com"),Go(2)):(this.h.info("Failed to ping google.com"),Go(1))},(en=jw.prototype).xa=function(){},en.wa=function(){},en.va=function(){},en.ua=function(){},en.Oa=function(){},Sg.prototype.g=function(i,e){return new qa(i,e)},nt(qa,fr),qa.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var i=this.g,e=this.l,t=this.h||void 0;i.Wa&&(i.h.info("Origin Trials enabled."),R_(ge(i.hb,i,e))),Go(0),i.W=e,i.aa=t||{},i.N=i.X,i.F=VS(i,null,i.W),$_(i)},qa.prototype.close=function(){bg(this.g)},qa.prototype.u=function(i){if("string"==typeof i){var e={};e.__data__=i,W_(this.g,e)}else this.v?((e={}).__data__=Lc(i),W_(this.g,e)):W_(this.g,i)},qa.prototype.M=function(){this.g.j=null,delete this.j,bg(this.g),delete this.g,qa.Z.M.call(this)},nt(Tg,og),nt(uc,qh),nt(nf,jw),nf.prototype.xa=function(){Gs(this.g,"a")},nf.prototype.wa=function(i){Gs(this.g,new Tg(i))},nf.prototype.va=function(i){Gs(this.g,new uc(i))},nf.prototype.ua=function(){Gs(this.g,"b")},Sg.prototype.createWebChannel=Sg.prototype.g,qa.prototype.send=qa.prototype.u,qa.prototype.open=qa.prototype.m,qa.prototype.close=qa.prototype.close,Gd.NO_ERROR=0,Gd.TIMEOUT=8,Gd.HTTP_ERROR=6,sg.COMPLETE="complete",du.EventType=hu,hu.OPEN="a",hu.CLOSE="b",hu.ERROR="c",hu.MESSAGE="d",fr.prototype.listen=fr.prototype.N,Ps.prototype.listenOnce=Ps.prototype.O,Ps.prototype.getLastError=Ps.prototype.La,Ps.prototype.getLastErrorCode=Ps.prototype.Da,Ps.prototype.getStatus=Ps.prototype.ba,Ps.prototype.getResponseJson=Ps.prototype.Qa,Ps.prototype.getResponseText=Ps.prototype.ga,Ps.prototype.send=Ps.prototype.ea;var aI=sa.createWebChannelTransport=function(){return new Sg},Ww=sa.getStatEventTarget=function(){return wp()},Hc=sa.ErrorCode=Gd,$w=sa.EventType=sg,US=sa.Event=ed,Z_=sa.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},eN=sa.FetchXmlHttpFactory=Mp,Mg=sa.WebChannel=du,tN=sa.XhrIo=Ps;const Cg="@firebase/firestore";class Ns{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ns.UNAUTHENTICATED=new Ns(null),Ns.GOOGLE_CREDENTIALS=new Ns("google-credentials-uid"),Ns.FIRST_PARTY=new Ns("first-party-uid"),Ns.MOCK_USER=new Ns("mock-user");let qd="9.8.3";const gu=new za.Yd("@firebase/firestore");function Ag(){return gu.logLevel}function Dt(i,...e){if(gu.logLevel<=za.in.DEBUG){const t=e.map(qw);gu.debug(`Firestore (${qd}): ${i}`,...t)}}function js(i,...e){if(gu.logLevel<=za.in.ERROR){const t=e.map(qw);gu.error(`Firestore (${qd}): ${i}`,...t)}}function Ig(i,...e){if(gu.logLevel<=za.in.WARN){const t=e.map(qw);gu.warn(`Firestore (${qd}): ${i}`,...t)}}function qw(i){if("string"==typeof i)return i;try{return JSON.stringify(i)}catch(t){return i}}function gn(i="Unexpected state"){const e=`FIRESTORE (${qd}) INTERNAL ASSERTION FAILED: `+i;throw js(e),new Error(e)}function Yn(i,e){i||gn()}function an(i,e){return i}const He={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class bt extends fi.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class To{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Y_{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iN{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ns.UNAUTHENTICATED))}shutdown(){}}class rN{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class sN{constructor(e){this.t=e,this.currentUser=Ns.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let r=this.i;const s=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let a=new To;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new To,e.enqueueRetryable(()=>s(this.currentUser))};const c=()=>{const f=a;e.enqueueRetryable((0,Ke.Z)(function*(){yield f.promise,yield s(n.currentUser)}))},d=f=>{Dt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.auth.addAuthTokenListener(this.o),c()};this.t.onInit(f=>d(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(Dt("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new To)}},0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Dt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Yn("string"==typeof n.accessToken),new Y_(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Yn(null===e||"string"==typeof e),new Ns(e)}}class oN{constructor(e,t,n){this.type="FirstParty",this.user=Ns.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",t);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class aN{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new oN(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(Ns.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cI{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lN{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,t){const n=s=>{null!=s.error&&Dt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.p;return this.p=s.token,Dt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const r=s=>{Dt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.g.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.g.getImmediate({optional:!0});s?r(s):Dt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Yn("string"==typeof t.token),this.p=t.token,new cI(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function cN(i){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(i);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let n=0;n<i;n++)t[n]=Math.floor(256*Math.random());return t}class uI{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=cN(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%e.length))}return n}}function Kn(i,e){return i<e?-1:i>e?1:0}function Kd(i,e,t){return i.length===e.length&&i.every((n,r)=>t(n,e[r]))}function BS(i){return i+"\0"}class Vr{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new bt(He.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new bt(He.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new bt(He.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new bt(He.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Vr.fromMillis(Date.now())}static fromDate(e){return Vr.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Vr(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Kn(this.nanoseconds,e.nanoseconds):Kn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Wn{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Wn(e)}static min(){return new Wn(new Vr(0,0))}static max(){return new Wn(new Vr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Cp{constructor(e,t,n){void 0===t?t=0:t>e.length&&gn(),void 0===n?n=e.length-t:n>e.length-t&&gn(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Cp.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Cp?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const s=e.get(r),a=t.get(r);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ni extends Cp{construct(e,t,n){return new Ni(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new bt(He.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(r=>r.length>0))}return new Ni(t)}static emptyPath(){return new Ni([])}}const dI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gr extends Cp{construct(e,t,n){return new gr(e,t,n)}static isValidIdentifier(e){return dI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new gr(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new bt(He.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;r<e.length;){const c=e[r];if("\\"===c){if(r+1===e.length)throw new bt(He.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[r+1];if("\\"!==d&&"."!==d&&"`"!==d)throw new bt(He.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,r+=2}else"`"===c?(a=!a,r++):"."!==c||a?(n+=c,r++):(s(),r++)}if(s(),a)throw new bt(He.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gr(t)}static emptyPath(){return new gr([])}}class Kt{constructor(e){this.path=e}static fromPath(e){return new Kt(Ni.fromString(e))}static fromName(e){return new Kt(Ni.fromString(e).popFirst(5))}static empty(){return new Kt(Ni.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ni.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ni.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Kt(new Ni(e.slice()))}}class X_{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function Dg(i){return i.fields.find(e=>2===e.kind)}function rf(i){return i.fields.filter(e=>2!==e.kind)}X_.UNKNOWN_ID=-1;class Rg{constructor(e,t){this.fieldPath=e,this.kind=t}}class Pg{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Pg(0,Mo.min())}}function HS(i,e){const t=i.toTimestamp().seconds,n=i.toTimestamp().nanoseconds+1,r=Wn.fromTimestamp(1e9===n?new Vr(t+1,0):new Vr(t,n));return new Mo(r,Kt.empty(),e)}function Ap(i){return new Mo(i.readTime,i.key,-1)}class Mo{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Mo(Wn.min(),Kt.empty(),-1)}static max(){return new Mo(Wn.max(),Kt.empty(),-1)}}function Ng(i,e){let t=i.readTime.compareTo(e.readTime);return 0!==t?t:(t=Kt.comparator(i.documentKey,e.documentKey),0!==t?t:Kn(i.largestBatchId,e.largestBatchId))}const sf="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ip{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function vl(i){return Kw.apply(this,arguments)}function Kw(){return Kw=(0,Ke.Z)(function*(i){if(i.code!==He.FAILED_PRECONDITION||i.message!==sf)throw i;Dt("LocalStore","Unexpectedly lost primary lease")}),Kw.apply(this,arguments)}class Le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&gn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Le((n,r)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,r)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Le?t:Le.resolve(t)}catch(t){return Le.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Le.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Le.reject(t)}static resolve(e){return new Le((t,n)=>{t(e)})}static reject(e){return new Le((t,n)=>{n(e)})}static waitFor(e){return new Le((t,n)=>{let r=0,s=0,a=!1;e.forEach(c=>{++r,c.next(()=>{++s,a&&s===r&&t()},d=>n(d))}),a=!0,s===r&&t()})}static or(e){let t=Le.resolve(!1);for(const n of e)t=t.next(r=>r?Le.resolve(r):n());return t}static forEach(e,t){const n=[];return e.forEach((r,s)=>{n.push(t.call(this,r,s))}),this.waitFor(n)}static mapArray(e,t){return new Le((n,r)=>{const s=e.length,a=new Array(s);let c=0;for(let d=0;d<s;d++){const f=d;t(e[f]).next(g=>{a[f]=g,++c,c===s&&n(a)},g=>r(g))}})}static doWhile(e,t){return new Le((n,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):n()};s()})}}class Og{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.T=new To,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{t.error?this.T.reject(new Dp(e,t.error)):this.T.resolve()},this.transaction.onerror=n=>{const r=J_(n.target.error);this.T.reject(new Dp(e,r))}}static open(e,t,n,r){try{return new Og(t,e.transaction(r,n))}catch(s){throw new Dp(t,s)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(Dt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new hI(t)}}class wl{constructor(e,t,n){this.name=e,this.version=t,this.P=n,12.2===wl.v((0,fi.z$)())&&js("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Dt("SimpleDb","Removing database:",e),Zd(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!(0,fi.hl)())return!1;if(wl.S())return!0;const e=(0,fi.z$)(),t=wl.v(e),n=0<t&&t<10,r=wl.D(e),s=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static S(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.C)}static N(e,t){return e.store(t)}static v(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static D(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}k(e){var t=this;return(0,Ke.Z)(function*(){return t.db||(Dt("SimpleDb","Opening database:",t.name),t.db=yield new Promise((n,r)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=a=>{n(a.target.result)},s.onblocked=()=>{r(new Dp(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const c=a.target.error;r("VersionError"===c.name?new bt(He.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===c.name?new bt(He.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c):new Dp(e,c))},s.onupgradeneeded=a=>{Dt("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',a.oldVersion),t.P.O(a.target.result,s.transaction,a.oldVersion,t.version).next(()=>{Dt("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.M&&(t.db.onversionchange=n=>t.M(n)),t.db})()}F(e){this.M=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,n,r){var s=this;return(0,Ke.Z)(function*(){const a="readonly"===t;let c=0;for(;;){++c;try{s.db=yield s.k(e);const d=Og.open(s.db,e,a?"readonly":"readwrite",n),f=r(d).next(g=>(d.R(),g)).catch(g=>(d.abort(g),Le.reject(g))).toPromise();return f.catch(()=>{}),yield d.A,f}catch(d){const f="FirebaseError"!==d.name&&c<3;if(Dt("SimpleDb","Transaction failed with error:",d.message,"Retrying:",f),s.close(),!f)return Promise.reject(d)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class Zw{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Zd(this.$.delete())}}class Dp extends bt{constructor(e,t){super(He.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function zc(i){return"IndexedDbTransactionError"===i.name}class hI{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Dt("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Dt("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Zd(n)}add(e){return Dt("SimpleDb","ADD",this.store.name,e,e),Zd(this.store.add(e))}get(e){return Zd(this.store.get(e)).next(t=>(void 0===t&&(t=null),Dt("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return Dt("SimpleDb","DELETE",this.store.name,e),Zd(this.store.delete(e))}count(){return Dt("SimpleDb","COUNT",this.store.name),Zd(this.store.count())}K(e,t){const n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){const r=this.cursor(n),s=[];return this.G(r,(a,c)=>{s.push(c)}).next(()=>s)}{const r=this.store.getAll(n.range);return new Le((s,a)=>{r.onerror=c=>{a(c.target.error)},r.onsuccess=c=>{s(c.target.result)}})}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Le((r,s)=>{n.onerror=a=>{s(a.target.error)},n.onsuccess=a=>{r(a.target.result)}})}W(e,t){Dt("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const r=this.cursor(n);return this.G(r,(s,a,c)=>c.delete())}J(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.G(r,t)}Y(e){const t=this.cursor({});return new Le((n,r)=>{t.onerror=s=>{const a=J_(s.target.error);r(a)},t.onsuccess=s=>{const a=s.target.result;a?e(a.primaryKey,a.value).next(c=>{c?a.continue():n()}):n()}})}G(e,t){const n=[];return new Le((r,s)=>{e.onerror=a=>{s(a.target.error)},e.onsuccess=a=>{const c=a.target.result;if(!c)return void r();const d=new Zw(c),f=t(c.primaryKey,c.value,d);if(f instanceof Le){const g=f.catch(v=>(d.done(),Le.reject(v)));n.push(g)}d.isDone?r():null===d.U?c.continue():c.continue(d.U)}}).next(()=>Le.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Zd(i){return new Le((e,t)=>{i.onsuccess=n=>{e(n.target.result)},i.onerror=n=>{const r=J_(n.target.error);t(r)}})}let fI=!1;function J_(i){const e=wl.v((0,fi.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(i.message.indexOf(t)>=0){const n=new bt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fI||(fI=!0,setTimeout(()=>{throw n},0)),n}}return i}class zS{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}Z(e){var t=this;Dt("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Ke.Z)(function*(){t.task=null;try{Dt("IndexBackiller",`Documents written: ${yield t.X.tt()}`)}catch(n){zc(n)?Dt("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):yield vl(n)}yield t.Z(1)}))}}class pI{constructor(e,t){this.localStore=e,this.persistence=t}tt(e=50){var t=this;return(0,Ke.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>t.et(n,e))})()}et(e,t){const n=new Set;let r=t,s=!0;return Le.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(a=>{if(null!==a&&!n.has(a))return Dt("IndexBackiller",`Processing collection: ${a}`),this.nt(e,a,r).next(c=>{r-=c,n.add(a)});s=!1})).next(()=>t-r)}nt(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(s=>{const a=s.changes;return this.localStore.indexManager.updateIndexEntries(e,a).next(()=>this.st(r,s)).next(c=>(Dt("IndexBackiller",`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c))).next(()=>a.size)}))}st(e,t){let n=e;return t.changes.forEach((r,s)=>{const a=Ap(s);Ng(a,n)>0&&(n=a)}),new Mo(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ea{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.it(n),this.rt=n=>t.writeSequenceNumber(n))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}function GS(i){let e=0;for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e++;return e}function of(i,e){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&e(t,i[t])}function Ka(i){for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e))return!1;return!0}Ea.ot=-1;class gs{constructor(e,t){this.comparator=e,this.root=t||aa.EMPTY}insert(e,t){return new gs(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,aa.BLACK,null,null))}remove(e){return new gs(this.comparator,this.root.remove(e,this.comparator).copy(null,null,aa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Q_(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Q_(this.root,e,this.comparator,!1)}getReverseIterator(){return new Q_(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Q_(this.root,e,this.comparator,!0)}}class Q_{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class aa{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:aa.RED,this.left=null!=r?r:aa.EMPTY,this.right=null!=s?s:aa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new aa(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return aa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return aa.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,aa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,aa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw gn();const e=this.left.check();if(e!==this.right.check())throw gn();return e+(this.isRed()?0:1)}}aa.EMPTY=null,aa.RED=!0,aa.BLACK=!1,aa.EMPTY=new class{constructor(){this.size=0}get key(){throw gn()}get value(){throw gn()}get color(){throw gn()}get left(){throw gn()}get right(){throw gn()}copy(i,e,t,n,r){return this}insert(i,e,t){return new aa(i,e)}remove(i,e){return this}isEmpty(){return!0}inorderTraversal(i){return!1}reverseTraversal(i){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Er{constructor(e){this.comparator=e,this.data=new gs(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Yw(this.data.getIterator())}getIteratorFrom(e){return new Yw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof Er)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(0!==this.comparator(r,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Er(this.comparator);return t.data=e,t}}class Yw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Lg(i){return i.hasNext()?i.getNext():void 0}class bl{constructor(e){this.fields=e,e.sort(gr.comparator)}static empty(){return new bl([])}unionWith(e){let t=new Er(gr.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new bl(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Kd(this.fields,e.fields,(t,n)=>t.isEqual(n))}}class Ws{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Ws(t)}static fromUint8Array(e){const t=function(n){let r="";for(let s=0;s<n.length;++s)r+=String.fromCharCode(n[s]);return r}(e);return new Ws(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Kn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ws.EMPTY_BYTE_STRING=new Ws("");const mI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yd(i){if(Yn(!!i),"string"==typeof i){let e=0;const t=mI.exec(i);if(Yn(!!t),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const n=new Date(i);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:ys(i.seconds),nanos:ys(i.nanos)}}function ys(i){return"number"==typeof i?i:"string"==typeof i?Number(i):0}function Xd(i){return"string"==typeof i?Ws.fromBase64String(i):Ws.fromUint8Array(i)}function Jw(i){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==i?void 0:i.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Qw(i){const e=i.mapValue.fields.__previous_value__;return Jw(e)?Qw(e):e}function kg(i){const e=Yd(i.mapValue.fields.__local_write_time__.timestampValue);return new Vr(e.seconds,e.nanos)}class gI{constructor(e,t,n,r,s,a,c,d){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.useFetchStreams=d}}class yu{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new yu("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof yu&&e.projectId===this.projectId&&e.database===this.database}}function Rp(i){return null==i}function Fg(i){return 0===i&&1/i==-1/0}function Gc(i){return"number"==typeof i&&Number.isInteger(i)&&!Fg(i)&&i<=Number.MAX_SAFE_INTEGER&&i>=Number.MIN_SAFE_INTEGER}const _u={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ev={nullValue:"NULL_VALUE"};function af(i){return"nullValue"in i?0:"booleanValue"in i?1:"integerValue"in i||"doubleValue"in i?2:"timestampValue"in i?3:"stringValue"in i?5:"bytesValue"in i?6:"referenceValue"in i?7:"geoPointValue"in i?8:"arrayValue"in i?9:"mapValue"in i?Jw(i)?4:tb(i)?9007199254740991:10:gn()}function nd(i,e){if(i===e)return!0;const t=af(i);if(t!==af(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return i.booleanValue===e.booleanValue;case 4:return kg(i).isEqual(kg(e));case 3:return function(n,r){if("string"==typeof n.timestampValue&&"string"==typeof r.timestampValue&&n.timestampValue.length===r.timestampValue.length)return n.timestampValue===r.timestampValue;const s=Yd(n.timestampValue),a=Yd(r.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(i,e);case 5:return i.stringValue===e.stringValue;case 6:return r=e,Xd(i.bytesValue).isEqual(Xd(r.bytesValue));case 7:return i.referenceValue===e.referenceValue;case 8:return function(n,r){return ys(n.geoPointValue.latitude)===ys(r.geoPointValue.latitude)&&ys(n.geoPointValue.longitude)===ys(r.geoPointValue.longitude)}(i,e);case 2:return function(n,r){if("integerValue"in n&&"integerValue"in r)return ys(n.integerValue)===ys(r.integerValue);if("doubleValue"in n&&"doubleValue"in r){const s=ys(n.doubleValue),a=ys(r.doubleValue);return s===a?Fg(s)===Fg(a):isNaN(s)&&isNaN(a)}return!1}(i,e);case 9:return Kd(i.arrayValue.values||[],e.arrayValue.values||[],nd);case 10:return function(n,r){const s=n.mapValue.fields||{},a=r.mapValue.fields||{};if(GS(s)!==GS(a))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(void 0===a[c]||!nd(s[c],a[c])))return!1;return!0}(i,e);default:return gn()}var r}function Pp(i,e){return void 0!==(i.values||[]).find(t=>nd(t,e))}function Jd(i,e){if(i===e)return 0;const t=af(i),n=af(e);if(t!==n)return Kn(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Kn(i.booleanValue,e.booleanValue);case 2:return function(r,s){const a=ys(r.integerValue||r.doubleValue),c=ys(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(i,e);case 3:return jS(i.timestampValue,e.timestampValue);case 4:return jS(kg(i),kg(e));case 5:return Kn(i.stringValue,e.stringValue);case 6:return function(r,s){const a=Xd(r),c=Xd(s);return a.compareTo(c)}(i.bytesValue,e.bytesValue);case 7:return function(r,s){const a=r.split("/"),c=s.split("/");for(let d=0;d<a.length&&d<c.length;d++){const f=Kn(a[d],c[d]);if(0!==f)return f}return Kn(a.length,c.length)}(i.referenceValue,e.referenceValue);case 8:return function(r,s){const a=Kn(ys(r.latitude),ys(s.latitude));return 0!==a?a:Kn(ys(r.longitude),ys(s.longitude))}(i.geoPointValue,e.geoPointValue);case 9:return function(r,s){const a=r.values||[],c=s.values||[];for(let d=0;d<a.length&&d<c.length;++d){const f=Jd(a[d],c[d]);if(f)return f}return Kn(a.length,c.length)}(i.arrayValue,e.arrayValue);case 10:return function(r,s){if(r===_u.mapValue&&s===_u.mapValue)return 0;if(r===_u.mapValue)return 1;if(s===_u.mapValue)return-1;const a=r.fields||{},c=Object.keys(a),d=s.fields||{},f=Object.keys(d);c.sort(),f.sort();for(let g=0;g<c.length&&g<f.length;++g){const v=Kn(c[g],f[g]);if(0!==v)return v;const b=Jd(a[c[g]],d[f[g]]);if(0!==b)return b}return Kn(c.length,f.length)}(i.mapValue,e.mapValue);default:throw gn()}}function jS(i,e){if("string"==typeof i&&"string"==typeof e&&i.length===e.length)return Kn(i,e);const t=Yd(i),n=Yd(e),r=Kn(t.seconds,n.seconds);return 0!==r?r:Kn(t.nanos,n.nanos)}function Np(i){return Vg(i)}function Vg(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?function(n){const r=Yd(n);return`time(${r.seconds},${r.nanos})`}(i.timestampValue):"stringValue"in i?i.stringValue:"bytesValue"in i?Xd(i.bytesValue).toBase64():"referenceValue"in i?Kt.fromName(i.referenceValue).toString():"geoPointValue"in i?`geo(${(e=i.geoPointValue).latitude},${e.longitude})`:"arrayValue"in i?function(n){let r="[",s=!0;for(const a of n.values||[])s?s=!1:r+=",",r+=Vg(a);return r+"]"}(i.arrayValue):"mapValue"in i?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",a=!0;for(const c of r)a?a=!1:s+=",",s+=`${c}:${Vg(n.fields[c])}`;return s+"}"}(i.mapValue):gn();var e}function lf(i,e){return{referenceValue:`projects/${i.projectId}/databases/${i.database}/documents/${e.path.canonicalString()}`}}function eb(i){return!!i&&"integerValue"in i}function Qd(i){return!!i&&"arrayValue"in i}function tv(i){return!!i&&"nullValue"in i}function WS(i){return!!i&&"doubleValue"in i&&isNaN(Number(i.doubleValue))}function Op(i){return!!i&&"mapValue"in i}function cf(i){if(i.geoPointValue)return{geoPointValue:Object.assign({},i.geoPointValue)};if(i.timestampValue&&"object"==typeof i.timestampValue)return{timestampValue:Object.assign({},i.timestampValue)};if(i.mapValue){const e={mapValue:{fields:{}}};return of(i.mapValue.fields,(t,n)=>e.mapValue.fields[t]=cf(n)),e}if(i.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(i.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cf(i.arrayValue.values[t]);return e}return Object.assign({},i)}function tb(i){return"__max__"===(((i.mapValue||{}).fields||{}).__type__||{}).stringValue}function yI(i){return"nullValue"in i?ev:"booleanValue"in i?{booleanValue:!1}:"integerValue"in i||"doubleValue"in i?{doubleValue:NaN}:"timestampValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in i?{stringValue:""}:"bytesValue"in i?{bytesValue:""}:"referenceValue"in i?lf(yu.empty(),Kt.empty()):"geoPointValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in i?{arrayValue:{}}:"mapValue"in i?{mapValue:{}}:gn()}function _I(i){return"nullValue"in i?{booleanValue:!1}:"booleanValue"in i?{doubleValue:NaN}:"integerValue"in i||"doubleValue"in i?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in i?{stringValue:""}:"stringValue"in i?{bytesValue:""}:"bytesValue"in i?lf(yu.empty(),Kt.empty()):"referenceValue"in i?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in i?{arrayValue:{}}:"arrayValue"in i?{mapValue:{}}:"mapValue"in i?_u:gn()}function nv(i,e){const t=Jd(i.value,e.value);return 0!==t?t:i.inclusive&&!e.inclusive?-1:!i.inclusive&&e.inclusive?1:0}function vI(i,e){const t=Jd(i.value,e.value);return 0!==t?t:i.inclusive&&!e.inclusive?1:!i.inclusive&&e.inclusive?-1:0}class jo{constructor(e){this.value=e}static empty(){return new jo({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Op(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cf(t)}setAll(e){let t=gr.emptyPath(),n={},r=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){const d=this.getFieldsMap(t);this.applyChanges(d,n,r),n={},r=[],t=c.popLast()}a?n[c.lastSegment()]=cf(a):r.push(c.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());Op(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return nd(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Op(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){of(t,(r,s)=>e[r]=s);for(const r of n)delete e[r]}clone(){return new jo(cf(this.value))}}function nb(i){const e=[];return of(i.fields,(t,n)=>{const r=new gr([t]);if(Op(n)){const s=nb(n.mapValue).fields;if(0===s.length)e.push(r);else for(const a of s)e.push(r.child(a))}else e.push(r)}),new bl(e)}class Sr{constructor(e,t,n,r,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.data=s,this.documentState=a}static newInvalidDocument(e){return new Sr(e,0,Wn.min(),Wn.min(),jo.empty(),0)}static newFoundDocument(e,t,n){return new Sr(e,1,t,Wn.min(),n,0)}static newNoDocument(e,t){return new Sr(e,2,t,Wn.min(),jo.empty(),0)}static newUnknownDocument(e,t){return new Sr(e,3,t,Wn.min(),jo.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jo.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jo.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Wn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Sr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Sr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class $S{constructor(e,t=null,n=[],r=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=a,this.endAt=c,this.ut=null}}function ib(i,e=null,t=[],n=[],r=null,s=null,a=null){return new $S(i,e,t,n,r,s,a)}function eh(i){const e=an(i);if(null===e.ut){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>{return(r=n).field.canonicalString()+r.op.toString()+Np(r.value);var r}).join(","),t+="|ob:",t+=e.orderBy.map(n=>{return(r=n).field.canonicalString()+r.dir;var r}).join(","),Rp(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Np(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Np(n)).join(",")),e.ut=t}return e.ut}function th(i,e){if(i.limit!==e.limit||i.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<i.orderBy.length;r++)if(!EI(i.orderBy[r],e.orderBy[r]))return!1;if(i.filters.length!==e.filters.length)return!1;for(let r=0;r<i.filters.length;r++)if((t=i.filters[r]).op!==(n=e.filters[r]).op||!t.field.isEqual(n.field)||!nd(t.value,n.value))return!1;var t,n;return i.collectionGroup===e.collectionGroup&&!!i.path.isEqual(e.path)&&!!uf(i.startAt,e.startAt)&&uf(i.endAt,e.endAt)}function iv(i){return Kt.isDocumentKey(i.path)&&null===i.collectionGroup&&0===i.filters.length}function rv(i,e){return i.filters.filter(t=>t instanceof Co&&t.field.isEqual(e))}function wI(i,e,t){let n=ev,r=!0;for(const s of rv(i,e)){let a=ev,c=!0;switch(s.op){case"<":case"<=":a=yI(s.value);break;case"==":case"in":case">=":a=s.value;break;case">":a=s.value,c=!1;break;case"!=":case"not-in":a=ev}nv({value:n,inclusive:r},{value:a,inclusive:c})<0&&(n=a,r=c)}if(null!==t)for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){const a=t.position[s];nv({value:n,inclusive:r},{value:a,inclusive:t.inclusive})<0&&(n=a,r=t.inclusive);break}return{value:n,inclusive:r}}function sv(i,e,t){let n=_u,r=!0;for(const s of rv(i,e)){let a=_u,c=!0;switch(s.op){case">=":case">":a=_I(s.value),c=!1;break;case"==":case"in":case"<=":a=s.value;break;case"<":a=s.value,c=!1;break;case"!=":case"not-in":a=_u}vI({value:n,inclusive:r},{value:a,inclusive:c})>0&&(n=a,r=c)}if(null!==t)for(let s=0;s<i.orderBy.length;++s)if(i.orderBy[s].field.isEqual(e)){const a=t.position[s];vI({value:n,inclusive:r},{value:a,inclusive:t.inclusive})>0&&(n=a,r=t.inclusive);break}return{value:n,inclusive:r}}class Co extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,n):new rb(e,t,n):"array-contains"===t?new qS(e,n):"in"===t?new KS(e,n):"not-in"===t?new ZS(e,n):"array-contains-any"===t?new xI(e,n):new Co(e,t,n)}static ct(e,t,n){return"in"===t?new Ug(e,n):new bI(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(Jd(t,this.value)):null!==t&&af(this.value)===af(t)&&this.at(Jd(t,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return gn()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class rb extends Co{constructor(e,t,n){super(e,t,n),this.key=Kt.fromName(n.referenceValue)}matches(e){const t=Kt.comparator(e.key,this.key);return this.at(t)}}class Ug extends Co{constructor(e,t){super(e,"in",t),this.keys=ov(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class bI extends Co{constructor(e,t){super(e,"not-in",t),this.keys=ov(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function ov(i,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(n=>Kt.fromName(n.referenceValue))}class qS extends Co{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Qd(t)&&Pp(t.arrayValue,this.value)}}class KS extends Co{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Pp(this.value.arrayValue,t)}}class ZS extends Co{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Pp(this.value.arrayValue,t)}}class xI extends Co{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Qd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Pp(this.value.arrayValue,n))}}class vu{constructor(e,t){this.position=e,this.inclusive=t}}class Lp{constructor(e,t="asc"){this.field=e,this.dir=t}}function EI(i,e){return i.dir===e.dir&&i.field.isEqual(e.field)}function sb(i,e,t){let n=0;for(let r=0;r<i.position.length;r++){const s=e[r],a=i.position[r];if(n=s.field.isKeyField()?Kt.comparator(Kt.fromName(a.referenceValue),t.key):Jd(a,t.data.field(s.field)),"desc"===s.dir&&(n*=-1),0!==n)break}return n}function uf(i,e){if(null===i)return null===e;if(null===e||i.inclusive!==e.inclusive||i.position.length!==e.position.length)return!1;for(let t=0;t<i.position.length;t++)if(!nd(i.position[t],e.position[t]))return!1;return!0}class wu{constructor(e,t=null,n=[],r=[],s=null,a="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=d,this.lt=null,this.ft=null}}function YS(i,e,t,n,r,s,a,c){return new wu(i,e,t,n,r,s,a,c)}function kp(i){return new wu(i)}function ob(i){return i.explicitOrderBy.length>0?i.explicitOrderBy[0].field:null}function ab(i){for(const e of i.filters)if(e.ht())return e.field;return null}function lb(i){return null!==i.collectionGroup}function Vp(i){const e=an(i);if(null===e.lt){e.lt=[];const t=ab(e),n=ob(e);if(null!==t&&null===n)t.isKeyField()||e.lt.push(new Lp(t)),e.lt.push(new Lp(gr.keyField(),"asc"));else{let r=!1;for(const s of e.explicitOrderBy)e.lt.push(s),s.field.isKeyField()&&(r=!0);if(!r){const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new Lp(gr.keyField(),s))}}}return e.lt}function _s(i){const e=an(i);if(!e.ft)if("F"===e.limitType)e.ft=ib(e.path,e.collectionGroup,Vp(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const s of Vp(e))t.push(new Lp(s.field,"desc"===s.dir?"asc":"desc"));const n=e.endAt?new vu(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new vu(e.startAt.position,e.startAt.inclusive):null;e.ft=ib(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e.ft}function av(i,e,t){return new wu(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),e,t,i.startAt,i.endAt)}function Up(i,e){return th(_s(i),_s(e))&&i.limitType===e.limitType}function cb(i){return`${eh(_s(i))}|lt:${i.limitType}`}function lv(i){return`Query(target=${function id(i){let e=i.path.canonicalString();return null!==i.collectionGroup&&(e+=" collectionGroup="+i.collectionGroup),i.filters.length>0&&(e+=`, filters: [${i.filters.map(t=>{return`${(n=t).field.canonicalString()} ${n.op} ${Np(n.value)}`;var n}).join(", ")}]`),Rp(i.limit)||(e+=", limit: "+i.limit),i.orderBy.length>0&&(e+=`, orderBy: [${i.orderBy.map(t=>{return`${(n=t).field.canonicalString()} (${n.dir})`;var n}).join(", ")}]`),i.startAt&&(e+=", startAt: ",e+=i.startAt.inclusive?"b:":"a:",e+=i.startAt.position.map(t=>Np(t)).join(",")),i.endAt&&(e+=", endAt: ",e+=i.endAt.inclusive?"a:":"b:",e+=i.endAt.position.map(t=>Np(t)).join(",")),`Target(${e})`}(_s(i))}; limitType=${i.limitType})`}function cv(i,e){return e.isFoundDocument()&&function(t,n){const r=n.key.path;return null!==t.collectionGroup?n.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(r):Kt.isDocumentKey(t.path)?t.path.isEqual(r):t.path.isImmediateParentOf(r)}(i,e)&&function(t,n){for(const r of t.explicitOrderBy)if(!r.field.isKeyField()&&null===n.data.field(r.field))return!1;return!0}(i,e)&&function(t,n){for(const r of t.filters)if(!r.matches(n))return!1;return!0}(i,e)&&(n=e,!((t=i).startAt&&!function(r,s,a){const c=sb(r,s,a);return r.inclusive?c<=0:c<0}(t.startAt,Vp(t),n)||t.endAt&&!function(r,s,a){const c=sb(r,s,a);return r.inclusive?c>=0:c>0}(t.endAt,Vp(t),n)));var t,n}function XS(i){return i.collectionGroup||(i.path.length%2==1?i.path.lastSegment():i.path.get(i.path.length-2))}function JS(i){return(e,t)=>{let n=!1;for(const r of Vp(i)){const s=SI(r,e,t);if(0!==s)return s;n=n||r.field.isKeyField()}return 0}}function SI(i,e,t){const n=i.field.isKeyField()?Kt.comparator(e.key,t.key):function(r,s,a){const c=s.data.field(r),d=a.data.field(r);return null!==c&&null!==d?Jd(c,d):gn()}(i.field,e,t);switch(i.dir){case"asc":return n;case"desc":return-1*n;default:return gn()}}function QS(i,e){if(i.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fg(e)?"-0":e}}function ub(i){return{integerValue:""+i}}function TI(i,e){return Gc(e)?ub(e):QS(i,e)}class Bg{constructor(){this._=void 0}}function MI(i,e,t){return i instanceof Hg?function(n,r){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:n.seconds,nanos:n.nanoseconds}}}};return r&&(s.fields.__previous_value__=r),{mapValue:s}}(t,e):i instanceof rd?eT(i,e):i instanceof nh?db(i,e):function(n,r){const s=AI(n,r),a=dc(s)+dc(n._t);return eb(s)&&eb(n._t)?ub(a):QS(n.wt,a)}(i,e)}function CI(i,e,t){return i instanceof rd?eT(i,e):i instanceof nh?db(i,e):t}function AI(i,e){return i instanceof zg?eb(t=e)||(n=t)&&"doubleValue"in n?e:{integerValue:0}:null;var n,t}class Hg extends Bg{}class rd extends Bg{constructor(e){super(),this.elements=e}}function eT(i,e){const t=II(e);for(const n of i.elements)t.some(r=>nd(r,n))||t.push(n);return{arrayValue:{values:t}}}class nh extends Bg{constructor(e){super(),this.elements=e}}function db(i,e){let t=II(e);for(const n of i.elements)t=t.filter(r=>!nd(r,n));return{arrayValue:{values:t}}}class zg extends Bg{constructor(e,t){super(),this.wt=e,this._t=t}}function dc(i){return ys(i.integerValue||i.doubleValue)}function II(i){return Qd(i)&&i.arrayValue.values?i.arrayValue.values.slice():[]}class uv{constructor(e,t){this.field=e,this.transform=t}}class nT{constructor(e,t){this.version=e,this.transformResults=t}}class Kr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Kr}static exists(e){return new Kr(void 0,e)}static updateTime(e){return new Kr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function dv(i,e){return void 0!==i.updateTime?e.isFoundDocument()&&e.version.isEqual(i.updateTime):void 0===i.exists||i.exists===e.isFoundDocument()}class hb{}function fb(i,e){if(!i.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return i.isNoDocument()?new od(i.key,Kr.none()):new Bp(i.key,i.data,Kr.none());{const t=i.data,n=jo.empty();let r=new Er(gr.comparator);for(let s of e.fields)if(!r.has(s)){let a=t.field(s);null===a&&s.length>1&&(s=s.popLast(),a=t.field(s)),null===a?n.delete(s):n.set(s,a),r=r.add(s)}return new sd(i.key,n,new bl(r.toArray()),Kr.none())}}function pb(i,e,t){i instanceof Bp?function(n,r,s){const a=n.value.clone(),c=sT(n.fieldTransforms,r,s.transformResults);a.setAll(c),r.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(i,e,t):i instanceof sd?function(n,r,s){if(!dv(n.precondition,r))return void r.convertToUnknownDocument(s.version);const a=sT(n.fieldTransforms,r,s.transformResults),c=r.data;c.setAll(rT(n)),c.setAll(a),r.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(i,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Gg(i,e,t,n){return i instanceof Bp?function(r,s,a,c){if(!dv(r.precondition,s))return a;const d=r.value.clone(),f=oT(r.fieldTransforms,c,s);return d.setAll(f),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),null}(i,e,t,n):i instanceof sd?function(r,s,a,c){if(!dv(r.precondition,s))return a;const d=oT(r.fieldTransforms,c,s),f=s.data;return f.setAll(rT(r)),f.setAll(d),s.convertToFoundDocument(s.version,f).setHasLocalMutations(),null===a?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(g=>g.field))}(i,e,t,n):(a=t,dv(i.precondition,s=e)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a);var s,a}function mb(i,e){let t=null;for(const n of i.fieldTransforms){const r=e.data.field(n.field),s=AI(n.transform,r||null);null!=s&&(null===t&&(t=jo.empty()),t.set(n.field,s))}return t||null}function iT(i,e){return i.type===e.type&&!!i.key.isEqual(e.key)&&!!i.precondition.isEqual(e.precondition)&&(n=e.fieldTransforms,!!(void 0===(t=i.fieldTransforms)&&void 0===n||t&&n&&Kd(t,n,(r,s)=>function tT(i,e){return i.field.isEqual(e.field)&&(n=e.transform,(t=i.transform)instanceof rd&&n instanceof rd||t instanceof nh&&n instanceof nh?Kd(t.elements,n.elements,nd):t instanceof zg&&n instanceof zg?nd(t._t,n._t):t instanceof Hg&&n instanceof Hg);var t,n}(r,s))))&&(0===i.type?i.value.isEqual(e.value):1!==i.type||i.data.isEqual(e.data)&&i.fieldMask.isEqual(e.fieldMask));var t,n}class Bp extends hb{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class sd extends hb{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function rT(i){const e=new Map;return i.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=i.data.field(t);e.set(t,n)}}),e}function sT(i,e,t){const n=new Map;Yn(i.length===t.length);for(let r=0;r<t.length;r++){const s=i[r],a=s.transform,c=e.data.field(s.field);n.set(s.field,CI(a,c,t[r]))}return n}function oT(i,e,t){const n=new Map;for(const r of i){const s=r.transform,a=t.data.field(r.field);n.set(r.field,MI(s,a,e))}return n}class od extends hb{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ih extends hb{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class DI{constructor(e){this.count=e}}var Zr,ji;function aT(i){switch(i){default:return gn();case He.CANCELLED:case He.UNKNOWN:case He.DEADLINE_EXCEEDED:case He.RESOURCE_EXHAUSTED:case He.INTERNAL:case He.UNAVAILABLE:case He.UNAUTHENTICATED:return!1;case He.INVALID_ARGUMENT:case He.NOT_FOUND:case He.ALREADY_EXISTS:case He.PERMISSION_DENIED:case He.FAILED_PRECONDITION:case He.ABORTED:case He.OUT_OF_RANGE:case He.UNIMPLEMENTED:case He.DATA_LOSS:return!0}}function hv(i){if(void 0===i)return js("GRPC error has no .code"),He.UNKNOWN;switch(i){case Zr.OK:return He.OK;case Zr.CANCELLED:return He.CANCELLED;case Zr.UNKNOWN:return He.UNKNOWN;case Zr.DEADLINE_EXCEEDED:return He.DEADLINE_EXCEEDED;case Zr.RESOURCE_EXHAUSTED:return He.RESOURCE_EXHAUSTED;case Zr.INTERNAL:return He.INTERNAL;case Zr.UNAVAILABLE:return He.UNAVAILABLE;case Zr.UNAUTHENTICATED:return He.UNAUTHENTICATED;case Zr.INVALID_ARGUMENT:return He.INVALID_ARGUMENT;case Zr.NOT_FOUND:return He.NOT_FOUND;case Zr.ALREADY_EXISTS:return He.ALREADY_EXISTS;case Zr.PERMISSION_DENIED:return He.PERMISSION_DENIED;case Zr.FAILED_PRECONDITION:return He.FAILED_PRECONDITION;case Zr.ABORTED:return He.ABORTED;case Zr.OUT_OF_RANGE:return He.OUT_OF_RANGE;case Zr.UNIMPLEMENTED:return He.UNIMPLEMENTED;case Zr.DATA_LOSS:return He.DATA_LOSS;default:return gn()}}(ji=Zr||(Zr={}))[ji.OK=0]="OK",ji[ji.CANCELLED=1]="CANCELLED",ji[ji.UNKNOWN=2]="UNKNOWN",ji[ji.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ji[ji.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ji[ji.NOT_FOUND=5]="NOT_FOUND",ji[ji.ALREADY_EXISTS=6]="ALREADY_EXISTS",ji[ji.PERMISSION_DENIED=7]="PERMISSION_DENIED",ji[ji.UNAUTHENTICATED=16]="UNAUTHENTICATED",ji[ji.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ji[ji.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ji[ji.ABORTED=10]="ABORTED",ji[ji.OUT_OF_RANGE=11]="OUT_OF_RANGE",ji[ji.UNIMPLEMENTED=12]="UNIMPLEMENTED",ji[ji.INTERNAL=13]="INTERNAL",ji[ji.UNAVAILABLE=14]="UNAVAILABLE",ji[ji.DATA_LOSS=15]="DATA_LOSS";class Wo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){of(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return Ka(this.inner)}size(){return this.innerSize}}const jg=new gs(Kt.comparator);function pr(){return jg}const rh=new gs(Kt.comparator);function sh(...i){let e=rh;for(const t of i)e=e.insert(t.key,t);return e}function xl(i){let e=rh;return i.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function hc(){return bu()}function df(){return bu()}function bu(){return new Wo(i=>i.toString(),(i,e)=>i.isEqual(e))}const Hp=new gs(Kt.comparator),zp=new Er(Kt.comparator);function ei(...i){let e=zp;for(const t of i)e=e.add(t);return e}const Gp=new Er(Kn);function ad(){return Gp}class xu{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,Eu.createSynthesizedTargetChangeForCurrentChange(e,t)),new xu(Wn.min(),n,ad(),pr(),ei())}}class Eu{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t){return new Eu(Ws.EMPTY_BYTE_STRING,t,ei(),ei(),ei())}}class Wg{constructor(e,t,n,r){this.gt=e,this.removedTargetIds=t,this.key=n,this.yt=r}}class gb{constructor(e,t){this.targetId=e,this.It=t}}class yb{constructor(e,t,n=Ws.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class _b{constructor(){this.Tt=0,this.Et=wb(),this.At=Ws.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=ei(),t=ei(),n=ei();return this.Et.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:gn()}}),new Eu(this.At,this.Rt,e,t,n)}Dt(){this.bt=!1,this.Et=wb()}Ct(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class lT{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=pr(),this.Bt=vb(),this.Lt=new Er(Kn)}Ut(e){for(const t of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(t,e.yt):this.Kt(t,e.key,e.yt);for(const t of e.removedTargetIds)this.Kt(t,e.key,e.yt)}Gt(e){this.forEachTarget(e,t=>{const n=this.Qt(t);switch(e.state){case 0:this.jt(t)&&n.Vt(e.resumeToken);break;case 1:n.kt(),n.Pt||n.Dt(),n.Vt(e.resumeToken);break;case 2:n.kt(),n.Pt||this.removeTarget(t);break;case 3:this.jt(t)&&(n.Ot(),n.Vt(e.resumeToken));break;case 4:this.jt(t)&&(this.Wt(t),n.Vt(e.resumeToken));break;default:gn()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((n,r)=>{this.jt(r)&&t(r)})}zt(e){const t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){const s=r.target;if(iv(s))if(0===n){const a=new Kt(s.path);this.Kt(t,a,Sr.newNoDocument(a,Wn.min()))}else Yn(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}Yt(e){const t=new Map;this.Ft.forEach((s,a)=>{const c=this.Ht(a);if(c){if(s.current&&iv(c.target)){const d=new Kt(c.target.path);null!==this.$t.get(d)||this.Xt(a,d)||this.Kt(a,d,Sr.newNoDocument(d,e))}s.vt&&(t.set(a,s.St()),s.Dt())}});let n=ei();this.Bt.forEach((s,a)=>{let c=!0;a.forEachWhile(d=>{const f=this.Ht(d);return!f||2===f.purpose||(c=!1,!1)}),c&&(n=n.add(s))}),this.$t.forEach((s,a)=>a.setReadTime(e));const r=new xu(e,t,this.Lt,this.$t,n);return this.$t=pr(),this.Bt=vb(),this.Lt=new Er(Kn),r}qt(e,t){if(!this.jt(e))return;const n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}Kt(e,t,n){if(!this.jt(e))return;const r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}removeTarget(e){this.Ft.delete(e)}Jt(e){const t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let t=this.Ft.get(e);return t||(t=new _b,this.Ft.set(e,t)),t}Zt(e){let t=this.Bt.get(e);return t||(t=new Er(Kn),this.Bt=this.Bt.insert(e,t)),t}jt(e){const t=null!==this.Ht(e);return t||Dt("WatchChangeAggregator","Detected inactive target",e),t}Ht(e){const t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new _b),this.Mt.getRemoteKeysForTarget(e).forEach(t=>{this.Kt(e,t,null)})}Xt(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}function vb(){return new gs(Kt.comparator)}function wb(){return new gs(Kt.comparator)}const cT={asc:"ASCENDING",desc:"DESCENDING"},uT={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class RI{constructor(e,t){this.databaseId=e,this.dt=t}}function jp(i,e){return i.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function dT(i,e){return i.dt?e.toBase64():e.toUint8Array()}function PI(i,e){return jp(i,e.toTimestamp())}function lo(i){return Yn(!!i),Wn.fromTimestamp(function(e){const t=Yd(e);return new Vr(t.seconds,t.nanos)}(i))}function bb(i,e){return(t=i,new Ni(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function hT(i){const e=Ni.fromString(i);return Yn(vT(e)),e}function Wp(i,e){return bb(i.databaseId,e.path)}function Su(i,e){const t=hT(e);if(t.get(1)!==i.databaseId.projectId)throw new bt(He.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+i.databaseId.projectId);if(t.get(3)!==i.databaseId.database)throw new bt(He.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+i.databaseId.database);return new Kt(NI(t))}function fv(i,e){return bb(i.databaseId,e)}function fT(i){const e=hT(i);return 4===e.length?Ni.emptyPath():NI(e)}function $g(i){return new Ni(["projects",i.databaseId.projectId,"databases",i.databaseId.database]).canonicalString()}function NI(i){return Yn(i.length>4&&"documents"===i.get(4)),i.popFirst(5)}function pT(i,e,t){return{name:Wp(i,e),fields:t.value.mapValue.fields}}function pv(i,e,t){const n=Su(i,e.name),r=lo(e.updateTime),s=new jo({mapValue:{fields:e.fields}}),a=Sr.newFoundDocument(n,r,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function mv(i,e){let t;if(e instanceof Bp)t={update:pT(i,e.key,e.value)};else if(e instanceof od)t={delete:Wp(i,e.key)};else if(e instanceof sd)t={update:pT(i,e.key,e.data),updateMask:_T(e.fieldMask)};else{if(!(e instanceof ih))return gn();t={verify:Wp(i,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(r,s){const a=s.transform;if(a instanceof Hg)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof rd)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof nh)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof zg)return{fieldPath:s.field.canonicalString(),increment:a._t};throw gn()}(0,n))),e.precondition.isNone||(t.currentDocument=void 0!==(r=e.precondition).updateTime?{updateTime:PI(i,r.updateTime)}:void 0!==r.exists?{exists:r.exists}:gn()),t;var r}function mT(i,e){const t=e.currentDocument?void 0!==(r=e.currentDocument).updateTime?Kr.updateTime(lo(r.updateTime)):void 0!==r.exists?Kr.exists(r.exists):Kr.none():Kr.none(),n=e.updateTransforms?e.updateTransforms.map(r=>function(s,a){let c=null;"setToServerValue"in a?(Yn("REQUEST_TIME"===a.setToServerValue),c=new Hg):"appendMissingElements"in a?c=new rd(a.appendMissingElements.values||[]):"removeAllFromArray"in a?c=new nh(a.removeAllFromArray.values||[]):"increment"in a?c=new zg(s,a.increment):gn();const d=gr.fromServerFormat(a.fieldPath);return new uv(d,c)}(i,r)):[];var r;if(e.update){const r=Su(i,e.update.name),s=new jo({mapValue:{fields:e.update.fields}});if(e.updateMask){const a=new bl((e.updateMask.fieldPaths||[]).map(f=>gr.fromServerFormat(f)));return new sd(r,s,a,t,n)}return new Bp(r,s,t,n)}if(e.delete){const r=Su(i,e.delete);return new od(r,t)}if(e.verify){const r=Su(i,e.verify);return new ih(r,t)}return gn()}function gT(i,e){return{documents:[fv(i,e.path)]}}function Eb(i,e){const t={structuredQuery:{}},n=e.path;null!==e.collectionGroup?(t.parent=fv(i,n),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=fv(i,n.popLast()),t.structuredQuery.from=[{collectionId:n.lastSegment()}]);const r=function(d){if(0===d.length)return;const f=d.map(g=>function(v){if("=="===v.op){if(WS(v.value))return{unaryFilter:{field:$p(v.field),op:"IS_NAN"}};if(tv(v.value))return{unaryFilter:{field:$p(v.field),op:"IS_NULL"}}}else if("!="===v.op){if(WS(v.value))return{unaryFilter:{field:$p(v.field),op:"IS_NOT_NAN"}};if(tv(v.value))return{unaryFilter:{field:$p(v.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$p(v.field),op:yT(v.op),value:v.value}}}(g));return 1===f.length?f[0]:{compositeFilter:{op:"AND",filters:f}}}(e.filters);r&&(t.structuredQuery.where=r);const s=function(d){if(0!==d.length)return d.map(f=>{return{field:$p((g=f).field),direction:FI(g.dir)};var g})}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=(f=e.limit,i.dt||Rp(f)?f:{value:f});var f,c,d;return null!==a&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt={before:(c=e.startAt).inclusive,values:c.position}),e.endAt&&(t.structuredQuery.endAt={before:!(d=e.endAt).inclusive,values:d.position}),t}function LI(i){let e=fT(i.parent);const t=i.structuredQuery,n=t.from?t.from.length:0;let r=null;if(n>0){Yn(1===n);const g=t.from[0];g.allDescendants?r=g.collectionId:e=e.child(g.collectionId)}let s=[];t.where&&(s=hf(t.where));let a=[];t.orderBy&&(a=t.orderBy.map(g=>{return new Lp(ff((v=g).field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction));var v}));let c=null;t.limit&&(c=function(g){let v;return v="object"==typeof g?g.value:g,Rp(v)?null:v}(t.limit));let d=null;var g;t.startAt&&(d=new vu((g=t.startAt).values||[],!!g.before));let f=null;return t.endAt&&(f=function(g){return new vu(g.values||[],!g.before)}(t.endAt)),YS(e,r,a,s,c,"F",d,f)}function hf(i){return i?void 0!==i.unaryFilter?[VI(i)]:void 0!==i.fieldFilter?[gv(i)]:void 0!==i.compositeFilter?i.compositeFilter.filters.map(e=>hf(e)).reduce((e,t)=>e.concat(t)):gn():[]}function FI(i){return cT[i]}function yT(i){return uT[i]}function $p(i){return{fieldPath:i.canonicalString()}}function ff(i){return gr.fromServerFormat(i.fieldPath)}function gv(i){return Co.create(ff(i.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return gn()}}(i.fieldFilter.op),i.fieldFilter.value)}function VI(i){switch(i.unaryFilter.op){case"IS_NAN":const e=ff(i.unaryFilter.field);return Co.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=ff(i.unaryFilter.field);return Co.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const n=ff(i.unaryFilter.field);return Co.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=ff(i.unaryFilter.field);return Co.create(r,"!=",{nullValue:"NULL_VALUE"});default:return gn()}}function _T(i){const e=[];return i.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function vT(i){return i.length>=4&&"projects"===i.get(0)&&"databases"===i.get(2)}function Sa(i){let e="";for(let t=0;t<i.length;t++)e.length>0&&(e=wT(e)),e=UI(i.get(t),e);return wT(e)}function UI(i,e){let t=e;const n=i.length;for(let r=0;r<n;r++){const s=i.charAt(r);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function wT(i){return i+"\x01\x01"}function Tu(i){const e=i.length;if(Yn(e>=2),2===e)return Yn("\x01"===i.charAt(0)&&"\x01"===i.charAt(1)),Ni.emptyPath();const t=e-2,n=[];let r="";for(let s=0;s<e;){const a=i.indexOf("\x01",s);switch((a<0||a>t)&&gn(),i.charAt(a+1)){case"\x01":const c=i.substring(s,a);let d;0===r.length?d=c:(r+=c,d=r,r=""),n.push(d);break;case"\x10":r+=i.substring(s,a),r+="\0";break;case"\x11":r+=i.substring(s,a+1);break;default:gn()}s=a+2}return new Ni(n)}const Sb=["userId","batchId"];function yv(i,e){return[i,Sa(e)]}function Tb(i,e,t){return[i,Sa(e),t]}const bT={},Mb=["prefixPath","collectionGroup","readTime","documentId"],dN=["prefixPath","collectionGroup","documentId"],Cb=["collectionGroup","readTime","prefixPath","documentId"],BI=["canonicalId","targetId"],hN=["targetId","path"],qg=["path","targetId"],xT=["collectionId","parent"],Ab=["indexId","uid"],Ib=["uid","sequenceNumber"],HI=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],_v=["indexId","uid","orderedDocumentKey"],vv=["userId","collectionPath","documentId"],Db=["userId","collectionPath","largestBatchId"],fN=["userId","collectionGroup","largestBatchId"],ET=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Rb=[...ET,"documentOverlays"],wv=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Pb=wv,ST=[...Pb,"indexConfiguration","indexState","indexEntries"];class Kg extends Ip{constructor(e,t){super(),this.ee=e,this.currentSequenceNumber=t}}function co(i,e){const t=an(i);return wl.N(t.ee,e)}class bv{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const s=this.mutations[r];s.key.isEqual(e.key)&&pb(s,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Gg(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Gg(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=df();return this.mutations.forEach(r=>{const s=e.get(r.key),a=s.overlayedDocument;let c=this.applyToLocalView(a,s.mutatedFields);c=t.has(r.key)?null:c;const d=fb(a,c);null!==d&&n.set(r.key,d),a.isValidDocument()||a.convertToNoDocument(Wn.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ei())}isEqual(e){return this.batchId===e.batchId&&Kd(this.mutations,e.mutations,(t,n)=>iT(t,n))&&Kd(this.baseMutations,e.baseMutations,(t,n)=>iT(t,n))}}class Zg{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Yn(e.mutations.length===n.length);let r=Hp;const s=e.mutations;for(let a=0;a<s.length;a++)r=r.insert(s[a].key,n[a].version);return new Zg(e,t,n,r)}}class xv{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class oh{constructor(e,t,n,r,s=Wn.min(),a=Wn.min(),c=Ws.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c}withSequenceNumber(e){return new oh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new oh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new oh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Nb{constructor(e){this.ne=e}}function Ev(i,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Yg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document={name:Wp(r=i.ne,(s=e).key),fields:s.data.value.mapValue.fields,updateTime:jp(r,s.version.toTimestamp())};else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:pf(e.version)};else{if(!e.isUnknownDocument())return gn();n.unknownDocument={path:t.path.toArray(),version:pf(e.version)}}var r,s;return n}function Yg(i){const e=i.toTimestamp();return[e.seconds,e.nanoseconds]}function pf(i){const e=i.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function mf(i){const e=new Vr(i.seconds,i.nanoseconds);return Wn.fromTimestamp(e)}function gf(i,e){const t=(e.baseMutations||[]).map(s=>mT(i.ne,s));for(let s=0;s<e.mutations.length-1;++s){const a=e.mutations[s];s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(a.updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s)}const n=e.mutations.map(s=>mT(i.ne,s)),r=Vr.fromMillis(e.localWriteTimeMs);return new bv(e.batchId,r,t,n)}function qp(i){const e=mf(i.readTime),t=void 0!==i.lastLimboFreeSnapshotVersion?mf(i.lastLimboFreeSnapshotVersion):Wn.min();let n;var r;return void 0!==i.query.documents?(Yn(1===(r=i.query).documents.length),n=_s(kp(fT(r.documents[0])))):n=_s(LI(i.query)),new oh(n,i.targetId,0,i.lastListenSequenceNumber,e,t,Ws.fromBase64String(i.resumeToken))}function Sv(i,e){const t=pf(e.snapshotVersion),n=pf(e.lastLimboFreeSnapshotVersion);let r;r=iv(e.target)?gT(i.ne,e.target):Eb(i.ne,e.target);const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:eh(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:r}}function Tv(i){const e=LI({parent:i.parent,structuredQuery:i.structuredQuery});return"LAST"===i.limitType?av(e,e.limit,"L"):e}function Mv(i,e){return new xv(e.largestBatchId,mT(i.ne,e.overlayMutation))}function Ob(i,e){const t=e.path.lastSegment();return[i,Sa(e.path.popLast()),t]}function Lb(i,e,t,n){return{indexId:i,uid:e.uid||"",sequenceNumber:t,readTime:pf(n.readTime),documentKey:Sa(n.documentKey.path),largestBatchId:n.largestBatchId}}class MT{getBundleMetadata(e,t){return kb(e).get(t).next(n=>{if(n)return{id:(r=n).bundleId,createTime:mf(r.createTime),version:r.version};var r})}saveBundleMetadata(e,t){return kb(e).put({bundleId:(n=t).id,createTime:pf(lo(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return Fb(e).get(t).next(n=>{if(n)return{name:(r=n).name,query:Tv(r.bundledQuery),readTime:mf(r.readTime)};var r})}saveNamedQuery(e,t){return Fb(e).put({name:(n=t).name,readTime:pf(lo(n.readTime)),bundledQuery:n.bundledQuery});var n}}function kb(i){return co(i,"bundles")}function Fb(i){return co(i,"namedQueries")}class Xg{constructor(e,t){this.wt=e,this.userId=t}static se(e,t){return new Xg(e,t.uid||"")}getOverlay(e,t){return Cv(e).get(Ob(this.userId,t)).next(n=>n?Mv(this.wt,n):null)}getOverlays(e,t){const n=hc();return Le.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((s,a)=>{const c=new xv(t,a);r.push(this.ie(e,c))}),Le.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(a=>r.add(Sa(a.getCollectionPath())));const s=[];return r.forEach(a=>{const c=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,n+1],!1,!0);s.push(Cv(e).W("collectionPathOverlayIndex",c))}),Le.waitFor(s)}getOverlaysForCollection(e,t,n){const r=hc(),s=Sa(t),a=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Cv(e).K("collectionPathOverlayIndex",a).next(c=>{for(const d of c){const f=Mv(this.wt,d);r.set(f.getKey(),f)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const s=hc();let a;const c=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Cv(e).J({index:"collectionGroupOverlayIndex",range:c},(d,f,g)=>{const v=Mv(this.wt,f);s.size()<r||v.largestBatchId===a?(s.set(v.getKey(),v),a=v.largestBatchId):g.done()}).next(()=>s)}ie(e,t){return Cv(e).put(function(n,r,s){const[a,c,d]=Ob(r,s.mutation.key);return{userId:r,collectionPath:c,documentId:d,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:mv(n.ne,s.mutation)}}(this.wt,this.userId,t))}}function Cv(i){return co(i,"documentOverlays")}class yf{constructor(){}re(e,t){this.oe(e,t),t.ue()}oe(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(ys(e.integerValue));else if("doubleValue"in e){const n=ys(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),Fg(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){const n=e.timestampValue;this.ce(t,20),"string"==typeof n?t.he(n):(t.he(`${n.seconds||""}`),t.ae(n.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(Xd(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ce(t,45),t.ae(n.latitude||0),t.ae(n.longitude||0)}else"mapValue"in e?tb(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):gn()}le(e,t){this.ce(t,25),this.ge(e,t)}ge(e,t){t.he(e)}we(e,t){const n=e.fields||{};this.ce(t,55);for(const r of Object.keys(n))this.le(r,t),this.oe(n[r],t)}me(e,t){const n=e.values||[];this.ce(t,50);for(const r of n)this.oe(r,t)}_e(e,t){this.ce(t,37),Kt.fromName(e).path.forEach(n=>{this.ce(t,60),this.ge(n,t)})}ce(e,t){e.ae(t)}fe(e){e.ae(2)}}function zI(i){if(0===i)return 8;let e=0;return i>>4==0&&(e+=4,i<<=4),i>>6==0&&(e+=2,i<<=2),i>>7==0&&(e+=1),e}function Vb(i){const e=64-function(t){let n=0;for(let r=0;r<8;++r){const s=zI(255&t[r]);if(n+=s,8!==s)break}return n}(i);return Math.ceil(e/8)}yf.ye=new yf;class GI{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ie(n.value),n=t.next();this.Te()}Ee(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ae(n.value),n=t.next();this.Re()}be(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ie(n);else if(n<2048)this.Ie(960|n>>>6),this.Ie(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.Ie(480|n>>>12),this.Ie(128|63&n>>>6),this.Ie(128|63&n);else{const r=t.codePointAt(0);this.Ie(240|r>>>18),this.Ie(128|63&r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r)}}this.Te()}Pe(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Ae(n);else if(n<2048)this.Ae(960|n>>>6),this.Ae(128|63&n);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|n>>>12),this.Ae(128|63&n>>>6),this.Ae(128|63&n);else{const r=t.codePointAt(0);this.Ae(240|r>>>18),this.Ae(128|63&r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r)}}this.Re()}ve(e){const t=this.Ve(e),n=Vb(t);this.Se(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}De(e){const t=this.Ve(e),n=Vb(t);this.Se(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const t=function(r){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,r,!1),new Uint8Array(s.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Ie(e){const t=255&e;0===t?(this.xe(0),this.xe(255)):255===t?(this.xe(255),this.xe(0)):this.xe(t)}Ae(e){const t=255&e;0===t?(this.ke(0),this.ke(255)):255===t?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class uo{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class CT{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class Jg{constructor(){this.Me=new GI,this.Fe=new uo(this.Me),this.$e=new CT(this.Me)}seed(e){this.Me.seed(e)}Be(e){return 0===e?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}class _f{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Le(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new _f(this.indexId,this.documentKey,this.arrayValue,n)}}function ah(i,e){let t=i.indexId-e.indexId;return 0!==t?t:(t=AT(i.arrayValue,e.arrayValue),0!==t?t:(t=AT(i.directionalValue,e.directionalValue),0!==t?t:Kt.comparator(i.documentKey,e.documentKey)))}function AT(i,e){for(let t=0;t<i.length&&t<e.length;++t){const n=i[t]-e[t];if(0!==n)return n}return i.length-e.length}class IT{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const t of e.filters){const n=t;n.ht()?this.Ke=n:this.qe.push(n)}}Ge(e){const t=Dg(e);if(void 0!==t&&!this.Qe(t))return!1;const n=rf(e);let r=0,s=0;for(;r<n.length&&this.Qe(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Ke){const a=n[r];if(!this.je(this.Ke,a)||!this.We(this.Ue[s++],a))return!1;++r}for(;r<n.length;++r){const a=n[r];if(s>=this.Ue.length||!this.We(this.Ue[s++],a))return!1}return!0}Qe(e){for(const t of this.qe)if(this.je(t,e))return!0;return!1}je(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}We(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class DT{constructor(){this.ze=new lh}addToCollectionParentIndex(e,t){return this.ze.add(t),Le.resolve()}getCollectionParents(e,t){return Le.resolve(this.ze.getEntries(t))}addFieldIndex(e,t){return Le.resolve()}deleteFieldIndex(e,t){return Le.resolve()}getDocumentsMatchingTarget(e,t){return Le.resolve(null)}getIndexType(e,t){return Le.resolve(0)}getFieldIndexes(e,t){return Le.resolve([])}getNextCollectionGroupToUpdate(e){return Le.resolve(null)}getMinOffset(e,t){return Le.resolve(Mo.min())}getMinOffsetFromCollectionGroup(e,t){return Le.resolve(Mo.min())}updateCollectionGroup(e,t,n){return Le.resolve()}updateIndexEntries(e,t){return Le.resolve()}}class lh{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Er(Ni.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Er(Ni.comparator)).toArray()}}const Av=new Uint8Array(0);class jI{constructor(e,t){this.user=e,this.databaseId=t,this.He=new lh,this.Je=new Wo(n=>eh(n),(n,r)=>th(n,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.He.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.He.add(t)});const s={collectionId:n,parent:Sa(r)};return Ub(e).put(s)}return Le.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[BS(t),""],!1,!0);return Ub(e).K(r).next(s=>{for(const a of s){if(a.collectionId!==t)break;n.push(Tu(a.parent))}return n})}addFieldIndex(e,t){const n=ey(e),r={indexId:(a=t).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])};var a;delete r.indexId;const s=n.add(r);if(t.indexState){const a=Iv(e);return s.next(c=>{a.put(Lb(c,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=ey(e),r=Iv(e),s=Qg(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const n=Qg(e);let r=!0;const s=new Map;return Le.forEach(this.Ye(t),a=>this.Xe(e,a).next(c=>{r&&(r=!!c),s.set(a,c)})).next(()=>{if(r){let a=ei();const c=[];return Le.forEach(s,(d,f)=>{var g;Dt("IndexedDbIndexManager",`Using index ${g=d,`id=${g.indexId}|cg=${g.collectionGroup}|f=${g.fields.map(z=>`${z.fieldPath}:${z.kind}`).join(",")}`} to execute ${eh(t)}`);const v=function(z,U){const $=Dg(U);if(void 0===$)return null;for(const Z of rv(z,$.fieldPath))switch(Z.op){case"array-contains-any":return Z.value.arrayValue.values||[];case"array-contains":return[Z.value]}return null}(f,d),b=function(z,U){const $=new Map;for(const Z of rf(U))for(const ae of rv(z,Z.fieldPath))switch(ae.op){case"==":case"in":$.set(Z.fieldPath.canonicalString(),ae.value);break;case"not-in":case"!=":return $.set(Z.fieldPath.canonicalString(),ae.value),Array.from($.values())}return null}(f,d),x=function(z,U){const $=[];let Z=!0;for(const ae of rf(U)){const j=0===ae.kind?wI(z,ae.fieldPath,z.startAt):sv(z,ae.fieldPath,z.startAt);$.push(j.value),Z&&(Z=j.inclusive)}return new vu($,Z)}(f,d),C=function(z,U){const $=[];let Z=!0;for(const ae of rf(U)){const j=0===ae.kind?sv(z,ae.fieldPath,z.endAt):wI(z,ae.fieldPath,z.endAt);$.push(j.value),Z&&(Z=j.inclusive)}return new vu($,Z)}(f,d),I=this.Ze(d,f,x),D=this.Ze(d,f,C),L=this.tn(d,f,b),V=this.en(d.indexId,v,I,x.inclusive,D,C.inclusive,L);return Le.forEach(V,z=>n.j(z,t.limit).next(U=>{U.forEach($=>{const Z=Kt.fromSegments($.documentKey);a.has(Z)||(a=a.add(Z),c.push(Z))})}))}).next(()=>c)}return Le.resolve(null)})}Ye(e){let t=this.Je.get(e);return t||(t=[e],this.Je.set(e,t),t)}en(e,t,n,r,s,a,c){const d=(null!=t?t.length:1)*Math.max(n.length,s.length),f=d/(null!=t?t.length:1),g=[];for(let v=0;v<d;++v){const b=t?this.nn(t[v/f]):Av,x=this.sn(e,b,n[v%f],r),C=this.rn(e,b,s[v%f],a),I=c.map(D=>this.sn(e,b,D,!0));g.push(...this.createRange(x,C,I))}return g}sn(e,t,n,r){const s=new _f(e,Kt.empty(),t,n);return r?s:s.Le()}rn(e,t,n,r){const s=new _f(e,Kt.empty(),t,n);return r?s.Le():s}Xe(e,t){const n=new IT(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(s=>{let a=null;for(const c of s)n.Ge(c)&&(!a||c.fields.length>a.fields.length)&&(a=c);return a})}getIndexType(e,t){let n=2;return Le.forEach(this.Ye(t),r=>this.Xe(e,r).next(s=>{s?0!==n&&s.fields.length<function(a){let c=new Er(gr.comparator),d=!1;for(const f of a.filters){const g=f;g.field.isKeyField()||("array-contains"===g.op||"array-contains-any"===g.op?d=!0:c=c.add(g.field))}for(const f of a.orderBy)f.field.isKeyField()||(c=c.add(f.field));return c.size+(d?1:0)}(r)&&(n=1):n=0})).next(()=>n)}on(e,t){const n=new Jg;for(const r of rf(e)){const s=t.data.field(r.fieldPath);if(null==s)return null;const a=n.Be(r.kind);yf.ye.re(s,a)}return n.Oe()}nn(e){const t=new Jg;return yf.ye.re(e,t.Be(0)),t.Oe()}un(e,t){const n=new Jg;return yf.ye.re(lf(this.databaseId,t),n.Be(function(r){const s=rf(r);return 0===s.length?0:s[s.length-1].kind}(e))),n.Oe()}tn(e,t,n){if(null===n)return[];let r=[];r.push(new Jg);let s=0;for(const a of rf(e)){const c=n[s++];for(const d of r)if(this.cn(t,a.fieldPath)&&Qd(c))r=this.an(r,a,c);else{const f=d.Be(a.kind);yf.ye.re(c,f)}}return this.hn(r)}Ze(e,t,n){return this.tn(e,t,n.position)}hn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Oe();return t}an(e,t,n){const r=[...e],s=[];for(const a of n.arrayValue.values||[])for(const c of r){const d=new Jg;d.seed(c.Oe()),yf.ye.re(a,d.Be(t.kind)),s.push(d)}return s}cn(e,t){return!!e.filters.find(n=>n instanceof Co&&n.field.isEqual(t)&&("in"===n.op||"not-in"===n.op))}getFieldIndexes(e,t){const n=ey(e),r=Iv(e);return(t?n.K("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.K()).next(s=>{const a=[];return Le.forEach(s,c=>r.get([c.indexId,this.uid]).next(d=>{a.push(function(f,g){const v=g?new Pg(g.sequenceNumber,new Mo(mf(g.readTime),new Kt(Tu(g.documentKey)),g.largestBatchId)):Pg.empty(),b=f.fields.map(([x,C])=>new Rg(gr.fromServerFormat(x),C));return new X_(f.indexId,f.collectionGroup,b,v)}(c,d))})).next(()=>a)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((n,r)=>{const s=n.indexState.sequenceNumber-r.indexState.sequenceNumber;return 0!==s?s:Kn(n.collectionGroup,r.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=ey(e),s=Iv(e);return this.ln(e).next(a=>r.K("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(c=>Le.forEach(c,d=>s.put(Lb(d.indexId,this.user,a,n)))))}updateIndexEntries(e,t){const n=new Map;return Le.forEach(t,(r,s)=>{const a=n.get(r.collectionGroup);return(a?Le.resolve(a):this.getFieldIndexes(e,r.collectionGroup)).next(c=>(n.set(r.collectionGroup,c),Le.forEach(c,d=>this.fn(e,r,d).next(f=>{const g=this.dn(s,d);return f.isEqual(g)?Le.resolve():this._n(e,s,d,f,g)}))))})}wn(e,t,n,r){return Qg(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.un(n,t.key),documentKey:t.key.path.toArray()})}mn(e,t,n,r){return Qg(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.un(n,t.key),t.key.path.toArray()])}fn(e,t,n){const r=Qg(e);let s=new Er(ah);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.un(n,t)])},(a,c)=>{s=s.add(new _f(n.indexId,t,c.arrayValue,c.directionalValue))}).next(()=>s)}dn(e,t){let n=new Er(ah);const r=this.on(t,e);if(null==r)return n;const s=Dg(t);if(null!=s){const a=e.data.field(s.fieldPath);if(Qd(a))for(const c of a.arrayValue.values||[])n=n.add(new _f(t.indexId,e.key,this.nn(c),r))}else n=n.add(new _f(t.indexId,e.key,Av,r));return n}_n(e,t,n,r,s){Dt("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const a=[];return function(c,d,f,g,v){const b=c.getIterator(),x=d.getIterator();let C=Lg(b),I=Lg(x);for(;C||I;){let D=!1,L=!1;if(C&&I){const V=f(C,I);V<0?L=!0:V>0&&(D=!0)}else null!=C?L=!0:D=!0;D?(g(I),I=Lg(x)):L?(v(C),C=Lg(b)):(C=Lg(b),I=Lg(x))}}(r,s,ah,c=>{a.push(this.wn(e,t,n,c))},c=>{a.push(this.mn(e,t,n,c))}),Le.waitFor(a)}ln(e){let t=1;return Iv(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,r,s)=>{s.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((a,c)=>ah(a,c)).filter((a,c,d)=>!c||0!==ah(a,d[c-1]));const r=[];r.push(e);for(const a of n){const c=ah(a,e),d=ah(a,t);if(0===c)r[0]=e.Le();else if(c>0&&d<0)r.push(a),r.push(a.Le());else if(d>0)break}r.push(t);const s=[];for(let a=0;a<r.length;a+=2)s.push(IDBKeyRange.bound([r[a].indexId,this.uid,r[a].arrayValue,r[a].directionalValue,Av,[]],[r[a+1].indexId,this.uid,r[a+1].arrayValue,r[a+1].directionalValue,Av,[]]));return s}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Bb)}getMinOffset(e,t){return Le.mapArray(this.Ye(t),n=>this.Xe(e,n).next(r=>r||gn())).next(Bb)}}function Ub(i){return co(i,"collectionParents")}function Qg(i){return co(i,"indexEntries")}function ey(i){return co(i,"indexConfiguration")}function Iv(i){return co(i,"indexState")}function Bb(i){Yn(0!==i.length);let e=i[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<i.length;n++){const r=i[n].indexState.offset;Ng(r,e)<0&&(e=r),t<r.largestBatchId&&(t=r.largestBatchId)}return new Mo(e.readTime,e.documentKey,t)}const Dv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class os{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new os(e,os.DEFAULT_COLLECTION_PERCENTILE,os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function RT(i,e,t){const n=i.store("mutations"),r=i.store("documentMutations"),s=[],a=IDBKeyRange.only(t.batchId);let c=0;const d=n.J({range:a},(g,v,b)=>(c++,b.delete()));s.push(d.next(()=>{Yn(1===c)}));const f=[];for(const g of t.mutations){const v=Tb(e,g.key.path,t.batchId);s.push(r.delete(v)),f.push(g.key)}return Le.waitFor(s).next(()=>f)}function Rv(i){if(!i)return 0;let e;if(i.document)e=i.document;else if(i.unknownDocument)e=i.unknownDocument;else{if(!i.noDocument)throw gn();e=i.noDocument}return JSON.stringify(e).length}os.DEFAULT_COLLECTION_PERCENTILE=10,os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,os.DEFAULT=new os(41943040,os.DEFAULT_COLLECTION_PERCENTILE,os.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),os.DISABLED=new os(-1,0,0);class El{constructor(e,t,n,r){this.userId=e,this.wt=t,this.indexManager=n,this.referenceDelegate=r,this.gn={}}static se(e,t,n,r){Yn(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new El(s,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ao(e).J({index:"userMutationsIndex",range:n},(r,s,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const s=vf(e),a=Ao(e);return a.add({}).next(c=>{Yn("number"==typeof c);const d=new bv(c,t,n,r),f=function(b,x,C){const I=C.baseMutations.map(L=>mv(b.ne,L)),D=C.mutations.map(L=>mv(b.ne,L));return{userId:x,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:I,mutations:D}}(this.wt,this.userId,d),g=[];let v=new Er((b,x)=>Kn(b.canonicalString(),x.canonicalString()));for(const b of r){const x=Tb(this.userId,b.key.path,c);v=v.add(b.key.path.popLast()),g.push(a.put(f)),g.push(s.put(x,bT))}return v.forEach(b=>{g.push(this.indexManager.addToCollectionParentIndex(e,b))}),e.addOnCommittedListener(()=>{this.gn[c]=d.keys()}),Le.waitFor(g).next(()=>d)})}lookupMutationBatch(e,t){return Ao(e).get(t).next(n=>n?(Yn(n.userId===this.userId),gf(this.wt,n)):null)}yn(e,t){return this.gn[t]?Le.resolve(this.gn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const r=n.keys();return this.gn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return Ao(e).J({index:"userMutationsIndex",range:r},(a,c,d)=>{c.userId===this.userId&&(Yn(c.batchId>=n),s=gf(this.wt,c)),d.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Ao(e).J({index:"userMutationsIndex",range:t,reverse:!0},(r,s,a)=>{n=s.batchId,a.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ao(e).K("userMutationsIndex",t).next(n=>n.map(r=>gf(this.wt,r)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=yv(this.userId,t.path),r=IDBKeyRange.lowerBound(n),s=[];return vf(e).J({range:r},(a,c,d)=>{const[f,g,v]=a,b=Tu(g);if(f===this.userId&&t.path.isEqual(b))return Ao(e).get(v).next(x=>{if(!x)throw gn();Yn(x.userId===this.userId),s.push(gf(this.wt,x))});d.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Er(Kn);const r=[];return t.forEach(s=>{const a=yv(this.userId,s.path),c=IDBKeyRange.lowerBound(a),d=vf(e).J({range:c},(f,g,v)=>{const[b,x,C]=f,I=Tu(x);b===this.userId&&s.path.isEqual(I)?n=n.add(C):v.done()});r.push(d)}),Le.waitFor(r).next(()=>this.pn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,s=yv(this.userId,n),a=IDBKeyRange.lowerBound(s);let c=new Er(Kn);return vf(e).J({range:a},(d,f,g)=>{const[v,b,x]=d,C=Tu(b);v===this.userId&&n.isPrefixOf(C)?C.length===r&&(c=c.add(x)):g.done()}).next(()=>this.pn(e,c))}pn(e,t){const n=[],r=[];return t.forEach(s=>{r.push(Ao(e).get(s).next(a=>{if(null===a)throw gn();Yn(a.userId===this.userId),n.push(gf(this.wt,a))}))}),Le.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return RT(e.ee,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.In(t.batchId)}),Le.forEach(n,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Le.resolve();const n=IDBKeyRange.lowerBound([this.userId]),r=[];return vf(e).J({range:n},(s,a,c)=>{if(s[0]===this.userId){const d=Tu(s[1]);r.push(d)}else c.done()}).next(()=>{Yn(0===r.length)})})}containsKey(e,t){return fc(e,this.userId,t)}Tn(e){return Hb(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function fc(i,e,t){const n=yv(e,t.path),r=n[1],s=IDBKeyRange.lowerBound(n);let a=!1;return vf(i).J({range:s,H:!0},(c,d,f)=>{const[g,v,b]=c;g===e&&v===r&&(a=!0),f.done()}).next(()=>a)}function Ao(i){return co(i,"mutations")}function vf(i){return co(i,"documentMutations")}function Hb(i){return co(i,"mutationQueues")}class wf{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new wf(0)}static Rn(){return new wf(-1)}}class WI{constructor(e,t){this.referenceDelegate=e,this.wt=t}allocateTargetId(e){return this.bn(e).next(t=>{const n=new wf(t.highestTargetId);return t.highestTargetId=n.next(),this.Pn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(t=>Wn.fromTimestamp(new Vr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.bn(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Pn(e,r)))}addTargetData(e,t){return this.vn(e,t).next(()=>this.bn(e).next(n=>(n.targetCount+=1,this.Vn(t,n),this.Pn(e,n))))}updateTargetData(e,t){return this.vn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Kp(e).delete(t.targetId)).next(()=>this.bn(e)).next(n=>(Yn(n.targetCount>0),n.targetCount-=1,this.Pn(e,n)))}removeTargets(e,t,n){let r=0;const s=[];return Kp(e).J((a,c)=>{const d=qp(c);d.sequenceNumber<=t&&null===n.get(d.targetId)&&(r++,s.push(this.removeTargetData(e,d)))}).next(()=>Le.waitFor(s)).next(()=>r)}forEachTarget(e,t){return Kp(e).J((n,r)=>{const s=qp(r);t(s)})}bn(e){return PT(e).get("targetGlobalKey").next(t=>(Yn(null!==t),t))}Pn(e,t){return PT(e).put("targetGlobalKey",t)}vn(e,t){return Kp(e).put(Sv(this.wt,t))}Vn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.bn(e).next(t=>t.targetCount)}getTargetData(e,t){const n=eh(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return Kp(e).J({range:r,index:"queryTargetsIndex"},(a,c,d)=>{const f=qp(c);th(t,f.target)&&(s=f,d.done())}).next(()=>s)}addMatchingKeys(e,t,n){const r=[],s=Mu(e);return t.forEach(a=>{const c=Sa(a.path);r.push(s.put({targetId:n,path:c})),r.push(this.referenceDelegate.addReference(e,n,a))}),Le.waitFor(r)}removeMatchingKeys(e,t,n){const r=Mu(e);return Le.forEach(t,s=>{const a=Sa(s.path);return Le.waitFor([r.delete([n,a]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=Mu(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Mu(e);let s=ei();return r.J({range:n,H:!0},(a,c,d)=>{const f=Tu(a[1]),g=new Kt(f);s=s.add(g)}).next(()=>s)}containsKey(e,t){const n=Sa(t.path),r=IDBKeyRange.bound([n],[BS(n)],!1,!0);let s=0;return Mu(e).J({index:"documentTargetsIndex",H:!0,range:r},([a,c],d,f)=>{0!==a&&(s++,f.done())}).next(()=>s>0)}te(e,t){return Kp(e).get(t).next(n=>n?qp(n):null)}}function Kp(i){return co(i,"targets")}function PT(i){return co(i,"targetGlobal")}function Mu(i){return co(i,"targetDocuments")}function Zp([i,e],[t,n]){const r=Kn(i,t);return 0===r?Kn(e,n):r}class $I{constructor(e){this.Sn=e,this.buffer=new Er(Zp),this.Dn=0}Cn(){return++this.Dn}xn(e){const t=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();Zp(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class NT{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Nn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return null!==this.Nn}kn(e){var t=this;Dt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Ke.Z)(function*(){t.Nn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(n){zc(n)?Dt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield vl(n)}yield t.kn(3e5)}))}}class qI{constructor(e,t){this.On=e,this.params=t}calculateTargetCount(e,t){return this.On.Mn(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(0===t)return Le.resolve(Ea.ot);const n=new $I(t);return this.On.forEachTarget(e,r=>n.xn(r.sequenceNumber)).next(()=>this.On.Fn(e,r=>n.xn(r))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.On.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.On.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Dt("LruGarbageCollector","Garbage collection skipped; disabled"),Le.resolve(Dv)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Dt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Dv):this.$n(e,t))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,t){let n,r,s,a,c,d,f;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(v=>(v>this.params.maximumSequenceNumbersToCollect?(Dt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),r=this.params.maximumSequenceNumbersToCollect):r=v,a=Date.now(),this.nthSequenceNumber(e,r))).next(v=>(n=v,c=Date.now(),this.removeTargets(e,n,t))).next(v=>(s=v,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(v=>(f=Date.now(),Ag()<=za.in.DEBUG&&Dt("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${a-g}ms\n\tDetermined least recently used ${r} in `+(c-a)+`ms\n\tRemoved ${s} targets in `+(d-c)+`ms\n\tRemoved ${v} documents in `+(f-d)+`ms\nTotal Duration: ${f-g}ms`),Le.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:v})))}}class OT{constructor(e,t){this.db=e,this.garbageCollector=new qI(this,t)}Mn(e){const t=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(r=>n+r))}Bn(e){let t=0;return this.Fn(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Fn(e,t){return this.Ln(e,(n,r)=>t(r))}addReference(e,t,n){return ty(e,n)}removeReference(e,t,n){return ty(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return ty(e,t)}Un(e,t){return function(n,r){let s=!1;return Hb(n).Y(a=>fc(n,a,r).next(c=>(c&&(s=!0),Le.resolve(!c)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Ln(e,(a,c)=>{if(c<=t){const d=this.Un(e,a).next(f=>{if(!f)return s++,n.getEntry(e,a).next(()=>(n.removeEntry(a,Wn.min()),Mu(e).delete([0,Sa(a.path)])))});r.push(d)}}).next(()=>Le.waitFor(r)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return ty(e,t)}Ln(e,t){const n=Mu(e);let r,s=Ea.ot;return n.J({index:"documentTargetsIndex"},([a,c],{path:d,sequenceNumber:f})=>{0===a?(s!==Ea.ot&&t(new Kt(Tu(r)),s),s=f,r=d):s=Ea.ot}).next(()=>{s!==Ea.ot&&t(new Kt(Tu(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ty(i,e){return Mu(i).put((n=i.currentSequenceNumber,{targetId:0,path:Sa(e.path),sequenceNumber:n}));var n}class ny{constructor(){this.changes=new Wo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Sr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Le.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class KI{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return ld(e).put(n)}removeEntry(e,t,n){return ld(e).delete(function(r,s){const a=r.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Yg(s),a[a.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.qn(e,n)))}getEntry(e,t){let n=Sr.newInvalidDocument(t);return ld(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Yp(t))},(r,s)=>{n=this.Kn(t,s)}).next(()=>n)}Gn(e,t){let n={size:0,document:Sr.newInvalidDocument(t)};return ld(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Yp(t))},(r,s)=>{n={document:this.Kn(t,s),size:Rv(s)}}).next(()=>n)}getEntries(e,t){let n=pr();return this.Qn(e,t,(r,s)=>{const a=this.Kn(r,s);n=n.insert(r,a)}).next(()=>n)}jn(e,t){let n=pr(),r=new gs(Kt.comparator);return this.Qn(e,t,(s,a)=>{const c=this.Kn(s,a);n=n.insert(s,c),r=r.insert(s,Rv(a))}).next(()=>({documents:n,Wn:r}))}Qn(e,t,n){if(t.isEmpty())return Le.resolve();let r=new Er(jb);t.forEach(d=>r=r.add(d));const s=IDBKeyRange.bound(Yp(r.first()),Yp(r.last())),a=r.getIterator();let c=a.getNext();return ld(e).J({index:"documentKeyIndex",range:s},(d,f,g)=>{const v=Kt.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;c&&jb(c,v)<0;)n(c,null),c=a.getNext();c&&c.isEqual(v)&&(n(c,f),c=a.hasNext()?a.getNext():null),c?g.q(Yp(c)):g.done()}).next(()=>{for(;c;)n(c,null),c=a.hasNext()?a.getNext():null})}getAllFromCollection(e,t,n){const r=[t.popLast().toArray(),t.lastSegment(),Yg(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],s=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return ld(e).K(IDBKeyRange.bound(r,s,!0)).next(a=>{let c=pr();for(const d of a){const f=this.Kn(Kt.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);c=c.insert(f.key,f)}return c})}getAllFromCollectionGroup(e,t,n,r){let s=pr();const a=Gb(t,n),c=Gb(t,Mo.max());return ld(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(a,c,!0)},(d,f,g)=>{const v=this.Kn(Kt.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(v.key,v),s.size===r&&g.done()}).next(()=>s)}newChangeBuffer(e){return new LT(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Pv(e).get("remoteDocumentGlobalKey").next(t=>(Yn(!!t),t))}qn(e,t){return Pv(e).put("remoteDocumentGlobalKey",t)}Kn(e,t){if(t){const n=function TT(i,e){let t;if(e.document)t=pv(i.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=Kt.fromSegments(e.noDocument.path),r=mf(e.noDocument.readTime);t=Sr.newNoDocument(n,r),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return gn();{const n=Kt.fromSegments(e.unknownDocument.path),r=mf(e.unknownDocument.version);t=Sr.newUnknownDocument(n,r)}}return e.readTime&&t.setReadTime(function(n){const r=new Vr(n[0],n[1]);return Wn.fromTimestamp(r)}(e.readTime)),t}(this.wt,t);if(!n.isNoDocument()||!n.version.isEqual(Wn.min()))return n}return Sr.newInvalidDocument(e)}}function zb(i){return new KI(i)}class LT extends ny{constructor(e,t){super(),this.zn=e,this.trackRemovals=t,this.Hn=new Wo(n=>n.toString(),(n,r)=>n.isEqual(r))}applyChanges(e){const t=[];let n=0,r=new Er((s,a)=>Kn(s.canonicalString(),a.canonicalString()));return this.changes.forEach((s,a)=>{const c=this.Hn.get(s);if(t.push(this.zn.removeEntry(e,s,c.readTime)),a.isValidDocument()){const d=Ev(this.zn.wt,a);r=r.add(s.path.popLast()),n+=Rv(d)-c.size,t.push(this.zn.addEntry(e,s,d))}else if(n-=c.size,this.trackRemovals){const d=Ev(this.zn.wt,a.convertToNoDocument(Wn.min()));t.push(this.zn.addEntry(e,s,d))}}),r.forEach(s=>{t.push(this.zn.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.zn.updateMetadata(e,n)),Le.waitFor(t)}getFromCache(e,t){return this.zn.Gn(e,t).next(n=>(this.Hn.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.zn.jn(e,t).next(({documents:n,Wn:r})=>(r.forEach((s,a)=>{this.Hn.set(s,{size:a,readTime:n.get(s).readTime})}),n))}}function Pv(i){return co(i,"remoteDocumentGlobal")}function ld(i){return co(i,"remoteDocumentsV14")}function Yp(i){const e=i.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Gb(i,e){const t=e.documentKey.path.toArray();return[i,Yg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function jb(i,e){const t=i.path.toArray(),n=e.path.toArray();let r=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(r=Kn(t[s],n[s]),r)return r;return r=Kn(t.length,n.length),r||(r=Kn(t[t.length-2],n[n.length-2]),r||Kn(t[t.length-1],n[n.length-1]))}class kT{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Wb{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.getBaseDocument(e,t,n))).next(r=>(null!==n&&Gg(n.mutation,r,bl.empty(),Vr.now()),r))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,ei()).next(()=>n))}getLocalViewOfDocuments(e,t,n=ei()){const r=hc();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(s=>{let a=sh();return s.forEach((c,d)=>{a=a.insert(c,d.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const n=hc();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,ei()))}populateOverlays(e,t,n){const r=[];return n.forEach(s=>{t.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(e,r).next(s=>{s.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,n,r){let s=pr();const a=bu(),c=bu();return t.forEach((d,f)=>{const g=n.get(f.key);r.has(f.key)&&(void 0===g||g.mutation instanceof sd)?s=s.insert(f.key,f):void 0!==g&&(a.set(f.key,g.mutation.getFieldMask()),Gg(g.mutation,f,g.mutation.getFieldMask(),Vr.now()))}),this.recalculateAndSaveOverlays(e,s).next(d=>(d.forEach((f,g)=>a.set(f,g)),t.forEach((f,g)=>{var v;return c.set(f,new kT(g,null!==(v=a.get(f))&&void 0!==v?v:null))}),c))}recalculateAndSaveOverlays(e,t){const n=bu();let r=new gs((a,c)=>a-c),s=ei();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const c of a)c.keys().forEach(d=>{const f=t.get(d);if(null===f)return;let g=n.get(d)||bl.empty();g=c.applyToLocalView(f,g),n.set(d,g);const v=(r.get(c.batchId)||ei()).add(d);r=r.insert(c.batchId,v)})}).next(()=>{const a=[],c=r.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),f=d.key,g=d.value,v=df();g.forEach(b=>{if(!s.has(b)){const x=fb(t.get(b),n.get(b));null!==x&&v.set(b,x),s=s.add(b)}}),a.push(this.documentOverlayCache.saveOverlays(e,f,v))}return Le.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n){return Kt.isDocumentKey((r=t).path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):lb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const a=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):Le.resolve(hc());let c=-1,d=s;return a.next(f=>Le.forEach(f,(g,v)=>(c<v.largestBatchId&&(c=v.largestBatchId),s.get(g)?Le.resolve():this.getBaseDocument(e,g,v).next(b=>{d=d.insert(g,b)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,d,f,ei())).next(g=>({batchId:c,changes:xl(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Kt(t)).next(n=>{let r=sh();return n.isFoundDocument()&&(r=r.insert(n.key,n)),r})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let s=sh();return this.indexManager.getCollectionParents(e,r).next(a=>Le.forEach(a,c=>{const d=(f=t,g=c.child(r),new wu(g,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt));var f,g;return this.getDocumentsMatchingCollectionQuery(e,d,n).next(f=>{f.forEach((g,v)=>{s=s.insert(g,v)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(s=>(r=s,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId))).next(s=>{s.forEach((c,d)=>{const f=d.getKey();null===r.get(f)&&(r=r.insert(f,Sr.newInvalidDocument(f)))});let a=sh();return r.forEach((c,d)=>{const f=s.get(c);void 0!==f&&Gg(f.mutation,d,bl.empty(),Vr.now()),cv(t,d)&&(a=a.insert(c,d))}),a})}getBaseDocument(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):Le.resolve(Sr.newInvalidDocument(t))}}class FT{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,t){return Le.resolve(this.Jn.get(t))}saveBundleMetadata(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:lo(n.createTime)}),Le.resolve()}getNamedQuery(e,t){return Le.resolve(this.Yn.get(t))}saveNamedQuery(e,t){return this.Yn.set(t.name,{name:(n=t).name,query:Tv(n.bundledQuery),readTime:lo(n.readTime)}),Le.resolve();var n}}class VT{constructor(){this.overlays=new gs(Kt.comparator),this.Xn=new Map}getOverlay(e,t){return Le.resolve(this.overlays.get(t))}getOverlays(e,t){const n=hc();return Le.forEach(t,r=>this.getOverlay(e,r).next(s=>{null!==s&&n.set(r,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((r,s)=>{this.ie(e,t,s)}),Le.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Xn.get(n);return void 0!==r&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Xn.delete(n)),Le.resolve()}getOverlaysForCollection(e,t,n){const r=hc(),s=t.length+1,a=new Kt(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){const d=c.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&d.largestBatchId>n&&r.set(d.getKey(),d)}return Le.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new gs((f,g)=>f-g);const a=this.overlays.getIterator();for(;a.hasNext();){const f=a.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>n){let g=s.get(f.largestBatchId);null===g&&(g=hc(),s=s.insert(f.largestBatchId,g)),g.set(f.getKey(),f)}}const c=hc(),d=s.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((f,g)=>c.set(f,g)),!(c.size()>=r)););return Le.resolve(c)}ie(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const a=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new xv(t,n));let s=this.Xn.get(t);void 0===s&&(s=ei(),this.Xn.set(t,s)),this.Xn.set(t,s.add(n.key))}}class Nv{constructor(){this.Zn=new Er(Io.ts),this.es=new Er(Io.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const n=new Io(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.rs(new Io(e,t))}os(e,t){e.forEach(n=>this.removeReference(n,t))}us(e){const t=new Kt(new Ni([])),n=new Io(t,e),r=new Io(t,e+1),s=[];return this.es.forEachInRange([n,r],a=>{this.rs(a),s.push(a.key)}),s}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new Kt(new Ni([])),n=new Io(t,e),r=new Io(t,e+1);let s=ei();return this.es.forEachInRange([n,r],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new Io(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Io{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return Kt.comparator(e.key,t.key)||Kn(e.ls,t.ls)}static ns(e,t){return Kn(e.ls,t.ls)||Kt.comparator(e.key,t.key)}}class ZI{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.fs=1,this.ds=new Er(Io.ts)}checkEmpty(e){return Le.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.fs;this.fs++;const a=new bv(s,t,n,r);this.mutationQueue.push(a);for(const c of r)this.ds=this.ds.add(new Io(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return Le.resolve(a)}lookupMutationBatch(e,t){return Le.resolve(this._s(t))}getNextMutationBatchAfterBatchId(e,t){const r=this.ws(t+1),s=r<0?0:r;return Le.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Le.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(e){return Le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Io(t,0),r=new Io(t,Number.POSITIVE_INFINITY),s=[];return this.ds.forEachInRange([n,r],a=>{const c=this._s(a.ls);s.push(c)}),Le.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Er(Kn);return t.forEach(r=>{const s=new Io(r,0),a=new Io(r,Number.POSITIVE_INFINITY);this.ds.forEachInRange([s,a],c=>{n=n.add(c.ls)})}),Le.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;Kt.isDocumentKey(s)||(s=s.child(""));const a=new Io(new Kt(s),0);let c=new Er(Kn);return this.ds.forEachWhile(d=>{const f=d.key.path;return!!n.isPrefixOf(f)&&(f.length===r&&(c=c.add(d.ls)),!0)},a),Le.resolve(this.gs(c))}gs(e){const t=[];return e.forEach(n=>{const r=this._s(n);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){Yn(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();let n=this.ds;return Le.forEach(t.mutations,r=>{const s=new Io(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=n})}In(e){}containsKey(e,t){const n=new Io(t,0),r=this.ds.firstAfterOrEqual(n);return Le.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return Le.resolve()}ys(e,t){return this.ws(e)}ws(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}_s(e){const t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class YI{constructor(e){this.ps=e,this.docs=new gs(Kt.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,a=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Le.resolve(n?n.document.mutableCopy():Sr.newInvalidDocument(t))}getEntries(e,t){let n=pr();return t.forEach(r=>{const s=this.docs.get(r);n=n.insert(r,s?s.document.mutableCopy():Sr.newInvalidDocument(r))}),Le.resolve(n)}getAllFromCollection(e,t,n){let r=pr();const s=new Kt(t.child("")),a=this.docs.getIteratorFrom(s);for(;a.hasNext();){const{key:c,value:{document:d}}=a.getNext();if(!t.isPrefixOf(c.path))break;c.path.length>t.length+1||Ng(Ap(d),n)<=0||(r=r.insert(d.key,d.mutableCopy()))}return Le.resolve(r)}getAllFromCollectionGroup(e,t,n,r){gn()}Is(e,t){return Le.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new XI(this)}getSize(e){return Le.resolve(this.size)}}class XI extends ny{constructor(e){super(),this.zn=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.zn.addEntry(e,r)):this.zn.removeEntry(n)}),Le.waitFor(t)}getFromCache(e,t){return this.zn.getEntry(e,t)}getAllFromCache(e,t){return this.zn.getEntries(e,t)}}class JI{constructor(e){this.persistence=e,this.Ts=new Wo(t=>eh(t),th),this.lastRemoteSnapshotVersion=Wn.min(),this.highestTargetId=0,this.Es=0,this.As=new Nv,this.targetCount=0,this.Rs=wf.An()}forEachTarget(e,t){return this.Ts.forEach((n,r)=>t(r)),Le.resolve()}getLastRemoteSnapshotVersion(e){return Le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Le.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),Le.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),Le.resolve()}vn(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new wf(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,t){return this.vn(t),this.targetCount+=1,Le.resolve()}updateTargetData(e,t){return this.vn(t),Le.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,Le.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.Ts.forEach((a,c)=>{c.sequenceNumber<=t&&null===n.get(c.targetId)&&(this.Ts.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),Le.waitFor(s).next(()=>r)}getTargetCount(e){return Le.resolve(this.targetCount)}getTargetData(e,t){const n=this.Ts.get(t)||null;return Le.resolve(n)}addMatchingKeys(e,t,n){return this.As.ss(t,n),Le.resolve()}removeMatchingKeys(e,t,n){this.As.os(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(a=>{s.push(r.markPotentiallyOrphaned(e,a))}),Le.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.As.us(t),Le.resolve()}getMatchingKeysForTargetId(e,t){const n=this.As.hs(t);return Le.resolve(n)}containsKey(e,t){return Le.resolve(this.As.containsKey(t))}}class UT{constructor(e,t){this.bs={},this.overlays={},this.Ps=new Ea(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new JI(this),this.indexManager=new DT,this.remoteDocumentCache=new YI(n=>this.referenceDelegate.Ss(n)),this.wt=new Nb(t),this.Ds=new FT(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new VT,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.bs[e.toKey()];return n||(n=new ZI(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,t,n){Dt("MemoryPersistence","Starting transaction:",e);const r=new QI(this.Ps.next());return this.referenceDelegate.Cs(),n(r).next(s=>this.referenceDelegate.xs(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Ns(e,t){return Le.or(Object.values(this.bs).map(n=>()=>n.containsKey(e,t)))}}class QI extends Ip{constructor(e){super(),this.currentSequenceNumber=e}}class Ov{constructor(e){this.persistence=e,this.ks=new Nv,this.Os=null}static Ms(e){return new Ov(e)}get Fs(){if(this.Os)return this.Os;throw gn()}addReference(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),Le.resolve()}removeReference(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),Le.resolve()}markPotentiallyOrphaned(e,t){return this.Fs.add(t.toString()),Le.resolve()}removeTarget(e,t){this.ks.us(t.targetId).forEach(r=>this.Fs.add(r.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(r=>{r.forEach(s=>this.Fs.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Cs(){this.Os=new Set}xs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Le.forEach(this.Fs,n=>{const r=Kt.fromPath(n);return this.$s(e,r).next(s=>{s||t.removeEntry(r,Wn.min())})}).next(()=>(this.Os=null,t.apply(e)))}updateLimboDocument(e,t){return this.$s(e,t).next(n=>{n?this.Fs.delete(t.toString()):this.Fs.add(t.toString())})}Ss(e){return 0}$s(e,t){return Le.or([()=>Le.resolve(this.ks.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ns(e,t)])}}class eD{constructor(e){this.wt=e}O(e,t,n,r){const s=new Og("createOrUpgrade",t);var c;n<1&&r>=1&&(e.createObjectStore("owner"),(c=e).createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sb,{unique:!0}),c.createObjectStore("documentMutations"),BT(e),function(c){c.createObjectStore("remoteDocuments")}(e));let a=Le.resolve();return n<3&&r>=3&&(0!==n&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),BT(e)),a=a.next(()=>function(c){const d=c.store("targetGlobal"),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Wn.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",f)}(s))),n<4&&r>=4&&(0!==n&&(a=a.next(()=>function(c,d){return d.store("mutations").K().next(f=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Sb,{unique:!0});const g=d.store("mutations"),v=f.map(b=>g.put(b));return Le.waitFor(v)})}(e,s))),a=a.next(()=>{!function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(a=a.next(()=>this.Bs(s))),n<6&&r>=6&&(a=a.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(s)))),n<7&&r>=7&&(a=a.next(()=>this.Us(s))),n<8&&r>=8&&(a=a.next(()=>this.qs(e,s))),n<9&&r>=9&&(a=a.next(()=>{!function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(a=a.next(()=>this.Ks(s))),n<11&&r>=11&&(a=a.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(a=a.next(()=>{!function(c){const d=c.createObjectStore("documentOverlays",{keyPath:vv});d.createIndex("collectionPathOverlayIndex",Db,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",fN,{unique:!1})}(e)})),n<13&&r>=13&&(a=a.next(()=>function(c){const d=c.createObjectStore("remoteDocumentsV14",{keyPath:Mb});d.createIndex("documentKeyIndex",dN),d.createIndex("collectionGroupIndex",Cb)}(e)).next(()=>this.Gs(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(a=a.next(()=>this.Qs(e,s))),n<15&&r>=15&&(a=a.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:Ab}).createIndex("sequenceNumberIndex",Ib,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:HI}).createIndex("documentKeyIndex",_v,{unique:!1})}(e))),a}Ls(e){let t=0;return e.store("remoteDocuments").J((n,r)=>{t+=Rv(r)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Bs(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.K().next(r=>Le.forEach(r,s=>{const a=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return n.K("userMutationsIndex",a).next(c=>Le.forEach(c,d=>{Yn(d.userId===s.userId);const f=gf(this.wt,d);return RT(e,s.userId,f).next(()=>{})}))}))}Us(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const s=[];return n.J((a,c)=>{const d=new Ni(a),f=[0,Sa(d)];s.push(t.get(f).next(g=>g?Le.resolve():t.put({targetId:0,path:Sa(d),sequenceNumber:r.highestListenSequenceNumber})))}).next(()=>Le.waitFor(s))})}qs(e,t){e.createObjectStore("collectionParents",{keyPath:xT});const n=t.store("collectionParents"),r=new lh,s=a=>{if(r.add(a)){const c=a.lastSegment(),d=a.popLast();return n.put({collectionId:c,parent:Sa(d)})}};return t.store("remoteDocuments").J({H:!0},(a,c)=>{const d=new Ni(a);return s(d.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([a,c,d],f)=>{const g=Tu(c);return s(g.popLast())}))}Ks(e){const t=e.store("targets");return t.J((n,r)=>{const s=qp(r),a=Sv(this.wt,s);return t.put(a)})}Gs(e,t){const n=t.store("remoteDocuments"),r=[];return n.J((s,a)=>{const c=t.store("remoteDocumentsV14"),d=(f=a,f.document?new Kt(Ni.fromString(f.document.name).popFirst(5)):f.noDocument?Kt.fromSegments(f.noDocument.path):f.unknownDocument?Kt.fromSegments(f.unknownDocument.path):gn()).path.toArray();var f;const g={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:a.readTime||[0,0],unknownDocument:a.unknownDocument,noDocument:a.noDocument,document:a.document,hasCommittedMutations:!!a.hasCommittedMutations};r.push(c.put(g))}).next(()=>Le.waitFor(r))}Qs(e,t){const n=t.store("mutations"),r=zb(this.wt),s=new UT(Ov.Ms,this.wt.ne);return n.K().next(a=>{const c=new Map;return a.forEach(d=>{var f;let g=null!==(f=c.get(d.userId))&&void 0!==f?f:ei();gf(this.wt,d).keys().forEach(v=>g=g.add(v)),c.set(d.userId,g)}),Le.forEach(c,(d,f)=>{const g=new Ns(f),v=Xg.se(this.wt,g),b=s.getIndexManager(g),x=El.se(g,this.wt,b,s.referenceDelegate);return new Wb(r,x,v,b).recalculateAndSaveOverlaysForDocumentKeys(new Kg(t,Ea.ot),d).next()})})}}function BT(i){i.createObjectStore("targetDocuments",{keyPath:hN}).createIndex("documentTargetsIndex",qg,{unique:!0}),i.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",BI,{unique:!0}),i.createObjectStore("targetGlobal")}const $b="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class qb{constructor(e,t,n,r,s,a,c,d,f,g,v=14){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.js=s,this.window=a,this.document=c,this.Ws=f,this.zs=g,this.Hs=v,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=b=>Promise.resolve(),!qb.V())throw new bt(He.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new OT(this,r),this.ei=t+"main",this.wt=new Nb(d),this.ni=new wl(this.ei,this.Hs,new eD(this.wt)),this.Vs=new WI(this.referenceDelegate,this.wt),this.remoteDocumentCache=zb(this.wt),this.Ds=new MT,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,!1===g&&js("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new bt(He.FAILED_PRECONDITION,$b);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new Ea(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){var t=this;return this.ti=function(){var n=(0,Ke.Z)(function*(r){if(t.started)return e(r)});return function(r){return n.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(function(){var t=(0,Ke.Z)(function*(n){null===n.newVersion&&(yield e())});return function(n){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget((0,Ke.Z)(function*(){t.started&&(yield t.ii())})))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Lv(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(t=>{t||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(t=>this.isPrimary&&!t?this.li(e).next(()=>!1):!!t&&this.fi(e).next(()=>!0))).catch(e=>{if(zc(e))return Dt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Dt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return iy(e).get("owner").next(t=>Le.resolve(this.di(t)))}_i(e){return Lv(e).delete(this.clientId)}wi(){var e=this;return(0,Ke.Z)(function*(){if(e.isPrimary&&!e.mi(e.Zs,18e5)){e.Zs=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=co(n,"clientMetadata");return r.K().next(s=>{const a=e.gi(s,18e5),c=s.filter(d=>-1===a.indexOf(d));return Le.forEach(c,d=>r.delete(d.clientId)).next(()=>c)})}).catch(()=>[]);if(e.si)for(const n of t)e.si.removeItem(e.yi(n.clientId))}})()}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?Le.resolve(!0):iy(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)){if(this.di(t)&&this.networkEnabled)return!0;if(!this.di(t)){if(!t.allowTabSynchronization)throw new bt(He.FAILED_PRECONDITION,$b);return!1}}return!(!this.networkEnabled||!this.inForeground)||Lv(e).K().next(n=>void 0===this.gi(n,5e3).find(r=>{if(this.clientId!==r.clientId){const a=!this.inForeground&&r.inForeground,c=this.networkEnabled===r.networkEnabled;if(!this.networkEnabled&&r.networkEnabled||a&&c)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&Dt("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,Ke.Z)(function*(){e.vs=!1,e.Ii(),e.Xs&&(e.Xs.cancel(),e.Xs=null),e.Ti(),e.Ei(),yield e.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const n=new Kg(t,Ea.ot);return e.li(n).next(()=>e._i(n))}),e.ni.close(),e.Ai()})()}gi(e,t){return e.filter(n=>this.mi(n.updateTimeMs,t)&&!this.pi(n.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>Lv(e).K().next(t=>this.gi(t,18e5).map(n=>n.clientId)))}get started(){return this.vs}getMutationQueue(e,t){return El.se(e,this.wt,t,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new jI(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return Xg.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,t,n){Dt("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=15===(a=this.Hs)?ST:14===a?Pb:13===a?wv:12===a?Rb:11===a?ET:void gn();var a;let c;return this.ni.runTransaction(e,r,s,d=>(c=new Kg(d,this.Ps?this.Ps.next():Ea.ot),"readwrite-primary"===t?this.ai(c).next(f=>!!f||this.hi(c)).next(f=>{if(!f)throw js(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new bt(He.FAILED_PRECONDITION,sf);return n(c)}).next(f=>this.fi(c).next(()=>f)):this.bi(c).next(()=>n(c)))).then(d=>(c.raiseOnCommittedEvent(),d))}bi(e){return iy(e).get("owner").next(t=>{if(null!==t&&this.mi(t.leaseTimestampMs,5e3)&&!this.pi(t.ownerId)&&!this.di(t)&&!(this.zs||this.allowTabSynchronization&&t.allowTabSynchronization))throw new bt(He.FAILED_PRECONDITION,$b)})}fi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return iy(e).put("owner",t)}static V(){return wl.V()}li(e){const t=iy(e);return t.get("owner").next(n=>this.di(n)?(Dt("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):Le.resolve())}mi(e,t){const n=Date.now();return!(e<n-t||e>n&&(js(`Detected an update time that is in the future: ${e} > ${n}`),1))}ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground="visible"===this.document.visibilityState)}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Js=()=>{this.Ii(),(0,fi.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var t;try{const n=null!==(null===(t=this.si)||void 0===t?void 0:t.getItem(this.yi(e)));return Dt("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return js("IndexedDbPersistence","Failed to get zombied client id.",n),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){js("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch(e){}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function iy(i){return co(i,"owner")}function Lv(i){return co(i,"clientMetadata")}function Kb(i,e){let t=i.projectId;return i.isDefaultDatabase||(t+="."+i.database),"firestore/"+e+"/"+t+"/"}class Zb{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Pi=n,this.vi=r}static Vi(e,t){let n=ei(),r=ei();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Zb(e,t.fromCache,n,r)}}class HT{constructor(){this.Si=!1}initialize(e,t){this.Di=e,this.indexManager=t,this.Si=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ci(e,t).next(s=>s||this.xi(e,t,r,n)).next(s=>s||this.Ni(e,t))}Ci(e,t){return Le.resolve(null)}xi(e,t,n,r){return function Fp(i){return 0===i.filters.length&&null===i.limit&&null==i.startAt&&null==i.endAt&&(0===i.explicitOrderBy.length||1===i.explicitOrderBy.length&&i.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(Wn.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next(s=>{const a=this.ki(t,s);return this.Oi(t,a,n,r)?this.Ni(e,t):(Ag()<=za.in.DEBUG&&Dt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),lv(t)),this.Mi(e,a,t,HS(r,-1)))})}ki(e,t){let n=new Er(JS(e));return t.forEach((r,s)=>{cv(e,s)&&(n=n.add(s))}),n}Oi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ni(e,t){return Ag()<=za.in.DEBUG&&Dt("QueryEngine","Using full collection scan to execute query:",lv(t)),this.Di.getDocumentsMatchingQuery(e,t,Mo.min())}Mi(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}class tD{constructor(e,t,n,r){this.persistence=e,this.Fi=t,this.wt=r,this.$i=new gs(Kn),this.Bi=new Wo(s=>eh(s),th),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(n)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Wb(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.$i))}}function Yb(i,e,t,n){return new tD(i,e,t,n)}function Xb(i,e){return kv.apply(this,arguments)}function kv(){return kv=(0,Ke.Z)(function*(i,e){const t=an(i);return yield t.persistence.runTransaction("Handle user change","readonly",n=>{let r;return t.mutationQueue.getAllMutationBatches(n).next(s=>(r=s,t.qi(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],c=[];let d=ei();for(const f of r){a.push(f.batchId);for(const g of f.mutations)d=d.add(g.key)}for(const f of s){c.push(f.batchId);for(const g of f.mutations)d=d.add(g.key)}return t.localDocuments.getDocuments(n,d).next(f=>({Ki:f,removedBatchIds:a,addedBatchIds:c}))})})}),kv.apply(this,arguments)}function zT(i,e){const t=an(i);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const r=e.batch.keys(),s=t.Ui.newChangeBuffer({trackRemovals:!0});return function(a,c,d,f){const g=d.batch,v=g.keys();let b=Le.resolve();return v.forEach(x=>{b=b.next(()=>f.getEntry(c,x)).next(C=>{const I=d.docVersions.get(x);Yn(null!==I),C.version.compareTo(I)<0&&(g.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),f.addEntry(C)))})}),b.next(()=>a.mutationQueue.removeMutationBatch(c,g))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,r,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(a){let c=ei();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,r))})}function Jb(i){const e=an(i);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Vs.getLastRemoteSnapshotVersion(t))}function GT(i,e){const t=an(i),n=e.snapshotVersion;let r=t.$i;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.Ui.newChangeBuffer({trackRemovals:!0});r=t.$i;const c=[];e.targetChanges.forEach((g,v)=>{const b=r.get(v);if(!b)return;c.push(t.Vs.removeMatchingKeys(s,g.removedDocuments,v).next(()=>t.Vs.addMatchingKeys(s,g.addedDocuments,v)));let x=b.withSequenceNumber(s.currentSequenceNumber);var C,I,D;e.targetMismatches.has(v)?x=x.withResumeToken(Ws.EMPTY_BYTE_STRING,Wn.min()).withLastLimboFreeSnapshotVersion(Wn.min()):g.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(g.resumeToken,n)),r=r.insert(v,x),I=x,D=g,(0===(C=b).resumeToken.approximateByteSize()||I.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8||D.addedDocuments.size+D.modifiedDocuments.size+D.removedDocuments.size>0)&&c.push(t.Vs.updateTargetData(s,x))});let d=pr(),f=ei();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,g))}),c.push(Qb(s,a,e.documentUpdates).next(g=>{d=g.Gi,f=g.Qi})),!n.isEqual(Wn.min())){const g=t.Vs.getLastRemoteSnapshotVersion(s).next(v=>t.Vs.setTargetsMetadata(s,s.currentSequenceNumber,n));c.push(g)}return Le.waitFor(c).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,d,f)).next(()=>d)}).then(s=>(t.$i=r,s))}function Qb(i,e,t){let n=ei(),r=ei();return t.forEach(s=>n=n.add(s)),e.getEntries(i,n).next(s=>{let a=pr();return t.forEach((c,d)=>{const f=s.get(c);d.isFoundDocument()!==f.isFoundDocument()&&(r=r.add(c)),d.isNoDocument()&&d.version.isEqual(Wn.min())?(e.removeEntry(c,d.readTime),a=a.insert(c,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||0===d.version.compareTo(f.version)&&f.hasPendingWrites?(e.addEntry(d),a=a.insert(c,d)):Dt("LocalStore","Ignoring outdated watch update for ",c,". Current version:",f.version," Watch version:",d.version)}),{Gi:a,Qi:r}})}function jT(i,e){const t=an(i);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function bf(i,e){const t=an(i);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let r;return t.Vs.getTargetData(n,e).next(s=>s?(r=s,Le.resolve(r)):t.Vs.allocateTargetId(n).next(a=>(r=new oh(e,a,0,n.currentSequenceNumber),t.Vs.addTargetData(n,r).next(()=>r))))}).then(n=>{const r=t.$i.get(n.targetId);return(null===r||n.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.$i=t.$i.insert(n.targetId,n),t.Bi.set(e,n.targetId)),n})}function xf(i,e,t){return Fv.apply(this,arguments)}function Fv(){return Fv=(0,Ke.Z)(function*(i,e,t){const n=an(i),r=n.$i.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,r)))}catch(a){if(!zc(a))throw a;Dt("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.$i=n.$i.remove(e),n.Bi.delete(r.target)}),Fv.apply(this,arguments)}function Cu(i,e,t){const n=an(i);let r=Wn.min(),s=ei();return n.persistence.runTransaction("Execute query","readonly",a=>function(c,d,f){const g=an(c),v=g.Bi.get(f);return void 0!==v?Le.resolve(g.$i.get(v)):g.Vs.getTargetData(d,f)}(n,a,_s(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,n.Vs.getMatchingKeysForTargetId(a,c.targetId).next(d=>{s=d})}).next(()=>n.Fi.getDocumentsMatchingQuery(a,e,t?r:Wn.min(),t?s:ei())).next(c=>(Ef(n,XS(e),c),{documents:c,ji:s})))}function WT(i,e){const t=an(i),n=an(t.Vs),r=t.$i.get(e);return r?Promise.resolve(r.target):t.persistence.runTransaction("Get target data","readonly",s=>n.te(s,e).next(a=>a?a.target:null))}function $T(i,e){const t=an(i),n=t.Li.get(e)||Wn.min();return t.persistence.runTransaction("Get new document changes","readonly",r=>t.Ui.getAllFromCollectionGroup(r,e,HS(n,-1),Number.MAX_SAFE_INTEGER)).then(r=>(Ef(t,e,r),r))}function Ef(i,e,t){let n=Wn.min();t.forEach((r,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),i.Li.set(e,n)}function ry(){return ry=(0,Ke.Z)(function*(i,e,t,n){const r=an(i);let s=ei(),a=pr();for(const f of t){const g=e.Wi(f.metadata.name);f.document&&(s=s.add(g));const v=e.zi(f);v.setReadTime(e.Hi(f.metadata.readTime)),a=a.insert(g,v)}const c=r.Ui.newChangeBuffer({trackRemovals:!0}),d=yield bf(r,(f=n,_s(kp(Ni.fromString(`__bundle__/docs/${f}`)))));var f;return r.persistence.runTransaction("Apply bundle documents","readwrite",f=>Qb(f,c,a).next(g=>(c.apply(f),g)).next(g=>r.Vs.removeMatchingKeysForTargetId(f,d.targetId).next(()=>r.Vs.addMatchingKeys(f,s,d.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(f,g.Gi,g.Qi)).next(()=>g.Gi)))}),ry.apply(this,arguments)}function mN(i,e){return Vv.apply(this,arguments)}function Vv(){return Vv=(0,Ke.Z)(function*(i,e,t=ei()){const n=yield bf(i,_s(Tv(e.bundledQuery))),r=an(i);return r.persistence.runTransaction("Save named query","readwrite",s=>{const a=lo(e.readTime);if(n.snapshotVersion.compareTo(a)>=0)return r.Ds.saveNamedQuery(s,e);const c=n.withResumeToken(Ws.EMPTY_BYTE_STRING,a);return r.$i=r.$i.insert(c.targetId,c),r.Vs.updateTargetData(s,c).next(()=>r.Vs.removeMatchingKeysForTargetId(s,n.targetId)).next(()=>r.Vs.addMatchingKeys(s,t,n.targetId)).next(()=>r.Ds.saveNamedQuery(s,e))})}),Vv.apply(this,arguments)}function ex(i,e){return`firestore_clients_${i}_${e}`}function nD(i,e,t){let n=`firestore_mutations_${i}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}function Un(i,e){return`firestore_targets_${i}_${e}`}class Uv{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Ji(e,t,n){const r=JSON.parse(n);let s,a="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(s=new bt(r.error.code,r.error.message))),a?new Uv(e,t,r.state,s):(js("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class sy{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Ji(e,t){const n=JSON.parse(t);let r,s="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&(s="string"==typeof n.error.message&&"string"==typeof n.error.code,s&&(r=new bt(n.error.code,n.error.message))),s?new sy(e,n.state,r):(js("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Bv{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ji(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,s=ad();for(let a=0;r&&a<n.activeTargetIds.length;++a)r=Gc(n.activeTargetIds[a]),s=s.add(n.activeTargetIds[a]);return r?new Bv(e,s):(js("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Xp{constructor(e,t){this.clientId=e,this.onlineState=t}static Ji(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Xp(t.clientId,t.onlineState):(js("SharedClientState",`Failed to parse online state: ${e}`),null)}}class tx{constructor(){this.activeTargetIds=ad()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Jp{constructor(e,t,n,r,s){this.window=e,this.js=t,this.persistenceKey=n,this.tr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new gs(Kn),this.started=!1,this.ir=[];const a=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.rr=ex(this.persistenceKey,this.tr),this.ur=`firestore_sequence_number_${this.persistenceKey}`,this.sr=this.sr.insert(this.tr,new tx),this.cr=new RegExp(`^firestore_clients_${a}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${a}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${a}_(\\d+)$`),this.lr=`firestore_online_state_${this.persistenceKey}`,this.dr=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Ke.Z)(function*(){const t=yield e.syncEngine.Ri();for(const r of t){if(r===e.tr)continue;const s=e.getItem(ex(e.persistenceKey,r));if(s){const a=Bv.Ji(r,s);a&&(e.sr=e.sr.insert(a.clientId,a))}}e._r();const n=e.storage.getItem(e.lr);if(n){const r=e.wr(n);r&&e.mr(r)}for(const r of e.ir)e.nr(r);e.ir=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let t=!1;return this.sr.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,t,n){this.yr(e,t,n),this.pr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(Un(this.persistenceKey,e));if(n){const r=sy.Ji(e,n);r&&(t=r.state)}}return this.Ir.Xi(e),this._r(),t}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Un(this.persistenceKey,e))}updateQueryState(e,t,n){this.Tr(e,t,n)}handleUserChange(e,t,n){t.forEach(r=>{this.pr(r)}),this.currentUser=e,n.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Dt("SharedClientState","READ",e,t),t}setItem(e,t){Dt("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Dt("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){var t=this;const n=e;if(n.storageArea===this.storage){if(Dt("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void js("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable((0,Ke.Z)(function*(){if(t.started){if(null!==n.key)if(t.cr.test(n.key)){if(null==n.newValue){const r=t.Rr(n.key);return t.br(r,null)}{const r=t.Pr(n.key,n.newValue);if(r)return t.br(r.clientId,r)}}else if(t.ar.test(n.key)){if(null!==n.newValue){const r=t.vr(n.key,n.newValue);if(r)return t.Vr(r)}}else if(t.hr.test(n.key)){if(null!==n.newValue){const r=t.Sr(n.key,n.newValue);if(r)return t.Dr(r)}}else if(n.key===t.lr){if(null!==n.newValue){const r=t.wr(n.newValue);if(r)return t.mr(r)}}else if(n.key===t.ur){const r=function(s){let a=Ea.ot;if(null!=s)try{const c=JSON.parse(s);Yn("number"==typeof c),a=c}catch(c){js("SharedClientState","Failed to read sequence number from WebStorage",c)}return a}(n.newValue);r!==Ea.ot&&t.sequenceNumberHandler(r)}else if(n.key===t.dr){const r=t.Cr(n.newValue);yield Promise.all(r.map(s=>t.syncEngine.Nr(s)))}}else t.ir.push(n)}))}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,t,n){const r=new Uv(this.currentUser,e,t,n),s=nD(this.persistenceKey,this.currentUser,e);this.setItem(s,r.Yi())}pr(e){const t=nD(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Er(e){this.storage.setItem(this.lr,JSON.stringify({clientId:this.tr,onlineState:e}))}Tr(e,t,n){const r=Un(this.persistenceKey,e),s=new sy(e,t,n);this.setItem(r,s.Yi())}Ar(e){const t=JSON.stringify(Array.from(e));this.setItem(this.dr,t)}Rr(e){const t=this.cr.exec(e);return t?t[1]:null}Pr(e,t){const n=this.Rr(e);return Bv.Ji(n,t)}vr(e,t){const n=this.ar.exec(e),r=Number(n[1]);return Uv.Ji(new Ns(void 0!==n[2]?n[2]:null),r,t)}Sr(e,t){const n=this.hr.exec(e),r=Number(n[1]);return sy.Ji(r,t)}wr(e){return Xp.Ji(e)}Cr(e){return JSON.parse(e)}Vr(e){var t=this;return(0,Ke.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.kr(e.batchId,e.state,e.error);Dt("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,t){const n=t?this.sr.insert(e,t):this.sr.remove(e),r=this.gr(this.sr),s=this.gr(n),a=[],c=[];return s.forEach(d=>{r.has(d)||a.push(d)}),r.forEach(d=>{s.has(d)||c.push(d)}),this.syncEngine.Mr(a,c).then(()=>{this.sr=n})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let t=ad();return e.forEach((n,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class oy{constructor(){this.Fr=new tx,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,t,n){this.$r[e]=t}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new tx,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class vs{Br(e){}shutdown(){}}class iD{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){Dt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){Dt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const qT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class rD{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}class sD extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.so=(e.ssl?"https":"http")+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,t,n,r,s){const a=this.oo(e,t);Dt("RestConnection","Sending: ",a,n);const c={};return this.uo(c,r,s),this.co(e,a,c,n).then(d=>(Dt("RestConnection","Received: ",d),d),d=>{throw Ig("RestConnection",`${e} failed with error: `,d,"url: ",a,"request:",n),d})}ao(e,t,n,r,s){return this.ro(e,t,n,r,s)}uo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+qd,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((r,s)=>e[s]=r),n&&n.headers.forEach((r,s)=>e[s]=r)}oo(e,t){return`${this.so}/v1/${t}:${qT[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,t,n,r){return new Promise((s,a)=>{const c=new tN;c.listenOnce($w.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Hc.NO_ERROR:const f=c.getResponseJson();Dt("Connection","XHR received:",JSON.stringify(f)),s(f);break;case Hc.TIMEOUT:Dt("Connection",'RPC "'+e+'" timed out'),a(new bt(He.DEADLINE_EXCEEDED,"Request time out"));break;case Hc.HTTP_ERROR:const g=c.getStatus();if(Dt("Connection",'RPC "'+e+'" failed with status:',g,"response text:",c.getResponseText()),g>0){const v=c.getResponseJson().error;if(v&&v.status&&v.message){const b=function(x){const C=x.toLowerCase().replace(/_/g,"-");return Object.values(He).indexOf(C)>=0?C:He.UNKNOWN}(v.status);a(new bt(b,v.message))}else a(new bt(He.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new bt(He.UNAVAILABLE,"Connection failed."));break;default:gn()}}finally{Dt("Connection",'RPC "'+e+'" completed.')}});const d=JSON.stringify(r);c.send(t,"POST",d,n,15)})}ho(e,t,n){const r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=aI(),a=Ww(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(c.xmlHttpFactory=new eN({})),this.uo(c.initMessageHeaders,t,n),(0,fi.uI)()||(0,fi.b$)()||(0,fi.d)()||(0,fi.w1)()||(0,fi.Mn)()||(0,fi.ru)()||(c.httpHeadersOverwriteParam="$httpHeaders");const d=r.join("");Dt("Connection","Creating WebChannel: "+d,c);const f=s.createWebChannel(d,c);let g=!1,v=!1;const b=new rD({jr:C=>{v?Dt("Connection","Not sending because WebChannel is closed:",C):(g||(Dt("Connection","Opening WebChannel transport."),f.open(),g=!0),Dt("Connection","WebChannel sending:",C),f.send(C))},Wr:()=>f.close()}),x=(C,I,D)=>{C.listen(I,L=>{try{D(L)}catch(V){setTimeout(()=>{throw V},0)}})};return x(f,Mg.EventType.OPEN,()=>{v||Dt("Connection","WebChannel transport opened.")}),x(f,Mg.EventType.CLOSE,()=>{v||(v=!0,Dt("Connection","WebChannel transport closed"),b.eo())}),x(f,Mg.EventType.ERROR,C=>{v||(v=!0,Ig("Connection","WebChannel transport errored:",C),b.eo(new bt(He.UNAVAILABLE,"The operation could not be completed")))}),x(f,Mg.EventType.MESSAGE,C=>{var I;if(!v){const D=C.data[0];Yn(!!D);const L=D,V=L.error||(null===(I=L[0])||void 0===I?void 0:I.error);if(V){Dt("Connection","WebChannel received error:",V);const z=V.status;let U=function(Z){const ae=Zr[Z];if(void 0!==ae)return hv(ae)}(z),$=V.message;void 0===U&&(U=He.INTERNAL,$="Unknown error status: "+z+" with message "+V.message),v=!0,b.eo(new bt(U,$)),f.close()}else Dt("Connection","WebChannel received:",D),b.no(D)}}),x(a,US.STAT_EVENT,C=>{C.stat===Z_.PROXY?Dt("Connection","Detected buffering proxy"):C.stat===Z_.NOPROXY&&Dt("Connection","Detected no buffering proxy")}),setTimeout(()=>{b.Zr()},0),b}}function nx(){return"undefined"!=typeof window?window:null}function ay(){return"undefined"!=typeof document?document:null}function Qp(i){return new RI(i,!0)}class Hv{constructor(e,t,n=1e3,r=1.5,s=6e4){this.js=e,this.timerId=t,this.lo=n,this.fo=r,this._o=s,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const t=Math.floor(this.wo+this.To()),n=Math.max(0,Date.now()-this.yo),r=Math.max(0,t-n);r>0&&Dt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.wo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,r,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class KT{constructor(e,t,n,r,s,a,c,d){this.js=e,this.Ao=n,this.Ro=r,this.bo=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Hv(e,t)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}stop(){var e=this;return(0,Ke.Z)(function*(){e.Do()&&(yield e.close(0))})()}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}Oo(){var e=this;return(0,Ke.Z)(function*(){if(e.Co())return e.close(0)})()}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}close(e,t){var n=this;return(0,Ke.Z)(function*(){n.Fo(),n.$o(),n.So.cancel(),n.Po++,4!==e?n.So.reset():t&&t.code===He.RESOURCE_EXHAUSTED?(js(t.toString()),js("Using maximum backoff delay to prevent overloading the backend."),n.So.po()):t&&t.code===He.UNAUTHENTICATED&&3!==n.state&&(n.authCredentialsProvider.invalidateToken(),n.appCheckCredentialsProvider.invalidateToken()),null!==n.stream&&(n.Bo(),n.stream.close(),n.stream=null),n.state=e,yield n.listener.Jr(t)})()}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),t=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,r])=>{this.Po===t&&this.Uo(n,r)},n=>{e(()=>{const r=new bt(He.UNKNOWN,"Fetching auth token failed: "+n.message);return this.qo(r)})})}Uo(e,t){const n=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr(()=>{n(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(r=>{n(()=>this.qo(r))}),this.stream.onMessage(r=>{n(()=>this.onMessage(r))})}xo(){var e=this;this.state=5,this.So.Io((0,Ke.Z)(function*(){e.state=0,e.start()}))}qo(e){return Dt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return t=>{this.js.enqueueAndForget(()=>this.Po===e?t():(Dt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class oD extends KT{constructor(e,t,n,r,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,a),this.wt=s}Ko(e,t){return this.bo.ho("Listen",e,t)}onMessage(e){this.So.reset();const t=function OI(i,e){let t;if("targetChange"in e){const n="NO_CHANGE"===(d=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===d?1:"REMOVE"===d?2:"CURRENT"===d?3:"RESET"===d?4:gn(),r=e.targetChange.targetIds||[],s=function(d,f){return d.dt?(Yn(void 0===f||"string"==typeof f),Ws.fromBase64String(f||"")):(Yn(void 0===f||f instanceof Uint8Array),Ws.fromUint8Array(f||new Uint8Array))}(i,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){const f=void 0===d.code?He.UNKNOWN:hv(d.code);return new bt(f,d.message||"")}(a);t=new yb(n,r,s,c||null)}else if("documentChange"in e){const n=e.documentChange,r=Su(i,n.document.name),s=lo(n.document.updateTime),a=new jo({mapValue:{fields:n.document.fields}}),c=Sr.newFoundDocument(r,s,a);t=new Wg(n.targetIds||[],n.removedTargetIds||[],c.key,c)}else if("documentDelete"in e){const n=e.documentDelete,r=Su(i,n.document),s=n.readTime?lo(n.readTime):Wn.min(),a=Sr.newNoDocument(r,s);t=new Wg([],n.removedTargetIds||[],a.key,a)}else if("documentRemove"in e){const n=e.documentRemove,r=Su(i,n.document);t=new Wg([],n.removedTargetIds||[],r,null)}else{if(!("filter"in e))return gn();{const n=e.filter,s=new DI(n.count||0);t=new gb(n.targetId,s)}}var d;return t}(this.wt,e),n=function(r){if(!("targetChange"in r))return Wn.min();const s=r.targetChange;return s.targetIds&&s.targetIds.length?Wn.min():s.readTime?lo(s.readTime):Wn.min()}(e);return this.listener.Go(t,n)}Qo(e){const t={};t.database=$g(this.wt),t.addTarget=function(r,s){let a;const c=s.target;return a=iv(c)?{documents:gT(r,c)}:{query:Eb(r,c)},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0?a.resumeToken=dT(r,s.resumeToken):s.snapshotVersion.compareTo(Wn.min())>0&&(a.readTime=jp(r,s.snapshotVersion.toTimestamp())),a}(this.wt,e);const n=function kI(i,e){const t=function(n,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return gn()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);n&&(t.labels=n),this.Mo(t)}jo(e){const t={};t.database=$g(this.wt),t.removeTarget=e,this.Mo(t)}}class aD extends KT{constructor(e,t,n,r,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.wt=s,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,t){return this.bo.ho("Write",e,t)}onMessage(e){if(Yn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const t=function uN(i,e){return i&&i.length>0?(Yn(void 0!==e),i.map(t=>function(n,r){let s=lo(n.updateTime?n.updateTime:r);return s.isEqual(Wn.min())&&(s=lo(r)),new nT(s,n.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),n=lo(e.commitTime);return this.listener.Jo(n,t)}return Yn(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=$g(this.wt),this.Mo(e)}Ho(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>mv(this.wt,n))};this.Mo(t)}}class ly extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.bo=n,this.wt=r,this.Zo=!1}tu(){if(this.Zo)throw new bt(He.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,t,n){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.bo.ro(e,t,n,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===He.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new bt(He.UNKNOWN,r.toString())})}ao(e,t,n){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,s])=>this.bo.ao(e,t,n,r,s)).catch(r=>{throw"FirebaseError"===r.name?(r.code===He.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new bt(He.UNKNOWN,r.toString())})}terminate(){this.Zo=!0}}class lD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(js(t),this.su=!1):Dt("OnlineStateTracker",t)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class cD{constructor(e,t,n,r,s){var a=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=s,this.du.Br(c=>{n.enqueueAndForget((0,Ke.Z)(function*(){var d;ch(a)&&(Dt("RemoteStore","Restarting streams for network reachability change."),yield(d=(0,Ke.Z)(function*(f){const g=an(f);g.lu.add(4),yield Sf(g),g._u.set("Unknown"),g.lu.delete(4),yield cy(g)}),function(f){return d.apply(this,arguments)})(a))}))}),this._u=new lD(n,r)}}function cy(i){return em.apply(this,arguments)}function em(){return em=(0,Ke.Z)(function*(i){if(ch(i))for(const e of i.fu)yield e(!0)}),em.apply(this,arguments)}function Sf(i){return zv.apply(this,arguments)}function zv(){return zv=(0,Ke.Z)(function*(i){for(const e of i.fu)yield e(!1)}),zv.apply(this,arguments)}function uy(i,e){const t=an(i);t.hu.has(e.targetId)||(t.hu.set(e.targetId,e),rx(t)?ix(t):nm(t).Co()&&Tf(t,e))}function dy(i,e){const t=an(i),n=nm(t);t.hu.delete(e),n.Co()&&tm(t,e),0===t.hu.size&&(n.Co()?n.ko():ch(t)&&t._u.set("Unknown"))}function Tf(i,e){i.wu.Nt(e.targetId),nm(i).Qo(e)}function tm(i,e){i.wu.Nt(e),nm(i).jo(e)}function ix(i){i.wu=new lT({getRemoteKeysForTarget:e=>i.remoteSyncer.getRemoteKeysForTarget(e),te:e=>i.hu.get(e)||null}),nm(i).start(),i._u.iu()}function rx(i){return ch(i)&&!nm(i).Do()&&i.hu.size>0}function ch(i){return 0===an(i).lu.size}function sx(i){i.wu=void 0}function ZT(i){return Gv.apply(this,arguments)}function Gv(){return Gv=(0,Ke.Z)(function*(i){i.hu.forEach((e,t)=>{Tf(i,e)})}),Gv.apply(this,arguments)}function uD(i,e){return jv.apply(this,arguments)}function jv(){return jv=(0,Ke.Z)(function*(i,e){sx(i),rx(i)?(i._u.uu(e),ix(i)):i._u.set("Unknown")}),jv.apply(this,arguments)}function dD(i,e,t){return ox.apply(this,arguments)}function ox(){return ox=(0,Ke.Z)(function*(i,e,t){if(i._u.set("Online"),e instanceof yb&&2===e.state&&e.cause)try{yield(n=(0,Ke.Z)(function*(r,s){const a=s.cause;for(const c of s.targetIds)r.hu.has(c)&&(yield r.remoteSyncer.rejectListen(c,a),r.hu.delete(c),r.wu.removeTarget(c))}),function(r,s){return n.apply(this,arguments)})(i,e)}catch(n){Dt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),yield ax(i,n)}else if(e instanceof Wg?i.wu.Ut(e):e instanceof gb?i.wu.zt(e):i.wu.Gt(e),!t.isEqual(Wn.min()))try{const n=yield Jb(i.localStore);t.compareTo(n)>=0&&(yield function(r,s){const a=r.wu.Yt(s);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const f=r.hu.get(d);f&&r.hu.set(d,f.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach(c=>{const d=r.hu.get(c);if(!d)return;r.hu.set(c,d.withResumeToken(Ws.EMPTY_BYTE_STRING,d.snapshotVersion)),tm(r,c);const f=new oh(d.target,c,1,d.sequenceNumber);Tf(r,f)}),r.remoteSyncer.applyRemoteEvent(a)}(i,t))}catch(n){Dt("RemoteStore","Failed to raise snapshot:",n),yield ax(i,n)}var n}),ox.apply(this,arguments)}function ax(i,e,t){return YT.apply(this,arguments)}function YT(){return YT=(0,Ke.Z)(function*(i,e,t){if(!zc(e))throw e;i.lu.add(1),yield Sf(i),i._u.set("Offline"),t||(t=()=>Jb(i.localStore)),i.asyncQueue.enqueueRetryable((0,Ke.Z)(function*(){Dt("RemoteStore","Retrying IndexedDB access"),yield t(),i.lu.delete(1),yield cy(i)}))}),YT.apply(this,arguments)}function hD(i,e){return e().catch(t=>ax(i,t,e))}function hy(i){return Wv.apply(this,arguments)}function Wv(){return Wv=(0,Ke.Z)(function*(i){const e=an(i),t=cd(e);let n=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;$v(e);)try{const r=yield jT(e.localStore,n);if(null===r){0===e.au.length&&t.ko();break}n=r.batchId,fD(e,r)}catch(r){yield ax(e,r)}XT(e)&&lx(e)}),Wv.apply(this,arguments)}function $v(i){return ch(i)&&i.au.length<10}function fD(i,e){i.au.push(e);const t=cd(i);t.Co()&&t.zo&&t.Ho(e.mutations)}function XT(i){return ch(i)&&!cd(i).Do()&&i.au.length>0}function lx(i){cd(i).start()}function fy(i){return cx.apply(this,arguments)}function cx(){return cx=(0,Ke.Z)(function*(i){cd(i).Xo()}),cx.apply(this,arguments)}function pD(i){return ux.apply(this,arguments)}function ux(){return ux=(0,Ke.Z)(function*(i){const e=cd(i);for(const t of i.au)e.Ho(t.mutations)}),ux.apply(this,arguments)}function mD(i,e,t){return dx.apply(this,arguments)}function dx(){return dx=(0,Ke.Z)(function*(i,e,t){const n=i.au.shift(),r=Zg.from(n,e,t);yield hD(i,()=>i.remoteSyncer.applySuccessfulWrite(r)),yield hy(i)}),dx.apply(this,arguments)}function JT(i,e){return hx.apply(this,arguments)}function hx(){return hx=(0,Ke.Z)(function*(i,e){var t;e&&cd(i).zo&&(yield(t=(0,Ke.Z)(function*(n,r){if(aT(s=r.code)&&s!==He.ABORTED){const a=n.au.shift();cd(n).No(),yield hD(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,r)),yield hy(n)}var s}),function(n,r){return t.apply(this,arguments)})(i,e)),XT(i)&&lx(i)}),hx.apply(this,arguments)}function QT(i,e){return uh.apply(this,arguments)}function uh(){return uh=(0,Ke.Z)(function*(i,e){const t=an(i);t.asyncQueue.verifyOperationInProgress(),Dt("RemoteStore","RemoteStore received new credentials");const n=ch(t);t.lu.add(3),yield Sf(t),n&&t._u.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.lu.delete(3),yield cy(t)}),uh.apply(this,arguments)}function fx(i,e){return qv.apply(this,arguments)}function qv(){return qv=(0,Ke.Z)(function*(i,e){const t=an(i);e?(t.lu.delete(2),yield cy(t)):e||(t.lu.add(2),yield Sf(t),t._u.set("Unknown"))}),qv.apply(this,arguments)}function nm(i){return i.mu||(i.mu=function(e,t,n){const r=an(e);return r.tu(),new oD(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(i.datastore,i.asyncQueue,{zr:ZT.bind(null,i),Jr:uD.bind(null,i),Go:dD.bind(null,i)}),i.fu.push(function(){var e=(0,Ke.Z)(function*(t){t?(i.mu.No(),rx(i)?ix(i):i._u.set("Unknown")):(yield i.mu.stop(),sx(i))});return function(t){return e.apply(this,arguments)}}())),i.mu}function cd(i){return i.gu||(i.gu=function(e,t,n){const r=an(e);return r.tu(),new aD(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(i.datastore,i.asyncQueue,{zr:fy.bind(null,i),Jr:JT.bind(null,i),Yo:pD.bind(null,i),Jo:mD.bind(null,i)}),i.fu.push(function(){var e=(0,Ke.Z)(function*(t){t?(i.gu.No(),yield hy(i)):(yield i.gu.stop(),i.au.length>0&&(Dt("RemoteStore",`Stopping write stream with ${i.au.length} pending writes`),i.au=[]))});return function(t){return e.apply(this,arguments)}}())),i.gu}class px{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new To,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}static createAndSchedule(e,t,n,r,s){const a=Date.now()+n,c=new px(e,t,a,r,s);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new bt(He.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mf(i,e){if(js("AsyncQueue",`${e}: ${i}`),zc(i))return new bt(He.UNAVAILABLE,`${e}: ${i}`);throw i}class im{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Kt.comparator(t.key,n.key):(t,n)=>Kt.comparator(t.key,n.key),this.keyedMap=sh(),this.sortedSet=new gs(this.comparator)}static emptySet(e){return new im(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof im)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,s=n.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new im;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Kv{constructor(){this.yu=new gs(Kt.comparator)}track(e){const t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):gn():this.yu=this.yu.insert(t,e)}pu(){const e=[];return this.yu.inorderTraversal((t,n)=>{e.push(n)}),e}}class rm{constructor(e,t,n,r,s,a,c,d){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=d}static fromInitialDocuments(e,t,n,r){const s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new rm(e,t,im.emptySet(t),s,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Up(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class eM{constructor(){this.Iu=void 0,this.listeners=[]}}class tM{constructor(){this.queries=new Wo(e=>cb(e),Up),this.onlineState="Unknown",this.Tu=new Set}}function mx(i,e){return gx.apply(this,arguments)}function gx(){return gx=(0,Ke.Z)(function*(i,e){const t=an(i),n=e.query;let r=!1,s=t.queries.get(n);if(s||(r=!0,s=new eM),r)try{s.Iu=yield t.onListen(n)}catch(a){const c=Mf(a,`Initialization of query '${lv(e.query)}' failed`);return void e.onError(c)}t.queries.set(n,s),s.listeners.push(e),e.Eu(t.onlineState),s.Iu&&e.Au(s.Iu)&&_x(t)}),gx.apply(this,arguments)}function yx(i,e){return py.apply(this,arguments)}function py(){return py=(0,Ke.Z)(function*(i,e){const t=an(i),n=e.query;let r=!1;const s=t.queries.get(n);if(s){const a=s.listeners.indexOf(e);a>=0&&(s.listeners.splice(a,1),r=0===s.listeners.length)}if(r)return t.queries.delete(n),t.onUnlisten(n)}),py.apply(this,arguments)}function gD(i,e){const t=an(i);let n=!1;for(const r of e){const a=t.queries.get(r.query);if(a){for(const c of a.listeners)c.Au(r)&&(n=!0);a.Iu=r}}n&&_x(t)}function nM(i,e,t){const n=an(i),r=n.queries.get(e);if(r)for(const s of r.listeners)s.onError(t);n.queries.delete(e)}function _x(i){i.Tu.forEach(e=>{e.next()})}class vx{constructor(e,t,n){this.query=e,this.Ru=t,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=n||{}}Au(e){if(!this.options.includeMetadataChanges){const n=[];for(const r of e.docChanges)3!==r.type&&n.push(r);e=new rm(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),t=!0):this.Vu(e,this.onlineState)&&(this.Su(e),t=!0),this.Pu=e,t}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}Vu(e,t){return!e.fromCache||!(this.options.Du&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}vu(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}Su(e){e=rm.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}class yD{constructor(e,t){this.payload=e,this.byteLength=t}Cu(){return"metadata"in this.payload}}class iM{constructor(e){this.wt=e}Wi(e){return Su(this.wt,e)}zi(e){return e.metadata.exists?pv(this.wt,e.document,!1):Sr.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return lo(e)}}class _D{constructor(e,t,n){this.xu=e,this.localStore=t,this.wt=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=rM(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t;const n=Ni.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ku(e){const t=new Map,n=new iM(this.wt);for(const r of e)if(r.metadata.queries){const s=n.Wi(r.metadata.name);for(const a of r.metadata.queries){const c=(t.get(a)||ei()).add(s);t.set(a,c)}}return t}complete(){var e=this;return(0,Ke.Z)(function*(){const t=yield function pN(i,e,t,n){return ry.apply(this,arguments)}(e.localStore,new iM(e.wt),e.documents,e.xu.id),n=e.ku(e.documents);for(const r of e.queries)yield mN(e.localStore,r,n.get(r.name));return e.progress.taskState="Success",{progress:e.progress,Ou:e.collectionGroups,Mu:t}})()}}function rM(i){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}}class sM{constructor(e){this.key=e}}class oM{constructor(e){this.key=e}}class wx{constructor(e,t){this.query=e,this.Fu=t,this.$u=null,this.current=!1,this.Bu=ei(),this.mutatedKeys=ei(),this.Lu=JS(e),this.Uu=new im(this.Lu)}get qu(){return this.Fu}Ku(e,t){const n=t?t.Gu:new Kv,r=t?t.Uu:this.Uu;let s=t?t.mutatedKeys:this.mutatedKeys,a=r,c=!1;const d="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,f="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((g,v)=>{const b=r.get(g),x=cv(this.query,v)?v:null,C=!!b&&this.mutatedKeys.has(b.key),I=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let D=!1;b&&x?b.data.isEqual(x.data)?C!==I&&(n.track({type:3,doc:x}),D=!0):this.Qu(b,x)||(n.track({type:2,doc:x}),D=!0,(d&&this.Lu(x,d)>0||f&&this.Lu(x,f)<0)&&(c=!0)):!b&&x?(n.track({type:0,doc:x}),D=!0):b&&!x&&(n.track({type:1,doc:b}),D=!0,(d||f)&&(c=!0)),D&&(x?(a=a.add(x),s=I?s.add(g):s.delete(g)):(a=a.delete(g),s=s.delete(g)))}),null!==this.query.limit)for(;a.size>this.query.limit;){const g="F"===this.query.limitType?a.last():a.first();a=a.delete(g.key),s=s.delete(g.key),n.track({type:1,doc:g})}return{Uu:a,Gu:n,Oi:c,mutatedKeys:s}}Qu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const s=e.Gu.pu();s.sort((f,g)=>function(v,b){const x=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return gn()}};return x(v)-x(b)}(f.type,g.type)||this.Lu(f.doc,g.doc)),this.ju(n);const a=t?this.Wu():[],c=0===this.Bu.size&&this.current?1:0,d=c!==this.$u;return this.$u=c,0!==s.length||d?{snapshot:new rm(this.query,e.Uu,r,s,e.mutatedKeys,0===c,d,!1),zu:a}:{zu:a}}Eu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new Kv,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(t=>this.Fu=this.Fu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Fu=this.Fu.delete(t)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=ei(),this.Uu.forEach(n=>{this.Hu(n.key)&&(this.Bu=this.Bu.add(n.key))});const t=[];return e.forEach(n=>{this.Bu.has(n)||t.push(new oM(n))}),this.Bu.forEach(n=>{e.has(n)||t.push(new sM(n))}),t}Ju(e){this.Fu=e.ji,this.Bu=ei();const t=this.Ku(e.documents);return this.applyChanges(t,!0)}Yu(){return rm.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class aM{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class vD{constructor(e){this.key=e,this.Xu=!1}}class wD{constructor(e,t,n,r,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Zu={},this.tc=new Wo(c=>cb(c),Up),this.ec=new Map,this.nc=new Set,this.sc=new gs(Kt.comparator),this.ic=new Map,this.rc=new Nv,this.oc={},this.uc=new Map,this.cc=wf.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}function lM(i,e){return bx.apply(this,arguments)}function bx(){return bx=(0,Ke.Z)(function*(i,e){const t=dh(i);let n,r;const s=t.tc.get(e);if(s)n=s.targetId,t.sharedClientState.addLocalQueryTarget(n),r=s.view.Yu();else{const a=yield bf(t.localStore,_s(e));t.isPrimaryClient&&uy(t.remoteStore,a);const c=t.sharedClientState.addLocalQueryTarget(a.targetId);n=a.targetId,r=yield xx(t,e,n,"current"===c)}return r}),bx.apply(this,arguments)}function xx(i,e,t,n){return Ex.apply(this,arguments)}function Ex(){return Ex=(0,Ke.Z)(function*(i,e,t,n){i.hc=(g,v,b)=>{return(x=(0,Ke.Z)(function*(C,I,D,L){let V=I.view.Ku(D);V.Oi&&(V=yield Cu(C.localStore,I.query,!1).then(({documents:$})=>I.view.Ku($,V)));const z=L&&L.targetChanges.get(I.targetId),U=I.view.applyChanges(V,C.isPrimaryClient,z);return Ax(C,I.targetId,U.zu),U.snapshot}),function(C,I,D,L){return x.apply(this,arguments)})(i,g,v,b);var x};const r=yield Cu(i.localStore,e,!0),s=new wx(e,r.ji),a=s.Ku(r.documents),c=Eu.createSynthesizedTargetChangeForCurrentChange(t,n&&"Offline"!==i.onlineState),d=s.applyChanges(a,i.isPrimaryClient,c);Ax(i,t,d.zu);const f=new aM(e,t,s);return i.tc.set(e,f),i.ec.has(t)?i.ec.get(t).push(e):i.ec.set(t,[e]),d.snapshot}),Ex.apply(this,arguments)}function Sx(i,e){return my.apply(this,arguments)}function my(){return my=(0,Ke.Z)(function*(i,e){const t=an(i),n=t.tc.get(e),r=t.ec.get(n.targetId);if(r.length>1)return t.ec.set(n.targetId,r.filter(s=>!Up(s,e))),void t.tc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(n.targetId),t.sharedClientState.isActiveQueryTarget(n.targetId)||(yield xf(t.localStore,n.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(n.targetId),dy(t.remoteStore,n.targetId),jc(t,n.targetId)}).catch(vl))):(jc(t,n.targetId),yield xf(t.localStore,n.targetId,!0))}),my.apply(this,arguments)}function gy(){return gy=(0,Ke.Z)(function*(i,e,t){const n=gM(i);try{const r=yield function(s,a){const c=an(s),d=Vr.now(),f=a.reduce((b,x)=>b.add(x.key),ei());let g,v;return c.persistence.runTransaction("Locally write mutations","readwrite",b=>{let x=pr(),C=ei();return c.Ui.getEntries(b,f).next(I=>{x=I,x.forEach((D,L)=>{L.isValidDocument()||(C=C.add(D))})}).next(()=>c.localDocuments.getOverlayedDocuments(b,x)).next(I=>{g=I;const D=[];for(const L of a){const V=mb(L,g.get(L.key).overlayedDocument);null!=V&&D.push(new sd(L.key,V,nb(V.value.mapValue),Kr.exists(!0)))}return c.mutationQueue.addMutationBatch(b,d,D,a)}).next(I=>{v=I;const D=I.applyToLocalDocumentSet(g,C);return c.documentOverlayCache.saveOverlays(b,I.batchId,D)})}).then(()=>({batchId:v.batchId,changes:xl(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(r.batchId),function(s,a,c){let d=s.oc[s.currentUser.toKey()];d||(d=new gs(Kn)),d=d.insert(a,c),s.oc[s.currentUser.toKey()]=d}(n,r.batchId,t),yield ud(n,r.changes),yield hy(n.remoteStore)}catch(r){const s=Mf(r,"Failed to persist write");t.reject(s)}}),gy.apply(this,arguments)}function uM(i,e){return Tx.apply(this,arguments)}function Tx(){return Tx=(0,Ke.Z)(function*(i,e){const t=an(i);try{const n=yield GT(t.localStore,e);e.targetChanges.forEach((r,s)=>{const a=t.ic.get(s);a&&(Yn(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?a.Xu=!0:r.modifiedDocuments.size>0?Yn(a.Xu):r.removedDocuments.size>0&&(Yn(a.Xu),a.Xu=!1))}),yield ud(t,n,e)}catch(n){yield vl(n)}}),Tx.apply(this,arguments)}function Zv(i,e,t){const n=an(i);if(n.isPrimaryClient&&0===t||!n.isPrimaryClient&&1===t){const r=[];n.tc.forEach((s,a)=>{const c=a.view.Eu(e);c.snapshot&&r.push(c.snapshot)}),function(s,a){const c=an(s);c.onlineState=a;let d=!1;c.queries.forEach((f,g)=>{for(const v of g.listeners)v.Eu(a)&&(d=!0)}),d&&_x(c)}(n.eventManager,e),r.length&&n.Zu.Go(r),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function bD(i,e,t){return Yv.apply(this,arguments)}function Yv(){return Yv=(0,Ke.Z)(function*(i,e,t){const n=an(i);n.sharedClientState.updateQueryState(e,"rejected",t);const r=n.ic.get(e),s=r&&r.key;if(s){let a=new gs(Kt.comparator);a=a.insert(s,Sr.newNoDocument(s,Wn.min()));const c=ei().add(s),d=new xu(Wn.min(),new Map,new Er(Kn),a,c);yield uM(n,d),n.sc=n.sc.remove(s),n.ic.delete(e),Qv(n)}else yield xf(n.localStore,e,!1).then(()=>jc(n,e,t)).catch(vl)}),Yv.apply(this,arguments)}function xD(i,e){return Xv.apply(this,arguments)}function Xv(){return Xv=(0,Ke.Z)(function*(i,e){const t=an(i),n=e.batch.batchId;try{const r=yield zT(t.localStore,e);Cx(t,n,null),sm(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),yield ud(t,r)}catch(r){yield vl(r)}}),Xv.apply(this,arguments)}function ED(i,e,t){return Jv.apply(this,arguments)}function Jv(){return Jv=(0,Ke.Z)(function*(i,e,t){const n=an(i);try{const r=yield function(s,a){const c=an(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return c.mutationQueue.lookupMutationBatch(d,a).next(g=>(Yn(null!==g),f=g.keys(),c.mutationQueue.removeMutationBatch(d,g))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,f,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>c.localDocuments.getDocuments(d,f))})}(n.localStore,e);Cx(n,e,t),sm(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),yield ud(n,r)}catch(r){yield vl(r)}}),Jv.apply(this,arguments)}function Mx(){return Mx=(0,Ke.Z)(function*(i,e){const t=an(i);ch(t.remoteStore)||Dt("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const n=yield function(s){const a=an(s);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(t.localStore);if(-1===n)return void e.resolve();const r=t.uc.get(n)||[];r.push(e),t.uc.set(n,r)}catch(n){const r=Mf(n,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}),Mx.apply(this,arguments)}function sm(i,e){(i.uc.get(e)||[]).forEach(t=>{t.resolve()}),i.uc.delete(e)}function Cx(i,e,t){const n=an(i);let r=n.oc[n.currentUser.toKey()];if(r){const s=r.get(e);s&&(t?s.reject(t):s.resolve(),r=r.remove(e)),n.oc[n.currentUser.toKey()]=r}}function jc(i,e,t=null){i.sharedClientState.removeLocalQueryTarget(e);for(const n of i.ec.get(e))i.tc.delete(n),t&&i.Zu.lc(n,t);i.ec.delete(e),i.isPrimaryClient&&i.rc.us(e).forEach(n=>{i.rc.containsKey(n)||om(i,n)})}function om(i,e){i.nc.delete(e.path.canonicalString());const t=i.sc.get(e);null!==t&&(dy(i.remoteStore,t),i.sc=i.sc.remove(e),i.ic.delete(t),Qv(i))}function Ax(i,e,t){for(const n of t)n instanceof sM?(i.rc.addReference(n.key,e),yN(i,n)):n instanceof oM?(Dt("SyncEngine","Document no longer in limbo: "+n.key),i.rc.removeReference(n.key,e),i.rc.containsKey(n.key)||om(i,n.key)):gn()}function yN(i,e){const t=e.key,n=t.path.canonicalString();i.sc.get(t)||i.nc.has(n)||(Dt("SyncEngine","New document in limbo: "+t),i.nc.add(n),Qv(i))}function Qv(i){for(;i.nc.size>0&&i.sc.size<i.maxConcurrentLimboResolutions;){const e=i.nc.values().next().value;i.nc.delete(e);const t=new Kt(Ni.fromString(e)),n=i.cc.next();i.ic.set(n,new vD(t)),i.sc=i.sc.insert(t,n),uy(i.remoteStore,new oh(_s(kp(t.path)),n,2,Ea.ot))}}function ud(i,e,t){return Ix.apply(this,arguments)}function Ix(){return Ix=(0,Ke.Z)(function*(i,e,t){const n=an(i),r=[],s=[],a=[];var c;n.tc.isEmpty()||(n.tc.forEach((c,d)=>{a.push(n.hc(d,e,t).then(f=>{if(f){n.isPrimaryClient&&n.sharedClientState.updateQueryState(d.targetId,f.fromCache?"not-current":"current"),r.push(f);const g=Zb.Vi(d.targetId,f);s.push(g)}}))}),yield Promise.all(a),n.Zu.Go(r),yield(c=(0,Ke.Z)(function*(d,f){const g=an(d);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",v=>Le.forEach(f,b=>Le.forEach(b.Pi,x=>g.persistence.referenceDelegate.addReference(v,b.targetId,x)).next(()=>Le.forEach(b.vi,x=>g.persistence.referenceDelegate.removeReference(v,b.targetId,x)))))}catch(v){if(!zc(v))throw v;Dt("LocalStore","Failed to update sequence numbers: "+v)}for(const v of f){const b=v.targetId;if(!v.fromCache){const x=g.$i.get(b),I=x.withLastLimboFreeSnapshotVersion(x.snapshotVersion);g.$i=g.$i.insert(b,I)}}}),function(d,f){return c.apply(this,arguments)})(n.localStore,s))}),Ix.apply(this,arguments)}function SD(i,e){return Dx.apply(this,arguments)}function Dx(){return Dx=(0,Ke.Z)(function*(i,e){const t=an(i);if(!t.currentUser.isEqual(e)){Dt("SyncEngine","User change. New user:",e.toKey());const n=yield Xb(t.localStore,e);t.currentUser=e,(r=t).uc.forEach(a=>{a.forEach(c=>{c.reject(new bt(He.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.uc.clear(),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield ud(t,n.Ki)}var r}),Dx.apply(this,arguments)}function dM(i,e){const t=an(i),n=t.ic.get(e);if(n&&n.Xu)return ei().add(n.key);{let r=ei();const s=t.ec.get(e);if(!s)return r;for(const a of s){const c=t.tc.get(a);r=r.unionWith(c.view.qu)}return r}}function hM(i,e){return yy.apply(this,arguments)}function yy(){return yy=(0,Ke.Z)(function*(i,e){const t=an(i),n=yield Cu(t.localStore,e.query,!0),r=e.view.Ju(n);return t.isPrimaryClient&&Ax(t,e.targetId,r.zu),r}),yy.apply(this,arguments)}function e0(i,e){return Cf.apply(this,arguments)}function Cf(){return Cf=(0,Ke.Z)(function*(i,e){const t=an(i);return $T(t.localStore,e).then(n=>ud(t,n))}),Cf.apply(this,arguments)}function TD(i,e,t,n){return t0.apply(this,arguments)}function t0(){return t0=(0,Ke.Z)(function*(i,e,t,n){const r=an(i),s=yield function(a,c){const d=an(a),f=an(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",g=>f.yn(g,c).next(v=>v?d.localDocuments.getDocuments(g,v):Le.resolve(null)))}(r.localStore,e);var c;null!==s?("pending"===t?yield hy(r.remoteStore):"acknowledged"===t||"rejected"===t?(Cx(r,e,n||null),sm(r,e),c=e,an(an(r.localStore).mutationQueue).In(c)):gn(),yield ud(r,s)):Dt("SyncEngine","Cannot apply mutation batch with id: "+e)}),t0.apply(this,arguments)}function Rx(){return Rx=(0,Ke.Z)(function*(i,e){const t=an(i);if(dh(t),gM(t),!0===e&&!0!==t.ac){const n=t.sharedClientState.getAllActiveQueryTargets(),r=yield pM(t,n.toArray());t.ac=!0,yield fx(t.remoteStore,!0);for(const s of r)uy(t.remoteStore,s)}else if(!1===e&&!1!==t.ac){const n=[];let r=Promise.resolve();t.ec.forEach((s,a)=>{t.sharedClientState.isLocalQueryTarget(a)?n.push(a):r=r.then(()=>(jc(t,a),xf(t.localStore,a,!0))),dy(t.remoteStore,a)}),yield r,yield pM(t,n),function(s){const a=an(s);a.ic.forEach((c,d)=>{dy(a.remoteStore,d)}),a.rc.cs(),a.ic=new Map,a.sc=new gs(Kt.comparator)}(t),t.ac=!1,yield fx(t.remoteStore,!1)}}),Rx.apply(this,arguments)}function pM(i,e,t){return _y.apply(this,arguments)}function _y(){return _y=(0,Ke.Z)(function*(i,e,t){const n=an(i),r=[],s=[];for(const a of e){let c;const d=n.ec.get(a);if(d&&0!==d.length){c=yield bf(n.localStore,_s(d[0]));for(const f of d){const g=n.tc.get(f),v=yield hM(n,g);v.snapshot&&s.push(v.snapshot)}}else{const f=yield WT(n.localStore,a);c=yield bf(n.localStore,f),yield xx(n,mM(f),a,!1)}r.push(c)}return n.Zu.Go(s),r}),_y.apply(this,arguments)}function mM(i){return YS(i.path,i.collectionGroup,i.orderBy,i.filters,i.limit,"F",i.startAt,i.endAt)}function _N(i){const e=an(i);return an(an(e.localStore).persistence).Ri()}function MD(i,e,t,n){return Px.apply(this,arguments)}function Px(){return Px=(0,Ke.Z)(function*(i,e,t,n){const r=an(i);if(r.ac)return void Dt("SyncEngine","Ignoring unexpected query state notification.");const s=r.ec.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const a=yield $T(r.localStore,XS(s[0])),c=xu.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield ud(r,a,c);break}case"rejected":yield xf(r.localStore,e,!0),jc(r,e,n);break;default:gn()}}),Px.apply(this,arguments)}function am(i,e,t){return n0.apply(this,arguments)}function n0(){return n0=(0,Ke.Z)(function*(i,e,t){const n=dh(i);if(n.ac){for(const r of e){if(n.ec.has(r)){Dt("SyncEngine","Adding an already active target "+r);continue}const s=yield WT(n.localStore,r),a=yield bf(n.localStore,s);yield xx(n,mM(s),a.targetId,!1),uy(n.remoteStore,a)}for(const r of t)n.ec.has(r)&&(yield xf(n.localStore,r,!1).then(()=>{dy(n.remoteStore,r),jc(n,r)}).catch(vl))}}),n0.apply(this,arguments)}function dh(i){const e=an(i);return e.remoteStore.remoteSyncer.applyRemoteEvent=uM.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=dM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bD.bind(null,e),e.Zu.Go=gD.bind(null,e.eventManager),e.Zu.lc=nM.bind(null,e.eventManager),e}function gM(i){const e=an(i);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=ED.bind(null,e),e}class _M{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,Ke.Z)(function*(){t.wt=Qp(e.databaseInfo.databaseId),t.sharedClientState=t.dc(e),t.persistence=t._c(e),yield t.persistence.start(),t.localStore=t.wc(e),t.gcScheduler=t.mc(e,t.localStore),t.indexBackfillerScheduler=t.gc(e,t.localStore)})()}mc(e,t){return null}gc(e,t){return null}wc(e){return Yb(this.persistence,new HT,e.initialUser,this.wt)}_c(e){return new UT(Ov.Ms,this.wt)}dc(e){return new oy}terminate(){var e=this;return(0,Ke.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class CD extends _M{constructor(e,t,n){super(),this.yc=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,n=this;return(0,Ke.Z)(function*(){yield t().call(n,e),yield n.yc.initialize(n,e),yield gM(n.yc.syncEngine),yield hy(n.yc.remoteStore),yield n.persistence.ci(()=>(n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(),n.indexBackfillerScheduler&&!n.indexBackfillerScheduler.started&&n.indexBackfillerScheduler.start(),Promise.resolve()))})()}wc(e){return Yb(this.persistence,new HT,e.initialUser,this.wt)}mc(e,t){return new NT(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}gc(e,t){const n=new pI(t,this.persistence);return new zS(e.asyncQueue,n)}_c(e){const t=Kb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?os.withCacheSize(this.cacheSizeBytes):os.DEFAULT;return new qb(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,nx(),ay(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new oy}}class vM extends CD{constructor(e,t){super(e,t,!1),this.yc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,n=this;return(0,Ke.Z)(function*(){yield t().call(n,e);const r=n.yc.syncEngine;n.sharedClientState instanceof Jp&&(n.sharedClientState.syncEngine={kr:TD.bind(null,r),Or:MD.bind(null,r),Mr:am.bind(null,r),Ri:_N.bind(null,r),Nr:e0.bind(null,r)},yield n.sharedClientState.start()),yield n.persistence.ci(function(){var s=(0,Ke.Z)(function*(a){yield function fM(i,e){return Rx.apply(this,arguments)}(n.yc.syncEngine,a),n.gcScheduler&&(a&&!n.gcScheduler.started?n.gcScheduler.start():a||n.gcScheduler.stop()),n.indexBackfillerScheduler&&(a&&!n.indexBackfillerScheduler.started?n.indexBackfillerScheduler.start():a||n.indexBackfillerScheduler.stop())});return function(a){return s.apply(this,arguments)}}())})()}dc(e){const t=nx();if(!Jp.V(t))throw new bt(He.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Kb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Jp(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class wM{initialize(e,t){var n=this;return(0,Ke.Z)(function*(){n.localStore||(n.localStore=e.localStore,n.sharedClientState=e.sharedClientState,n.datastore=n.createDatastore(t),n.remoteStore=n.createRemoteStore(t),n.eventManager=n.createEventManager(t),n.syncEngine=n.createSyncEngine(t,!e.synchronizeTabs),n.sharedClientState.onlineStateHandler=r=>Zv(n.syncEngine,r,1),n.remoteStore.remoteSyncer.handleCredentialChange=SD.bind(null,n.syncEngine),yield fx(n.remoteStore,n.syncEngine.isPrimaryClient))})()}createEventManager(e){return new tM}createDatastore(e){const t=Qp(e.databaseInfo.databaseId),n=new sD(e.databaseInfo);return new ly(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,s=c=>Zv(this.syncEngine,c,0),a=iD.V()?new iD:new vs,new cD(t,n,r,s,a);var t,n,r,s,a}createSyncEngine(e,t){return function(n,r,s,a,c,d,f){const g=new wD(n,r,s,a,c,d);return f&&(g.ac=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,Ke.Z)(function*(t){const n=an(t);Dt("RemoteStore","RemoteStore shutting down."),n.lu.add(5),yield Sf(n),n.du.shutdown(),n._u.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Nx(i,e=10240){let t=0;return{read:()=>(0,Ke.Z)(function*(){if(t<i.byteLength){const n={value:i.slice(t,t+e),done:!1};return t+=e,n}return{done:!0}})(),cancel:()=>(0,Ke.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class lm{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class AD{constructor(e,t){this.Ec=e,this.wt=t,this.metadata=new To,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(n=>{n&&n.Cu()?this.metadata.resolve(n.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==n?void 0:n.payload)}`))},n=>this.metadata.reject(n))}close(){return this.Ec.cancel()}getMetadata(){var e=this;return(0,Ke.Z)(function*(){return e.metadata.promise})()}fc(){var e=this;return(0,Ke.Z)(function*(){return yield e.getMetadata(),e.Rc()})()}Rc(){var e=this;return(0,Ke.Z)(function*(){const t=yield e.bc();if(null===t)return null;const n=e.Ac.decode(t),r=Number(n);isNaN(r)&&e.Pc(`length string (${n}) is not valid number`);const s=yield e.vc(r);return new yD(JSON.parse(s),t.length+r)})()}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}bc(){var e=this;return(0,Ke.Z)(function*(){for(;e.Vc()<0&&!(yield e.Sc()););if(0===e.buffer.length)return null;const t=e.Vc();t<0&&e.Pc("Reached the end of bundle when a length string is expected.");const n=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),n})()}vc(e){var t=this;return(0,Ke.Z)(function*(){for(;t.buffer.length<e;)(yield t.Sc())&&t.Pc("Reached the end of bundle when more is expected.");const n=t.Ac.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),n})()}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}Sc(){var e=this;return(0,Ke.Z)(function*(){const t=yield e.Ec.read();if(!t.done){const n=new Uint8Array(e.buffer.length+t.value.length);n.set(e.buffer),n.set(t.value,e.buffer.length),e.buffer=n}return t.done})()}}class ID{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,Ke.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new bt(He.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=yield(r=(0,Ke.Z)(function*(s,a){const c=an(s),d=$g(c.wt)+"/documents",f={documents:a.map(x=>Wp(c.wt,x))},g=yield c.ao("BatchGetDocuments",d,f),v=new Map;g.forEach(x=>{const C=function xb(i,e){return"found"in e?function(t,n){Yn(!!n.found);const r=Su(t,n.found.name),s=lo(n.found.updateTime),a=new jo({mapValue:{fields:n.found.fields}});return Sr.newFoundDocument(r,s,a)}(i,e):"missing"in e?function(t,n){Yn(!!n.missing),Yn(!!n.readTime);const r=Su(t,n.missing),s=lo(n.readTime);return Sr.newNoDocument(r,s)}(i,e):gn()}(c.wt,x);v.set(C.key.toString(),C)});const b=[];return a.forEach(x=>{const C=v.get(x.toString());Yn(!!C),b.push(C)}),b}),function(s,a){return r.apply(this,arguments)})(t.datastore,e);var r;return n.forEach(r=>t.recordVersion(r)),n})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastWriteError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new od(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Ke.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var n;e.mutations.forEach(n=>{t.delete(n.key.toString())}),t.forEach((n,r)=>{const s=Kt.fromPath(r);e.mutations.push(new ih(s,e.precondition(s)))}),yield(n=(0,Ke.Z)(function*(r,s){const a=an(r),c=$g(a.wt)+"/documents",d={writes:s.map(f=>mv(a.wt,f))};yield a.ro("Commit",c,d)}),function(r,s){return n.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw gn();t=Wn.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new bt(He.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?Kr.updateTime(t):Kr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Wn.min()))throw new bt(He.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Kr.updateTime(t)}return Kr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class DD{constructor(e,t,n,r,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=s,this.Dc=n.maxAttempts,this.So=new Hv(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){var e=this;this.So.Io((0,Ke.Z)(function*(){const t=new ID(e.datastore),n=e.xc(t);n&&n.then(r=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(r)}).catch(s=>{e.Nc(s)}))}).catch(r=>{e.Nc(r)})}))}xc(e){try{const t=this.updateFunction(e);return!Rp(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!aT(t)}return!1}}class RD{constructor(e,t,n,r){var s=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Ns.UNAUTHENTICATED,this.clientId=uI.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,function(){var a=(0,Ke.Z)(function*(c){Dt("FirestoreClient","Received user=",c.uid),yield s.authCredentialListener(c),s.user=c});return function(c){return a.apply(this,arguments)}}()),this.appCheckCredentials.start(n,a=>(Dt("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}getConfiguration(){var e=this;return(0,Ke.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new bt(He.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new To;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Ke.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(n){const r=Mf(n,"Failed to shutdown persistence");t.reject(r)}})),t.promise}}function bM(i,e){return Ox.apply(this,arguments)}function Ox(){return Ox=(0,Ke.Z)(function*(i,e){i.asyncQueue.verifyOperationInProgress(),Dt("FirestoreClient","Initializing OfflineComponentProvider");const t=yield i.getConfiguration();yield e.initialize(t);let n=t.initialUser;i.setCredentialChangeListener(function(){var r=(0,Ke.Z)(function*(s){n.isEqual(s)||(yield Xb(e.localStore,s),n=s)});return function(s){return r.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>i.terminate()),i.offlineComponents=e}),Ox.apply(this,arguments)}function xM(i,e){return Lx.apply(this,arguments)}function Lx(){return Lx=(0,Ke.Z)(function*(i,e){i.asyncQueue.verifyOperationInProgress();const t=yield kx(i);Dt("FirestoreClient","Initializing OnlineComponentProvider");const n=yield i.getConfiguration();yield e.initialize(t,n),i.setCredentialChangeListener(r=>QT(e.remoteStore,r)),i.setAppCheckTokenChangeListener((r,s)=>QT(e.remoteStore,s)),i.onlineComponents=e}),Lx.apply(this,arguments)}function kx(i){return Fx.apply(this,arguments)}function Fx(){return Fx=(0,Ke.Z)(function*(i){return i.offlineComponents||(Dt("FirestoreClient","Using default OfflineComponentProvider"),yield bM(i,new _M)),i.offlineComponents}),Fx.apply(this,arguments)}function hh(i){return r0.apply(this,arguments)}function r0(){return r0=(0,Ke.Z)(function*(i){return i.onlineComponents||(Dt("FirestoreClient","Using default OnlineComponentProvider"),yield xM(i,new wM)),i.onlineComponents}),r0.apply(this,arguments)}function Vx(i){return kx(i).then(e=>e.persistence)}function s0(i){return kx(i).then(e=>e.localStore)}function Ux(i){return hh(i).then(e=>e.remoteStore)}function o0(i){return hh(i).then(e=>e.syncEngine)}function cm(i){return Bx.apply(this,arguments)}function Bx(){return Bx=(0,Ke.Z)(function*(i){const e=yield hh(i),t=e.eventManager;return t.onListen=lM.bind(null,e.syncEngine),t.onUnlisten=Sx.bind(null,e.syncEngine),t}),Bx.apply(this,arguments)}function EM(i,e,t={}){const n=new To;return i.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return function(r,s,a,c,d){const f=new lm({next:v=>{s.enqueueAndForget(()=>yx(r,g));const b=v.docs.has(a);!b&&v.fromCache?d.reject(new bt(He.UNAVAILABLE,"Failed to get document because the client is offline.")):b&&v.fromCache&&c&&"server"===c.source?d.reject(new bt(He.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(v)},error:v=>d.reject(v)}),g=new vx(kp(a.path),f,{includeMetadataChanges:!0,Du:!0});return mx(r,g)}(yield cm(i),i.asyncQueue,e,t,n)})),n.promise}function um(i,e,t={}){const n=new To;return i.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return function(r,s,a,c,d){const f=new lm({next:v=>{s.enqueueAndForget(()=>yx(r,g)),v.fromCache&&"server"===c.source?d.reject(new bt(He.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(v)},error:v=>d.reject(v)}),g=new vx(a,f,{includeMetadataChanges:!0,Du:!0});return mx(r,g)}(yield cm(i),i.asyncQueue,e,t,n)})),n.promise}const a0=new Map;function Af(i,e,t){if(!t)throw new bt(He.INVALID_ARGUMENT,`Function ${i}() cannot be called with an empty ${e}.`)}function SM(i,e,t,n){if(!0===e&&!0===n)throw new bt(He.INVALID_ARGUMENT,`${i} and ${t} cannot be used together.`)}function TM(i){if(!Kt.isDocumentKey(i))throw new bt(He.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${i} has ${i.length}.`)}function MM(i){if(Kt.isDocumentKey(i))throw new bt(He.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${i} has ${i.length}.`)}function If(i){if(void 0===i)return"undefined";if(null===i)return"null";if("string"==typeof i)return i.length>20&&(i=`${i.substring(0,20)}...`),JSON.stringify(i);if("number"==typeof i||"boolean"==typeof i)return""+i;if("object"==typeof i){if(i instanceof Array)return"an array";{const e=(t=i).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof i?"a function":gn()}function Mi(i,e){if("_delegate"in i&&(i=i._delegate),!(i instanceof e)){if(e.name===i.constructor.name)throw new bt(He.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=If(i);throw new bt(He.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return i}function CM(i,e){if(e<=0)throw new bt(He.INVALID_ARGUMENT,`Function ${i}() requires a positive number, but it was: ${e}.`)}class AM{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new bt(He.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new bt(He.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,SM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dm{constructor(e,t,n){this._authCredentials=t,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new AM({}),this._settingsFrozen=!1,e instanceof yu?this._databaseId=e:(this._app=e,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new bt(He.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yu(r.options.projectId)}(e))}get app(){if(!this._app)throw new bt(He.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new bt(He.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new AM(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new iN;switch(t.type){case"gapi":const n=t.client;return Yn(!("object"!=typeof n||null===n||!n.auth||!n.auth.getAuthHeaderValueForFirstParty)),new aN(n,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new bt(He.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=a0.get(e);t&&(Dt("ComponentProvider","Removing Datastore"),a0.delete(e),t.terminate())}(this),Promise.resolve()}}class Tr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Iu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tr(this.firestore,e,this._key)}}class $o{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new $o(this.firestore,e,this._query)}}class Iu extends $o{constructor(e,t,n){super(e,t,kp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tr(this.firestore,null,new Kt(e))}withConverter(e){return new Iu(this.firestore,e,this._path)}}function DM(i,e,...t){if(i=(0,fi.m9)(i),Af("collection","path",e),i instanceof dm){const n=Ni.fromString(e,...t);return MM(n),new Iu(i,null,n)}{if(!(i instanceof Tr||i instanceof Iu))throw new bt(He.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Ni.fromString(e,...t));return MM(n),new Iu(i.firestore,null,n)}}function hm(i,e,...t){if(i=(0,fi.m9)(i),1===arguments.length&&(e=uI.I()),Af("doc","path",e),i instanceof dm){const n=Ni.fromString(e,...t);return TM(n),new Tr(i,null,new Kt(n))}{if(!(i instanceof Tr||i instanceof Iu))throw new bt(He.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=i._path.child(Ni.fromString(e,...t));return TM(n),new Tr(i.firestore,i instanceof Iu?i.converter:null,new Kt(n))}}function l0(i,e){return i=(0,fi.m9)(i),e=(0,fi.m9)(e),(i instanceof Tr||i instanceof Iu)&&(e instanceof Tr||e instanceof Iu)&&i.firestore===e.firestore&&i.path===e.path&&i.converter===e.converter}function zx(i,e){return i=(0,fi.m9)(i),e=(0,fi.m9)(e),i instanceof $o&&e instanceof $o&&i.firestore===e.firestore&&Up(i._query,e._query)&&i.converter===e.converter}class Gx{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Hv(this,"async_queue_retry"),this.Kc=()=>{const t=ay();t&&Dt("AsyncQueue","Visibility state changed to "+t.visibilityState),this.So.Eo()};const e=ay();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const t=ay();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const t=new To;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}jc(){var e=this;return(0,Ke.Z)(function*(){if(0!==e.Mc.length){try{yield e.Mc[0](),e.Mc.shift(),e.So.reset()}catch(t){if(!zc(t))throw t;Dt("AsyncQueue","Operation failed with retryable error: "+t)}e.Mc.length>0&&e.So.Io(()=>e.jc())}})()}Qc(e){const t=this.Oc.then(()=>(this.Lc=!0,e().catch(n=>{throw this.Bc=n,this.Lc=!1,js("INTERNAL UNHANDLED ERROR: ",function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+"\n"+s.stack),a}(n)),n}).then(n=>(this.Lc=!1,n))));return this.Oc=t,t}enqueueAfterDelay(e,t,n){this.Gc(),this.qc.indexOf(e)>-1&&(t=0);const r=px.createAndSchedule(this,e,t,n,s=>this.Wc(s));return this.$c.push(r),r}Gc(){this.Bc&&gn()}verifyOperationInProgress(){}zc(){var e=this;return(0,Ke.Z)(function*(){let t;do{t=e.Oc,yield t}while(t!==e.Oc)})()}Hc(e){for(const t of this.$c)if(t.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.$c)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const t=this.$c.indexOf(e);this.$c.splice(t,1)}}function vy(i){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of["next","error","complete"])if(r in n&&"function"==typeof n[r])return!0;return!1}(i)}class VD{constructor(){this._progressObserver={},this._taskCompletionResolver=new To,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Yr extends dm{constructor(e,t,n){super(e,t,n),this.type="firestore",this._queue=new Gx,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||jx(this),this._firestoreClient.terminate()}}function ws(i){return i._firestoreClient||jx(i),i._firestoreClient.verifyNotTerminated(),i._firestoreClient}function jx(i){var e;const t=i._freezeSettings(),n=(s=(null===(e=i._app)||void 0===e?void 0:e.options.appId)||"",new gI(i._databaseId,s,i._persistenceKey,(c=t).host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,c.useFetchStreams));var s,c;i._firestoreClient=new RD(i._authCredentials,i._appCheckCredentials,i._queue,n)}function Wx(i,e,t){const n=new To;return i.asyncQueue.enqueue((0,Ke.Z)(function*(){try{yield bM(i,t),yield xM(i,e),n.resolve()}catch(r){if(!("FirebaseError"===(s=r).name?s.code===He.FAILED_PRECONDITION||s.code===He.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&s instanceof DOMException)||22===s.code||20===s.code||11===s.code))throw r;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),n.reject(r)}var s})).then(()=>n.promise)}function Df(i){if(i._initialized||i._terminated)throw new bt(He.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class dd{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new bt(He.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class hd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new hd(Ws.fromBase64String(e))}catch(t){throw new bt(He.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new hd(Ws.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Wc{constructor(e){this._methodName=e}}class c0{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new bt(He.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new bt(He.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Kn(this._lat,e._lat)||Kn(this._long,e._long)}}const $x=/^__.*__$/;class WD{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new sd(e,this.data,this.fieldMask,t,this.fieldTransforms):new Bp(e,this.data,t,this.fieldTransforms)}}class qx{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new sd(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function LM(i){switch(i){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw gn()}}class u0{constructor(e,t,n,r,s,a){this.settings=e,this.databaseId=t,this.wt=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Xc(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new u0(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}ia(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return p0(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(LM(this.Zc)&&$x.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class Kx{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.wt=n||Qp(e)}aa(e,t,n,r=!1){return new u0({Zc:e,methodName:t,ca:n,path:gr.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function fh(i){const e=i._freezeSettings(),t=Qp(i._databaseId);return new Kx(i._databaseId,!!e.ignoreUndefinedProperties,t)}function wy(i,e,t,n,r,s={}){const a=i.aa(s.merge||s.mergeFields?2:0,e,t,r);Zx("Data must be an object, but it was:",a,n);const c=f0(n,a);let d,f;if(s.merge)d=new bl(a.fieldMask),f=a.fieldTransforms;else if(s.mergeFields){const g=[];for(const v of s.mergeFields){const b=Yx(e,v,t);if(!a.contains(b))throw new bt(He.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);Xx(g,b)||g.push(b)}d=new bl(g),f=a.fieldTransforms.filter(v=>d.covers(v.field))}else d=null,f=a.fieldTransforms;return new WD(new jo(c),d,f)}class ph extends Wc{_toFieldTransform(e){if(2!==e.Zc)throw e.oa(1===e.Zc?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ph}}function d0(i,e,t){return new u0({Zc:3,ca:e.settings.ca,methodName:i._methodName,na:t},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class kM extends Wc{_toFieldTransform(e){return new uv(e.path,new Hg)}isEqual(e){return e instanceof kM}}class FM extends Wc{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=d0(this,e,!0),n=this.ha.map(s=>fd(s,t)),r=new rd(n);return new uv(e.path,r)}isEqual(e){return this===e}}class $D extends Wc{constructor(e,t){super(e),this.ha=t}_toFieldTransform(e){const t=d0(this,e,!0),n=this.ha.map(s=>fd(s,t)),r=new nh(n);return new uv(e.path,r)}isEqual(e){return this===e}}class VM extends Wc{constructor(e,t){super(e),this.la=t}_toFieldTransform(e){const t=new zg(e.wt,TI(e.wt,this.la));return new uv(e.path,t)}isEqual(e){return this===e}}function fm(i,e,t,n){const r=i.aa(1,e,t);Zx("Data must be an object, but it was:",r,n);const s=[],a=jo.empty();of(n,(d,f)=>{const g=by(e,d,t);f=(0,fi.m9)(f);const v=r.ia(g);if(f instanceof ph)s.push(g);else{const b=fd(f,v);null!=b&&(s.push(g),a.set(g,b))}});const c=new bl(s);return new qx(a,c,r.fieldTransforms)}function h0(i,e,t,n,r,s){const a=i.aa(1,e,t),c=[Yx(e,n,t)],d=[r];if(s.length%2!=0)throw new bt(He.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<s.length;b+=2)c.push(Yx(e,s[b])),d.push(s[b+1]);const f=[],g=jo.empty();for(let b=c.length-1;b>=0;--b)if(!Xx(f,c[b])){const x=c[b];let C=d[b];C=(0,fi.m9)(C);const I=a.ia(x);if(C instanceof ph)f.push(x);else{const D=fd(C,I);null!=D&&(f.push(x),g.set(x,D))}}const v=new bl(f);return new qx(g,v,a.fieldTransforms)}function UM(i,e,t,n=!1){return fd(t,i.aa(n?4:3,e))}function fd(i,e){if(qD(i=(0,fi.m9)(i)))return Zx("Unsupported field value:",e,i),f0(i,e);if(i instanceof Wc)return function(t,n){if(!LM(n.Zc))throw n.oa(`${t._methodName}() can only be used with update() and set()`);if(!n.path)throw n.oa(`${t._methodName}() is not currently supported inside arrays`);const r=t._toFieldTransform(n);r&&n.fieldTransforms.push(r)}(i,e),null;if(void 0===i&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),i instanceof Array){if(e.settings.na&&4!==e.Zc)throw e.oa("Nested arrays are not supported");return function(t,n){const r=[];let s=0;for(const a of t){let c=fd(a,n.ra(s));null==c&&(c={nullValue:"NULL_VALUE"}),r.push(c),s++}return{arrayValue:{values:r}}}(i,e)}return function(t,n){if(null===(t=(0,fi.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return TI(n.wt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const r=Vr.fromDate(t);return{timestampValue:jp(n.wt,r)}}if(t instanceof Vr){const r=new Vr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:jp(n.wt,r)}}if(t instanceof c0)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof hd)return{bytesValue:dT(n.wt,t._byteString)};if(t instanceof Tr){const r=n.databaseId,s=t.firestore._databaseId;if(!s.isEqual(r))throw n.oa(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:bb(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n.oa(`Unsupported field value: ${If(t)}`)}(i,e)}function f0(i,e){const t={};return Ka(i)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):of(i,(n,r)=>{const s=fd(r,e.ea(n));null!=s&&(t[n]=s)}),{mapValue:{fields:t}}}function qD(i){return!("object"!=typeof i||null===i||i instanceof Array||i instanceof Date||i instanceof Vr||i instanceof c0||i instanceof hd||i instanceof Tr||i instanceof Wc)}function Zx(i,e,t){if(!qD(t)||"object"!=typeof(n=t)||null===n||Object.getPrototypeOf(n)!==Object.prototype&&null!==Object.getPrototypeOf(n)){const n=If(t);throw e.oa("an object"===n?i+" a custom object":i+" "+n)}var n}function Yx(i,e,t){if((e=(0,fi.m9)(e))instanceof dd)return e._internalPath;if("string"==typeof e)return by(i,e);throw p0("Field path arguments must be of type string or ",i,!1,void 0,t)}const BM=new RegExp("[~\\*/\\[\\]]");function by(i,e,t){if(e.search(BM)>=0)throw p0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,i,!1,void 0,t);try{return new dd(...e.split("."))._internalPath}catch(n){throw p0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,i,!1,void 0,t)}}function p0(i,e,t,n,r){const s=n&&!n.isEmpty(),a=void 0!==r;let c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let d="";return(s||a)&&(d+=" (found",s&&(d+=` in field ${n}`),a&&(d+=` in document ${r}`),d+=")"),new bt(He.INVALID_ARGUMENT,c+i+d)}function Xx(i,e){return i.some(t=>t.isEqual(e))}class pm{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Tr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new KD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(m0("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class KD extends pm{data(){return super.data()}}function m0(i,e){return"string"==typeof e?by(i,e):e instanceof dd?e._internalPath:e._delegate._internalPath}class mh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pd extends pm{constructor(e,t,n,r,s,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new mm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(m0("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class mm extends pd{data(e={}){return super.data(e)}}class md{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new mh(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new mm(this._firestore,this._userDataWriter,n.key,n,new mh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new bt(He.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(n,r){if(n._snapshot.oldDocs.isEmpty()){let s=0;return n._snapshot.docChanges.map(a=>({type:"added",doc:new mm(n._firestore,n._userDataWriter,a.doc.key,a.doc,new mh(n._snapshot.mutatedKeys.has(a.doc.key),n._snapshot.fromCache),n.query.converter),oldIndex:-1,newIndex:s++}))}{let s=n._snapshot.oldDocs;return n._snapshot.docChanges.filter(a=>r||3!==a.type).map(a=>{const c=new mm(n._firestore,n._userDataWriter,a.doc.key,a.doc,new mh(n._snapshot.mutatedKeys.has(a.doc.key),n._snapshot.fromCache),n.query.converter);let d=-1,f=-1;return 0!==a.type&&(d=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),1!==a.type&&(s=s.add(a.doc),f=s.indexOf(a.doc.key)),{type:HM(a.type),doc:c,oldIndex:d,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function HM(i){switch(i){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return gn()}}function Jx(i,e){return i instanceof pd&&e instanceof pd?i._firestore===e._firestore&&i._key.isEqual(e._key)&&(null===i._document?null===e._document:i._document.isEqual(e._document))&&i._converter===e._converter:i instanceof md&&e instanceof md&&i._firestore===e._firestore&&zx(i.query,e.query)&&i.metadata.isEqual(e.metadata)&&i._snapshot.isEqual(e._snapshot)}function zM(i){if("L"===i.limitType&&0===i.explicitOrderBy.length)throw new bt(He.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xy{}function Rf(i,...e){for(const t of e)i=t._apply(i);return i}class GM extends xy{constructor(e,t,n){super(),this.fa=e,this.da=t,this._a=n,this.type="where"}_apply(e){const t=fh(e.firestore),n=function(r,s,a,c,d,f,g){let v;if(d.isKeyField()){if("array-contains"===f||"array-contains-any"===f)throw new bt(He.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if("in"===f||"not-in"===f){JD(g,f);const x=[];for(const C of g)x.push(tE(c,r,C));v={arrayValue:{values:x}}}else v=tE(c,r,g)}else"in"!==f&&"not-in"!==f&&"array-contains-any"!==f||JD(g,f),v=UM(a,"where",g,"in"===f||"not-in"===f);const b=Co.create(d,f,v);return function(x,C){if(C.ht()){const D=ab(x);if(null!==D&&!D.isEqual(C.field))throw new bt(He.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${D.toString()}' and '${C.field.toString()}'`);const L=ob(x);null!==L&&y0(0,C.field,L)}const I=function(D,L){for(const V of D.filters)if(L.indexOf(V.op)>=0)return V.op;return null}(x,function(D){switch(D){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(C.op));if(null!==I)throw new bt(He.INVALID_ARGUMENT,I===C.op?`Invalid query. You cannot use more than one '${C.op.toString()}' filter.`:`Invalid query. You cannot use '${C.op.toString()}' filters with '${I.toString()}' filters.`)}(r,b),b}(e._query,0,t,e.firestore._databaseId,this.fa,this.da,this._a);return new $o(e.firestore,e.converter,function(r,s){const a=r.filters.concat([s]);return new wu(r.path,r.collectionGroup,r.explicitOrderBy.slice(),a,r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}class EN extends xy{constructor(e,t){super(),this.fa=e,this.wa=t,this.type="orderBy"}_apply(e){const t=function(n,r,s){if(null!==n.startAt)throw new bt(He.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==n.endAt)throw new bt(He.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const a=new Lp(r,s);return function(c,d){if(null===ob(c)){const f=ab(c);null!==f&&y0(0,f,d.field)}}(n,a),a}(e._query,this.fa,this.wa);return new $o(e.firestore,e.converter,function(n,r){const s=n.explicitOrderBy.concat([r]);return new wu(n.path,n.collectionGroup,s,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)}(e._query,t))}}class ZD extends xy{constructor(e,t,n){super(),this.type=e,this.ma=t,this.ga=n}_apply(e){return new $o(e.firestore,e.converter,av(e._query,this.ma,this.ga))}}class YD extends xy{constructor(e,t,n){super(),this.type=e,this.ya=t,this.pa=n}_apply(e){const t=eE(e,this.type,this.ya,this.pa);return new $o(e.firestore,e.converter,(r=t,new wu((n=e._query).path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,r,n.endAt)));var n,r}}class XD extends xy{constructor(e,t,n){super(),this.type=e,this.ya=t,this.pa=n}_apply(e){const t=eE(e,this.type,this.ya,this.pa);return new $o(e.firestore,e.converter,(r=t,new wu((n=e._query).path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,n.startAt,r)));var n,r}}function eE(i,e,t,n){if(t[0]=(0,fi.m9)(t[0]),t[0]instanceof pm)return function(r,s,a,c,d){if(!c)throw new bt(He.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const f=[];for(const g of Vp(r))if(g.field.isKeyField())f.push(lf(s,c.key));else{const v=c.data.field(g.field);if(Jw(v))throw new bt(He.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===v){const b=g.field.canonicalString();throw new bt(He.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${b}' (used as the orderBy) does not exist.`)}f.push(v)}return new vu(f,d)}(i._query,i.firestore._databaseId,e,t[0]._document,n);{const r=fh(i.firestore);return function(s,a,c,d,f,g){const v=s.explicitOrderBy;if(f.length>v.length)throw new bt(He.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const b=[];for(let x=0;x<f.length;x++){const C=f[x];if(v[x].field.isKeyField()){if("string"!=typeof C)throw new bt(He.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof C}`);if(!lb(s)&&-1!==C.indexOf("/"))throw new bt(He.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${d}() must be a plain document ID, but '${C}' contains a slash.`);const I=s.path.child(Ni.fromString(C));if(!Kt.isDocumentKey(I))throw new bt(He.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${d}() must result in a valid document path, but '${I}' is not because it contains an odd number of segments.`);const D=new Kt(I);b.push(lf(a,D))}else{const I=UM(c,d,C);b.push(I)}}return new vu(b,g)}(i._query,i.firestore._databaseId,r,e,t,n)}}function tE(i,e,t){if("string"==typeof(t=(0,fi.m9)(t))){if(""===t)throw new bt(He.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lb(e)&&-1!==t.indexOf("/"))throw new bt(He.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Ni.fromString(t));if(!Kt.isDocumentKey(n))throw new bt(He.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return lf(i,new Kt(n))}if(t instanceof Tr)return lf(i,t._key);throw new bt(He.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${If(t)}.`)}function JD(i,e){if(!Array.isArray(i)||0===i.length)throw new bt(He.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(i.length>10)throw new bt(He.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function y0(i,e,t){if(!t.isEqual(e))throw new bt(He.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}const WM={maxAttempts:5};class _0{convertValue(e,t="none"){switch(af(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ys(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Xd(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw gn()}}convertObject(e,t){const n={};return of(e.fields,(r,s)=>{n[r]=this.convertValue(s,t)}),n}convertGeoPoint(e){return new c0(ys(e.latitude),ys(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Qw(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(kg(e));default:return null}}convertTimestamp(e){const t=Yd(e);return new Vr(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ni.fromString(e);Yn(vT(n));const r=new yu(n.get(1),n.get(3)),s=new Kt(n.popFirst(5));return r.isEqual(t)||js(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Ey(i,e,t){let n;return n=i?t&&(t.merge||t.mergeFields)?i.toFirestore(e,t):i.toFirestore(e):e,n}class AN extends _0{constructor(e){super(),this.firestore=e}convertBytes(e){return new hd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tr(this.firestore,null,t)}}class nE{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=fh(e)}set(e,t,n){this._verifyNotCommitted();const r=gh(e,this._firestore),s=Ey(r.converter,t,n),a=wy(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,n);return this._mutations.push(a.toMutation(r._key,Kr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const s=gh(e,this._firestore);let a;return a="string"==typeof(t=(0,fi.m9)(t))||t instanceof dd?h0(this._dataReader,"WriteBatch.update",s._key,t,n,r):fm(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Kr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=gh(e,this._firestore);return this._mutations=this._mutations.concat(new od(t._key,Kr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new bt(He.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function gh(i,e){if((i=(0,fi.m9)(i)).firestore!==e)throw new bt(He.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return i}class Pf extends _0{constructor(e){super(),this.firestore=e}convertBytes(e){return new hd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tr(this.firestore,null,t)}}function $M(i,e,t){i=Mi(i,Tr);const n=Mi(i.firestore,Yr),r=Ey(i.converter,e,t);return gm(n,[wy(fh(n),"setDoc",i._key,r,null!==i.converter,t).toMutation(i._key,Kr.none())])}function t1(i,e,t,...n){i=Mi(i,Tr);const r=Mi(i.firestore,Yr),s=fh(r);let a;return a="string"==typeof(e=(0,fi.m9)(e))||e instanceof dd?h0(s,"updateDoc",i._key,e,t,n):fm(s,"updateDoc",i._key,e),gm(r,[a.toMutation(i._key,Kr.exists(!0))])}function qM(i,...e){var t,n,r;i=(0,fi.m9)(i);let s={includeMetadataChanges:!1},a=0;"object"!=typeof e[a]||vy(e[a])||(s=e[a],a++);const c={includeMetadataChanges:s.includeMetadataChanges};if(vy(e[a])){const v=e[a];e[a]=null===(t=v.next)||void 0===t?void 0:t.bind(v),e[a+1]=null===(n=v.error)||void 0===n?void 0:n.bind(v),e[a+2]=null===(r=v.complete)||void 0===r?void 0:r.bind(v)}let d,f,g;if(i instanceof Tr)f=Mi(i.firestore,Yr),g=kp(i._key.path),d={next:v=>{e[a]&&e[a](Sy(f,i,v))},error:e[a+1],complete:e[a+2]};else{const v=Mi(i,$o);f=Mi(v.firestore,Yr),g=v._query;const b=new Pf(f);d={next:x=>{e[a]&&e[a](new md(f,b,v,x))},error:e[a+1],complete:e[a+2]},zM(i._query)}return function(v,b,x,C){const I=new lm(C),D=new vx(b,I,x);return v.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return mx(yield cm(v),D)})),()=>{I.Tc(),v.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return yx(yield cm(v),D)}))}}(ws(f),g,c,d)}function gm(i,e){return function(t,n){const r=new To;return t.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return function cM(i,e,t){return gy.apply(this,arguments)}(yield o0(t),n,r)})),r.promise}(ws(i),e)}function Sy(i,e,t){const n=t.docs.get(e._key),r=new Pf(i);return new pd(i,r,e._key,n,new mh(t.hasPendingWrites,t.fromCache),e.converter)}class i1 extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=fh(e)}get(e){const t=gh(e,this._firestore),n=new AN(this._firestore);return this._transaction.lookup([t._key]).then(r=>{if(!r||1!==r.length)return gn();const s=r[0];if(s.isFoundDocument())return new pm(this._firestore,n,s.key,s,t.converter);if(s.isNoDocument())return new pm(this._firestore,n,t._key,null,t.converter);throw gn()})}set(e,t,n){const r=gh(e,this._firestore),s=Ey(r.converter,t,n),a=wy(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,n);return this._transaction.set(r._key,a),this}update(e,t,n,...r){const s=gh(e,this._firestore);let a;return a="string"==typeof(t=(0,fi.m9)(t))||t instanceof dd?h0(this._dataReader,"Transaction.update",s._key,t,n,r):fm(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,a),this}delete(e){const t=gh(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=gh(e,this._firestore),n=new Pf(this._firestore);return super.get(e).then(r=>new pd(this._firestore,n,t._key,r._document,new mh(!1,!1),t.converter))}}function aE(i,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new bt("invalid-argument",`Invalid options passed to function ${i}(): You cannot specify both "merge" and "mergeFields".`);return e}function a1(){if("undefined"==typeof Uint8Array)throw new bt("unimplemented","Uint8Arrays are not available in this environment.")}function JM(){if(!function Xw(){return"undefined"!=typeof atob}())throw new bt("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(i,e=!0){qd=bo.SDK_VERSION,(0,bo._registerComponent)(new Xu.wA("firestore",(t,{options:n})=>{const r=t.getProvider("app").getImmediate(),s=new Yr(r,new sN(t.getProvider("auth-internal")),new lN(t.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:e},n),s._setSettings(n),s},"PUBLIC")),(0,bo.registerVersion)(Cg,"3.4.10",i),(0,bo.registerVersion)(Cg,"3.4.10","esm2017")}();class ym{constructor(e){this._delegate=e}static fromBase64String(e){return JM(),new ym(hd.fromBase64String(e))}static fromUint8Array(e){return a1(),new ym(hd.fromUint8Array(e))}toBase64(){return JM(),this._delegate.toBase64()}toUint8Array(){return a1(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function lE(i){return function l1(i,e){if("object"!=typeof i||null===i)return!1;const t=i;for(const n of e)if(n in t&&"function"==typeof t[n])return!0;return!1}(i,["next","error","complete"])}class QM{enableIndexedDbPersistence(e,t){return function RM(i,e){Df(i=Mi(i,Yr));const t=ws(i),n=i._freezeSettings(),r=new wM;return Wx(t,r,new CD(r,n.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function PM(i){Df(i=Mi(i,Yr));const e=ws(i),t=i._freezeSettings(),n=new wM;return Wx(e,n,new vM(n,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function HD(i){if(i._initialized&&!i._terminated)throw new bt(He.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new To;return i._queue.enqueueAndForgetEvenWhileRestricted((0,Ke.Z)(function*(){try{yield(t=(0,Ke.Z)(function*(n){if(!wl.V())return Promise.resolve();const r=n+"main";yield wl.delete(r)}),function(n){return t.apply(this,arguments)})(Kb(i._databaseId,i._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class eC{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof yu||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&Ig("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){!function IM(i,e,t,n={}){var r;const s=(i=Mi(i,dm))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&Ig("Host has been set in both settings() and useEmulator(), emulator host will be used"),i._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${t}`,ssl:!1})),n.mockUserToken){let a,c;if("string"==typeof n.mockUserToken)a=n.mockUserToken,c=Ns.MOCK_USER;else{a=(0,fi.Sg)(n.mockUserToken,null===(r=i._app)||void 0===r?void 0:r.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new bt(He.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ns(d)}i._authCredentials=new rN(new Y_(a,c))}}(this._delegate,e,t,n)}enableNetwork(){return function OM(i){return function PD(i){return i.asyncQueue.enqueue((0,Ke.Z)(function*(){const e=yield Vx(i),t=yield Ux(i);return e.setNetworkEnabled(!0),function(n){const r=an(n);return r.lu.delete(0),cy(r)}(t)}))}(ws(i=Mi(i,Yr)))}(this._delegate)}disableNetwork(){return function zD(i){return function ND(i){return i.asyncQueue.enqueue((0,Ke.Z)(function*(){const e=yield Vx(i),t=yield Ux(i);return e.setNetworkEnabled(!1),(n=(0,Ke.Z)(function*(r){const s=an(r);s.lu.add(0),yield Sf(s),s._u.set("Offline")}),function(r){return n.apply(this,arguments)})(t);var n}))}(ws(i=Mi(i,Yr)))}(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,SM("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function NM(i){return function(e){const t=new To;return e.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return function gN(i,e){return Mx.apply(this,arguments)}(yield o0(e),t)})),t.promise}(ws(i=Mi(i,Yr)))}(this._delegate)}onSnapshotsInSync(e){return function $c(i,e){return function kD(i,e){const t=new lm(e);return i.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return n=yield cm(i),r=t,an(n).Tu.add(r),void r.next();var n,r})),()=>{t.Tc(),i.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return n=yield cm(i),r=t,void an(n).Tu.delete(r);var n,r}))}}(ws(i=Mi(i,Yr)),vy(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new bt("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new My(this,DM(this._delegate,e))}catch(t){throw qo(t,"collection()","Firestore.collection()")}}doc(e){try{return new Sl(this,hm(this._delegate,e))}catch(t){throw qo(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new la(this,function vN(i,e){if(i=Mi(i,dm),Af("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new bt(He.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new $o(i,null,(t=e,new wu(Ni.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw qo(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function r1(i,e,t){i=Mi(i,Yr);const n=Object.assign(Object.assign({},WM),t);return function(r){if(r.maxAttempts<1)throw new bt(He.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function Hx(i,e,t){const n=new To;return i.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){const r=yield(s=i,hh(s).then(a=>a.datastore));var s;new DD(i.asyncQueue,r,t,e,n).run()})),n.promise}(ws(i),r=>e(new i1(i,r)),n)}(this._delegate,t=>e(new uE(this,t)))}batch(){return ws(this._delegate),new nC(new nE(this._delegate,e=>gm(this._delegate,e)))}loadBundle(e){return function jD(i,e){const t=ws(i=Mi(i,Yr)),n=new VD;return function Au(i,e,t,n){const r=function(s,a){let c;return c="string"==typeof s?(new TextEncoder).encode(s):s,d=function(d,f){if(d instanceof Uint8Array)return Nx(d,f);if(d instanceof ArrayBuffer)return Nx(new Uint8Array(d),f);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),new AD(d,a);var d}(t,Qp(e));i.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){!function yM(i,e,t){const n=an(i);var r;(r=(0,Ke.Z)(function*(s,a,c){try{const d=yield a.getMetadata();if(yield function(b,x){const C=an(b),I=lo(x.createTime);return C.persistence.runTransaction("hasNewerBundle","readonly",D=>C.Ds.getBundleMetadata(D,x.id)).then(D=>!!D&&D.createTime.compareTo(I)>=0)}(s.localStore,d))return yield a.close(),c._completeWith({taskState:"Success",documentsLoaded:(b=d).totalDocuments,bytesLoaded:b.totalBytes,totalDocuments:b.totalDocuments,totalBytes:b.totalBytes}),Promise.resolve(new Set);c._updateProgress(rM(d));const f=new _D(d,s.localStore,a.wt);let g=yield a.fc();for(;g;){const b=yield f.Nu(g);b&&c._updateProgress(b),g=yield a.fc()}const v=yield f.complete();return yield ud(s,v.Mu,void 0),yield function(b,x){const C=an(b);return C.persistence.runTransaction("Save bundle","readwrite",I=>C.Ds.saveBundleMetadata(I,x))}(s.localStore,d),c._completeWith(v.progress),Promise.resolve(v.Ou)}catch(d){return Ig("SyncEngine",`Loading bundle failed with ${d}`),c._failWith(d),Promise.resolve(new Set)}var b}),function(s,a,c){return r.apply(this,arguments)})(n,e,t).then(r=>{n.sharedClientState.notifyBundleLoaded(r)})}(yield o0(i),r,n)}))}(t,i._databaseId,e,n),n}(this._delegate,e)}namedQuery(e){return function Ta(i,e){return function FD(i,e){return i.asyncQueue.enqueue((0,Ke.Z)(function*(){return function(t,n){const r=an(t);return r.persistence.runTransaction("Get named query","readonly",s=>r.Ds.getNamedQuery(s,n))}(yield s0(i),e)}))}(ws(i=Mi(i,Yr)),e).then(t=>t?new $o(i,null,t.query):null)}(this._delegate,e).then(t=>t?new la(this,t):null)}}class cE extends _0{constructor(e){super(),this.firestore=e}convertBytes(e){return new ym(new hd(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Sl.forKey(t,this.firestore,null)}}class uE{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new cE(e)}get(e){const t=vm(e);return this._delegate.get(t).then(n=>new Ty(this._firestore,new pd(this._firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,t.converter)))}set(e,t,n){const r=vm(e);return n?(aE("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const s=vm(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){const t=vm(e);return this._delegate.delete(t),this}}class nC{constructor(e){this._delegate=e}set(e,t,n){const r=vm(e);return n?(aE("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const s=vm(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,n,...r),this}delete(e){const t=vm(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Nf{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new mm(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new _m(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=Nf.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let s=r.get(t);return s||(s=new Nf(e,new cE(e),t),r.set(t,s)),s}}Nf.INSTANCES=new WeakMap;class Sl{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new cE(e)}static forPath(e,t,n){if(e.length%2!=0)throw new bt("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Sl(t,new Tr(t._delegate,n,new Kt(e)))}static forKey(e,t,n){return new Sl(t,new Tr(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new My(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new My(this.firestore,DM(this._delegate,e))}catch(t){throw qo(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,fi.m9)(e))instanceof Tr&&l0(this._delegate,e)}set(e,t){t=aE("DocumentReference.set",t);try{return t?$M(this._delegate,e,t):$M(this._delegate,e)}catch(n){throw qo(n,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?t1(this._delegate,e):t1(this._delegate,e,t,...n)}catch(r){throw qo(r,"updateDoc()","DocumentReference.update()")}}delete(){return function n1(i){return gm(Mi(i.firestore,Yr),[new od(i._key,Kr.none())])}(this._delegate)}onSnapshot(...e){const t=v0(e),n=dE(e,r=>new Ty(this.firestore,new pd(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return qM(this._delegate,t,n)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function IN(i){i=Mi(i,Tr);const e=Mi(i.firestore,Yr),t=ws(e),n=new Pf(e);return function OD(i,e){const t=new To;return i.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return(n=(0,Ke.Z)(function*(r,s,a){try{const c=yield function(d,f){const g=an(d);return g.persistence.runTransaction("read document","readonly",v=>g.localDocuments.getDocument(v,f))}(r,s);c.isFoundDocument()?a.resolve(c):c.isNoDocument()?a.resolve(null):a.reject(new bt(He.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(c){const d=Mf(c,`Failed to get document '${s} from cache`);a.reject(d)}}),function(r,s,a){return n.apply(this,arguments)})(yield s0(i),e,t);var n})),t.promise}(t,i._key).then(r=>new pd(e,n,i._key,r,new mh(null!==r&&r.hasLocalMutations,!0),i.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function DN(i){i=Mi(i,Tr);const e=Mi(i.firestore,Yr);return EM(ws(e),i._key,{source:"server"}).then(t=>Sy(e,i,t))}(this._delegate):function iE(i){i=Mi(i,Tr);const e=Mi(i.firestore,Yr);return EM(ws(e),i._key).then(t=>Sy(e,i,t))}(this._delegate),t.then(n=>new Ty(this.firestore,new pd(this.firestore._delegate,this._userDataWriter,n._key,n._document,n.metadata,this._delegate.converter)))}withConverter(e){return new Sl(this.firestore,this._delegate.withConverter(e?Nf.getInstance(this.firestore,e):null))}}function qo(i,e,t){return i.message=i.message.replace(e,t),i}function v0(i){for(const e of i)if("object"==typeof e&&!lE(e))return e;return{}}function dE(i,e){var t,n;let r;return r=lE(i[0])?i[0]:lE(i[1])?i[1]:"function"==typeof i[0]?{next:i[0],error:i[1],complete:i[2]}:{next:i[1],error:i[2],complete:i[3]},{next:s=>{r.next&&r.next(e(s))},error:null===(t=r.error)||void 0===t?void 0:t.bind(r),complete:null===(n=r.complete)||void 0===n?void 0:n.bind(r)}}class Ty{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Sl(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Jx(this._delegate,e._delegate)}}class _m extends Ty{data(e){const t=this._delegate.data(e);return function lI(i,e){i||gn()}(void 0!==t),t}}class la{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new cE(e)}where(e,t,n){try{return new la(this.firestore,Rf(this._delegate,function xN(i,e,t){const n=e,r=m0("where",i);return new GM(r,n,t)}(e,t,n)))}catch(r){throw qo(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new la(this.firestore,Rf(this._delegate,function SN(i,e="asc"){const t=e,n=m0("orderBy",i);return new EN(n,t)}(e,t)))}catch(n){throw qo(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new la(this.firestore,Rf(this._delegate,function TN(i){return CM("limit",i),new ZD("limit",i,"F")}(e)))}catch(t){throw qo(t,"limit()","Query.limit()")}}limitToLast(e){try{return new la(this.firestore,Rf(this._delegate,function MN(i){return CM("limitToLast",i),new ZD("limitToLast",i,"L")}(e)))}catch(t){throw qo(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new la(this.firestore,Rf(this._delegate,function CN(...i){return new YD("startAt",i,!0)}(...e)))}catch(t){throw qo(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new la(this.firestore,Rf(this._delegate,function g0(...i){return new YD("startAfter",i,!1)}(...e)))}catch(t){throw qo(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new la(this.firestore,Rf(this._delegate,function jM(...i){return new XD("endBefore",i,!1)}(...e)))}catch(t){throw qo(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new la(this.firestore,Rf(this._delegate,function Qx(...i){return new XD("endAt",i,!0)}(...e)))}catch(t){throw qo(t,"endAt()","Query.endAt()")}}isEqual(e){return zx(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function QD(i){i=Mi(i,$o);const e=Mi(i.firestore,Yr),t=ws(e),n=new Pf(e);return function LD(i,e){const t=new To;return i.asyncQueue.enqueueAndForget((0,Ke.Z)(function*(){return(n=(0,Ke.Z)(function*(r,s,a){try{const c=yield Cu(r,s,!0),d=new wx(s,c.ji),f=d.Ku(c.documents),g=d.applyChanges(f,!1);a.resolve(g.snapshot)}catch(c){const d=Mf(c,`Failed to execute query '${s} against cache`);a.reject(d)}}),function(r,s,a){return n.apply(this,arguments)})(yield s0(i),e,t);var n})),t.promise}(t,i._query).then(r=>new md(e,n,i,r))}(this._delegate):"server"===(null==e?void 0:e.source)?function e1(i){i=Mi(i,$o);const e=Mi(i.firestore,Yr),t=ws(e),n=new Pf(e);return um(t,i._query,{source:"server"}).then(r=>new md(e,n,i,r))}(this._delegate):function RN(i){i=Mi(i,$o);const e=Mi(i.firestore,Yr),t=ws(e),n=new Pf(e);return zM(i._query),um(t,i._query).then(r=>new md(e,n,i,r))}(this._delegate),t.then(n=>new hE(this.firestore,new md(this.firestore._delegate,this._userDataWriter,this._delegate,n._snapshot)))}onSnapshot(...e){const t=v0(e),n=dE(e,r=>new hE(this.firestore,new md(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return qM(this._delegate,t,n)}withConverter(e){return new la(this.firestore,this._delegate.withConverter(e?Nf.getInstance(this.firestore,e):null))}}class c1{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new _m(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class hE{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new la(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new _m(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new c1(this._firestore,t))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new _m(this._firestore,n))})}isEqual(e){return Jx(this._delegate,e._delegate)}}class My extends la{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Sl(this.firestore,e):null}doc(e){try{return new Sl(this.firestore,void 0===e?hm(this._delegate):hm(this._delegate,e))}catch(t){throw qo(t,"doc()","CollectionReference.doc()")}}add(e){return function rE(i,e){const t=Mi(i.firestore,Yr),n=hm(i),r=Ey(i.converter,e);return gm(t,[wy(fh(i.firestore),"addDoc",n._key,r,null!==i.converter,{}).toMutation(n._key,Kr.exists(!1))]).then(()=>n)}(this._delegate,e).then(t=>new Sl(this.firestore,t))}isEqual(e){return l0(this._delegate,e._delegate)}withConverter(e){return new My(this.firestore,this._delegate.withConverter(e?Nf.getInstance(this.firestore,e):null))}}function vm(i){return Mi(i,Tr)}class w0{constructor(...e){this._delegate=new dd(...e)}static documentId(){return new w0(gr.keyField().canonicalString())}isEqual(e){return(e=(0,fi.m9)(e))instanceof dd&&this._delegate._internalPath.isEqual(e._internalPath)}}class Of{constructor(e){this._delegate=e}static serverTimestamp(){const e=function KM(){return new kM("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Of(e)}static delete(){const e=function sE(){return new ph("deleteField")}();return e._methodName="FieldValue.delete",new Of(e)}static arrayUnion(...e){const t=function ZM(...i){return new FM("arrayUnion",i)}(...e);return t._methodName="FieldValue.arrayUnion",new Of(t)}static arrayRemove(...e){const t=function s1(...i){return new $D("arrayRemove",i)}(...e);return t._methodName="FieldValue.arrayRemove",new Of(t)}static increment(e){const t=function YM(i){return new VM("increment",i)}(e);return t._methodName="FieldValue.increment",new Of(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const u1={Firestore:eC,GeoPoint:c0,Timestamp:Vr,Blob:ym,Transaction:uE,WriteBatch:nC,DocumentReference:Sl,DocumentSnapshot:Ty,Query:la,QueryDocumentSnapshot:_m,QuerySnapshot:hE,CollectionReference:My,FieldPath:w0,FieldValue:Of,setLogLevel:function tC(i){!function nN(i){gu.setLogLevel(i)}(i)},CACHE_SIZE_UNLIMITED:-1};!function NN(i){(function d1(i,e){i.INTERNAL.registerComponent(new Xu.wA("firestore-compat",t=>{const n=t.getProvider("app-compat").getImmediate(),r=t.getProvider("firestore").getImmediate();return e(n,r)},"PUBLIC").setServiceProps(Object.assign({},u1)))})(i,(e,t)=>new eC(e,t,new QM)),i.registerVersion("@firebase/firestore-compat","0.1.19")}(w_.Z);var Lf=K(7579),ON=K(6451),fE=K(5363),pE=K(8421);function Ma(i,e){return(0,vn.e)((t,n)=>{let r=null,s=0,a=!1;const c=()=>a&&!r&&n.complete();t.subscribe((0,cn.x)(n,d=>{null==r||r.unsubscribe();let f=0;const g=s++;(0,pE.Xf)(i(d,g)).subscribe(r=(0,cn.x)(n,v=>n.next(e?e(d,v,g,f++):v),()=>{r=null,c()}))},()=>{a=!0,c()}))})}var b0=K(6063);class h1 extends Lf.x{constructor(e=1/0,t=1/0,n=b0.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=n,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:n,_infiniteTimeWindow:r,_timestampProvider:s,_windowTime:a}=this;t||(n.push(e),!r&&n.push(s.now()+a)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:n,_buffer:r}=this,s=r.slice();for(let a=0;a<s.length&&!e.closed;a+=n?1:2)e.next(s[a]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:n,_infiniteTimeWindow:r}=this,s=(r?1:2)*e;if(e<1/0&&s<n.length&&n.splice(0,n.length-s),!r){const a=t.now();let c=0;for(let d=1;d<n.length&&n[d]<=a;d+=2)c=d;c&&n.splice(0,c+1)}}}var f1=K(3099);function mE(i,e,t){let n,r=!1;return i&&"object"==typeof i?({bufferSize:n=1/0,windowTime:e=1/0,refCount:r=!1,scheduler:t}=i):n=null!=i?i:1/0,(0,f1.B)({connector:()=>new h1(n,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}const Cy=(0,K(3888).d)(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});var Ay=K(5698);function x0(i){return(0,vn.e)((e,t)=>{let n=!1;e.subscribe((0,cn.x)(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function iC(i=gE){return(0,vn.e)((e,t)=>{let n=!1;e.subscribe((0,cn.x)(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function gE(){return new Cy}function gd(i,e){const t=arguments.length>=2;return n=>n.pipe(i?ri((r,s)=>i(r,s,n)):rc.y,(0,Ay.q)(1),t?x0(e):iC(()=>new Cy))}function Iy(i,e){return(0,mn.m)(e)?Ma(()=>i,e):Ma(()=>i)}var rC=K(9468);K(5867);const cC=new Map,w1={activated:!1,tokenObservers:[]},BN={initialized:!1,enabled:!1};function Ko(i){return cC.get(i)||w1}function Du(i,e){cC.set(i,e)}function E0(){return BN}class x1{constructor(e,t,n,r,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,Ke.Z)(function*(){t.stop();try{t.pending=new fi.BH,yield function WN(i){return new Promise(e=>{setTimeout(e,i)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new fi.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(n){t.retryPolicy(n)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const Za=new fi.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function o(i){if(!Ko(i).activated)throw Za.create("use-before-activation",{appName:i.name})}function p(i,e){return y.apply(this,arguments)}function y(){return y=(0,Ke.Z)(function*({url:i,body:e},t){var n,r;const s={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){const x=yield a.getHeartbeatsHeader();x&&(s["X-Firebase-Client"]=x)}const c={method:"POST",body:JSON.stringify(e),headers:s};let d,f;try{d=yield fetch(i,c)}catch(x){throw Za.create("fetch-network-error",{originalErrorMessage:null===(n=x)||void 0===n?void 0:n.message})}if(200!==d.status)throw Za.create("fetch-status-error",{httpStatus:d.status});try{f=yield d.json()}catch(x){throw Za.create("fetch-parse-error",{originalErrorMessage:null===(r=x)||void 0===r?void 0:r.message})}const g=f.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw Za.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${f.ttl}`});const v=1e3*Number(g[1]),b=Date.now();return{token:f.token,expireTimeMillis:b+v,issuedAtTimeMillis:b}}),y.apply(this,arguments)}function R(i,e){const{projectId:t,appId:n,apiKey:r}=i.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${n}:exchangeDebugToken?key=${r}`,body:{debug_token:e}}}const X="firebase-app-check-store";let xe=null;function Je(){return xe||(xe=new Promise((i,e)=>{var t;try{const n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=r=>{i(r.target.result)},n.onerror=r=>{var s;e(Za.create("storage-open",{originalErrorMessage:null===(s=r.target.error)||void 0===s?void 0:s.message}))},n.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(X,{keyPath:"compositeKey"})}}catch(n){e(Za.create("storage-open",{originalErrorMessage:null===(t=n)||void 0===t?void 0:t.message}))}}),xe)}function wi(){return wi=(0,Ke.Z)(function*(i,e){const n=(yield Je()).transaction(X,"readwrite"),s=n.objectStore(X).put({compositeKey:i,value:e});return new Promise((a,c)=>{s.onsuccess=d=>{a()},n.onerror=d=>{var f;c(Za.create("storage-set",{originalErrorMessage:null===(f=d.target.error)||void 0===f?void 0:f.message}))}})}),wi.apply(this,arguments)}const Ff=new za.Yd("@firebase/app-check");function S0(i,e){return(0,fi.hl)()?function Zt(i,e){return function Nn(i,e){return wi.apply(this,arguments)}(function yh(i){return`${i.options.appId}-${i.name}`}(i),e)}(i,e).catch(t=>{Ff.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function T0(){return E0().enabled}function M0(){return Py.apply(this,arguments)}function Py(){return Py=(0,Ke.Z)(function*(){const i=E0();if(i.enabled&&i.token)return i.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),Py.apply(this,arguments)}const $3={error:"UNKNOWN_ERROR"};function q3(i){return fi.US.encodeString(JSON.stringify(i),!1)}function uC(i){return E1.apply(this,arguments)}function E1(){return E1=(0,Ke.Z)(function*(i,e=!1){const t=i.app;o(t);const n=Ko(t);let s,r=n.token;if(!r){const d=yield n.cachedTokenPromise;d&&dC(d)&&(r=d)}if(!e&&r&&dC(r))return{token:r.token};let c,a=!1;if(T0()){n.exchangeTokenPromise||(n.exchangeTokenPromise=p(R(t,yield M0()),i.heartbeatServiceProvider).then(f=>(n.exchangeTokenPromise=void 0,f)),a=!0);const d=yield n.exchangeTokenPromise;return yield S0(t,d),Du(t,Object.assign(Object.assign({},n),{token:d})),{token:d.token}}try{n.exchangeTokenPromise||(n.exchangeTokenPromise=n.provider.getToken().then(d=>(n.exchangeTokenPromise=void 0,d)),a=!0),r=yield n.exchangeTokenPromise}catch(d){"appCheck/throttled"===d.code?Ff.warn(d.message):Ff.error(d),s=d}return r?(c={token:r.token},Du(t,Object.assign(Object.assign({},n),{token:r})),yield S0(t,r)):c=Z3(s),a&&KN(t,c),c}),E1.apply(this,arguments)}function T1(i,e){const t=Ko(i),n=t.tokenObservers.filter(r=>r.next!==e);0===n.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),Du(i,Object.assign(Object.assign({},t),{tokenObservers:n}))}function qN(i){const{app:e}=i,t=Ko(e);let n=t.tokenRefresher;n||(n=function K3(i){const{app:e}=i;return new x1((0,Ke.Z)(function*(){let n;if(n=Ko(e).token?yield uC(i,!0):yield uC(i),n.error)throw n.error}),()=>!0,()=>{const t=Ko(e);if(t.token){let n=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return n=Math.min(n,t.token.expireTimeMillis-3e5),Math.max(0,n-Date.now())}return 0},3e4,96e4)}(i),Du(e,Object.assign(Object.assign({},t),{tokenRefresher:n}))),!n.isRunning()&&t.isTokenAutoRefreshEnabled&&n.start()}function KN(i,e){const t=Ko(i).tokenObservers;for(const n of t)try{"EXTERNAL"===n.type&&null!=e.error?n.error(e.error):n.next(e)}catch(r){}}function dC(i){return i.expireTimeMillis-Date.now()>0}function Z3(i){return{token:q3($3),error:i}}class Y3{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=Ko(this.app);for(const t of e)T1(this.app,t.next);return Promise.resolve()}}const nO="app-check-internal";!function uV(){(0,bo._registerComponent)(new Xu.wA("app-check",i=>function X3(i,e){return new Y3(i,e)}(i.getProvider("app").getImmediate(),i.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((i,e,t)=>{i.getProvider(nO).initialize()})),(0,bo._registerComponent)(new Xu.wA(nO,i=>function J3(i){return{getToken:e=>uC(i,e),addTokenListener:e=>function S1(i,e,t,n){const{app:r}=i,s=Ko(r),a={next:t,error:n,type:e};if(Du(r,Object.assign(Object.assign({},s),{tokenObservers:[...s.tokenObservers,a]})),s.token&&dC(s.token)){const c=s.token;Promise.resolve().then(()=>{t({token:c.token}),qN(i)}).catch(()=>{})}s.cachedTokenPromise.then(()=>qN(i))}(i,"INTERNAL",e),removeTokenListener:e=>T1(i.app,e)}}(i.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,bo.registerVersion)("@firebase/app-check","0.5.9")}();class I1{constructor(){return(0,kr.vb)("app-check")}}"undefined"!=typeof window&&window;var mV=K(127);const rO=new w.OlP("angularfire2.auth.use-emulator"),sO=new w.OlP("angularfire2.auth.settings"),oO=new w.OlP("angularfire2.auth.tenant-id"),aO=new w.OlP("angularfire2.auth.langugage-code"),lO=new w.OlP("angularfire2.auth.use-device-language"),cO=new w.OlP("angularfire.auth.persistence"),uO=(i,e,t,n,r,s,a,c)=>(0,Dr.cc)(`${i.name}.auth`,"AngularFireAuth",i.name,()=>{const d=e.runOutsideAngular(()=>i.auth());if(t&&d.useEmulator(...t),n&&(d.tenantId=n),d.languageCode=r,s&&d.useDeviceLanguage(),a)for(const[f,g]of Object.entries(a))d.settings[f]=g;return c&&d.setPersistence(c),d},[t,n,r,s,a,c]);let dO=(()=>{class i{constructor(t,n,r,s,a,c,d,f,g,v,b,x){const C=new Lf.x,I=qe(void 0).pipe((0,fE.Q)(a.outsideAngular),Ma(()=>s.runOutsideAngular(()=>Promise.resolve().then(K.bind(K,9916)))),(0,St.U)(()=>(0,Dr.on)(t,s,n)),(0,St.U)(D=>uO(D,s,c,f,g,v,d,b)),mE({bufferSize:1,refCount:!1}));if(Ul(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=qe(null);else{I.pipe(gd()).subscribe();const L=I.pipe(Ma(U=>U.getRedirectResult().then($=>$,()=>null)),kr.iC,mE({bufferSize:1,refCount:!1})),V=I.pipe(Ma(U=>new Tt.y($=>({unsubscribe:s.runOutsideAngular(()=>U.onAuthStateChanged(Z=>$.next(Z),Z=>$.error(Z),()=>$.complete()))})))),z=I.pipe(Ma(U=>new Tt.y($=>({unsubscribe:s.runOutsideAngular(()=>U.onIdTokenChanged(Z=>$.next(Z),Z=>$.error(Z),()=>$.complete()))}))));this.authState=L.pipe(Iy(V),(0,rC.R)(a.outsideAngular),(0,fE.Q)(a.insideAngular)),this.user=L.pipe(Iy(z),(0,rC.R)(a.outsideAngular),(0,fE.Q)(a.insideAngular)),this.idToken=this.user.pipe(Ma(U=>U?(0,Rt.D)(U.getIdToken()):qe(null))),this.idTokenResult=this.user.pipe(Ma(U=>U?(0,Rt.D)(U.getIdTokenResult()):qe(null))),this.credential=(0,ON.T)(L,C,this.authState.pipe(ri(U=>!U))).pipe((0,St.U)(U=>(null==U?void 0:U.user)?U:null),(0,rC.R)(a.outsideAngular),(0,fE.Q)(a.insideAngular))}return(0,Dr.pX)(this,I,s,{spy:{apply:(D,L,V)=>{(D.startsWith("signIn")||D.startsWith("createUser"))&&V.then(z=>C.next(z))}}})}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Dr.Dh),w.LFG(Dr.xv,8),w.LFG(w.Lbi),w.LFG(w.R0b),w.LFG(kr.HU),w.LFG(rO,8),w.LFG(sO,8),w.LFG(oO,8),w.LFG(aO,8),w.LFG(lO,8),w.LFG(cO,8),w.LFG(I1,8))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})();function hO(i,e){return function yV(i,e=ia.z){return new Tt.y(t=>{let n;return null!=e?e.schedule(()=>{n=i.onSnapshot({includeMetadataChanges:!0},t)}):n=i.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=n&&n()}})}(i,e)}function R1(i,e){return hO(i,e).pipe((0,St.U)(t=>({payload:t,type:"query"})))}function fC(i,e){return R1(i,e).pipe(Ha(void 0),va(),(0,St.U)(([t,n])=>{const r=n.payload.docChanges(),s=r.map(a=>({type:a.type,payload:a}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(n.payload.metadata)&&n.payload.docs.forEach((a,c)=>{const d=r.find(g=>g.doc.ref.isEqual(a.ref)),f=null==t?void 0:t.payload.docs.find(g=>g.ref.isEqual(a.ref));d&&JSON.stringify(d.doc.metadata)===JSON.stringify(a.metadata)||!d&&f&&JSON.stringify(f.metadata)===JSON.stringify(a.metadata)||s.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),s}))}function fO(i,e,t){return fC(i,t).pipe(lu((n,r)=>function vV(i,e,t){return e.forEach(n=>{t.indexOf(n.type)>-1&&(i=function wV(i,e){switch(e.type){case"added":if(!i[e.newIndex]||!i[e.newIndex].doc.ref.isEqual(e.doc.ref))return P1(i,e.newIndex,0,e);break;case"modified":if(null==i[e.oldIndex]||i[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=i.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return P1(i,e.newIndex,1,e)}break;case"removed":if(i[e.oldIndex]&&i[e.oldIndex].doc.ref.isEqual(e.doc.ref))return P1(i,e.oldIndex,1)}return i}(i,n))}),i}(n,r.map(s=>s.payload),e),[]),function ra(i,e=rc.y){return i=null!=i?i:Fd,(0,vn.e)((t,n)=>{let r,s=!0;t.subscribe((0,cn.x)(n,a=>{const c=e(a);(s||!i(r,c))&&(s=!1,r=c,n.next(a))}))})}(),(0,St.U)(n=>n.map(r=>({type:r.type,payload:r}))))}function P1(i,e,t,...n){const r=i.slice();return r.splice(e,t,...n),r}function pO(i){return(!i||0===i.length)&&(i=["added","removed","modified"]),i}class mO{constructor(e,t,n){this.ref=e,this.query=t,this.afs=n}stateChanges(e){let t=fC(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,St.U)(n=>n.filter(r=>e.indexOf(r.type)>-1)))),t.pipe(Ha(void 0),va(),ri(([n,r])=>r.length>0||!n),(0,St.U)(([n,r])=>r),kr.iC)}auditTrail(e){return this.stateChanges(e).pipe(lu((t,n)=>[...t,...n],[]))}snapshotChanges(e){const t=pO(e);return fO(this.query,t,this.afs.schedulers.outsideAngular).pipe(kr.iC)}valueChanges(e={}){return R1(this.query,this.afs.schedulers.outsideAngular).pipe((0,St.U)(t=>t.payload.docs.map(n=>e.idField?Object.assign(Object.assign({},n.data()),{[e.idField]:n.id}):n.data())),kr.iC)}get(e){return(0,Rt.D)(this.query.get(e)).pipe(kr.iC)}add(e){return this.ref.add(e)}doc(e){return new gO(this.ref.doc(e),this.afs)}}class gO{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const n=this.ref.collection(e),{ref:r,query:s}=vO(n,t);return new mO(r,s,this.afs)}snapshotChanges(){return function _V(i,e){return hO(i,e).pipe(Ha(void 0),va(),(0,St.U)(([t,n])=>n.exists?(null==t?void 0:t.exists)?{payload:n,type:"modified"}:{payload:n,type:"added"}:{payload:n,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(kr.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,St.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,Rt.D)(this.ref.get(e)).pipe(kr.iC)}}class bV{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?fC(this.query,this.afs.schedulers.outsideAngular).pipe((0,St.U)(t=>t.filter(n=>e.indexOf(n.type)>-1)),ri(t=>t.length>0),kr.iC):fC(this.query,this.afs.schedulers.outsideAngular).pipe(kr.iC)}auditTrail(e){return this.stateChanges(e).pipe(lu((t,n)=>[...t,...n],[]))}snapshotChanges(e){const t=pO(e);return fO(this.query,t,this.afs.schedulers.outsideAngular).pipe(kr.iC)}valueChanges(e={}){return R1(this.query,this.afs.schedulers.outsideAngular).pipe((0,St.U)(n=>n.payload.docs.map(r=>e.idField?Object.assign({[e.idField]:r.id},r.data()):r.data())),kr.iC)}get(e){return(0,Rt.D)(this.query.get(e)).pipe(kr.iC)}}const yO=new w.OlP("angularfire2.enableFirestorePersistence"),_O=new w.OlP("angularfire2.firestore.persistenceSettings"),xV=new w.OlP("angularfire2.firestore.settings"),EV=new w.OlP("angularfire2.firestore.use-emulator");function vO(i,e=(t=>t)){return{query:e(i),ref:i}}let wO=(()=>{class i{constructor(t,n,r,s,a,c,d,f,g,v,b,x,C,I,D,L,V){this.schedulers=d;const z=(0,Dr.on)(t,c,n),U=g;v&&uO(z,c,b,C,I,D,x,L),[this.firestore,this.persistenceEnabled$]=(0,Dr.cc)(`${z.name}.firestore`,"AngularFirestore",z.name,()=>{const $=c.runOutsideAngular(()=>z.firestore());if(s&&$.settings(s),U&&$.useEmulator(...U),r&&!Ul(a)){const Z=()=>{try{return(0,Rt.D)($.enablePersistence(f||void 0).then(()=>!0,()=>!1))}catch(ae){return"undefined"!=typeof console&&console.warn(ae),qe(!1)}};return[$,c.runOutsideAngular(Z)]}return[$,qe(!1)]},[s,U,r])}collection(t,n){let r;r="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:a}=vO(r,n),c=this.schedulers.ngZone.run(()=>s);return new mO(c,a,this)}collectionGroup(t,n){const r=n||(a=>a),s=this.firestore.collectionGroup(t);return new bV(r(s),this)}doc(t){let n;n="string"==typeof t?this.firestore.doc(t):t;const r=this.schedulers.ngZone.run(()=>n);return new gO(r,this)}createId(){return this.firestore.collection("_").doc().id}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Dr.Dh),w.LFG(Dr.xv,8),w.LFG(yO,8),w.LFG(xV,8),w.LFG(w.Lbi),w.LFG(w.R0b),w.LFG(kr.HU),w.LFG(_O,8),w.LFG(EV,8),w.LFG(dO,8),w.LFG(rO,8),w.LFG(sO,8),w.LFG(oO,8),w.LFG(aO,8),w.LFG(lO,8),w.LFG(cO,8),w.LFG(I1,8))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac,providedIn:"any"}),i})(),SV=(()=>{class i{constructor(){mV.Z.registerVersion("angularfire",kr.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:i,providers:[{provide:yO,useValue:!0},{provide:_O,useValue:t}]}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({providers:[wO]}),i})();class yd extends Lf.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}}const{isArray:TV}=Array,{getPrototypeOf:MV,prototype:CV,keys:AV}=Object;function bO(i){if(1===i.length){const e=i[0];if(TV(e))return{args:e,keys:null};if(function IV(i){return i&&"object"==typeof i&&MV(i)===CV}(e)){const t=AV(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}const{isArray:DV}=Array;function xO(i){return(0,St.U)(e=>function RV(i,e){return DV(e)?i(...e):i(e)}(i,e))}function EO(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}var PV=K(9672);function SO(i,e,t){i?(0,PV.f)(t,i,e):e()}function pC(i,e){const t=(0,mn.m)(i)?i:()=>i,n=r=>r.error(t());return new Tt.y(e?r=>e.schedule(n,0,r):n)}function TO(i){return new Tt.y(e=>{(0,pE.Xf)(i()).subscribe(e)})}var C0=K(515),MO=K(727);function CO(){return(0,vn.e)((i,e)=>{let t=null;i._refCount++;const n=(0,cn.x)(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount)return void(t=null);const r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}class LV extends Tt.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,vn.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new MO.w0;const t=this.getSubject();e.add(this.source.subscribe((0,cn.x)(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=MO.w0.EMPTY)}return e}refCount(){return CO()(this)}}function wm(i){return(0,vn.e)((e,t)=>{let s,n=null,r=!1;n=e.subscribe((0,cn.x)(t,void 0,void 0,a=>{s=(0,pE.Xf)(i(a,wm(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function N1(i){return i<=0?()=>C0.E:(0,vn.e)((e,t)=>{let n=[];e.subscribe((0,cn.x)(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(const r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}var Kc=K(8505);class Vf{constructor(e,t){this.id=e,this.url=t}}class O1 extends Vf{constructor(e,t,n="imperative",r=null){super(e,t),this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class EE extends Vf{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class AO extends Vf{constructor(e,t,n){super(e,t),this.reason=n}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class VV extends Vf{constructor(e,t,n){super(e,t),this.error=n}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class UV extends Vf{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class BV extends Vf{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class HV extends Vf{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class zV extends Vf{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class GV extends Vf{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class IO{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class DO{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class jV{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class WV{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class $V{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qV{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class RO{constructor(e,t,n){this.routerEvent=e,this.position=t,this.anchor=n}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Oi="primary";class KV{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function A0(i){return new KV(i)}const PO="ngNavigationCancelingError";function L1(i){const e=Error("NavigationCancelingError: "+i);return e[PO]=!0,e}function YV(i,e,t){const n=t.path.split("/");if(n.length>i.length||"full"===t.pathMatch&&(e.hasChildren()||n.length<i.length))return null;const r={};for(let s=0;s<n.length;s++){const a=n[s],c=i[s];if(a.startsWith(":"))r[a.substring(1)]=c;else if(a!==c.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function _h(i,e){const t=i?Object.keys(i):void 0,n=e?Object.keys(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!NO(i[r],e[r]))return!1;return!0}function NO(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;const t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}return i===e}function OO(i){return Array.prototype.concat.apply([],i)}function LO(i){return i.length>0?i[i.length-1]:null}function Aa(i,e){for(const t in i)i.hasOwnProperty(t)&&e(i[t],t)}function vh(i){return(0,w.CqO)(i)?i:(0,w.QGY)(i)?(0,Rt.D)(Promise.resolve(i)):qe(i)}const QV={exact:function VO(i,e,t){if(!Oy(i.segments,e.segments)||!mC(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(const n in e.children)if(!i.children[n]||!VO(i.children[n],e.children[n],t))return!1;return!0},subset:UO},kO={exact:function eU(i,e){return _h(i,e)},subset:function tU(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>NO(i[t],e[t]))},ignored:()=>!0};function FO(i,e,t){return QV[t.paths](i.root,e.root,t.matrixParams)&&kO[t.queryParams](i.queryParams,e.queryParams)&&!("exact"===t.fragment&&i.fragment!==e.fragment)}function UO(i,e,t){return BO(i,e,e.segments,t)}function BO(i,e,t,n){if(i.segments.length>t.length){const r=i.segments.slice(0,t.length);return!(!Oy(r,t)||e.hasChildren()||!mC(r,t,n))}if(i.segments.length===t.length){if(!Oy(i.segments,t)||!mC(i.segments,t,n))return!1;for(const r in e.children)if(!i.children[r]||!UO(i.children[r],e.children[r],n))return!1;return!0}{const r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!!(Oy(i.segments,r)&&mC(i.segments,r,n)&&i.children[Oi])&&BO(i.children[Oi],e,s,n)}}function mC(i,e,t){return e.every((n,r)=>kO[t](i[r].parameters,n.parameters))}class Ny{constructor(e,t,n){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=A0(this.queryParams)),this._queryParamMap}toString(){return rU.serialize(this)}}class Wi{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Aa(t,(n,r)=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return gC(this)}}class SE{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=A0(this.parameters)),this._parameterMap}toString(){return WO(this)}}function Oy(i,e){return i.length===e.length&&i.every((t,n)=>t.path===e[n].path)}class HO{}class zO{parse(e){const t=new fU(e);return new Ny(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${TE(e.root,!0)}`,n=function aU(i){const e=Object.keys(i).map(t=>{const n=i[t];return Array.isArray(n)?n.map(r=>`${yC(t)}=${yC(r)}`).join("&"):`${yC(t)}=${yC(n)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams),r="string"==typeof e.fragment?`#${function sU(i){return encodeURI(i)}(e.fragment)}`:"";return`${t}${n}${r}`}}const rU=new zO;function gC(i){return i.segments.map(e=>WO(e)).join("/")}function TE(i,e){if(!i.hasChildren())return gC(i);if(e){const t=i.children[Oi]?TE(i.children[Oi],!1):"",n=[];return Aa(i.children,(r,s)=>{s!==Oi&&n.push(`${s}:${TE(r,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}{const t=function iU(i,e){let t=[];return Aa(i.children,(n,r)=>{r===Oi&&(t=t.concat(e(n,r)))}),Aa(i.children,(n,r)=>{r!==Oi&&(t=t.concat(e(n,r)))}),t}(i,(n,r)=>r===Oi?[TE(i.children[Oi],!1)]:[`${r}:${TE(n,!1)}`]);return 1===Object.keys(i.children).length&&null!=i.children[Oi]?`${gC(i)}/${t[0]}`:`${gC(i)}/(${t.join("//")})`}}function GO(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yC(i){return GO(i).replace(/%3B/gi,";")}function k1(i){return GO(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function _C(i){return decodeURIComponent(i)}function jO(i){return _C(i.replace(/\+/g,"%20"))}function WO(i){return`${k1(i.path)}${function oU(i){return Object.keys(i).map(e=>`;${k1(e)}=${k1(i[e])}`).join("")}(i.parameters)}`}const lU=/^[^\/()?;=#]+/;function vC(i){const e=i.match(lU);return e?e[0]:""}const cU=/^[^=?&#]+/,dU=/^[^&#]+/;class fU{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Wi([],{}):new Wi([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[Oi]=new Wi(e,t)),n}parseSegment(){const e=vC(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new SE(_C(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=vC(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const r=vC(this.remaining);r&&(n=r,this.capture(n))}e[_C(t)]=_C(n)}parseQueryParam(e){const t=function uU(i){const e=i.match(cU);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){const a=function hU(i){const e=i.match(dU);return e?e[0]:""}(this.remaining);a&&(n=a,this.capture(n))}const r=jO(t),s=jO(n);if(e.hasOwnProperty(r)){let a=e[r];Array.isArray(a)||(a=[a],e[r]=a),a.push(s)}else e[r]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const n=vC(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error(`Cannot parse url '${this.url}'`);let s;n.indexOf(":")>-1?(s=n.substr(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Oi);const a=this.parseChildren();t[s]=1===Object.keys(a).length?a[Oi]:new Wi([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class $O{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=F1(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){const t=F1(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=V1(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return V1(e,this._root).map(t=>t.value)}}function F1(i,e){if(i===e.value)return e;for(const t of e.children){const n=F1(i,t);if(n)return n}return null}function V1(i,e){if(i===e.value)return[e];for(const t of e.children){const n=V1(i,t);if(n.length)return n.unshift(e),n}return[]}class Uf{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function I0(i){const e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}class qO extends $O{constructor(e,t){super(e),this.snapshot=t,U1(this,e)}toString(){return this.snapshot.toString()}}function KO(i,e){const t=function pU(i,e){const a=new wC([],{},{},"",{},Oi,e,null,i.root,-1,{});return new YO("",new Uf(a,[]))}(i,e),n=new yd([new SE("",{})]),r=new yd({}),s=new yd({}),a=new yd({}),c=new yd(""),d=new D0(n,r,a,c,s,Oi,e,t.root);return d.snapshot=t.root,new qO(new Uf(d,[]),t)}class D0{constructor(e,t,n,r,s,a,c,d){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=a,this.component=c,this._futureSnapshot=d}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,St.U)(e=>A0(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,St.U)(e=>A0(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function ZO(i,e="emptyOnly"){const t=i.pathFromRoot;let n=0;if("always"!==e)for(n=t.length-1;n>=1;){const r=t[n],s=t[n-1];if(r.routeConfig&&""===r.routeConfig.path)n--;else{if(s.component)break;n--}}return function mU(i){return i.reduce((e,t)=>({params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}),{params:{},data:{},resolve:{}})}(t.slice(n))}class wC{constructor(e,t,n,r,s,a,c,d,f,g,v){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=a,this.component=c,this.routeConfig=d,this._urlSegment=f,this._lastPathIndex=g,this._resolve=v}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=A0(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=A0(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(n=>n.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class YO extends $O{constructor(e,t){super(t),this.url=e,U1(this,t)}toString(){return XO(this._root)}}function U1(i,e){e.value._routerState=i,e.children.forEach(t=>U1(i,t))}function XO(i){const e=i.children.length>0?` { ${i.children.map(XO).join(", ")} } `:"";return`${i.value}${e}`}function B1(i){if(i.snapshot){const e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,_h(e.queryParams,t.queryParams)||i.queryParams.next(t.queryParams),e.fragment!==t.fragment&&i.fragment.next(t.fragment),_h(e.params,t.params)||i.params.next(t.params),function XV(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!_h(i[t],e[t]))return!1;return!0}(e.url,t.url)||i.url.next(t.url),_h(e.data,t.data)||i.data.next(t.data)}else i.snapshot=i._futureSnapshot,i.data.next(i._futureSnapshot.data)}function H1(i,e){const t=_h(i.params,e.params)&&function nU(i,e){return Oy(i,e)&&i.every((t,n)=>_h(t.parameters,e[n].parameters))}(i.url,e.url);return t&&!(!i.parent!=!e.parent)&&(!i.parent||H1(i.parent,e.parent))}function ME(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){const n=t.value;n._futureSnapshot=e.value;const r=function yU(i,e,t){return e.children.map(n=>{for(const r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return ME(i,n,r);return ME(i,n)})}(i,e,t);return new Uf(n,r)}{if(i.shouldAttach(e.value)){const s=i.retrieve(e.value);if(null!==s){const a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(c=>ME(i,c)),a}}const n=function _U(i){return new D0(new yd(i.url),new yd(i.params),new yd(i.queryParams),new yd(i.fragment),new yd(i.data),i.outlet,i.component,i)}(e.value),r=e.children.map(s=>ME(i,s));return new Uf(n,r)}}function bC(i){return"object"==typeof i&&null!=i&&!i.outlets&&!i.segmentPath}function CE(i){return"object"==typeof i&&null!=i&&i.outlets}function z1(i,e,t,n,r){let s={};if(n&&Aa(n,(c,d)=>{s[d]=Array.isArray(c)?c.map(f=>`${f}`):`${c}`}),i===e)return new Ny(t,s,r);const a=JO(i,e,t);return new Ny(a,s,r)}function JO(i,e,t){const n={};return Aa(i.children,(r,s)=>{n[s]=r===e?t:JO(r,e,t)}),new Wi(i.segments,n)}class QO{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&bC(n[0]))throw new Error("Root segment cannot have matrix parameters");const r=n.find(CE);if(r&&r!==LO(n))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class G1{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}}function eL(i,e,t){if(i||(i=new Wi([],{})),0===i.segments.length&&i.hasChildren())return xC(i,e,t);const n=function SU(i,e,t){let n=0,r=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;const a=i.segments[r],c=t[n];if(CE(c))break;const d=`${c}`,f=n<t.length-1?t[n+1]:null;if(r>0&&void 0===d)break;if(d&&f&&"object"==typeof f&&void 0===f.outlets){if(!nL(d,f,a))return s;n+=2}else{if(!nL(d,{},a))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){const s=new Wi(i.segments.slice(0,n.pathIndex),{});return s.children[Oi]=new Wi(i.segments.slice(n.pathIndex),i.children),xC(s,0,r)}return n.match&&0===r.length?new Wi(i.segments,{}):n.match&&!i.hasChildren()?j1(i,e,t):n.match?xC(i,0,r):j1(i,e,t)}function xC(i,e,t){if(0===t.length)return new Wi(i.segments,{});{const n=function EU(i){return CE(i[0])?i[0].outlets:{[Oi]:i}}(t),r={};return Aa(n,(s,a)=>{"string"==typeof s&&(s=[s]),null!==s&&(r[a]=eL(i.children[a],e,s))}),Aa(i.children,(s,a)=>{void 0===n[a]&&(r[a]=s)}),new Wi(i.segments,r)}}function j1(i,e,t){const n=i.segments.slice(0,e);let r=0;for(;r<t.length;){const s=t[r];if(CE(s)){const d=TU(s.outlets);return new Wi(n,d)}if(0===r&&bC(t[0])){n.push(new SE(i.segments[e].path,tL(t[0]))),r++;continue}const a=CE(s)?s.outlets[Oi]:`${s}`,c=r<t.length-1?t[r+1]:null;a&&c&&bC(c)?(n.push(new SE(a,tL(c))),r+=2):(n.push(new SE(a,{})),r++)}return new Wi(n,{})}function TU(i){const e={};return Aa(i,(t,n)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[n]=j1(new Wi([],{}),0,t))}),e}function tL(i){const e={};return Aa(i,(t,n)=>e[n]=`${t}`),e}function nL(i,e,t){return i==t.path&&_h(e,t.parameters)}class CU{constructor(e,t,n,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r}activate(e){const t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),B1(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){const r=I0(t);e.children.forEach(s=>{const a=s.value.outlet;this.deactivateRoutes(s,r[a],n),delete r[a]}),Aa(r,(s,a)=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(r===s)if(r.component){const a=n.getContext(r.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=I0(e);for(const a of Object.keys(s))this.deactivateRouteAndItsChildren(s[a],r);if(n&&n.outlet){const a=n.outlet.detach(),c=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){const n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=I0(e);for(const a of Object.keys(s))this.deactivateRouteAndItsChildren(s[a],r);n&&n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated(),n.attachRef=null,n.resolver=null,n.route=null)}activateChildRoutes(e,t,n){const r=I0(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new qV(s.value.snapshot))}),e.children.length&&this.forwardEvent(new WV(e.value.snapshot))}activateRoutes(e,t,n){const r=e.value,s=t?t.value:null;if(B1(r),r===s)if(r.component){const a=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,n);else if(r.component){const a=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const c=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),a.children.onOutletReAttached(c.contexts),a.attachRef=c.componentRef,a.route=c.route.value,a.outlet&&a.outlet.attach(c.componentRef,c.route.value),B1(c.route.value),this.activateChildRoutes(e,null,a.children)}else{const c=function AU(i){for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig;if(t&&t.component)return null}return null}(r.snapshot),d=c?c.module.componentFactoryResolver:null;a.attachRef=null,a.route=r,a.resolver=d,a.outlet&&a.outlet.activateWith(r,d),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,n)}}class W1{constructor(e,t){this.routes=e,this.module=t}}function bm(i){return"function"==typeof i}function Ly(i){return i instanceof Ny}const AE=Symbol("INITIAL_VALUE");function IE(){return Ma(i=>function NV(...i){const e=(0,Nt.yG)(i),t=(0,Nt.jO)(i),{args:n,keys:r}=bO(i);if(0===n.length)return(0,Rt.D)([],e);const s=new Tt.y(function OV(i,e,t=rc.y){return n=>{SO(e,()=>{const{length:r}=i,s=new Array(r);let a=r,c=r;for(let d=0;d<r;d++)SO(e,()=>{const f=(0,Rt.D)(i[d],e);let g=!1;f.subscribe((0,cn.x)(n,v=>{s[d]=v,g||(g=!0,c--),c||n.next(t(s.slice()))},()=>{--a||n.complete()}))},n)},n)}}(n,e,r?a=>EO(r,a):rc.y));return t?s.pipe(xO(t)):s}(i.map(e=>e.pipe((0,Ay.q)(1),Ha(AE)))).pipe(lu((e,t)=>{let n=!1;return t.reduce((r,s,a)=>r!==AE?r:(s===AE&&(n=!0),n||!1!==s&&a!==t.length-1&&!Ly(s)?r:s),e)},AE),ri(e=>e!==AE),(0,St.U)(e=>Ly(e)?e:!0===e),(0,Ay.q)(1)))}class OU{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new DE,this.attachRef=null}}class DE{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new OU,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}let $1=(()=>{class i{constructor(t,n,r,s,a){this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=a,this.activated=null,this._activatedRoute=null,this.activateEvents=new w.vpe,this.deactivateEvents=new w.vpe,this.attachEvents=new w.vpe,this.detachEvents=new w.vpe,this.name=s||Oi,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,n){this.activated=t,this._activatedRoute=n,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,n){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=t;const a=(n=n||this.resolver).resolveComponentFactory(t._futureSnapshot.routeConfig.component),c=this.parentContexts.getOrCreateContext(this.name).children,d=new LU(t,c,this.location.injector);this.activated=this.location.createComponent(a,this.location.length,d),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return i.\u0275fac=function(t){return new(t||i)(w.Y36(DE),w.Y36(w.s_b),w.Y36(w._Vd),w.$8M("name"),w.Y36(w.sBO))},i.\u0275dir=w.lG2({type:i,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),i})();class LU{constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===D0?this.route:e===DE?this.childContexts:this.parent.get(e,t)}}let iL=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=w.Xpm({type:i,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,n){1&t&&w._UZ(0,"router-outlet")},directives:[$1],encapsulation:2}),i})();function rL(i,e=""){for(let t=0;t<i.length;t++){const n=i[t];kU(n,FU(e,n))}}function kU(i,e){i.children&&rL(i.children,e)}function FU(i,e){return e?i||e.path?i&&!e.path?`${i}/`:!i&&e.path?e.path:`${i}/${e.path}`:"":i}function q1(i){const e=i.children&&i.children.map(q1),t=e?Object.assign(Object.assign({},i),{children:e}):Object.assign({},i);return!t.component&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Oi&&(t.component=iL),t}function Ru(i){return i.outlet||Oi}function sL(i,e){const t=i.filter(n=>Ru(n)===e);return t.push(...i.filter(n=>Ru(n)!==e)),t}const oL={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function EC(i,e,t){var n;if(""===e.path)return"full"===e.pathMatch&&(i.hasChildren()||t.length>0)?Object.assign({},oL):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const s=(e.matcher||YV)(t,i,e);if(!s)return Object.assign({},oL);const a={};Aa(s.posParams,(d,f)=>{a[f]=d.path});const c=s.consumed.length>0?Object.assign(Object.assign({},a),s.consumed[s.consumed.length-1].parameters):a;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:c,positionalParamSegments:null!==(n=s.posParams)&&void 0!==n?n:{}}}function SC(i,e,t,n,r="corrected"){if(t.length>0&&function BU(i,e,t){return t.some(n=>TC(i,e,n)&&Ru(n)!==Oi)}(i,t,n)){const a=new Wi(e,function UU(i,e,t,n){const r={};r[Oi]=n,n._sourceSegment=i,n._segmentIndexShift=e.length;for(const s of t)if(""===s.path&&Ru(s)!==Oi){const a=new Wi([],{});a._sourceSegment=i,a._segmentIndexShift=e.length,r[Ru(s)]=a}return r}(i,e,n,new Wi(t,i.children)));return a._sourceSegment=i,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:[]}}if(0===t.length&&function HU(i,e,t){return t.some(n=>TC(i,e,n))}(i,t,n)){const a=new Wi(i.segments,function VU(i,e,t,n,r,s){const a={};for(const c of n)if(TC(i,t,c)&&!r[Ru(c)]){const d=new Wi([],{});d._sourceSegment=i,d._segmentIndexShift="legacy"===s?i.segments.length:e.length,a[Ru(c)]=d}return Object.assign(Object.assign({},r),a)}(i,e,t,n,i.children,r));return a._sourceSegment=i,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}const s=new Wi(i.segments,i.children);return s._sourceSegment=i,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function TC(i,e,t){return(!(i.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function aL(i,e,t,n){return!!(Ru(i)===n||n!==Oi&&TC(e,t,i))&&("**"===i.path||EC(e,i,t).matched)}function lL(i,e,t){return 0===e.length&&!i.children[t]}class MC{constructor(e){this.segmentGroup=e||null}}class cL{constructor(e){this.urlTree=e}}function RE(i){return pC(new MC(i))}function uL(i){return pC(new cL(i))}function zU(i){return pC(new Error(`Only absolute redirects can have named outlets. redirectTo: '${i}'`))}class WU{constructor(e,t,n,r,s){this.configLoader=t,this.urlSerializer=n,this.urlTree=r,this.config=s,this.allowRedirects=!0,this.ngModule=e.get(w.h0i)}apply(){const e=SC(this.urlTree.root,[],[],this.config).segmentGroup,t=new Wi(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,t,Oi).pipe((0,St.U)(s=>this.createUrlTree(K1(s),this.urlTree.queryParams,this.urlTree.fragment))).pipe(wm(s=>{if(s instanceof cL)return this.allowRedirects=!1,this.match(s.urlTree);throw s instanceof MC?this.noMatchError(s):s}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,Oi).pipe((0,St.U)(r=>this.createUrlTree(K1(r),e.queryParams,e.fragment))).pipe(wm(r=>{throw r instanceof MC?this.noMatchError(r):r}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,t,n){const r=e.segments.length>0?new Wi([],{[Oi]:e}):e;return new Ny(r,t,n)}expandSegmentGroup(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe((0,St.U)(s=>new Wi([],s))):this.expandSegment(e,n,t,n.segments,r,!0)}expandChildren(e,t,n){const r=[];for(const s of Object.keys(n.children))"primary"===s?r.unshift(s):r.push(s);return(0,Rt.D)(r).pipe(bn(s=>{const a=n.children[s],c=sL(t,s);return this.expandSegmentGroup(e,c,a,s).pipe((0,St.U)(d=>({segment:d,outlet:s})))}),lu((s,a)=>(s[a.outlet]=a.segment,s),{}),function kV(i,e){const t=arguments.length>=2;return n=>n.pipe(i?ri((r,s)=>i(r,s,n)):rc.y,N1(1),t?x0(e):iC(()=>new Cy))}())}expandSegment(e,t,n,r,s,a){return(0,Rt.D)(n).pipe(bn(c=>this.expandSegmentAgainstRoute(e,t,n,c,r,s,a).pipe(wm(f=>{if(f instanceof MC)return qe(null);throw f}))),gd(c=>!!c),wm((c,d)=>{if(c instanceof Cy||"EmptyError"===c.name)return lL(t,r,s)?qe(new Wi([],{})):RE(t);throw c}))}expandSegmentAgainstRoute(e,t,n,r,s,a,c){return aL(r,t,s,a)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,s,a):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,a):RE(t):RE(t)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,a){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,a):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,a)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,n,r){const s=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?uL(s):this.lineralizeSegments(n,s).pipe((0,En.z)(a=>{const c=new Wi(a,{});return this.expandSegment(e,c,t,a,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,s,a){const{matched:c,consumedSegments:d,remainingSegments:f,positionalParamSegments:g}=EC(t,r,s);if(!c)return RE(t);const v=this.applyRedirectCommands(d,r.redirectTo,g);return r.redirectTo.startsWith("/")?uL(v):this.lineralizeSegments(r,v).pipe((0,En.z)(b=>this.expandSegment(e,t,n,b.concat(f),a,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){if("**"===n.path)return n.loadChildren?(n._loadedConfig?qe(n._loadedConfig):this.configLoader.load(e.injector,n)).pipe((0,St.U)(v=>(n._loadedConfig=v,new Wi(r,{})))):qe(new Wi(r,{}));const{matched:a,consumedSegments:c,remainingSegments:d}=EC(t,n,r);return a?this.getChildConfig(e,n,r).pipe((0,En.z)(g=>{const v=g.module,b=g.routes,{segmentGroup:x,slicedSegments:C}=SC(t,c,d,b),I=new Wi(x.segments,x.children);if(0===C.length&&I.hasChildren())return this.expandChildren(v,b,I).pipe((0,St.U)(z=>new Wi(c,z)));if(0===b.length&&0===C.length)return qe(new Wi(c,{}));const D=Ru(n)===s;return this.expandSegment(v,I,b,C,D?Oi:s,!0).pipe((0,St.U)(V=>new Wi(c.concat(V.segments),V.children)))})):RE(t)}getChildConfig(e,t,n){return t.children?qe(new W1(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?qe(t._loadedConfig):this.runCanLoadGuards(e.injector,t,n).pipe((0,En.z)(r=>r?this.configLoader.load(e.injector,t).pipe((0,St.U)(s=>(t._loadedConfig=s,s))):function GU(i){return pC(L1(`Cannot load children because the guard of the route "path: '${i.path}'" returned false`))}(t))):qe(new W1([],e))}runCanLoadGuards(e,t,n){const r=t.canLoad;if(!r||0===r.length)return qe(!0);const s=r.map(a=>{const c=e.get(a);let d;if(function DU(i){return i&&bm(i.canLoad)}(c))d=c.canLoad(t,n);else{if(!bm(c))throw new Error("Invalid CanLoad guard");d=c(t,n)}return vh(d)});return qe(s).pipe(IE(),(0,Kc.b)(a=>{if(!Ly(a))return;const c=L1(`Redirecting to "${this.urlSerializer.serialize(a)}"`);throw c.url=a,c}),(0,St.U)(a=>!0===a))}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return qe(n);if(r.numberOfChildren>1||!r.children[Oi])return zU(e.redirectTo);r=r.children[Oi]}}applyRedirectCommands(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}applyRedirectCreatreUrlTree(e,t,n,r){const s=this.createSegmentGroup(e,t.root,n,r);return new Ny(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const n={};return Aa(e,(r,s)=>{if("string"==typeof r&&r.startsWith(":")){const c=r.substring(1);n[s]=t[c]}else n[s]=r}),n}createSegmentGroup(e,t,n,r){const s=this.createSegments(e,t.segments,n,r);let a={};return Aa(t.children,(c,d)=>{a[d]=this.createSegmentGroup(e,c,n,r)}),new Wi(s,a)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){const r=n[t.path.substring(1)];if(!r)throw new Error(`Cannot redirect to '${e}'. Cannot find '${t.path}'.`);return r}findOrReturn(e,t){let n=0;for(const r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}}function K1(i){const e={};for(const n of Object.keys(i.children)){const s=K1(i.children[n]);(s.segments.length>0||s.hasChildren())&&(e[n]=s)}return function $U(i){if(1===i.numberOfChildren&&i.children[Oi]){const e=i.children[Oi];return new Wi(i.segments.concat(e.segments),e.children)}return i}(new Wi(i.segments,e))}class dL{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class CC{constructor(e,t){this.component=e,this.route=t}}function KU(i,e,t){const n=i._root;return PE(n,e?e._root:null,t,[n.value])}function AC(i,e,t){const n=function YU(i){if(!i)return null;for(let e=i.parent;e;e=e.parent){const t=e.routeConfig;if(t&&t._loadedConfig)return t._loadedConfig}return null}(e);return(n?n.module.injector:t).get(i)}function PE(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=I0(e);return i.children.forEach(a=>{(function XU(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){const s=i.value,a=e?e.value:null,c=t?t.getContext(i.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){const d=function JU(i,e,t){if("function"==typeof t)return t(i,e);switch(t){case"pathParamsChange":return!Oy(i.url,e.url);case"pathParamsOrQueryParamsChange":return!Oy(i.url,e.url)||!_h(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!H1(i,e)||!_h(i.queryParams,e.queryParams);default:return!H1(i,e)}}(a,s,s.routeConfig.runGuardsAndResolvers);d?r.canActivateChecks.push(new dL(n)):(s.data=a.data,s._resolvedData=a._resolvedData),PE(i,e,s.component?c?c.children:null:t,n,r),d&&c&&c.outlet&&c.outlet.isActivated&&r.canDeactivateChecks.push(new CC(c.outlet.component,a))}else a&&NE(e,c,r),r.canActivateChecks.push(new dL(n)),PE(i,null,s.component?c?c.children:null:t,n,r)})(a,s[a.value.outlet],t,n.concat([a.value]),r),delete s[a.value.outlet]}),Aa(s,(a,c)=>NE(a,t.getContext(c),r)),r}function NE(i,e,t){const n=I0(i),r=i.value;Aa(n,(s,a)=>{NE(s,r.component?e?e.children.getContext(a):null:e,t)}),t.canDeactivateChecks.push(new CC(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}class aB{}function hL(i){return new Tt.y(e=>e.error(i))}class cB{constructor(e,t,n,r,s,a){this.rootComponentType=e,this.config=t,this.urlTree=n,this.url=r,this.paramsInheritanceStrategy=s,this.relativeLinkResolution=a}recognize(){const e=SC(this.urlTree.root,[],[],this.config.filter(a=>void 0===a.redirectTo),this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,Oi);if(null===t)return null;const n=new wC([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Oi,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Uf(n,t),s=new YO(this.url,r);return this.inheritParamsAndData(s._root),s}inheritParamsAndData(e){const t=e.value,n=ZO(t,this.paramsInheritanceStrategy);t.params=Object.freeze(n.params),t.data=Object.freeze(n.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}processChildren(e,t){const n=[];for(const s of Object.keys(t.children)){const a=t.children[s],c=sL(e,s),d=this.processSegmentGroup(c,a,s);if(null===d)return null;n.push(...d)}const r=fL(n);return function uB(i){i.sort((e,t)=>e.value.outlet===Oi?-1:t.value.outlet===Oi?1:e.value.outlet.localeCompare(t.value.outlet))}(r),r}processSegment(e,t,n,r){for(const s of e){const a=this.processSegmentAgainstRoute(s,t,n,r);if(null!==a)return a}return lL(t,n,r)?[]:null}processSegmentAgainstRoute(e,t,n,r){if(e.redirectTo||!aL(e,t,n,r))return null;let s,a=[],c=[];if("**"===e.path){const x=n.length>0?LO(n).parameters:{};s=new wC(n,x,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,gL(e),Ru(e),e.component,e,pL(t),mL(t)+n.length,yL(e))}else{const x=EC(t,e,n);if(!x.matched)return null;a=x.consumedSegments,c=x.remainingSegments,s=new wC(a,x.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,gL(e),Ru(e),e.component,e,pL(t),mL(t)+a.length,yL(e))}const d=function dB(i){return i.children?i.children:i.loadChildren?i._loadedConfig.routes:[]}(e),{segmentGroup:f,slicedSegments:g}=SC(t,a,c,d.filter(x=>void 0===x.redirectTo),this.relativeLinkResolution);if(0===g.length&&f.hasChildren()){const x=this.processChildren(d,f);return null===x?null:[new Uf(s,x)]}if(0===d.length&&0===g.length)return[new Uf(s,[])];const v=Ru(e)===r,b=this.processSegment(d,f,g,v?Oi:r);return null===b?null:[new Uf(s,b)]}}function hB(i){const e=i.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function fL(i){const e=[],t=new Set;for(const n of i){if(!hB(n)){e.push(n);continue}const r=e.find(s=>n.value.routeConfig===s.value.routeConfig);void 0!==r?(r.children.push(...n.children),t.add(r)):e.push(n)}for(const n of t){const r=fL(n.children);e.push(new Uf(n.value,r))}return e.filter(n=>!t.has(n))}function pL(i){let e=i;for(;e._sourceSegment;)e=e._sourceSegment;return e}function mL(i){let e=i,t=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift?e._segmentIndexShift:0;return t-1}function gL(i){return i.data||{}}function yL(i){return i.resolve||{}}function _L(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function Z1(i){return Ma(e=>{const t=i(e);return t?(0,Rt.D)(t).pipe((0,St.U)(()=>e)):qe(e)})}class wB extends class vB{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Y1=new w.OlP("ROUTES");class vL{constructor(e,t,n,r){this.injector=e,this.compiler=t,this.onLoadStartListener=n,this.onLoadEndListener=r}load(e,t){if(t._loader$)return t._loader$;this.onLoadStartListener&&this.onLoadStartListener(t);const r=this.loadModuleFactory(t.loadChildren).pipe((0,St.U)(s=>{this.onLoadEndListener&&this.onLoadEndListener(t);const a=s.create(e);return new W1(OO(a.injector.get(Y1,void 0,w.XFs.Self|w.XFs.Optional)).map(q1),a)}),wm(s=>{throw t._loader$=void 0,s}));return t._loader$=new LV(r,()=>new Lf.x).pipe(CO()),t._loader$}loadModuleFactory(e){return vh(e()).pipe((0,En.z)(t=>t instanceof w.YKP?qe(t):(0,Rt.D)(this.compiler.compileModuleAsync(t))))}}class xB{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function EB(i){throw i}function SB(i,e,t){return e.parse("/")}function wL(i,e){return qe(null)}const TB={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},MB={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Tl=(()=>{class i{constructor(t,n,r,s,a,c,d){this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=s,this.config=d,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Lf.x,this.errorHandler=EB,this.malformedUriErrorHandler=SB,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:wL,afterPreactivation:wL},this.urlHandlingStrategy=new xB,this.routeReuseStrategy=new wB,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=a.get(w.h0i),this.console=a.get(w.c2e);const v=a.get(w.R0b);this.isNgZoneEnabled=v instanceof w.R0b&&w.R0b.isInAngularZone(),this.resetConfig(d),this.currentUrlTree=function JV(){return new Ny(new Wi([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new vL(a,c,b=>this.triggerEvent(new IO(b)),b=>this.triggerEvent(new DO(b))),this.routerState=KO(this.currentUrlTree,this.rootComponentType),this.transitions=new yd({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const n=this.events;return t.pipe(ri(r=>0!==r.id),(0,St.U)(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Ma(r=>{let s=!1,a=!1;return qe(r).pipe((0,Kc.b)(c=>{this.currentNavigation={id:c.id,initialUrl:c.currentRawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Ma(c=>{const d=this.browserUrlTree.toString(),f=!this.navigated||c.extractedUrl.toString()!==d||d!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||f)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return bL(c.source)&&(this.browserUrlTree=c.extractedUrl),qe(c).pipe(Ma(v=>{const b=this.transitions.getValue();return n.next(new O1(v.id,this.serializeUrl(v.extractedUrl),v.source,v.restoredState)),b!==this.transitions.getValue()?C0.E:Promise.resolve(v)}),function qU(i,e,t,n){return Ma(r=>function jU(i,e,t,n,r){return new WU(i,e,t,n,r).apply()}(i,e,t,r.extractedUrl,n).pipe((0,St.U)(s=>Object.assign(Object.assign({},r),{urlAfterRedirects:s}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,Kc.b)(v=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:v.urlAfterRedirects})}),function fB(i,e,t,n,r){return(0,En.z)(s=>function lB(i,e,t,n,r="emptyOnly",s="legacy"){try{const a=new cB(i,e,t,n,r,s).recognize();return null===a?hL(new aB):qe(a)}catch(a){return hL(a)}}(i,e,s.urlAfterRedirects,t(s.urlAfterRedirects),n,r).pipe((0,St.U)(a=>Object.assign(Object.assign({},s),{targetSnapshot:a}))))}(this.rootComponentType,this.config,v=>this.serializeUrl(v),this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,Kc.b)(v=>{if("eager"===this.urlUpdateStrategy){if(!v.extras.skipLocationChange){const x=this.urlHandlingStrategy.merge(v.urlAfterRedirects,v.rawUrl);this.setBrowserUrl(x,v)}this.browserUrlTree=v.urlAfterRedirects}const b=new UV(v.id,this.serializeUrl(v.extractedUrl),this.serializeUrl(v.urlAfterRedirects),v.targetSnapshot);n.next(b)}));if(f&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:b,extractedUrl:x,source:C,restoredState:I,extras:D}=c,L=new O1(b,this.serializeUrl(x),C,I);n.next(L);const V=KO(x,this.rootComponentType).snapshot;return qe(Object.assign(Object.assign({},c),{targetSnapshot:V,urlAfterRedirects:x,extras:Object.assign(Object.assign({},D),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=c.rawUrl,c.resolve(null),C0.E}),Z1(c=>{const{targetSnapshot:d,id:f,extractedUrl:g,rawUrl:v,extras:{skipLocationChange:b,replaceUrl:x}}=c;return this.hooks.beforePreactivation(d,{navigationId:f,appliedUrlTree:g,rawUrlTree:v,skipLocationChange:!!b,replaceUrl:!!x})}),(0,Kc.b)(c=>{const d=new BV(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(d)}),(0,St.U)(c=>Object.assign(Object.assign({},c),{guards:KU(c.targetSnapshot,c.currentSnapshot,this.rootContexts)})),function QU(i,e){return(0,En.z)(t=>{const{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return 0===a.length&&0===s.length?qe(Object.assign(Object.assign({},t),{guardsResult:!0})):function eB(i,e,t,n){return(0,Rt.D)(i).pipe((0,En.z)(r=>function oB(i,e,t,n,r){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?qe(s.map(c=>{const d=AC(c,e,r);let f;if(function NU(i){return i&&bm(i.canDeactivate)}(d))f=vh(d.canDeactivate(i,e,t,n));else{if(!bm(d))throw new Error("Invalid CanDeactivate guard");f=vh(d(i,e,t,n))}return f.pipe(gd())})).pipe(IE()):qe(!0)}(r.component,r.route,t,e,n)),gd(r=>!0!==r,!0))}(a,n,r,i).pipe((0,En.z)(c=>c&&function IU(i){return"boolean"==typeof i}(c)?function tB(i,e,t,n){return(0,Rt.D)(e).pipe(bn(r=>ic(function iB(i,e){return null!==i&&e&&e(new jV(i)),qe(!0)}(r.route.parent,n),function nB(i,e){return null!==i&&e&&e(new $V(i)),qe(!0)}(r.route,n),function sB(i,e,t){const n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>function ZU(i){const e=i.routeConfig?i.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:i,guards:e}:null}(a)).filter(a=>null!==a).map(a=>TO(()=>qe(a.guards.map(d=>{const f=AC(d,a.node,t);let g;if(function PU(i){return i&&bm(i.canActivateChild)}(f))g=vh(f.canActivateChild(n,i));else{if(!bm(f))throw new Error("Invalid CanActivateChild guard");g=vh(f(n,i))}return g.pipe(gd())})).pipe(IE())));return qe(s).pipe(IE())}(i,r.path,t),function rB(i,e,t){const n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||0===n.length)return qe(!0);const r=n.map(s=>TO(()=>{const a=AC(s,e,t);let c;if(function RU(i){return i&&bm(i.canActivate)}(a))c=vh(a.canActivate(e,i));else{if(!bm(a))throw new Error("Invalid CanActivate guard");c=vh(a(e,i))}return c.pipe(gd())}));return qe(r).pipe(IE())}(i,r.route,t))),gd(r=>!0!==r,!0))}(n,s,i,e):qe(c)),(0,St.U)(c=>Object.assign(Object.assign({},t),{guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),(0,Kc.b)(c=>{if(Ly(c.guardsResult)){const f=L1(`Redirecting to "${this.serializeUrl(c.guardsResult)}"`);throw f.url=c.guardsResult,f}const d=new HV(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(d)}),ri(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,""),!1)),Z1(c=>{if(c.guards.canActivateChecks.length)return qe(c).pipe((0,Kc.b)(d=>{const f=new zV(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);this.triggerEvent(f)}),Ma(d=>{let f=!1;return qe(d).pipe(function pB(i,e){return(0,En.z)(t=>{const{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return qe(t);let s=0;return(0,Rt.D)(r).pipe(bn(a=>function mB(i,e,t,n){return function gB(i,e,t,n){const r=_L(i);if(0===r.length)return qe({});const s={};return(0,Rt.D)(r).pipe((0,En.z)(a=>function yB(i,e,t,n){const r=AC(i,e,n);return vh(r.resolve?r.resolve(e,t):r(e,t))}(i[a],e,t,n).pipe((0,Kc.b)(c=>{s[a]=c}))),N1(1),(0,En.z)(()=>_L(s).length===r.length?qe(s):C0.E))}(i._resolve,i,e,n).pipe((0,St.U)(s=>(i._resolvedData=s,i.data=Object.assign(Object.assign({},i.data),ZO(i,t).resolve),null)))}(a.route,n,i,e)),(0,Kc.b)(()=>s++),N1(1),(0,En.z)(a=>s===r.length?qe(t):C0.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,Kc.b)({next:()=>f=!0,complete:()=>{f||(this.restoreHistory(d),this.cancelNavigationTransition(d,"At least one route resolver didn't emit any value."))}}))}),(0,Kc.b)(d=>{const f=new GV(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);this.triggerEvent(f)}))}),Z1(c=>{const{targetSnapshot:d,id:f,extractedUrl:g,rawUrl:v,extras:{skipLocationChange:b,replaceUrl:x}}=c;return this.hooks.afterPreactivation(d,{navigationId:f,appliedUrlTree:g,rawUrlTree:v,skipLocationChange:!!b,replaceUrl:!!x})}),(0,St.U)(c=>{const d=function gU(i,e,t){const n=ME(i,e._root,t?t._root:void 0);return new qO(n,e)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return Object.assign(Object.assign({},c),{targetRouterState:d})}),(0,Kc.b)(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((i,e,t)=>(0,St.U)(n=>(new CU(e,n.targetRouterState,n.currentRouterState,t).activate(i),n)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),(0,Kc.b)({next(){s=!0},complete(){s=!0}}),function FV(i){return(0,vn.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}(()=>{var c;s||a||this.cancelNavigationTransition(r,`Navigation ID ${r.id} is not equal to the current navigation id ${this.navigationId}`),(null===(c=this.currentNavigation)||void 0===c?void 0:c.id)===r.id&&(this.currentNavigation=null)}),wm(c=>{if(a=!0,function ZV(i){return i&&i[PO]}(c)){const d=Ly(c.url);d||(this.navigated=!0,this.restoreHistory(r,!0));const f=new AO(r.id,this.serializeUrl(r.extractedUrl),c.message);n.next(f),d?setTimeout(()=>{const g=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),v={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||bL(r.source)};this.scheduleNavigation(g,"imperative",null,v,{resolve:r.resolve,reject:r.reject,promise:r.promise})},0):r.resolve(!1)}else{this.restoreHistory(r,!0);const d=new VV(r.id,this.serializeUrl(r.extractedUrl),c);n.next(d);try{r.resolve(this.errorHandler(c))}catch(f){r.reject(f)}}return C0.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const n="popstate"===t.type?"popstate":"hashchange";"popstate"===n&&setTimeout(()=>{var r;const s={replaceUrl:!0},a=(null===(r=t.state)||void 0===r?void 0:r.navigationId)?t.state:null;if(a){const d=Object.assign({},a);delete d.navigationId,delete d.\u0275routerPageId,0!==Object.keys(d).length&&(s.state=d)}const c=this.parseUrl(t.url);this.scheduleNavigation(c,n,a,s)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){rL(t),this.config=t.map(q1),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,n={}){const{relativeTo:r,queryParams:s,fragment:a,queryParamsHandling:c,preserveFragment:d}=n,f=r||this.routerState.root,g=d?this.currentUrlTree.fragment:a;let v=null;switch(c){case"merge":v=Object.assign(Object.assign({},this.currentUrlTree.queryParams),s);break;case"preserve":v=this.currentUrlTree.queryParams;break;default:v=s||null}return null!==v&&(v=this.removeEmptyProps(v)),function vU(i,e,t,n,r){if(0===t.length)return z1(e.root,e.root,e.root,n,r);const s=function wU(i){if("string"==typeof i[0]&&1===i.length&&"/"===i[0])return new QO(!0,0,i);let e=0,t=!1;const n=i.reduce((r,s,a)=>{if("object"==typeof s&&null!=s){if(s.outlets){const c={};return Aa(s.outlets,(d,f)=>{c[f]="string"==typeof d?d.split("/"):d}),[...r,{outlets:c}]}if(s.segmentPath)return[...r,s.segmentPath]}return"string"!=typeof s?[...r,s]:0===a?(s.split("/").forEach((c,d)=>{0==d&&"."===c||(0==d&&""===c?t=!0:".."===c?e++:""!=c&&r.push(c))}),r):[...r,s]},[]);return new QO(t,e,n)}(t);if(s.toRoot())return z1(e.root,e.root,new Wi([],{}),n,r);const a=function bU(i,e,t){if(i.isAbsolute)return new G1(e.root,!0,0);if(-1===t.snapshot._lastPathIndex){const s=t.snapshot._urlSegment;return new G1(s,s===e.root,0)}const n=bC(i.commands[0])?0:1;return function xU(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new Error("Invalid number of '../'");r=n.segments.length}return new G1(n,!1,r-s)}(t.snapshot._urlSegment,t.snapshot._lastPathIndex+n,i.numberOfDoubleDots)}(s,e,i),c=a.processChildren?xC(a.segmentGroup,a.index,s.commands):eL(a.segmentGroup,a.index,s.commands);return z1(e.root,a.segmentGroup,c,n,r)}(f,this.currentUrlTree,t,v,null!=g?g:null)}navigateByUrl(t,n={skipLocationChange:!1}){const r=Ly(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(s,"imperative",null,n)}navigate(t,n={skipLocationChange:!1}){return function CB(i){for(let e=0;e<i.length;e++){const t=i[e];if(null==t)throw new Error(`The requested path contains ${t} segment at index ${e}`)}}(t),this.navigateByUrl(this.createUrlTree(t,n),n)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let n;try{n=this.urlSerializer.parse(t)}catch(r){n=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return n}isActive(t,n){let r;if(r=!0===n?Object.assign({},TB):!1===n?Object.assign({},MB):n,Ly(t))return FO(this.currentUrlTree,t,r);const s=this.parseUrl(t);return FO(this.currentUrlTree,s,r)}removeEmptyProps(t){return Object.keys(t).reduce((n,r)=>{const s=t[r];return null!=s&&(n[r]=s),n},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new EE(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,n,r,s,a){var c,d;if(this.disposed)return Promise.resolve(!1);let f,g,v;a?(f=a.resolve,g=a.reject,v=a.promise):v=new Promise((C,I)=>{f=C,g=I});const b=++this.navigationId;let x;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),x=r&&r.\u0275routerPageId?r.\u0275routerPageId:s.replaceUrl||s.skipLocationChange?null!==(c=this.browserPageId)&&void 0!==c?c:0:(null!==(d=this.browserPageId)&&void 0!==d?d:0)+1):x=0,this.setTransition({id:b,targetPageId:x,source:n,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:s,resolve:f,reject:g,promise:v,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),v.catch(C=>Promise.reject(C))}setBrowserUrl(t,n){const r=this.urlSerializer.serialize(t),s=Object.assign(Object.assign({},n.extras.state),this.generateNgRouterState(n.id,n.targetPageId));this.location.isCurrentPathEqualTo(r)||n.extras.replaceUrl?this.location.replaceState(r,"",s):this.location.go(r,"",s)}restoreHistory(t,n=!1){var r,s;if("computed"===this.canceledNavigationResolution){const a=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===a?this.currentUrlTree===(null===(s=this.currentNavigation)||void 0===s?void 0:s.finalUrl)&&0===a&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(a)}else"replace"===this.canceledNavigationResolution&&(n&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,n){const r=new AO(t.id,this.serializeUrl(t.extractedUrl),n);this.triggerEvent(r),t.resolve(!1)}generateNgRouterState(t,n){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:n}:{navigationId:t}}}return i.\u0275fac=function(t){w.$Z()},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();function bL(i){return"imperative"!==i}class xL{}class EL{preload(e,t){return qe(null)}}let SL=(()=>{class i{constructor(t,n,r,s){this.router=t,this.injector=r,this.preloadingStrategy=s,this.loader=new vL(r,n,d=>t.triggerEvent(new IO(d)),d=>t.triggerEvent(new DO(d)))}setUpPreloading(){this.subscription=this.router.events.pipe(ri(t=>t instanceof EE),bn(()=>this.preload())).subscribe(()=>{})}preload(){const t=this.injector.get(w.h0i);return this.processRoutes(t,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,n){const r=[];for(const s of n)if(s.loadChildren&&!s.canLoad&&s._loadedConfig){const a=s._loadedConfig;r.push(this.processRoutes(a.module,a.routes))}else s.loadChildren&&!s.canLoad?r.push(this.preloadConfig(t,s)):s.children&&r.push(this.processRoutes(t,s.children));return(0,Rt.D)(r).pipe((0,fl.J)(),(0,St.U)(s=>{}))}preloadConfig(t,n){return this.preloadingStrategy.preload(n,()=>(n._loadedConfig?qe(n._loadedConfig):this.loader.load(t.injector,n)).pipe((0,En.z)(s=>(n._loadedConfig=s,this.processRoutes(s.module,s.routes)))))}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(Tl),w.LFG(w.Sil),w.LFG(w.zs3),w.LFG(xL))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})(),Q1=(()=>{class i{constructor(t,n,r={}){this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof O1?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof EE&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof RO&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,n){this.router.triggerEvent(new RO(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,n))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return i.\u0275fac=function(t){w.$Z()},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();const ky=new w.OlP("ROUTER_CONFIGURATION"),TL=new w.OlP("ROUTER_FORROOT_GUARD"),RB=[Ye,{provide:HO,useClass:zO},{provide:Tl,useFactory:function kB(i,e,t,n,r,s,a={},c,d){const f=new Tl(null,i,e,t,n,r,OO(s));return c&&(f.urlHandlingStrategy=c),d&&(f.routeReuseStrategy=d),function FB(i,e){i.errorHandler&&(e.errorHandler=i.errorHandler),i.malformedUriErrorHandler&&(e.malformedUriErrorHandler=i.malformedUriErrorHandler),i.onSameUrlNavigation&&(e.onSameUrlNavigation=i.onSameUrlNavigation),i.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=i.paramsInheritanceStrategy),i.relativeLinkResolution&&(e.relativeLinkResolution=i.relativeLinkResolution),i.urlUpdateStrategy&&(e.urlUpdateStrategy=i.urlUpdateStrategy),i.canceledNavigationResolution&&(e.canceledNavigationResolution=i.canceledNavigationResolution)}(a,f),a.enableTracing&&f.events.subscribe(g=>{var v,b;null===(v=console.group)||void 0===v||v.call(console,`Router Event: ${g.constructor.name}`),console.log(g.toString()),console.log(g),null===(b=console.groupEnd)||void 0===b||b.call(console)}),f},deps:[HO,DE,Ye,w.zs3,w.Sil,Y1,ky,[class bB{},new w.FiY],[class _B{},new w.FiY]]},DE,{provide:D0,useFactory:function VB(i){return i.routerState.root},deps:[Tl]},SL,EL,class DB{preload(e,t){return t().pipe(wm(()=>qe(null)))}},{provide:ky,useValue:{enableTracing:!1}}];function PB(){return new w.PXZ("Router",Tl)}let ML=(()=>{class i{constructor(t,n){}static forRoot(t,n){return{ngModule:i,providers:[RB,CL(t),{provide:TL,useFactory:LB,deps:[[Tl,new w.FiY,new w.tp0]]},{provide:ky,useValue:n||{}},{provide:ze,useFactory:OB,deps:[Ne,[new w.tBr(qt),new w.FiY],ky]},{provide:Q1,useFactory:NB,deps:[Tl,Hu,ky]},{provide:xL,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:EL},{provide:w.PXZ,multi:!0,useFactory:PB},[eR,{provide:w.ip1,multi:!0,useFactory:UB,deps:[eR]},{provide:AL,useFactory:BB,deps:[eR]},{provide:w.tb,multi:!0,useExisting:AL}]]}}static forChild(t){return{ngModule:i,providers:[CL(t)]}}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(TL,8),w.LFG(Tl,8))},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({}),i})();function NB(i,e,t){return t.scrollOffset&&e.setOffset(t.scrollOffset),new Q1(i,e,t)}function OB(i,e,t={}){return t.useHash?new lt(i,e):new nn(i,e)}function LB(i){return"guarded"}function CL(i){return[{provide:w.deG,multi:!0,useValue:i},{provide:Y1,multi:!0,useValue:i}]}let eR=(()=>{class i{constructor(t){this.injector=t,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Lf.x}appInitializer(){return this.injector.get(ue,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let n=null;const r=new Promise(c=>n=c),s=this.injector.get(Tl),a=this.injector.get(ky);return"disabled"===a.initialNavigation?(s.setUpLocationChangeListener(),n(!0)):"enabled"===a.initialNavigation||"enabledBlocking"===a.initialNavigation?(s.hooks.afterPreactivation=()=>this.initNavigation?qe(null):(this.initNavigation=!0,n(!0),this.resultOfPreactivationDone),s.initialNavigation()):n(!0),r})}bootstrapListener(t){const n=this.injector.get(ky),r=this.injector.get(SL),s=this.injector.get(Q1),a=this.injector.get(Tl),c=this.injector.get(w.z2F);t===c.components[0]&&(("enabledNonBlocking"===n.initialNavigation||void 0===n.initialNavigation)&&a.initialNavigation(),r.setUpPreloading(),s.init(),a.resetRootComponentType(c.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(w.zs3))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac}),i})();function UB(i){return i.appInitializer.bind(i)}function BB(i){return i.bootstrapListener.bind(i)}const AL=new w.OlP("Router Initializer"),Hy=1e3,Ml=1001,Do=1003,$s=1006,Em=1008,zy=1009,Gy=1014,Sm=1015,FE=1016,k0=1020,Nu=1023,jy=1026,F0=1027,VE=2300,V0=2301,Wy=3e3,yr=3001,Hf="srgb",qy="srgb-linear";class Ky{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const s=r.indexOf(t);-1!==s&&r.splice(s,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const n=this._listeners[e.type];if(void 0!==n){e.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const Ia=[];for(let i=0;i<256;i++)Ia[i]=(i<16?"0":"")+i.toString(16);let ck=1234567;const Zy=Math.PI/180,UE=180/Math.PI;function Zc(){const i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(Ia[255&i]+Ia[i>>8&255]+Ia[i>>16&255]+Ia[i>>24&255]+"-"+Ia[255&e]+Ia[e>>8&255]+"-"+Ia[e>>16&15|64]+Ia[e>>24&255]+"-"+Ia[63&t|128]+Ia[t>>8&255]+"-"+Ia[t>>16&255]+Ia[t>>24&255]+Ia[255&n]+Ia[n>>8&255]+Ia[n>>16&255]+Ia[n>>24&255]).toLowerCase()}function ho(i,e,t){return Math.max(e,Math.min(t,i))}function pR(i,e){return(i%e+e)%e}function BE(i,e,t){return(1-t)*i+t*e}function mR(i){return 0==(i&i-1)&&0!==i}function uk(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function LC(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}var nz=Object.freeze({__proto__:null,DEG2RAD:Zy,RAD2DEG:UE,generateUUID:Zc,clamp:ho,euclideanModulo:pR,mapLinear:function HH(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)},inverseLerp:function zH(i,e,t){return i!==e?(t-i)/(e-i):0},lerp:BE,damp:function GH(i,e,t,n){return BE(i,e,1-Math.exp(-t*n))},pingpong:function jH(i,e=1){return e-Math.abs(pR(i,2*e)-e)},smoothstep:function WH(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*(3-2*i)},smootherstep:function $H(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e))*i*i*(i*(6*i-15)+10)},randInt:function qH(i,e){return i+Math.floor(Math.random()*(e-i+1))},randFloat:function KH(i,e){return i+Math.random()*(e-i)},randFloatSpread:function ZH(i){return i*(.5-Math.random())},seededRandom:function YH(i){void 0!==i&&(ck=i);let e=ck+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296},degToRad:function XH(i){return i*Zy},radToDeg:function JH(i){return i*UE},isPowerOfTwo:mR,ceilPowerOfTwo:uk,floorPowerOfTwo:LC,setQuaternionFromProperEuler:function QH(i,e,t,n,r){const s=Math.cos,a=Math.sin,c=s(t/2),d=a(t/2),f=s((e+n)/2),g=a((e+n)/2),v=s((e-n)/2),b=a((e-n)/2),x=s((n-e)/2),C=a((n-e)/2);switch(r){case"XYX":i.set(c*g,d*v,d*b,c*f);break;case"YZY":i.set(d*b,c*g,d*v,c*f);break;case"ZXZ":i.set(d*v,d*b,c*g,c*f);break;case"XZX":i.set(c*g,d*C,d*x,c*f);break;case"YXY":i.set(d*x,c*g,d*C,c*f);break;case"ZYZ":i.set(d*C,d*x,c*g,c*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:function tz(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return Math.round(65535*i);case Uint8Array:return Math.round(255*i);case Int16Array:return Math.round(32767*i);case Int8Array:return Math.round(127*i);default:throw new Error("Invalid component type.")}},denormalize:function ez(i,e){switch(e.constructor){case Float32Array:return i;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}});class gt{constructor(e=0,t=0){this.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*r+e.x,this.y=s*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class _d{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,a,c,d,f){const g=this.elements;return g[0]=e,g[1]=r,g[2]=c,g[3]=t,g[4]=s,g[5]=d,g[6]=n,g[7]=a,g[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],c=n[3],d=n[6],f=n[1],g=n[4],v=n[7],b=n[2],x=n[5],C=n[8],I=r[0],D=r[3],L=r[6],V=r[1],z=r[4],U=r[7],$=r[2],Z=r[5],ae=r[8];return s[0]=a*I+c*V+d*$,s[3]=a*D+c*z+d*Z,s[6]=a*L+c*U+d*ae,s[1]=f*I+g*V+v*$,s[4]=f*D+g*z+v*Z,s[7]=f*L+g*U+v*ae,s[2]=b*I+x*V+C*$,s[5]=b*D+x*z+C*Z,s[8]=b*L+x*U+C*ae,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],c=e[5],d=e[6],f=e[7],g=e[8];return t*a*g-t*c*f-n*s*g+n*c*d+r*s*f-r*a*d}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],c=e[5],d=e[6],f=e[7],g=e[8],v=g*a-c*f,b=c*d-g*s,x=f*s-a*d,C=t*v+n*b+r*x;if(0===C)return this.set(0,0,0,0,0,0,0,0,0);const I=1/C;return e[0]=v*I,e[1]=(r*f-g*n)*I,e[2]=(c*n-r*a)*I,e[3]=b*I,e[4]=(g*t-r*d)*I,e[5]=(r*s-c*t)*I,e[6]=x*I,e[7]=(n*d-f*t)*I,e[8]=(a*t-n*s)*I,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,a,c){const d=Math.cos(s),f=Math.sin(s);return this.set(n*d,n*f,-n*(d*a+f*c)+a+e,-r*f,r*d,-r*(-f*a+d*c)+c+t,0,0,1),this}scale(e,t){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}rotate(e){const t=Math.cos(e),n=Math.sin(e),r=this.elements,s=r[0],a=r[3],c=r[6],d=r[1],f=r[4],g=r[7];return r[0]=t*s+n*d,r[3]=t*a+n*f,r[6]=t*c+n*g,r[1]=-n*s+t*d,r[4]=-n*a+t*f,r[7]=-n*c+t*g,this}translate(e,t){const n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function dk(i){for(let e=i.length-1;e>=0;--e)if(i[e]>65535)return!0;return!1}function HE(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function Yy(i){return i<.04045?.0773993808*i:Math.pow(.9478672986*i+.0521327014,2.4)}function kC(i){return i<.0031308?12.92*i:1.055*Math.pow(i,.41666)-.055}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const gR={[Hf]:{[qy]:Yy},[qy]:{[Hf]:kC}},vd={legacyMode:!0,get workingColorSpace(){return qy},set workingColorSpace(i){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(i,e,t){if(this.legacyMode||e===t||!e||!t)return i;if(gR[e]&&void 0!==gR[e][t]){const n=gR[e][t];return i.r=n(i.r),i.g=n(i.g),i.b=n(i.b),i}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(i,e){return this.convert(i,this.workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this.workingColorSpace)}},hk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zo={r:0,g:0,b:0},wd={h:0,s:0,l:0},FC={h:0,s:0,l:0};function yR(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+6*(e-i)*(2/3-t):i}function VC(i,e){return e.r=i.r,e.g=i.g,e.b=i.b,e}let z0,rn=(()=>{class i{constructor(t,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=Hf){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,vd.toWorkingColorSpace(this,n),this}setRGB(t,n,r,s=qy){return this.r=t,this.g=n,this.b=r,vd.toWorkingColorSpace(this,s),this}setHSL(t,n,r,s=qy){if(t=pR(t,1),n=ho(n,0,1),r=ho(r,0,1),0===n)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+n):r+n-r*n,c=2*r-a;this.r=yR(c,a,t+1/3),this.g=yR(c,a,t),this.b=yR(c,a,t-1/3)}return vd.toWorkingColorSpace(this,s),this}setStyle(t,n=Hf){function r(a){void 0!==a&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let s;if(s=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let a;const d=s[2];switch(s[1]){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,vd.toWorkingColorSpace(this,n),r(a[4]),this;if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,vd.toWorkingColorSpace(this,n),r(a[4]),this;break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(d)){const f=parseFloat(a[1])/360,g=parseInt(a[2],10)/100,v=parseInt(a[3],10)/100;return r(a[4]),this.setHSL(f,g,v,n)}}}else if(s=/^\#([A-Fa-f\d]+)$/.exec(t)){const a=s[1],c=a.length;if(3===c)return this.r=parseInt(a.charAt(0)+a.charAt(0),16)/255,this.g=parseInt(a.charAt(1)+a.charAt(1),16)/255,this.b=parseInt(a.charAt(2)+a.charAt(2),16)/255,vd.toWorkingColorSpace(this,n),this;if(6===c)return this.r=parseInt(a.charAt(0)+a.charAt(1),16)/255,this.g=parseInt(a.charAt(2)+a.charAt(3),16)/255,this.b=parseInt(a.charAt(4)+a.charAt(5),16)/255,vd.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=Hf){const r=hk[t.toLowerCase()];return void 0!==r?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Yy(t.r),this.g=Yy(t.g),this.b=Yy(t.b),this}copyLinearToSRGB(t){return this.r=kC(t.r),this.g=kC(t.g),this.b=kC(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Hf){return vd.fromWorkingColorSpace(VC(this,Zo),t),ho(255*Zo.r,0,255)<<16^ho(255*Zo.g,0,255)<<8^ho(255*Zo.b,0,255)<<0}getHexString(t=Hf){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=qy){vd.fromWorkingColorSpace(VC(this,Zo),n);const r=Zo.r,s=Zo.g,a=Zo.b,c=Math.max(r,s,a),d=Math.min(r,s,a);let f,g;const v=(d+c)/2;if(d===c)f=0,g=0;else{const b=c-d;switch(g=v<=.5?b/(c+d):b/(2-c-d),c){case r:f=(s-a)/b+(s<a?6:0);break;case s:f=(a-r)/b+2;break;case a:f=(r-s)/b+4}f/=6}return t.h=f,t.s=g,t.l=v,t}getRGB(t,n=qy){return vd.fromWorkingColorSpace(VC(this,Zo),n),t.r=Zo.r,t.g=Zo.g,t.b=Zo.b,t}getStyle(t=Hf){return vd.fromWorkingColorSpace(VC(this,Zo),t),t!==Hf?`color(${t} ${Zo.r} ${Zo.g} ${Zo.b})`:`rgb(${255*Zo.r|0},${255*Zo.g|0},${255*Zo.b|0})`}offsetHSL(t,n,r){return this.getHSL(wd),wd.h+=t,wd.s+=n,wd.l+=r,this.setHSL(wd.h,wd.s,wd.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,r){return this.r=t.r+(n.r-t.r)*r,this.g=t.g+(n.g-t.g)*r,this.b=t.b+(n.b-t.b)*r,this}lerpHSL(t,n){this.getHSL(wd),t.getHSL(FC);const r=BE(wd.h,FC.h,n),s=BE(wd.s,FC.s,n),a=BE(wd.l,FC.l,n);return this.setHSL(r,s,a),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return i.NAMES=hk,i})();class fk{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===z0&&(z0=HE("canvas")),z0.width=e.width,z0.height=e.height;const n=z0.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=z0}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=HE("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=255*Yy(s[a]/255);return n.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t[n]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Yy(t[n]/255)):Yy(t[n]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class G0{constructor(e=null){this.isSource=!0,this.uuid=Zc(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(null!==r){let s;if(Array.isArray(r)){s=[];for(let a=0,c=r.length;a<c;a++)s.push(_R(r[a].isDataTexture?r[a].image:r[a]))}else s=_R(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function _R(i){return"undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&i instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&i instanceof ImageBitmap?fk.getDataURL(i):i.data?{data:Array.prototype.slice.call(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let rz=0,bd=(()=>{class i extends Ky{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=Ml,s=Ml,a=$s,c=Em,d=Nu,f=zy,g=1,v=Wy){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:rz++}),this.uuid=Zc(),this.name="",this.source=new G0(t),this.mipmaps=[],this.mapping=n,this.wrapS=r,this.wrapT=s,this.magFilter=a,this.minFilter=c,this.anisotropy=g,this.format=d,this.internalFormat=null,this.type=f,this.offset=new gt(0,0),this.repeat=new gt(1,1),this.center=new gt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new _d,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=v,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=void 0===t||"string"==typeof t;if(!n&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Hy:t.x=t.x-Math.floor(t.x);break;case Ml:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Hy:t.y=t.y-Math.floor(t.y);break;case Ml:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=300,i})();class Ur{constructor(e=0,t=0,n=0,r=1){this.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const d=e.elements,f=d[0],g=d[4],v=d[8],b=d[1],x=d[5],C=d[9],I=d[2],D=d[6],L=d[10];if(Math.abs(g-b)<.01&&Math.abs(v-I)<.01&&Math.abs(C-D)<.01){if(Math.abs(g+b)<.1&&Math.abs(v+I)<.1&&Math.abs(C+D)<.1&&Math.abs(f+x+L-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const z=(f+1)/2,U=(x+1)/2,$=(L+1)/2,Z=(g+b)/4,ae=(v+I)/4,j=(C+D)/4;return z>U&&z>$?z<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(z),r=Z/n,s=ae/n):U>$?U<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(U),n=Z/r,s=j/r):$<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt($),n=ae/s,r=j/s),this.set(n,r,s,t),this}let V=Math.sqrt((D-C)*(D-C)+(v-I)*(v-I)+(b-g)*(b-g));return Math.abs(V)<.001&&(V=1),this.x=(D-C)/V,this.y=(v-I)/V,this.z=(b-g)/V,this.w=Math.acos((f+x+L-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Tm extends Ky{constructor(e,t,n={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ur(0,0,e,t),this.scissorTest=!1,this.viewport=new Ur(0,0,e,t),this.texture=new bd({width:e,height:t,depth:1},n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.internalFormat=void 0!==n.internalFormat?n.internalFormat:null,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:$s,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0!==n.stencilBuffer&&n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null,this.samples=void 0!==n.samples?n.samples:0}setSize(e,t,n=1){(this.width!==e||this.height!==t||this.depth!==n)&&(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new G0(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class vR extends bd{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Do,this.minFilter=Do,this.wrapR=Ml,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Ya{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerp(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}static slerpFlat(e,t,n,r,s,a,c){let d=n[r+0],f=n[r+1],g=n[r+2],v=n[r+3];const b=s[a+0],x=s[a+1],C=s[a+2],I=s[a+3];if(0===c)return e[t+0]=d,e[t+1]=f,e[t+2]=g,void(e[t+3]=v);if(1===c)return e[t+0]=b,e[t+1]=x,e[t+2]=C,void(e[t+3]=I);if(v!==I||d!==b||f!==x||g!==C){let D=1-c;const L=d*b+f*x+g*C+v*I,V=L>=0?1:-1,z=1-L*L;if(z>Number.EPSILON){const $=Math.sqrt(z),Z=Math.atan2($,L*V);D=Math.sin(D*Z)/$,c=Math.sin(c*Z)/$}const U=c*V;if(d=d*D+b*U,f=f*D+x*U,g=g*D+C*U,v=v*D+I*U,D===1-c){const $=1/Math.sqrt(d*d+f*f+g*g+v*v);d*=$,f*=$,g*=$,v*=$}}e[t]=d,e[t+1]=f,e[t+2]=g,e[t+3]=v}static multiplyQuaternionsFlat(e,t,n,r,s,a){const c=n[r],d=n[r+1],f=n[r+2],g=n[r+3],v=s[a],b=s[a+1],x=s[a+2],C=s[a+3];return e[t]=c*C+g*v+d*x-f*b,e[t+1]=d*C+g*b+f*v-c*x,e[t+2]=f*C+g*x+c*b-d*v,e[t+3]=g*C-c*v-d*b-f*x,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const n=e._x,r=e._y,s=e._z,a=e._order,c=Math.cos,d=Math.sin,f=c(n/2),g=c(r/2),v=c(s/2),b=d(n/2),x=d(r/2),C=d(s/2);switch(a){case"XYZ":this._x=b*g*v+f*x*C,this._y=f*x*v-b*g*C,this._z=f*g*C+b*x*v,this._w=f*g*v-b*x*C;break;case"YXZ":this._x=b*g*v+f*x*C,this._y=f*x*v-b*g*C,this._z=f*g*C-b*x*v,this._w=f*g*v+b*x*C;break;case"ZXY":this._x=b*g*v-f*x*C,this._y=f*x*v+b*g*C,this._z=f*g*C+b*x*v,this._w=f*g*v-b*x*C;break;case"ZYX":this._x=b*g*v-f*x*C,this._y=f*x*v+b*g*C,this._z=f*g*C-b*x*v,this._w=f*g*v+b*x*C;break;case"YZX":this._x=b*g*v+f*x*C,this._y=f*x*v+b*g*C,this._z=f*g*C-b*x*v,this._w=f*g*v-b*x*C;break;case"XZY":this._x=b*g*v-f*x*C,this._y=f*x*v-b*g*C,this._z=f*g*C+b*x*v,this._w=f*g*v+b*x*C;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],a=t[1],c=t[5],d=t[9],f=t[2],g=t[6],v=t[10],b=n+c+v;if(b>0){const x=.5/Math.sqrt(b+1);this._w=.25/x,this._x=(g-d)*x,this._y=(s-f)*x,this._z=(a-r)*x}else if(n>c&&n>v){const x=2*Math.sqrt(1+n-c-v);this._w=(g-d)/x,this._x=.25*x,this._y=(r+a)/x,this._z=(s+f)/x}else if(c>v){const x=2*Math.sqrt(1+c-n-v);this._w=(s-f)/x,this._x=(r+a)/x,this._y=.25*x,this._z=(d+g)/x}else{const x=2*Math.sqrt(1+v-n-c);this._w=(a-r)/x,this._x=(s+f)/x,this._y=(d+g)/x,this._z=.25*x}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(ho(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(0===n)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,a=e._w,c=t._x,d=t._y,f=t._z,g=t._w;return this._x=n*g+a*c+r*f-s*d,this._y=r*g+a*d+s*c-n*f,this._z=s*g+a*f+n*d-r*c,this._w=a*g-n*c-r*d-s*f,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const n=this._x,r=this._y,s=this._z,a=this._w;let c=a*e._w+n*e._x+r*e._y+s*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=a,this._x=n,this._y=r,this._z=s,this;const d=1-c*c;if(d<=Number.EPSILON){const x=1-t;return this._w=x*a+t*this._w,this._x=x*n+t*this._x,this._y=x*r+t*this._y,this._z=x*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const f=Math.sqrt(d),g=Math.atan2(f,c),v=Math.sin((1-t)*g)/f,b=Math.sin(t*g)/f;return this._w=a*v+this._w*b,this._x=n*v+this._x*b,this._y=r*v+this._y*b,this._z=s*v+this._z*b,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(s),n*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Q{constructor(e=0,t=0,n=0){this.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(mk.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(mk.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,a=e.y,c=e.z,d=e.w,f=d*t+a*r-c*n,g=d*n+c*t-s*r,v=d*r+s*n-a*t,b=-s*t-a*n-c*r;return this.x=f*d+b*-s+g*-c-v*-a,this.y=g*d+b*-a+v*-s-f*-c,this.z=v*d+b*-c+f*-a-g*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,a=t.x,c=t.y,d=t.z;return this.x=r*d-s*c,this.y=s*a-n*d,this.z=n*c-r*a,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return wR.copy(this).projectOnVector(e),this.sub(wR)}reflect(e){return this.sub(wR.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(ho(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-e**2);return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const wR=new Q,mk=new Ya;class Xy{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,n=1/0,r=1/0,s=-1/0,a=-1/0,c=-1/0;for(let d=0,f=e.length;d<f;d+=3){const g=e[d],v=e[d+1],b=e[d+2];g<t&&(t=g),v<n&&(n=v),b<r&&(r=b),g>s&&(s=g),v>a&&(a=v),b>c&&(c=b)}return this.min.set(t,n,r),this.max.set(s,a,c),this}setFromBufferAttribute(e){let t=1/0,n=1/0,r=1/0,s=-1/0,a=-1/0,c=-1/0;for(let d=0,f=e.count;d<f;d++){const g=e.getX(d),v=e.getY(d),b=e.getZ(d);g<t&&(t=g),v<n&&(n=v),b<r&&(r=b),g>s&&(s=g),v>a&&(a=v),b>c&&(c=b)}return this.min.set(t,n,r),this.max.set(s,a,c),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Jy.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(void 0!==n)if(t&&null!=n.attributes&&void 0!==n.attributes.position){const s=n.attributes.position;for(let a=0,c=s.count;a<c;a++)Jy.fromBufferAttribute(s,a).applyMatrix4(e.matrixWorld),this.expandByPoint(Jy)}else null===n.boundingBox&&n.computeBoundingBox(),bR.copy(n.boundingBox),bR.applyMatrix4(e.matrixWorld),this.union(bR);const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Jy),Jy.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(zE),UC.subVectors(this.max,zE),j0.subVectors(e.a,zE),W0.subVectors(e.b,zE),$0.subVectors(e.c,zE),Mm.subVectors(W0,j0),Cm.subVectors($0,W0),Qy.subVectors(j0,$0);let t=[0,-Mm.z,Mm.y,0,-Cm.z,Cm.y,0,-Qy.z,Qy.y,Mm.z,0,-Mm.x,Cm.z,0,-Cm.x,Qy.z,0,-Qy.x,-Mm.y,Mm.x,0,-Cm.y,Cm.x,0,-Qy.y,Qy.x,0];return!(!xR(t,j0,W0,$0,UC)||(t=[1,0,0,0,1,0,0,0,1],!xR(t,j0,W0,$0,UC)))&&(BC.crossVectors(Mm,Cm),t=[BC.x,BC.y,BC.z],xR(t,j0,W0,$0,UC))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Jy.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Jy).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(zf[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),zf[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),zf[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),zf[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),zf[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),zf[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),zf[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),zf[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(zf)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const zf=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],Jy=new Q,bR=new Xy,j0=new Q,W0=new Q,$0=new Q,Mm=new Q,Cm=new Q,Qy=new Q,zE=new Q,UC=new Q,BC=new Q,e_=new Q;function xR(i,e,t,n,r){for(let s=0,a=i.length-3;s<=a;s+=3){e_.fromArray(i,s);const c=r.x*Math.abs(e_.x)+r.y*Math.abs(e_.y)+r.z*Math.abs(e_.z),d=e.dot(e_),f=t.dot(e_),g=n.dot(e_);if(Math.max(-Math.max(d,f,g),Math.min(d,f,g))>c)return!1}return!0}const sz=new Xy,gk=new Q,HC=new Q,ER=new Q;class t_{constructor(e=new Q,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;void 0!==t?n.copy(t):sz.setFromPoints(e).getCenter(n);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){ER.subVectors(e,this.center);const t=ER.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(ER.multiplyScalar(r/n)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?HC.set(0,0,1).multiplyScalar(e.radius):HC.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(gk.copy(e.center).add(HC)),this.expandByPoint(gk.copy(e.center).sub(HC)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Gf=new Q,SR=new Q,zC=new Q,Am=new Q,TR=new Q,GC=new Q,MR=new Q;class jC{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Gf)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Gf.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Gf.copy(this.direction).multiplyScalar(t).add(this.origin),Gf.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){SR.copy(e).add(t).multiplyScalar(.5),zC.copy(t).sub(e).normalize(),Am.copy(this.origin).sub(SR);const s=.5*e.distanceTo(t),a=-this.direction.dot(zC),c=Am.dot(this.direction),d=-Am.dot(zC),f=Am.lengthSq(),g=Math.abs(1-a*a);let v,b,x,C;if(g>0)if(v=a*d-c,b=a*c-d,C=s*g,v>=0)if(b>=-C)if(b<=C){const I=1/g;v*=I,b*=I,x=v*(v+a*b+2*c)+b*(a*v+b+2*d)+f}else b=s,v=Math.max(0,-(a*b+c)),x=-v*v+b*(b+2*d)+f;else b=-s,v=Math.max(0,-(a*b+c)),x=-v*v+b*(b+2*d)+f;else b<=-C?(v=Math.max(0,-(-a*s+c)),b=v>0?-s:Math.min(Math.max(-s,-d),s),x=-v*v+b*(b+2*d)+f):b<=C?(v=0,b=Math.min(Math.max(-s,-d),s),x=b*(b+2*d)+f):(v=Math.max(0,-(a*s+c)),b=v>0?s:Math.min(Math.max(-s,-d),s),x=-v*v+b*(b+2*d)+f);else b=a>0?-s:s,v=Math.max(0,-(a*b+c)),x=-v*v+b*(b+2*d)+f;return n&&n.copy(this.direction).multiplyScalar(v).add(this.origin),r&&r.copy(zC).multiplyScalar(b).add(SR),x}intersectSphere(e,t){Gf.subVectors(e.center,this.origin);const n=Gf.dot(this.direction),r=Gf.dot(Gf)-n*n,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),c=n-a,d=n+a;return c<0&&d<0?null:this.at(c<0?d:c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,a,c,d;const f=1/this.direction.x,g=1/this.direction.y,v=1/this.direction.z,b=this.origin;return f>=0?(n=(e.min.x-b.x)*f,r=(e.max.x-b.x)*f):(n=(e.max.x-b.x)*f,r=(e.min.x-b.x)*f),g>=0?(s=(e.min.y-b.y)*g,a=(e.max.y-b.y)*g):(s=(e.max.y-b.y)*g,a=(e.min.y-b.y)*g),n>a||s>r||((s>n||n!=n)&&(n=s),(a<r||r!=r)&&(r=a),v>=0?(c=(e.min.z-b.z)*v,d=(e.max.z-b.z)*v):(c=(e.max.z-b.z)*v,d=(e.min.z-b.z)*v),n>d||c>r)||((c>n||n!=n)&&(n=c),(d<r||r!=r)&&(r=d),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Gf)}intersectTriangle(e,t,n,r,s){TR.subVectors(t,e),GC.subVectors(n,e),MR.crossVectors(TR,GC);let c,a=this.direction.dot(MR);if(a>0){if(r)return null;c=1}else{if(!(a<0))return null;c=-1,a=-a}Am.subVectors(this.origin,e);const d=c*this.direction.dot(GC.crossVectors(Am,GC));if(d<0)return null;const f=c*this.direction.dot(TR.cross(Am));if(f<0||d+f>a)return null;const g=-c*Am.dot(MR);return g<0?null:this.at(g/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class bi{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,n,r,s,a,c,d,f,g,v,b,x,C,I,D){const L=this.elements;return L[0]=e,L[4]=t,L[8]=n,L[12]=r,L[1]=s,L[5]=a,L[9]=c,L[13]=d,L[2]=f,L[6]=g,L[10]=v,L[14]=b,L[3]=x,L[7]=C,L[11]=I,L[15]=D,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new bi).fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,r=1/q0.setFromMatrixColumn(e,0).length(),s=1/q0.setFromMatrixColumn(e,1).length(),a=1/q0.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,n=e.x,r=e.y,s=e.z,a=Math.cos(n),c=Math.sin(n),d=Math.cos(r),f=Math.sin(r),g=Math.cos(s),v=Math.sin(s);if("XYZ"===e.order){const b=a*g,x=a*v,C=c*g,I=c*v;t[0]=d*g,t[4]=-d*v,t[8]=f,t[1]=x+C*f,t[5]=b-I*f,t[9]=-c*d,t[2]=I-b*f,t[6]=C+x*f,t[10]=a*d}else if("YXZ"===e.order){const b=d*g,x=d*v,C=f*g,I=f*v;t[0]=b+I*c,t[4]=C*c-x,t[8]=a*f,t[1]=a*v,t[5]=a*g,t[9]=-c,t[2]=x*c-C,t[6]=I+b*c,t[10]=a*d}else if("ZXY"===e.order){const b=d*g,x=d*v,C=f*g,I=f*v;t[0]=b-I*c,t[4]=-a*v,t[8]=C+x*c,t[1]=x+C*c,t[5]=a*g,t[9]=I-b*c,t[2]=-a*f,t[6]=c,t[10]=a*d}else if("ZYX"===e.order){const b=a*g,x=a*v,C=c*g,I=c*v;t[0]=d*g,t[4]=C*f-x,t[8]=b*f+I,t[1]=d*v,t[5]=I*f+b,t[9]=x*f-C,t[2]=-f,t[6]=c*d,t[10]=a*d}else if("YZX"===e.order){const b=a*d,x=a*f,C=c*d,I=c*f;t[0]=d*g,t[4]=I-b*v,t[8]=C*v+x,t[1]=v,t[5]=a*g,t[9]=-c*g,t[2]=-f*g,t[6]=x*v+C,t[10]=b-I*v}else if("XZY"===e.order){const b=a*d,x=a*f,C=c*d,I=c*f;t[0]=d*g,t[4]=-v,t[8]=f*g,t[1]=b*v+I,t[5]=a*g,t[9]=x*v-C,t[2]=C*v-x,t[6]=c*g,t[10]=I*v+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(oz,e,az)}lookAt(e,t,n){const r=this.elements;return Yc.subVectors(e,t),0===Yc.lengthSq()&&(Yc.z=1),Yc.normalize(),Im.crossVectors(n,Yc),0===Im.lengthSq()&&(1===Math.abs(n.z)?Yc.x+=1e-4:Yc.z+=1e-4,Yc.normalize(),Im.crossVectors(n,Yc)),Im.normalize(),WC.crossVectors(Yc,Im),r[0]=Im.x,r[4]=WC.x,r[8]=Yc.x,r[1]=Im.y,r[5]=WC.y,r[9]=Yc.y,r[2]=Im.z,r[6]=WC.z,r[10]=Yc.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],c=n[4],d=n[8],f=n[12],g=n[1],v=n[5],b=n[9],x=n[13],C=n[2],I=n[6],D=n[10],L=n[14],V=n[3],z=n[7],U=n[11],$=n[15],Z=r[0],ae=r[4],j=r[8],ie=r[12],we=r[1],Me=r[5],dt=r[9],Mt=r[13],Se=r[2],it=r[6],Ge=r[10],_t=r[14],vt=r[3],rt=r[7],ht=r[11],zt=r[15];return s[0]=a*Z+c*we+d*Se+f*vt,s[4]=a*ae+c*Me+d*it+f*rt,s[8]=a*j+c*dt+d*Ge+f*ht,s[12]=a*ie+c*Mt+d*_t+f*zt,s[1]=g*Z+v*we+b*Se+x*vt,s[5]=g*ae+v*Me+b*it+x*rt,s[9]=g*j+v*dt+b*Ge+x*ht,s[13]=g*ie+v*Mt+b*_t+x*zt,s[2]=C*Z+I*we+D*Se+L*vt,s[6]=C*ae+I*Me+D*it+L*rt,s[10]=C*j+I*dt+D*Ge+L*ht,s[14]=C*ie+I*Mt+D*_t+L*zt,s[3]=V*Z+z*we+U*Se+$*vt,s[7]=V*ae+z*Me+U*it+$*rt,s[11]=V*j+z*dt+U*Ge+$*ht,s[15]=V*ie+z*Mt+U*_t+$*zt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],a=e[1],c=e[5],d=e[9],f=e[13],g=e[2],v=e[6],b=e[10],x=e[14];return e[3]*(+s*d*v-r*f*v-s*c*b+n*f*b+r*c*x-n*d*x)+e[7]*(+t*d*x-t*f*b+s*a*b-r*a*x+r*f*g-s*d*g)+e[11]*(+t*f*v-t*c*x-s*a*v+n*a*x+s*c*g-n*f*g)+e[15]*(-r*c*g-t*d*v+t*c*b+r*a*v-n*a*b+n*d*g)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],c=e[5],d=e[6],f=e[7],g=e[8],v=e[9],b=e[10],x=e[11],C=e[12],I=e[13],D=e[14],L=e[15],V=v*D*f-I*b*f+I*d*x-c*D*x-v*d*L+c*b*L,z=C*b*f-g*D*f-C*d*x+a*D*x+g*d*L-a*b*L,U=g*I*f-C*v*f+C*c*x-a*I*x-g*c*L+a*v*L,$=C*v*d-g*I*d-C*c*b+a*I*b+g*c*D-a*v*D,Z=t*V+n*z+r*U+s*$;if(0===Z)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ae=1/Z;return e[0]=V*ae,e[1]=(I*b*s-v*D*s-I*r*x+n*D*x+v*r*L-n*b*L)*ae,e[2]=(c*D*s-I*d*s+I*r*f-n*D*f-c*r*L+n*d*L)*ae,e[3]=(v*d*s-c*b*s-v*r*f+n*b*f+c*r*x-n*d*x)*ae,e[4]=z*ae,e[5]=(g*D*s-C*b*s+C*r*x-t*D*x-g*r*L+t*b*L)*ae,e[6]=(C*d*s-a*D*s-C*r*f+t*D*f+a*r*L-t*d*L)*ae,e[7]=(a*b*s-g*d*s+g*r*f-t*b*f-a*r*x+t*d*x)*ae,e[8]=U*ae,e[9]=(C*v*s-g*I*s-C*n*x+t*I*x+g*n*L-t*v*L)*ae,e[10]=(a*I*s-C*c*s+C*n*f-t*I*f-a*n*L+t*c*L)*ae,e[11]=(g*c*s-a*v*s-g*n*f+t*v*f+a*n*x-t*c*x)*ae,e[12]=$*ae,e[13]=(g*I*r-C*v*r+C*n*b-t*I*b-g*n*D+t*v*D)*ae,e[14]=(C*c*r-a*I*r-C*n*d+t*I*d+a*n*D-t*c*D)*ae,e[15]=(a*v*r-g*c*r+g*n*d-t*v*d-a*n*b+t*c*b)*ae,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,a=e.x,c=e.y,d=e.z,f=s*a,g=s*c;return this.set(f*a+n,f*c-r*d,f*d+r*c,0,f*c+r*d,g*c+n,g*d-r*a,0,f*d-r*c,g*d+r*a,s*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,a){return this.set(1,n,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,a=t._y,c=t._z,d=t._w,f=s+s,g=a+a,v=c+c,b=s*f,x=s*g,C=s*v,I=a*g,D=a*v,L=c*v,V=d*f,z=d*g,U=d*v,$=n.x,Z=n.y,ae=n.z;return r[0]=(1-(I+L))*$,r[1]=(x+U)*$,r[2]=(C-z)*$,r[3]=0,r[4]=(x-U)*Z,r[5]=(1-(b+L))*Z,r[6]=(D+V)*Z,r[7]=0,r[8]=(C+z)*ae,r[9]=(D-V)*ae,r[10]=(1-(b+I))*ae,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;let s=q0.set(r[0],r[1],r[2]).length();const a=q0.set(r[4],r[5],r[6]).length(),c=q0.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],xd.copy(this);const f=1/s,g=1/a,v=1/c;return xd.elements[0]*=f,xd.elements[1]*=f,xd.elements[2]*=f,xd.elements[4]*=g,xd.elements[5]*=g,xd.elements[6]*=g,xd.elements[8]*=v,xd.elements[9]*=v,xd.elements[10]*=v,t.setFromRotationMatrix(xd),n.x=s,n.y=a,n.z=c,this}makePerspective(e,t,n,r,s,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const c=this.elements,f=2*s/(n-r),g=(t+e)/(t-e),v=(n+r)/(n-r),b=-(a+s)/(a-s),x=-2*a*s/(a-s);return c[0]=2*s/(t-e),c[4]=0,c[8]=g,c[12]=0,c[1]=0,c[5]=f,c[9]=v,c[13]=0,c[2]=0,c[6]=0,c[10]=b,c[14]=x,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,r,s,a){const c=this.elements,d=1/(t-e),f=1/(n-r),g=1/(a-s),v=(t+e)*d,b=(n+r)*f,x=(a+s)*g;return c[0]=2*d,c[4]=0,c[8]=0,c[12]=-v,c[1]=0,c[5]=2*f,c[9]=0,c[13]=-b,c[2]=0,c[6]=0,c[10]=-2*g,c[14]=-x,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const q0=new Q,xd=new bi,oz=new Q(0,0,0),az=new Q(1,1,1),Im=new Q,WC=new Q,Yc=new Q,yk=new bi,_k=new Ya;let lz=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DefaultOrder){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){const s=t.elements,a=s[0],c=s[4],d=s[8],f=s[1],g=s[5],v=s[9],b=s[2],x=s[6],C=s[10];switch(n){case"XYZ":this._y=Math.asin(ho(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-v,C),this._z=Math.atan2(-c,a)):(this._x=Math.atan2(x,g),this._z=0);break;case"YXZ":this._x=Math.asin(-ho(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(d,C),this._z=Math.atan2(f,g)):(this._y=Math.atan2(-b,a),this._z=0);break;case"ZXY":this._x=Math.asin(ho(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(-b,C),this._z=Math.atan2(-c,g)):(this._y=0,this._z=Math.atan2(f,a));break;case"ZYX":this._y=Math.asin(-ho(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(x,C),this._z=Math.atan2(f,a)):(this._x=0,this._z=Math.atan2(-c,g));break;case"YZX":this._z=Math.asin(ho(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-v,g),this._y=Math.atan2(-b,a)):(this._x=0,this._y=Math.atan2(d,C));break;case"XZY":this._z=Math.asin(-ho(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(x,g),this._y=Math.atan2(d,a)):(this._x=Math.atan2(-v,C),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return yk.makeRotationFromQuaternion(t),this.setFromRotationMatrix(yk,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return _k.setFromEuler(this),this.setFromQuaternion(_k,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return i.DefaultOrder="XYZ",i.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],i})();class CR{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let cz=0;const vk=new Q,K0=new Ya,jf=new bi,$C=new Q,GE=new Q,uz=new Q,dz=new Ya,wk=new Q(1,0,0),bk=new Q(0,1,0),xk=new Q(0,0,1),hz={type:"added"},Ek={type:"removed"};class qs extends Ky{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:cz++}),this.uuid=Zc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=qs.DefaultUp.clone();const e=new Q,t=new lz,n=new Ya,r=new Q(1,1,1);t._onChange(function s(){n.setFromEuler(t,!1)}),n._onChange(function a(){t.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new bi},normalMatrix:{value:new _d}}),this.matrix=new bi,this.matrixWorld=new bi,this.matrixAutoUpdate=qs.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new CR,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return K0.setFromAxisAngle(e,t),this.quaternion.multiply(K0),this}rotateOnWorldAxis(e,t){return K0.setFromAxisAngle(e,t),this.quaternion.premultiply(K0),this}rotateX(e){return this.rotateOnAxis(wk,e)}rotateY(e){return this.rotateOnAxis(bk,e)}rotateZ(e){return this.rotateOnAxis(xk,e)}translateOnAxis(e,t){return vk.copy(e).applyQuaternion(this.quaternion),this.position.add(vk.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(wk,e)}translateY(e){return this.translateOnAxis(bk,e)}translateZ(e){return this.translateOnAxis(xk,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(jf.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?$C.copy(e):$C.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),GE.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?jf.lookAt(GE,$C,this.up):jf.lookAt($C,GE,this.up),this.quaternion.setFromRotationMatrix(jf),r&&(jf.extractRotation(r.matrixWorld),K0.setFromRotationMatrix(jf),this.quaternion.premultiply(K0.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(hz)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Ek)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(Ek)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),jf.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),jf.multiply(e.parent.matrixWorld)),e.applyMatrix4(jf),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(void 0!==a)return a}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(GE,e,uz),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(GE,dz,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};function s(c,d){return void 0===c[d.uuid]&&(c[d.uuid]=d.toJSON(e)),d.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const c=this.geometry.parameters;if(void 0!==c&&void 0!==c.shapes){const d=c.shapes;if(Array.isArray(d))for(let f=0,g=d.length;f<g;f++)s(e.shapes,d[f]);else s(e.shapes,d)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const c=[];for(let d=0,f=this.material.length;d<f;d++)c.push(s(e.materials,this.material[d]));r.material=c}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let c=0;c<this.children.length;c++)r.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let c=0;c<this.animations.length;c++)r.animations.push(s(e.animations,this.animations[c]))}if(t){const c=a(e.geometries),d=a(e.materials),f=a(e.textures),g=a(e.images),v=a(e.shapes),b=a(e.skeletons),x=a(e.animations),C=a(e.nodes);c.length>0&&(n.geometries=c),d.length>0&&(n.materials=d),f.length>0&&(n.textures=f),g.length>0&&(n.images=g),v.length>0&&(n.shapes=v),b.length>0&&(n.skeletons=b),x.length>0&&(n.animations=x),C.length>0&&(n.nodes=C)}return n.object=r,n;function a(c){const d=[];for(const f in c){const g=c[f];delete g.metadata,d.push(g)}return d}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let n=0;n<e.children.length;n++)this.add(e.children[n].clone());return this}}qs.DefaultUp=new Q(0,1,0),qs.DefaultMatrixAutoUpdate=!0;const Ed=new Q,Wf=new Q,AR=new Q,$f=new Q,Z0=new Q,Y0=new Q,Sk=new Q,IR=new Q,DR=new Q,RR=new Q;class Sd{constructor(e=new Q,t=new Q,n=new Q){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Ed.subVectors(e,t),r.cross(Ed);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Ed.subVectors(r,t),Wf.subVectors(n,t),AR.subVectors(e,t);const a=Ed.dot(Ed),c=Ed.dot(Wf),d=Ed.dot(AR),f=Wf.dot(Wf),g=Wf.dot(AR),v=a*f-c*c;if(0===v)return s.set(-2,-1,-1);const b=1/v,x=(f*d-c*g)*b,C=(a*g-c*d)*b;return s.set(1-x-C,C,x)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,$f),$f.x>=0&&$f.y>=0&&$f.x+$f.y<=1}static getUV(e,t,n,r,s,a,c,d){return this.getBarycoord(e,t,n,r,$f),d.set(0,0),d.addScaledVector(s,$f.x),d.addScaledVector(a,$f.y),d.addScaledVector(c,$f.z),d}static isFrontFacing(e,t,n,r){return Ed.subVectors(n,t),Wf.subVectors(e,t),Ed.cross(Wf).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ed.subVectors(this.c,this.b),Wf.subVectors(this.a,this.b),.5*Ed.cross(Wf).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Sd.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Sd.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,n,r,s){return Sd.getUV(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return Sd.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Sd.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let a,c;Z0.subVectors(r,n),Y0.subVectors(s,n),IR.subVectors(e,n);const d=Z0.dot(IR),f=Y0.dot(IR);if(d<=0&&f<=0)return t.copy(n);DR.subVectors(e,r);const g=Z0.dot(DR),v=Y0.dot(DR);if(g>=0&&v<=g)return t.copy(r);const b=d*v-g*f;if(b<=0&&d>=0&&g<=0)return a=d/(d-g),t.copy(n).addScaledVector(Z0,a);RR.subVectors(e,s);const x=Z0.dot(RR),C=Y0.dot(RR);if(C>=0&&x<=C)return t.copy(s);const I=x*f-d*C;if(I<=0&&f>=0&&C<=0)return c=f/(f-C),t.copy(n).addScaledVector(Y0,c);const D=g*C-x*v;if(D<=0&&v-g>=0&&x-C>=0)return Sk.subVectors(s,r),c=(v-g)/(v-g+(x-C)),t.copy(r).addScaledVector(Sk,c);const L=1/(D+I+b);return a=I*L,c=b*L,t.copy(n).addScaledVector(Z0,a).addScaledVector(Y0,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let fz=0,Ro=(()=>{class i extends Ky{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:fz++}),this.uuid=Zc(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const n in t){const r=t[n];if(void 0===r){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}if("shading"===n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===r;continue}const s=this[n];void 0!==s?s&&s.isColor?s.set(r):s&&s.isVector3&&r&&r.isVector3?s.copy(r):this[n]=r:console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.")}}toJSON(t){const n=void 0===t||"string"==typeof t;n&&(t={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function s(a){const c=[];for(const d in a){const f=a[d];delete f.metadata,c.push(f)}return c}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n){const a=s(t.textures),c=s(t.images);a.length>0&&(r.textures=a),c.length>0&&(r.images=c)}return r}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const n=t.clippingPlanes;let r=null;if(null!==n){const s=n.length;r=new Array(s);for(let a=0;a!==s;++a)r[a]=n[a].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(t){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}return i.fromType=function(){return null},i})();class Ou extends Ro{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new rn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Po=new Q,qC=new gt;class No{constructor(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),a=new rn),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this}copyVector2sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new gt),t[n++]=a.x,t[n++]=a.y}return this}copyVector3sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),a=new Q),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this}copyVector4sArray(e){const t=this.array;let n=0;for(let r=0,s=e.length;r<s;r++){let a=e[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),a=new Ur),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,n=this.count;t<n;t++)qC.fromBufferAttribute(this,t),qC.applyMatrix3(e),this.setXY(t,qC.x,qC.y);else if(3===this.itemSize)for(let t=0,n=this.count;t<n;t++)Po.fromBufferAttribute(this,t),Po.applyMatrix3(e),this.setXYZ(t,Po.x,Po.y,Po.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Po.fromBufferAttribute(this,t),Po.applyMatrix4(e),this.setXYZ(t,Po.x,Po.y,Po.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Po.fromBufferAttribute(this,t),Po.applyNormalMatrix(e),this.setXYZ(t,Po.x,Po.y,Po.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Po.fromBufferAttribute(this,t),Po.transformDirection(e),this.setXYZ(t,Po.x,Po.y,Po.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class Tk extends No{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class Mk extends No{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class Dn extends No{constructor(e,t,n){super(new Float32Array(e),t,n)}}let pz=0;const Lu=new bi,PR=new qs,X0=new Q,Xc=new Xy,jE=new Xy,ca=new Q;class Li extends Ky{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:pz++}),this.uuid=Zc(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(dk(e)?Mk:Tk)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const s=(new _d).getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Lu.makeRotationFromQuaternion(e),this.applyMatrix4(Lu),this}rotateX(e){return Lu.makeRotationX(e),this.applyMatrix4(Lu),this}rotateY(e){return Lu.makeRotationY(e),this.applyMatrix4(Lu),this}rotateZ(e){return Lu.makeRotationZ(e),this.applyMatrix4(Lu),this}translate(e,t,n){return Lu.makeTranslation(e,t,n),this.applyMatrix4(Lu),this}scale(e,t,n){return Lu.makeScale(e,t,n),this.applyMatrix4(Lu),this}lookAt(e){return PR.lookAt(e),PR.updateMatrix(),this.applyMatrix4(PR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(X0).negate(),this.translate(X0.x,X0.y,X0.z),this}setFromPoints(e){const t=[];for(let n=0,r=e.length;n<r;n++){const s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Dn(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Xy);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++)Xc.setFromBufferAttribute(t[n]),this.morphTargetsRelative?(ca.addVectors(this.boundingBox.min,Xc.min),this.boundingBox.expandByPoint(ca),ca.addVectors(this.boundingBox.max,Xc.max),this.boundingBox.expandByPoint(ca)):(this.boundingBox.expandByPoint(Xc.min),this.boundingBox.expandByPoint(Xc.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new t_);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Q,1/0);if(e){const n=this.boundingSphere.center;if(Xc.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++)jE.setFromBufferAttribute(t[s]),this.morphTargetsRelative?(ca.addVectors(Xc.min,jE.min),Xc.expandByPoint(ca),ca.addVectors(Xc.max,jE.max),Xc.expandByPoint(ca)):(Xc.expandByPoint(jE.min),Xc.expandByPoint(jE.max));Xc.getCenter(n);let r=0;for(let s=0,a=e.count;s<a;s++)ca.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(ca));if(t)for(let s=0,a=t.length;s<a;s++){const c=t[s],d=this.morphTargetsRelative;for(let f=0,g=c.count;f<g;f++)ca.fromBufferAttribute(c,f),d&&(X0.fromBufferAttribute(e,f),ca.add(X0)),r=Math.max(r,n.distanceToSquared(ca))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const n=e.array,r=t.position.array,s=t.normal.array,a=t.uv.array,c=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new No(new Float32Array(4*c),4));const d=this.getAttribute("tangent").array,f=[],g=[];for(let we=0;we<c;we++)f[we]=new Q,g[we]=new Q;const v=new Q,b=new Q,x=new Q,C=new gt,I=new gt,D=new gt,L=new Q,V=new Q;function z(we,Me,dt){v.fromArray(r,3*we),b.fromArray(r,3*Me),x.fromArray(r,3*dt),C.fromArray(a,2*we),I.fromArray(a,2*Me),D.fromArray(a,2*dt),b.sub(v),x.sub(v),I.sub(C),D.sub(C);const Mt=1/(I.x*D.y-D.x*I.y);!isFinite(Mt)||(L.copy(b).multiplyScalar(D.y).addScaledVector(x,-I.y).multiplyScalar(Mt),V.copy(x).multiplyScalar(I.x).addScaledVector(b,-D.x).multiplyScalar(Mt),f[we].add(L),f[Me].add(L),f[dt].add(L),g[we].add(V),g[Me].add(V),g[dt].add(V))}let U=this.groups;0===U.length&&(U=[{start:0,count:n.length}]);for(let we=0,Me=U.length;we<Me;++we){const dt=U[we],Mt=dt.start;for(let it=Mt,Ge=Mt+dt.count;it<Ge;it+=3)z(n[it+0],n[it+1],n[it+2])}const $=new Q,Z=new Q,ae=new Q,j=new Q;function ie(we){ae.fromArray(s,3*we),j.copy(ae);const Me=f[we];$.copy(Me),$.sub(ae.multiplyScalar(ae.dot(Me))).normalize(),Z.crossVectors(j,Me);const Mt=Z.dot(g[we])<0?-1:1;d[4*we]=$.x,d[4*we+1]=$.y,d[4*we+2]=$.z,d[4*we+3]=Mt}for(let we=0,Me=U.length;we<Me;++we){const dt=U[we],Mt=dt.start;for(let it=Mt,Ge=Mt+dt.count;it<Ge;it+=3)ie(n[it+0]),ie(n[it+1]),ie(n[it+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let n=this.getAttribute("normal");if(void 0===n)n=new No(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(let b=0,x=n.count;b<x;b++)n.setXYZ(b,0,0,0);const r=new Q,s=new Q,a=new Q,c=new Q,d=new Q,f=new Q,g=new Q,v=new Q;if(e)for(let b=0,x=e.count;b<x;b+=3){const C=e.getX(b+0),I=e.getX(b+1),D=e.getX(b+2);r.fromBufferAttribute(t,C),s.fromBufferAttribute(t,I),a.fromBufferAttribute(t,D),g.subVectors(a,s),v.subVectors(r,s),g.cross(v),c.fromBufferAttribute(n,C),d.fromBufferAttribute(n,I),f.fromBufferAttribute(n,D),c.add(g),d.add(g),f.add(g),n.setXYZ(C,c.x,c.y,c.z),n.setXYZ(I,d.x,d.y,d.z),n.setXYZ(D,f.x,f.y,f.z)}else for(let b=0,x=t.count;b<x;b+=3)r.fromBufferAttribute(t,b+0),s.fromBufferAttribute(t,b+1),a.fromBufferAttribute(t,b+2),g.subVectors(a,s),v.subVectors(r,s),g.cross(v),n.setXYZ(b+0,g.x,g.y,g.z),n.setXYZ(b+1,g.x,g.y,g.z),n.setXYZ(b+2,g.x,g.y,g.z);this.normalizeNormals(),n.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const r in n){if(void 0===e.attributes[r])continue;const a=n[r].array,c=e.attributes[r],d=c.array,f=c.itemSize*t,g=Math.min(d.length,a.length-f);for(let v=0,b=f;v<g;v++,b++)a[b]=d[v]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)ca.fromBufferAttribute(e,t),ca.normalize(),e.setXYZ(t,ca.x,ca.y,ca.z)}toNonIndexed(){function e(c,d){const f=c.array,g=c.itemSize,v=c.normalized,b=new f.constructor(d.length*g);let x=0,C=0;for(let I=0,D=d.length;I<D;I++){x=c.isInterleavedBufferAttribute?d[I]*c.data.stride+c.offset:d[I]*g;for(let L=0;L<g;L++)b[C++]=f[x++]}return new No(b,g,v)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Li,n=this.index.array,r=this.attributes;for(const c in r){const f=e(r[c],n);t.setAttribute(c,f)}const s=this.morphAttributes;for(const c in s){const d=[],f=s[c];for(let g=0,v=f.length;g<v;g++){const x=e(f[g],n);d.push(x)}t.morphAttributes[c]=d}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let c=0,d=a.length;c<d;c++){const f=a[c];t.addGroup(f.start,f.count,f.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const d=this.parameters;for(const f in d)void 0!==d[f]&&(e[f]=d[f]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n)e.data.attributes[d]=n[d].toJSON(e.data);const r={};let s=!1;for(const d in this.morphAttributes){const f=this.morphAttributes[d],g=[];for(let v=0,b=f.length;v<b;v++)g.push(f[v].toJSON(e.data));g.length>0&&(r[d]=g,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const c=this.boundingSphere;return null!==c&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;null!==n&&this.setIndex(n.clone(t));const r=e.attributes;for(const f in r)this.setAttribute(f,r[f].clone(t));const s=e.morphAttributes;for(const f in s){const g=[],v=s[f];for(let b=0,x=v.length;b<x;b++)g.push(v[b].clone(t));this.morphAttributes[f]=g}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let f=0,g=a.length;f<g;f++){const v=a[f];this.addGroup(v.start,v.count,v.materialIndex)}const c=e.boundingBox;null!==c&&(this.boundingBox=c.clone());const d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const Ck=new bi,J0=new jC,NR=new t_,Dm=new Q,Rm=new Q,Pm=new Q,OR=new Q,LR=new Q,kR=new Q,KC=new Q,ZC=new Q,YC=new Q,XC=new gt,JC=new gt,QC=new gt,FR=new Q,eA=new Q;class Cl extends qs{constructor(e=new Li,t=new Ou){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;if(void 0===r||(null===n.boundingSphere&&n.computeBoundingSphere(),NR.copy(n.boundingSphere),NR.applyMatrix4(s),!1===e.ray.intersectsSphere(NR))||(Ck.copy(s).invert(),J0.copy(e.ray).applyMatrix4(Ck),null!==n.boundingBox&&!1===J0.intersectsBox(n.boundingBox)))return;let a;const c=n.index,d=n.attributes.position,f=n.morphAttributes.position,g=n.morphTargetsRelative,v=n.attributes.uv,b=n.attributes.uv2,x=n.groups,C=n.drawRange;if(null!==c)if(Array.isArray(r))for(let I=0,D=x.length;I<D;I++){const L=x[I],V=r[L.materialIndex];for(let $=Math.max(L.start,C.start),Z=Math.min(c.count,Math.min(L.start+L.count,C.start+C.count));$<Z;$+=3){const ae=c.getX($),j=c.getX($+1),ie=c.getX($+2);a=tA(this,V,e,J0,d,f,g,v,b,ae,j,ie),a&&(a.faceIndex=Math.floor($/3),a.face.materialIndex=L.materialIndex,t.push(a))}}else for(let L=Math.max(0,C.start),V=Math.min(c.count,C.start+C.count);L<V;L+=3){const z=c.getX(L),U=c.getX(L+1),$=c.getX(L+2);a=tA(this,r,e,J0,d,f,g,v,b,z,U,$),a&&(a.faceIndex=Math.floor(L/3),t.push(a))}else if(void 0!==d)if(Array.isArray(r))for(let I=0,D=x.length;I<D;I++){const L=x[I],V=r[L.materialIndex];for(let $=Math.max(L.start,C.start),Z=Math.min(d.count,Math.min(L.start+L.count,C.start+C.count));$<Z;$+=3)a=tA(this,V,e,J0,d,f,g,v,b,$,$+1,$+2),a&&(a.faceIndex=Math.floor($/3),a.face.materialIndex=L.materialIndex,t.push(a))}else for(let L=Math.max(0,C.start),V=Math.min(d.count,C.start+C.count);L<V;L+=3)a=tA(this,r,e,J0,d,f,g,v,b,L,L+1,L+2),a&&(a.faceIndex=Math.floor(L/3),t.push(a))}}function tA(i,e,t,n,r,s,a,c,d,f,g,v){Dm.fromBufferAttribute(r,f),Rm.fromBufferAttribute(r,g),Pm.fromBufferAttribute(r,v);const b=i.morphTargetInfluences;if(s&&b){KC.set(0,0,0),ZC.set(0,0,0),YC.set(0,0,0);for(let C=0,I=s.length;C<I;C++){const D=b[C],L=s[C];0!==D&&(OR.fromBufferAttribute(L,f),LR.fromBufferAttribute(L,g),kR.fromBufferAttribute(L,v),a?(KC.addScaledVector(OR,D),ZC.addScaledVector(LR,D),YC.addScaledVector(kR,D)):(KC.addScaledVector(OR.sub(Dm),D),ZC.addScaledVector(LR.sub(Rm),D),YC.addScaledVector(kR.sub(Pm),D)))}Dm.add(KC),Rm.add(ZC),Pm.add(YC)}i.isSkinnedMesh&&(i.boneTransform(f,Dm),i.boneTransform(g,Rm),i.boneTransform(v,Pm));const x=function mz(i,e,t,n,r,s,a,c){let d;if(d=1===e.side?n.intersectTriangle(a,s,r,!0,c):n.intersectTriangle(r,s,a,2!==e.side,c),null===d)return null;eA.copy(c),eA.applyMatrix4(i.matrixWorld);const f=t.ray.origin.distanceTo(eA);return f<t.near||f>t.far?null:{distance:f,point:eA.clone(),object:i}}(i,e,t,n,Dm,Rm,Pm,FR);if(x){c&&(XC.fromBufferAttribute(c,f),JC.fromBufferAttribute(c,g),QC.fromBufferAttribute(c,v),x.uv=Sd.getUV(FR,Dm,Rm,Pm,XC,JC,QC,new gt)),d&&(XC.fromBufferAttribute(d,f),JC.fromBufferAttribute(d,g),QC.fromBufferAttribute(d,v),x.uv2=Sd.getUV(FR,Dm,Rm,Pm,XC,JC,QC,new gt));const C={a:f,b:g,c:v,normal:new Q,materialIndex:0};Sd.getNormal(Dm,Rm,Pm,C.normal),x.face=C}return x}class n_ extends Li{constructor(e=1,t=1,n=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:a};const c=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const d=[],f=[],g=[],v=[];let b=0,x=0;function C(I,D,L,V,z,U,$,Z,ae,j,ie){const we=U/ae,Me=$/j,dt=U/2,Mt=$/2,Se=Z/2,it=ae+1,Ge=j+1;let _t=0,vt=0;const rt=new Q;for(let ht=0;ht<Ge;ht++){const zt=ht*Me-Mt;for(let At=0;At<it;At++)rt[I]=(At*we-dt)*V,rt[D]=zt*z,rt[L]=Se,f.push(rt.x,rt.y,rt.z),rt[I]=0,rt[D]=0,rt[L]=Z>0?1:-1,g.push(rt.x,rt.y,rt.z),v.push(At/ae),v.push(1-ht/j),_t+=1}for(let ht=0;ht<j;ht++)for(let zt=0;zt<ae;zt++){const ln=b+zt+it*(ht+1),Mn=b+(zt+1)+it*(ht+1),Bn=b+(zt+1)+it*ht;d.push(b+zt+it*ht,ln,Bn),d.push(ln,Mn,Bn),vt+=6}c.addGroup(x,vt,ie),x+=vt,b+=_t}C("z","y","x",-1,-1,n,t,e,a,s,0),C("z","y","x",1,-1,n,t,-e,a,s,1),C("x","z","y",1,1,e,n,t,r,a,2),C("x","z","y",1,-1,e,n,-t,r,a,3),C("x","y","z",1,-1,e,t,n,r,s,4),C("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(d),this.setAttribute("position",new Dn(f,3)),this.setAttribute("normal",new Dn(g,3)),this.setAttribute("uv",new Dn(v,2))}static fromJSON(e){return new n_(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Q0(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];e[t][n]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function Xa(i){const e={};for(let t=0;t<i.length;t++){const n=Q0(i[t]);for(const r in n)e[r]=n[r]}return e}const gz={clone:Q0,merge:Xa};class qf extends Ro{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Q0(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;t.uniforms[r]=a&&a.isTexture?{type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?{type:"c",value:a.getHex()}:a&&a.isVector2?{type:"v2",value:a.toArray()}:a&&a.isVector3?{type:"v3",value:a.toArray()}:a&&a.isVector4?{type:"v4",value:a.toArray()}:a&&a.isMatrix3?{type:"m3",value:a.toArray()}:a&&a.isMatrix4?{type:"m4",value:a.toArray()}:{value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const n={};for(const r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class VR extends qs{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new bi,this.projectionMatrix=new bi,this.projectionMatrixInverse=new bi}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class ua extends VR{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*UE*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Zy*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*UE*Math.atan(Math.tan(.5*Zy*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,n,r,s,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Zy*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const a=this.view;if(null!==this.view&&this.view.enabled){const d=a.fullWidth,f=a.fullHeight;s+=a.offsetX*r/d,t-=a.offsetY*n/f,r*=a.width/d,n*=a.height/f}const c=this.filmOffset;0!==c&&(s+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class vz extends qs{constructor(e,t,n){if(super(),this.type="CubeCamera",!0!==n.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=n;const r=new ua(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Q(1,0,0)),this.add(r);const s=new ua(90,1,e,t);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Q(-1,0,0)),this.add(s);const a=new ua(90,1,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(new Q(0,1,0)),this.add(a);const c=new ua(90,1,e,t);c.layers=this.layers,c.up.set(0,0,-1),c.lookAt(new Q(0,-1,0)),this.add(c);const d=new ua(90,1,e,t);d.layers=this.layers,d.up.set(0,-1,0),d.lookAt(new Q(0,0,1)),this.add(d);const f=new ua(90,1,e,t);f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new Q(0,0,-1)),this.add(f)}update(e,t){null===this.parent&&this.updateMatrixWorld();const n=this.renderTarget,[r,s,a,c,d,f]=this.children,g=e.getRenderTarget(),v=e.toneMapping,b=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;const x=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,r),e.setRenderTarget(n,1),e.render(t,s),e.setRenderTarget(n,2),e.render(t,a),e.setRenderTarget(n,3),e.render(t,c),e.setRenderTarget(n,4),e.render(t,d),n.texture.generateMipmaps=x,e.setRenderTarget(n,5),e.render(t,f),e.setRenderTarget(g),e.toneMapping=v,e.xr.enabled=b,n.texture.needsPMREMUpdate=!0}}class nA extends bd{constructor(e,t,n,r,s,a,c,d,f,g){super(e=void 0!==e?e:[],t=void 0!==t?t:301,n,r,s,a,c,d,f,g),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class wz extends Tm{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1};this.texture=new nA([n,n,n,n,n,n],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:$s}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n_uniforms={tEquirect:{value:null}},n_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",n_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new n_(5,5,5),s=new qf({name:"CubemapFromEquirect",uniforms:Q0(n_uniforms),vertexShader:n_vertexShader,fragmentShader:n_fragmentShader,side:1,blending:0});s.uniforms.tEquirect.value=t;const a=new Cl(r,s),c=t.minFilter;return t.minFilter===Em&&(t.minFilter=$s),new vz(1,10,this).update(e,a),t.minFilter=c,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,n,r){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(s)}}const UR=new Q,bz=new Q,xz=new _d;class i_{constructor(e=new Q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=UR.subVectors(n,t).cross(bz.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const n=e.delta(UR),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(n).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||xz.getNormalMatrix(e),r=this.coplanarPoint(UR).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const nw=new t_,iA=new Q;class BR{constructor(e=new i_,t=new i_,n=new i_,r=new i_,s=new i_,a=new i_){this.planes=[e,t,n,r,s,a]}set(e,t,n,r,s,a){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(s),c[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e){const t=this.planes,n=e.elements,r=n[0],s=n[1],a=n[2],c=n[3],d=n[4],f=n[5],g=n[6],v=n[7],b=n[8],x=n[9],C=n[10],I=n[11],D=n[12],L=n[13],V=n[14],z=n[15];return t[0].setComponents(c-r,v-d,I-b,z-D).normalize(),t[1].setComponents(c+r,v+d,I+b,z+D).normalize(),t[2].setComponents(c+s,v+f,I+x,z+L).normalize(),t[3].setComponents(c-s,v-f,I-x,z-L).normalize(),t[4].setComponents(c-a,v-g,I-C,z-V).normalize(),t[5].setComponents(c+a,v+g,I+C,z+V).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),nw.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(nw)}intersectsSprite(e){return nw.center.set(0,0,0),nw.radius=.7071067811865476,nw.applyMatrix4(e.matrixWorld),this.intersectsSphere(nw)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(iA.x=r.normal.x>0?e.max.x:e.min.x,iA.y=r.normal.y>0?e.max.y:e.min.y,iA.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(iA)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Ak(){let i=null,e=!1,t=null,n=null;function r(s,a){t(s,a),n=i.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function Ez(i,e){const t=e.isWebGL2,n=new WeakMap;return{get:function a(f){return f.isInterleavedBufferAttribute&&(f=f.data),n.get(f)},remove:function c(f){f.isInterleavedBufferAttribute&&(f=f.data);const g=n.get(f);g&&(i.deleteBuffer(g.buffer),n.delete(f))},update:function d(f,g){if(f.isGLBufferAttribute){const b=n.get(f);return void((!b||b.version<f.version)&&n.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version}))}f.isInterleavedBufferAttribute&&(f=f.data);const v=n.get(f);void 0===v?n.set(f,function r(f,g){const v=f.array,b=f.usage,x=i.createBuffer();let C;if(i.bindBuffer(g,x),i.bufferData(g,v,b),f.onUploadCallback(),v instanceof Float32Array)C=5126;else if(v instanceof Uint16Array)if(f.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");C=5131}else C=5123;else if(v instanceof Int16Array)C=5122;else if(v instanceof Uint32Array)C=5125;else if(v instanceof Int32Array)C=5124;else if(v instanceof Int8Array)C=5120;else if(v instanceof Uint8Array)C=5121;else{if(!(v instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+v);C=5121}return{buffer:x,type:C,bytesPerElement:v.BYTES_PER_ELEMENT,version:f.version}}(f,g)):v.version<f.version&&(function s(f,g,v){const b=g.array,x=g.updateRange;i.bindBuffer(v,f),-1===x.count?i.bufferSubData(v,0,b):(t?i.bufferSubData(v,x.offset*b.BYTES_PER_ELEMENT,b,x.offset,x.count):i.bufferSubData(v,x.offset*b.BYTES_PER_ELEMENT,b.subarray(x.offset,x.offset+x.count)),x.count=-1)}(v.buffer,f,g),v.version=f.version)}}}class WE extends Li{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,a=t/2,c=Math.floor(n),d=Math.floor(r),f=c+1,g=d+1,v=e/c,b=t/d,x=[],C=[],I=[],D=[];for(let L=0;L<g;L++){const V=L*b-a;for(let z=0;z<f;z++)C.push(z*v-s,-V,0),I.push(0,0,1),D.push(z/c),D.push(1-L/d)}for(let L=0;L<d;L++)for(let V=0;V<c;V++){const U=V+f*(L+1),$=V+1+f*(L+1),Z=V+1+f*L;x.push(V+f*L,U,Z),x.push(U,$,Z)}this.setIndex(x),this.setAttribute("position",new Dn(C,3)),this.setAttribute("normal",new Dn(I,3)),this.setAttribute("uv",new Dn(D,2))}static fromJSON(e){return new WE(e.width,e.height,e.widthSegments,e.heightSegments)}}const Vi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\nvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\nconst mat3 XYZ_TO_REC709 = mat3(\n    3.2404542, -0.9692660,  0.0556434,\n   -1.5371385,  1.8760108, -0.2040259,\n   -0.4985314,  0.0415560,  1.0572252\n);\nvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n   vec3 sqrtF0 = sqrt( fresnel0 );\n   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n}\nvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n}\nfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n}\nvec3 evalSensitivity( float OPD, vec3 shift ) {\n   float phase = 2.0 * PI * OPD * 1.0e-9;\n   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );\n   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );\n   xyz /= 1.0685e-7;\n   vec3 srgb = XYZ_TO_REC709 * xyz;\n   return srgb;\n}\nvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n   vec3 I;\n   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n   float cosTheta2Sq = 1.0 - sinTheta2Sq;\n   if ( cosTheta2Sq < 0.0 ) {\n       return vec3( 1.0 );\n   }\n   float cosTheta2 = sqrt( cosTheta2Sq );\n   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n   float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n   float R21 = R12;\n   float T121 = 1.0 - R12;\n   float phi12 = 0.0;\n   if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n   float phi21 = PI - phi12;\n   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n   vec3 phi23 = vec3( 0.0 );\n   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;\n   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;\n   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;\n   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n   vec3 phi = vec3( phi21 ) + phi23;\n   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n   vec3 r123 = sqrt( R123 );\n   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n   vec3 C0 = R12 + Rs;\n   I = C0;\n   vec3 Cm = Rs - T121;\n   for ( int m = 1; m <= 2; ++m ) {\n       Cm *= r123;\n       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n       I += Cm * Sm;\n   }\n   return max( I, vec3( 0.0 ) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\nfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\nif ( material.iridescenceThickness == 0.0 ) {\n\tmaterial.iridescence = 0.0;\n} else {\n\tmaterial.iridescence = saturate( material.iridescence );\n}\nif ( material.iridescence > 0.0 ) {\n\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},un={common:{diffuse:{value:new rn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new _d},uv2Transform:{value:new _d},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new gt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new rn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new rn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new _d}},sprite:{diffuse:{value:new rn(16777215)},opacity:{value:1},center:{value:new gt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new _d}}},wh={basic:{uniforms:Xa([un.common,un.specularmap,un.envmap,un.aomap,un.lightmap,un.fog]),vertexShader:Vi.meshbasic_vert,fragmentShader:Vi.meshbasic_frag},lambert:{uniforms:Xa([un.common,un.specularmap,un.envmap,un.aomap,un.lightmap,un.emissivemap,un.fog,un.lights,{emissive:{value:new rn(0)}}]),vertexShader:Vi.meshlambert_vert,fragmentShader:Vi.meshlambert_frag},phong:{uniforms:Xa([un.common,un.specularmap,un.envmap,un.aomap,un.lightmap,un.emissivemap,un.bumpmap,un.normalmap,un.displacementmap,un.fog,un.lights,{emissive:{value:new rn(0)},specular:{value:new rn(1118481)},shininess:{value:30}}]),vertexShader:Vi.meshphong_vert,fragmentShader:Vi.meshphong_frag},standard:{uniforms:Xa([un.common,un.envmap,un.aomap,un.lightmap,un.emissivemap,un.bumpmap,un.normalmap,un.displacementmap,un.roughnessmap,un.metalnessmap,un.fog,un.lights,{emissive:{value:new rn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Vi.meshphysical_vert,fragmentShader:Vi.meshphysical_frag},toon:{uniforms:Xa([un.common,un.aomap,un.lightmap,un.emissivemap,un.bumpmap,un.normalmap,un.displacementmap,un.gradientmap,un.fog,un.lights,{emissive:{value:new rn(0)}}]),vertexShader:Vi.meshtoon_vert,fragmentShader:Vi.meshtoon_frag},matcap:{uniforms:Xa([un.common,un.bumpmap,un.normalmap,un.displacementmap,un.fog,{matcap:{value:null}}]),vertexShader:Vi.meshmatcap_vert,fragmentShader:Vi.meshmatcap_frag},points:{uniforms:Xa([un.points,un.fog]),vertexShader:Vi.points_vert,fragmentShader:Vi.points_frag},dashed:{uniforms:Xa([un.common,un.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Vi.linedashed_vert,fragmentShader:Vi.linedashed_frag},depth:{uniforms:Xa([un.common,un.displacementmap]),vertexShader:Vi.depth_vert,fragmentShader:Vi.depth_frag},normal:{uniforms:Xa([un.common,un.bumpmap,un.normalmap,un.displacementmap,{opacity:{value:1}}]),vertexShader:Vi.meshnormal_vert,fragmentShader:Vi.meshnormal_frag},sprite:{uniforms:Xa([un.sprite,un.fog]),vertexShader:Vi.sprite_vert,fragmentShader:Vi.sprite_frag},background:{uniforms:{uvTransform:{value:new _d},t2D:{value:null}},vertexShader:Vi.background_vert,fragmentShader:Vi.background_frag},cube:{uniforms:Xa([un.envmap,{opacity:{value:1}}]),vertexShader:Vi.cube_vert,fragmentShader:Vi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Vi.equirect_vert,fragmentShader:Vi.equirect_frag},distanceRGBA:{uniforms:Xa([un.common,un.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Vi.distanceRGBA_vert,fragmentShader:Vi.distanceRGBA_frag},shadow:{uniforms:Xa([un.lights,un.fog,{color:{value:new rn(0)},opacity:{value:1}}]),vertexShader:Vi.shadow_vert,fragmentShader:Vi.shadow_frag}};function b4(i,e,t,n,r,s){const a=new rn(0);let d,f,c=!0===r?0:1,g=null,v=0,b=null;function C(I,D){t.buffers.color.setClear(I.r,I.g,I.b,D,s)}return{getClearColor:function(){return a},setClearColor:function(I,D=1){a.set(I),c=D,C(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(I){c=I,C(a,c)},render:function x(I,D){let L=!1,V=!0===D.isScene?D.background:null;V&&V.isTexture&&(V=e.get(V));const z=i.xr,U=z.getSession&&z.getSession();U&&"additive"===U.environmentBlendMode&&(V=null),null===V?C(a,c):V&&V.isColor&&(C(V,1),L=!0),(i.autoClear||L)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),V&&(V.isCubeTexture||306===V.mapping)?(void 0===f&&(f=new Cl(new n_(1,1,1),new qf({name:"BackgroundCubeMaterial",uniforms:Q0(wh.cube.uniforms),vertexShader:wh.cube.vertexShader,fragmentShader:wh.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function($,Z,ae){this.matrixWorld.copyPosition(ae.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(f)),f.material.uniforms.envMap.value=V,f.material.uniforms.flipEnvMap.value=V.isCubeTexture&&!1===V.isRenderTargetTexture?-1:1,(g!==V||v!==V.version||b!==i.toneMapping)&&(f.material.needsUpdate=!0,g=V,v=V.version,b=i.toneMapping),f.layers.enableAll(),I.unshift(f,f.geometry,f.material,0,0,null)):V&&V.isTexture&&(void 0===d&&(d=new Cl(new WE(2,2),new qf({name:"BackgroundMaterial",uniforms:Q0(wh.background.uniforms),vertexShader:wh.background.vertexShader,fragmentShader:wh.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(d)),d.material.uniforms.t2D.value=V,!0===V.matrixAutoUpdate&&V.updateMatrix(),d.material.uniforms.uvTransform.value.copy(V.matrix),(g!==V||v!==V.version||b!==i.toneMapping)&&(d.material.needsUpdate=!0,g=V,v=V.version,b=i.toneMapping),d.layers.enableAll(),I.unshift(d,d.geometry,d.material,0,0,null))}}}function x4(i,e,t,n){const r=i.getParameter(34921),s=n.isWebGL2?null:e.get("OES_vertex_array_object"),a=n.isWebGL2||null!==s,c={},d=D(null);let f=d,g=!1;function x(Se){return n.isWebGL2?i.bindVertexArray(Se):s.bindVertexArrayOES(Se)}function C(Se){return n.isWebGL2?i.deleteVertexArray(Se):s.deleteVertexArrayOES(Se)}function D(Se){const it=[],Ge=[],_t=[];for(let vt=0;vt<r;vt++)it[vt]=0,Ge[vt]=0,_t[vt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:it,enabledAttributes:Ge,attributeDivisors:_t,object:Se,attributes:{},index:null}}function z(){const Se=f.newAttributes;for(let it=0,Ge=Se.length;it<Ge;it++)Se[it]=0}function U(Se){$(Se,0)}function $(Se,it){const _t=f.enabledAttributes,vt=f.attributeDivisors;f.newAttributes[Se]=1,0===_t[Se]&&(i.enableVertexAttribArray(Se),_t[Se]=1),vt[Se]!==it&&((n.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Se,it),vt[Se]=it)}function Z(){const Se=f.newAttributes,it=f.enabledAttributes;for(let Ge=0,_t=it.length;Ge<_t;Ge++)it[Ge]!==Se[Ge]&&(i.disableVertexAttribArray(Ge),it[Ge]=0)}function ae(Se,it,Ge,_t,vt,rt){!0!==n.isWebGL2||5124!==Ge&&5125!==Ge?i.vertexAttribPointer(Se,it,Ge,_t,vt,rt):i.vertexAttribIPointer(Se,it,Ge,vt,rt)}function dt(){Mt(),g=!0,f!==d&&(f=d,x(f.object))}function Mt(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:function v(Se,it,Ge,_t,vt){let rt=!1;if(a){const ht=function I(Se,it,Ge){const _t=!0===Ge.wireframe;let vt=c[Se.id];void 0===vt&&(vt={},c[Se.id]=vt);let rt=vt[it.id];void 0===rt&&(rt={},vt[it.id]=rt);let ht=rt[_t];return void 0===ht&&(ht=D(function b(){return n.isWebGL2?i.createVertexArray():s.createVertexArrayOES()}()),rt[_t]=ht),ht}(_t,Ge,it);f!==ht&&(f=ht,x(f.object)),rt=function L(Se,it,Ge,_t){const vt=f.attributes,rt=it.attributes;let ht=0;const zt=Ge.getAttributes();for(const At in zt)if(zt[At].location>=0){const Mn=vt[At];let Bn=rt[At];if(void 0===Bn&&("instanceMatrix"===At&&Se.instanceMatrix&&(Bn=Se.instanceMatrix),"instanceColor"===At&&Se.instanceColor&&(Bn=Se.instanceColor)),void 0===Mn||Mn.attribute!==Bn||Bn&&Mn.data!==Bn.data)return!0;ht++}return f.attributesNum!==ht||f.index!==_t}(Se,_t,Ge,vt),rt&&function V(Se,it,Ge,_t){const vt={},rt=it.attributes;let ht=0;const zt=Ge.getAttributes();for(const At in zt)if(zt[At].location>=0){let Mn=rt[At];void 0===Mn&&("instanceMatrix"===At&&Se.instanceMatrix&&(Mn=Se.instanceMatrix),"instanceColor"===At&&Se.instanceColor&&(Mn=Se.instanceColor));const Bn={};Bn.attribute=Mn,Mn&&Mn.data&&(Bn.data=Mn.data),vt[At]=Bn,ht++}f.attributes=vt,f.attributesNum=ht,f.index=_t}(Se,_t,Ge,vt)}else{const ht=!0===it.wireframe;(f.geometry!==_t.id||f.program!==Ge.id||f.wireframe!==ht)&&(f.geometry=_t.id,f.program=Ge.id,f.wireframe=ht,rt=!0)}null!==vt&&t.update(vt,34963),(rt||g)&&(g=!1,function j(Se,it,Ge,_t){if(!1===n.isWebGL2&&(Se.isInstancedMesh||_t.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;z();const vt=_t.attributes,rt=Ge.getAttributes(),ht=it.defaultAttributeValues;for(const zt in rt){const At=rt[zt];if(At.location>=0){let ln=vt[zt];if(void 0===ln&&("instanceMatrix"===zt&&Se.instanceMatrix&&(ln=Se.instanceMatrix),"instanceColor"===zt&&Se.instanceColor&&(ln=Se.instanceColor)),void 0!==ln){const Mn=ln.normalized,Bn=ln.itemSize,ft=t.get(ln);if(void 0===ft)continue;const Bi=ft.buffer,oi=ft.type,di=ft.bytesPerElement;if(ln.isInterleavedBufferAttribute){const tn=ln.data,xi=tn.stride,xt=ln.offset;if(tn.isInstancedInterleavedBuffer){for(let wt=0;wt<At.locationSize;wt++)$(At.location+wt,tn.meshPerAttribute);!0!==Se.isInstancedMesh&&void 0===_t._maxInstanceCount&&(_t._maxInstanceCount=tn.meshPerAttribute*tn.count)}else for(let wt=0;wt<At.locationSize;wt++)U(At.location+wt);i.bindBuffer(34962,Bi);for(let wt=0;wt<At.locationSize;wt++)ae(At.location+wt,Bn/At.locationSize,oi,Mn,xi*di,(xt+Bn/At.locationSize*wt)*di)}else{if(ln.isInstancedBufferAttribute){for(let tn=0;tn<At.locationSize;tn++)$(At.location+tn,ln.meshPerAttribute);!0!==Se.isInstancedMesh&&void 0===_t._maxInstanceCount&&(_t._maxInstanceCount=ln.meshPerAttribute*ln.count)}else for(let tn=0;tn<At.locationSize;tn++)U(At.location+tn);i.bindBuffer(34962,Bi);for(let tn=0;tn<At.locationSize;tn++)ae(At.location+tn,Bn/At.locationSize,oi,Mn,Bn*di,Bn/At.locationSize*tn*di)}}else if(void 0!==ht){const Mn=ht[zt];if(void 0!==Mn)switch(Mn.length){case 2:i.vertexAttrib2fv(At.location,Mn);break;case 3:i.vertexAttrib3fv(At.location,Mn);break;case 4:i.vertexAttrib4fv(At.location,Mn);break;default:i.vertexAttrib1fv(At.location,Mn)}}}}Z()}(Se,it,Ge,_t),null!==vt&&i.bindBuffer(34963,t.get(vt).buffer))},reset:dt,resetDefaultState:Mt,dispose:function ie(){dt();for(const Se in c){const it=c[Se];for(const Ge in it){const _t=it[Ge];for(const vt in _t)C(_t[vt].object),delete _t[vt];delete it[Ge]}delete c[Se]}},releaseStatesOfGeometry:function we(Se){if(void 0===c[Se.id])return;const it=c[Se.id];for(const Ge in it){const _t=it[Ge];for(const vt in _t)C(_t[vt].object),delete _t[vt];delete it[Ge]}delete c[Se.id]},releaseStatesOfProgram:function Me(Se){for(const it in c){const Ge=c[it];if(void 0===Ge[Se.id])continue;const _t=Ge[Se.id];for(const vt in _t)C(_t[vt].object),delete _t[vt];delete Ge[Se.id]}},initAttributes:z,enableAttribute:U,disableUnusedAttributes:Z}}function E4(i,e,t,n){const r=n.isWebGL2;let s;this.setMode=function a(f){s=f},this.render=function c(f,g){i.drawArrays(s,f,g),t.update(g,s,1)},this.renderInstances=function d(f,g,v){if(0===v)return;let b,x;if(r)b=i,x="drawArraysInstanced";else if(b=e.get("ANGLE_instanced_arrays"),x="drawArraysInstancedANGLE",null===b)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");b[x](s,f,g,v),t.update(g,s,v)}}function S4(i,e,t){let n;function s(ae){if("highp"===ae){if(i.getShaderPrecisionFormat(35633,36338).precision>0&&i.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";ae="mediump"}return"mediump"===ae&&i.getShaderPrecisionFormat(35633,36337).precision>0&&i.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a="undefined"!=typeof WebGL2RenderingContext&&i instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&i instanceof WebGL2ComputeRenderingContext;let c=void 0!==t.precision?t.precision:"highp";const d=s(c);d!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",d,"instead."),c=d);const f=a||e.has("WEBGL_draw_buffers"),g=!0===t.logarithmicDepthBuffer,v=i.getParameter(34930),b=i.getParameter(35660),x=i.getParameter(3379),C=i.getParameter(34076),I=i.getParameter(34921),D=i.getParameter(36347),L=i.getParameter(36348),V=i.getParameter(36349),z=b>0,U=a||e.has("OES_texture_float");return{isWebGL2:a,drawBuffers:f,getMaxAnisotropy:function r(){if(void 0!==n)return n;if(!0===e.has("EXT_texture_filter_anisotropic")){const ae=e.get("EXT_texture_filter_anisotropic");n=i.getParameter(ae.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n},getMaxPrecision:s,precision:c,logarithmicDepthBuffer:g,maxTextures:v,maxVertexTextures:b,maxTextureSize:x,maxCubemapSize:C,maxAttributes:I,maxVertexUniforms:D,maxVaryings:L,maxFragmentUniforms:V,vertexTextures:z,floatFragmentTextures:U,floatVertexTextures:z&&U,maxSamples:a?i.getParameter(36183):0}}function T4(i){const e=this;let t=null,n=0,r=!1,s=!1;const a=new i_,c=new _d,d={value:null,needsUpdate:!1};function f(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function g(v,b,x,C){const I=null!==v?v.length:0;let D=null;if(0!==I){if(D=d.value,!0!==C||null===D){const L=x+4*I,V=b.matrixWorldInverse;c.getNormalMatrix(V),(null===D||D.length<L)&&(D=new Float32Array(L));for(let z=0,U=x;z!==I;++z,U+=4)a.copy(v[z]).applyMatrix4(V,c),a.normal.toArray(D,U),D[U+3]=a.constant}d.value=D,d.needsUpdate=!0}return e.numPlanes=I,e.numIntersection=0,D}this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(v,b,x){const C=0!==v.length||b||0!==n||r;return r=b,t=g(v,x,0),n=v.length,C},this.beginShadows=function(){s=!0,g(null)},this.endShadows=function(){s=!1,f()},this.setState=function(v,b,x){const C=v.clippingPlanes,I=v.clipIntersection,D=v.clipShadows,L=i.get(v);if(!r||null===C||0===C.length||s&&!D)s?g(null):f();else{const V=s?0:n,z=4*V;let U=L.clippingState||null;d.value=U,U=g(C,b,z,x);for(let $=0;$!==z;++$)U[$]=t[$];L.clippingState=U,this.numIntersection=I?this.numPlanes:0,this.numPlanes+=V}}}function M4(i){let e=new WeakMap;function t(a,c){return 303===c?a.mapping=301:304===c&&(a.mapping=302),a}function r(a){const c=a.target;c.removeEventListener("dispose",r);const d=e.get(c);void 0!==d&&(e.delete(c),d.dispose())}return{get:function n(a){if(a&&a.isTexture&&!1===a.isRenderTargetTexture){const c=a.mapping;if(303===c||304===c){if(e.has(a))return t(e.get(a).texture,a.mapping);{const d=a.image;if(d&&d.height>0){const f=new wz(d.height/2);return f.fromEquirectangularTexture(i,a),e.set(a,f),a.addEventListener("dispose",r),t(f.texture,a.mapping)}return null}}}return a},dispose:function s(){e=new WeakMap}}}wh.physical={uniforms:Xa([wh.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new gt(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new rn(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new gt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new rn(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new rn(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Vi.meshphysical_vert,fragmentShader:Vi.meshphysical_frag};class rA extends VR{constructor(e=-1,t=1,n=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,a=n+e,c=r+t,d=r-t;if(null!==this.view&&this.view.enabled){const f=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=f*this.view.offsetX,a=s+f*this.view.width,c-=g*this.view.offsetY,d=c-g*this.view.height}this.projectionMatrix.makeOrthographic(s,a,c,d,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const Ik=[.125,.215,.35,.446,.526,.582],HR=new rA,Dk=new rn;let zR=null;const s_=(1+Math.sqrt(5))/2,rw=1/s_,Rk=[new Q(1,1,1),new Q(-1,1,1),new Q(1,1,-1),new Q(-1,1,-1),new Q(0,s_,rw),new Q(0,s_,-rw),new Q(rw,0,s_),new Q(-rw,0,s_),new Q(s_,rw,0),new Q(-s_,rw,0)];class Pk{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){zR=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Lk(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Ok(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(zR),e.scissorTest=!1,sA(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),zR=this._renderer.getRenderTarget();const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:$s,minFilter:$s,generateMipmaps:!1,type:FE,format:Nu,encoding:Wy,depthBuffer:!1},r=Nk(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Nk(e,t,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function C4(i){const e=[],t=[],n=[];let r=i;const s=i-4+1+Ik.length;for(let a=0;a<s;a++){const c=Math.pow(2,r);t.push(c);let d=1/c;a>i-4?d=Ik[a-i+4-1]:0===a&&(d=0),n.push(d);const f=1/(c-2),g=-f,v=1+f,b=[g,g,v,g,v,v,g,g,v,v,g,v],x=6,C=6,I=3,D=2,L=1,V=new Float32Array(I*C*x),z=new Float32Array(D*C*x),U=new Float32Array(L*C*x);for(let Z=0;Z<x;Z++){const ae=Z%3*2/3-1,j=Z>2?0:-1;V.set([ae,j,0,ae+2/3,j,0,ae+2/3,j+1,0,ae,j,0,ae+2/3,j+1,0,ae,j+1,0],I*C*Z),z.set(b,D*C*Z),U.set([Z,Z,Z,Z,Z,Z],L*C*Z)}const $=new Li;$.setAttribute("position",new No(V,I)),$.setAttribute("uv",new No(z,D)),$.setAttribute("faceIndex",new No(U,L)),e.push($),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}(s)),this._blurMaterial=function A4(i,e,t){const n=new Float32Array(20),r=new Q(0,1,0);return new qf({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(s,e,t)}return r}_compileMaterial(e){const t=new Cl(this._lodPlanes[0],e);this._renderer.compile(t,HR)}_sceneToCubeUV(e,t,n,r){const c=new ua(90,1,t,n),d=[1,-1,1,1,1,1],f=[1,1,1,-1,-1,-1],g=this._renderer,v=g.autoClear,b=g.toneMapping;g.getClearColor(Dk),g.toneMapping=0,g.autoClear=!1;const x=new Ou({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),C=new Cl(new n_,x);let I=!1;const D=e.background;D?D.isColor&&(x.color.copy(D),e.background=null,I=!0):(x.color.copy(Dk),I=!0);for(let L=0;L<6;L++){const V=L%3;0===V?(c.up.set(0,d[L],0),c.lookAt(f[L],0,0)):1===V?(c.up.set(0,0,d[L]),c.lookAt(0,f[L],0)):(c.up.set(0,d[L],0),c.lookAt(0,0,f[L]));const z=this._cubeSize;sA(r,V*z,L>2?z:0,z,z),g.setRenderTarget(r),I&&g.render(C,c),g.render(e,c)}C.geometry.dispose(),C.material.dispose(),g.toneMapping=b,g.autoClear=v,e.background=D}_textureToCubeUV(e,t){const n=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=Lk()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Ok());const s=r?this._cubemapMaterial:this._equirectMaterial,a=new Cl(this._lodPlanes[0],s);s.uniforms.envMap.value=e;const d=this._cubeSize;sA(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(a,HR)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,s,Rk[(r-1)%Rk.length])}t.autoClear=n}_blur(e,t,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",s),this._halfBlur(a,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,a,c){const d=this._renderer,f=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");const v=new Cl(this._lodPlanes[r],f),b=f.uniforms,x=this._sizeLods[n]-1,C=isFinite(s)?Math.PI/(2*x):2*Math.PI/39,I=s/C,D=isFinite(s)?1+Math.floor(3*I):20;D>20&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${D} samples when the maximum is set to 20`);const L=[];let V=0;for(let ae=0;ae<20;++ae){const j=ae/I,ie=Math.exp(-j*j/2);L.push(ie),0===ae?V+=ie:ae<D&&(V+=2*ie)}for(let ae=0;ae<L.length;ae++)L[ae]=L[ae]/V;b.envMap.value=e.texture,b.samples.value=D,b.weights.value=L,b.latitudinal.value="latitudinal"===a,c&&(b.poleAxis.value=c);const{_lodMax:z}=this;b.dTheta.value=C,b.mipInt.value=z-n;const U=this._sizeLods[r];sA(t,3*U*(r>z-4?r-z+4:0),4*(this._cubeSize-U),3*U,2*U),d.setRenderTarget(t),d.render(v,HR)}}function Nk(i,e,t){const n=new Tm(i,e,t);return n.texture.mapping=306,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function sA(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function Ok(){return new qf({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function Lk(){return new qf({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function I4(i){let e=new WeakMap,t=null;function s(c){const d=c.target;d.removeEventListener("dispose",s);const f=e.get(d);void 0!==f&&(e.delete(d),f.dispose())}return{get:function n(c){if(c&&c.isTexture){const d=c.mapping,f=303===d||304===d,g=301===d||302===d;if(f||g){if(c.isRenderTargetTexture&&!0===c.needsPMREMUpdate){c.needsPMREMUpdate=!1;let v=e.get(c);return null===t&&(t=new Pk(i)),v=f?t.fromEquirectangular(c,v):t.fromCubemap(c,v),e.set(c,v),v.texture}if(e.has(c))return e.get(c).texture;{const v=c.image;if(f&&v&&v.height>0||g&&v&&function r(c){let d=0;for(let g=0;g<6;g++)void 0!==c[g]&&d++;return 6===d}(v)){null===t&&(t=new Pk(i));const b=f?t.fromEquirectangular(c):t.fromCubemap(c);return e.set(c,b),c.addEventListener("dispose",s),b.texture}return null}}}return c},dispose:function a(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function D4(i){const e={};function t(n){if(void 0!==e[n])return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return null!==t(n)},init:function(n){n.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(n){const r=t(n);return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function R4(i,e,t,n){const r={},s=new WeakMap;function a(v){const b=v.target;null!==b.index&&e.remove(b.index);for(const C in b.attributes)e.remove(b.attributes[C]);b.removeEventListener("dispose",a),delete r[b.id];const x=s.get(b);x&&(e.remove(x),s.delete(b)),n.releaseStatesOfGeometry(b),!0===b.isInstancedBufferGeometry&&delete b._maxInstanceCount,t.memory.geometries--}function f(v){const b=[],x=v.index,C=v.attributes.position;let I=0;if(null!==x){const V=x.array;I=x.version;for(let z=0,U=V.length;z<U;z+=3){const $=V[z+0],Z=V[z+1],ae=V[z+2];b.push($,Z,Z,ae,ae,$)}}else{I=C.version;for(let z=0,U=C.array.length/3-1;z<U;z+=3){const $=z+0,Z=z+1,ae=z+2;b.push($,Z,Z,ae,ae,$)}}const D=new(dk(b)?Mk:Tk)(b,1);D.version=I;const L=s.get(v);L&&e.remove(L),s.set(v,D)}return{get:function c(v,b){return!0===r[b.id]||(b.addEventListener("dispose",a),r[b.id]=!0,t.memory.geometries++),b},update:function d(v){const b=v.attributes;for(const C in b)e.update(b[C],34962);const x=v.morphAttributes;for(const C in x){const I=x[C];for(let D=0,L=I.length;D<L;D++)e.update(I[D],34962)}},getWireframeAttribute:function g(v){const b=s.get(v);if(b){const x=v.index;null!==x&&b.version<x.version&&f(v)}else f(v);return s.get(v)}}}function P4(i,e,t,n){const r=n.isWebGL2;let s,c,d;this.setMode=function a(b){s=b},this.setIndex=function f(b){c=b.type,d=b.bytesPerElement},this.render=function g(b,x){i.drawElements(s,x,c,b*d),t.update(x,s,1)},this.renderInstances=function v(b,x,C){if(0===C)return;let I,D;if(r)I=i,D="drawElementsInstanced";else if(I=e.get("ANGLE_instanced_arrays"),D="drawElementsInstancedANGLE",null===I)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");I[D](s,x,c,b*d,C),t.update(x,s,C)}}function N4(i){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function n(s,a,c){switch(t.calls++,a){case 4:t.triangles+=c*(s/3);break;case 1:t.lines+=c*(s/2);break;case 3:t.lines+=c*(s-1);break;case 2:t.lines+=c*s;break;case 0:t.points+=c*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a)}}}}function O4(i,e){return i[0]-e[0]}function L4(i,e){return Math.abs(e[1])-Math.abs(i[1])}function jR(i,e){let t=1;const n=e.isInterleavedBufferAttribute?e.data.array:e.array;n instanceof Int8Array?t=127:n instanceof Int16Array?t=32767:n instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",n),i.divideScalar(t)}function k4(i,e,t){const n={},r=new Float32Array(8),s=new WeakMap,a=new Ur,c=[];for(let f=0;f<8;f++)c[f]=[f,0];return{update:function d(f,g,v,b){const x=f.morphTargetInfluences;if(!0===e.isWebGL2){const C=g.morphAttributes.position||g.morphAttributes.normal||g.morphAttributes.color,I=void 0!==C?C.length:0;let D=s.get(g);if(void 0===D||D.count!==I){let it=function(){Mt.dispose(),s.delete(g),g.removeEventListener("dispose",it)};void 0!==D&&D.texture.dispose();const z=void 0!==g.morphAttributes.position,U=void 0!==g.morphAttributes.normal,$=void 0!==g.morphAttributes.color,Z=g.morphAttributes.position||[],ae=g.morphAttributes.normal||[],j=g.morphAttributes.color||[];let ie=0;!0===z&&(ie=1),!0===U&&(ie=2),!0===$&&(ie=3);let we=g.attributes.position.count*ie,Me=1;we>e.maxTextureSize&&(Me=Math.ceil(we/e.maxTextureSize),we=e.maxTextureSize);const dt=new Float32Array(we*Me*4*I),Mt=new vR(dt,we,Me,I);Mt.type=Sm,Mt.needsUpdate=!0;const Se=4*ie;for(let Ge=0;Ge<I;Ge++){const _t=Z[Ge],vt=ae[Ge],rt=j[Ge],ht=we*Me*4*Ge;for(let zt=0;zt<_t.count;zt++){const At=zt*Se;!0===z&&(a.fromBufferAttribute(_t,zt),!0===_t.normalized&&jR(a,_t),dt[ht+At+0]=a.x,dt[ht+At+1]=a.y,dt[ht+At+2]=a.z,dt[ht+At+3]=0),!0===U&&(a.fromBufferAttribute(vt,zt),!0===vt.normalized&&jR(a,vt),dt[ht+At+4]=a.x,dt[ht+At+5]=a.y,dt[ht+At+6]=a.z,dt[ht+At+7]=0),!0===$&&(a.fromBufferAttribute(rt,zt),!0===rt.normalized&&jR(a,rt),dt[ht+At+8]=a.x,dt[ht+At+9]=a.y,dt[ht+At+10]=a.z,dt[ht+At+11]=4===rt.itemSize?a.w:1)}}D={count:I,texture:Mt,size:new gt(we,Me)},s.set(g,D),g.addEventListener("dispose",it)}let L=0;for(let z=0;z<x.length;z++)L+=x[z];const V=g.morphTargetsRelative?1:1-L;b.getUniforms().setValue(i,"morphTargetBaseInfluence",V),b.getUniforms().setValue(i,"morphTargetInfluences",x),b.getUniforms().setValue(i,"morphTargetsTexture",D.texture,t),b.getUniforms().setValue(i,"morphTargetsTextureSize",D.size)}else{const C=void 0===x?0:x.length;let I=n[g.id];if(void 0===I||I.length!==C){I=[];for(let U=0;U<C;U++)I[U]=[U,0];n[g.id]=I}for(let U=0;U<C;U++){const $=I[U];$[0]=U,$[1]=x[U]}I.sort(L4);for(let U=0;U<8;U++)U<C&&I[U][1]?(c[U][0]=I[U][0],c[U][1]=I[U][1]):(c[U][0]=Number.MAX_SAFE_INTEGER,c[U][1]=0);c.sort(O4);const D=g.morphAttributes.position,L=g.morphAttributes.normal;let V=0;for(let U=0;U<8;U++){const $=c[U],Z=$[0],ae=$[1];Z!==Number.MAX_SAFE_INTEGER&&ae?(D&&g.getAttribute("morphTarget"+U)!==D[Z]&&g.setAttribute("morphTarget"+U,D[Z]),L&&g.getAttribute("morphNormal"+U)!==L[Z]&&g.setAttribute("morphNormal"+U,L[Z]),r[U]=ae,V+=ae):(D&&!0===g.hasAttribute("morphTarget"+U)&&g.deleteAttribute("morphTarget"+U),L&&!0===g.hasAttribute("morphNormal"+U)&&g.deleteAttribute("morphNormal"+U),r[U]=0)}const z=g.morphTargetsRelative?1:1-V;b.getUniforms().setValue(i,"morphTargetBaseInfluence",z),b.getUniforms().setValue(i,"morphTargetInfluences",r)}}}}function F4(i,e,t,n){let r=new WeakMap;function c(d){const f=d.target;f.removeEventListener("dispose",c),t.remove(f.instanceMatrix),null!==f.instanceColor&&t.remove(f.instanceColor)}return{update:function s(d){const f=n.render.frame,v=e.get(d,d.geometry);return r.get(v)!==f&&(e.update(v),r.set(v,f)),d.isInstancedMesh&&(!1===d.hasEventListener("dispose",c)&&d.addEventListener("dispose",c),t.update(d.instanceMatrix,34962),null!==d.instanceColor&&t.update(d.instanceColor,34962)),v},dispose:function a(){r=new WeakMap}}}const kk=new bd,Fk=new vR,Vk=new class pk extends bd{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Do,this.minFilter=Do,this.wrapR=Ml,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Uk=new nA,Bk=[],Hk=[],zk=new Float32Array(16),Gk=new Float32Array(9),jk=new Float32Array(4);function sw(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=Bk[r];if(void 0===s&&(s=new Float32Array(r),Bk[r]=s),0!==e){n.toArray(s,0);for(let a=1,c=0;a!==e;++a)c+=t,i[a].toArray(s,c)}return s}function Al(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Il(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function oA(i,e){let t=Hk[e];void 0===t&&(t=new Int32Array(e),Hk[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function V4(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function U4(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Al(t,e))return;i.uniform2fv(this.addr,e),Il(t,e)}}function B4(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Al(t,e))return;i.uniform3fv(this.addr,e),Il(t,e)}}function H4(i,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Al(t,e))return;i.uniform4fv(this.addr,e),Il(t,e)}}function z4(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Al(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Il(t,e)}else{if(Al(t,n))return;jk.set(n),i.uniformMatrix2fv(this.addr,!1,jk),Il(t,n)}}function G4(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Al(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Il(t,e)}else{if(Al(t,n))return;Gk.set(n),i.uniformMatrix3fv(this.addr,!1,Gk),Il(t,n)}}function j4(i,e){const t=this.cache,n=e.elements;if(void 0===n){if(Al(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Il(t,e)}else{if(Al(t,n))return;zk.set(n),i.uniformMatrix4fv(this.addr,!1,zk),Il(t,n)}}function W4(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function $4(i,e){const t=this.cache;Al(t,e)||(i.uniform2iv(this.addr,e),Il(t,e))}function q4(i,e){const t=this.cache;Al(t,e)||(i.uniform3iv(this.addr,e),Il(t,e))}function K4(i,e){const t=this.cache;Al(t,e)||(i.uniform4iv(this.addr,e),Il(t,e))}function Z4(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function Y4(i,e){const t=this.cache;Al(t,e)||(i.uniform2uiv(this.addr,e),Il(t,e))}function X4(i,e){const t=this.cache;Al(t,e)||(i.uniform3uiv(this.addr,e),Il(t,e))}function J4(i,e){const t=this.cache;Al(t,e)||(i.uniform4uiv(this.addr,e),Il(t,e))}function Q4(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2D(e||kk,r)}function ej(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||Vk,r)}function tj(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||Uk,r)}function nj(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||Fk,r)}function rj(i,e){i.uniform1fv(this.addr,e)}function sj(i,e){const t=sw(e,this.size,2);i.uniform2fv(this.addr,t)}function oj(i,e){const t=sw(e,this.size,3);i.uniform3fv(this.addr,t)}function aj(i,e){const t=sw(e,this.size,4);i.uniform4fv(this.addr,t)}function lj(i,e){const t=sw(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function cj(i,e){const t=sw(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function uj(i,e){const t=sw(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function dj(i,e){i.uniform1iv(this.addr,e)}function hj(i,e){i.uniform2iv(this.addr,e)}function fj(i,e){i.uniform3iv(this.addr,e)}function pj(i,e){i.uniform4iv(this.addr,e)}function mj(i,e){i.uniform1uiv(this.addr,e)}function gj(i,e){i.uniform2uiv(this.addr,e)}function yj(i,e){i.uniform3uiv(this.addr,e)}function _j(i,e){i.uniform4uiv(this.addr,e)}function vj(i,e,t){const n=e.length,r=oA(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2D(e[s]||kk,r[s])}function wj(i,e,t){const n=e.length,r=oA(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture3D(e[s]||Vk,r[s])}function bj(i,e,t){const n=e.length,r=oA(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTextureCube(e[s]||Uk,r[s])}function xj(i,e,t){const n=e.length,r=oA(t,n);i.uniform1iv(this.addr,r);for(let s=0;s!==n;++s)t.setTexture2DArray(e[s]||Fk,r[s])}class Sj{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function ij(i){switch(i){case 5126:return V4;case 35664:return U4;case 35665:return B4;case 35666:return H4;case 35674:return z4;case 35675:return G4;case 35676:return j4;case 5124:case 35670:return W4;case 35667:case 35671:return $4;case 35668:case 35672:return q4;case 35669:case 35673:return K4;case 5125:return Z4;case 36294:return Y4;case 36295:return X4;case 36296:return J4;case 35678:case 36198:case 36298:case 36306:case 35682:return Q4;case 35679:case 36299:case 36307:return ej;case 35680:case 36300:case 36308:case 36293:return tj;case 36289:case 36303:case 36311:case 36292:return nj}}(t.type)}}class Tj{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function Ej(i){switch(i){case 5126:return rj;case 35664:return sj;case 35665:return oj;case 35666:return aj;case 35674:return lj;case 35675:return cj;case 35676:return uj;case 5124:case 35670:return dj;case 35667:case 35671:return hj;case 35668:case 35672:return fj;case 35669:case 35673:return pj;case 5125:return mj;case 36294:return gj;case 36295:return yj;case 36296:return _j;case 35678:case 36198:case 36298:case 36306:case 35682:return vj;case 35679:case 36299:case 36307:return wj;case 35680:case 36300:case 36308:case 36293:return bj;case 36289:case 36303:case 36311:case 36292:return xj}}(t.type)}}class Mj{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const c=r[s];c.setValue(e,t[c.id],n)}}}const WR=/(\w+)(\])?(\[|\.)?/g;function Wk(i,e){i.seq.push(e),i.map[e.id]=e}function Cj(i,e,t){const n=i.name,r=n.length;for(WR.lastIndex=0;;){const s=WR.exec(n),a=WR.lastIndex;let c=s[1];const f=s[3];if("]"===s[2]&&(c|=0),void 0===f||"["===f&&a+2===r){Wk(t,void 0===f?new Sj(c,i,e):new Tj(c,i,e));break}{let v=t.map[c];void 0===v&&(v=new Mj(c),Wk(t,v)),t=v}}}class aA{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,35718);for(let r=0;r<n;++r){const s=e.getActiveUniform(t,r);Cj(s,e.getUniformLocation(t,s.name),this)}}setValue(e,t,n,r){const s=this.map[t];void 0!==s&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];void 0!==r&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,a=t.length;s!==a;++s){const c=t[s],d=n[c.id];!1!==d.needsUpdate&&c.setValue(e,d.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function $k(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}let Aj=0;function qk(i,e,t){const n=i.getShaderParameter(e,35713),r=i.getShaderInfoLog(e).trim();if(n&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const a=parseInt(s[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function Ij(i,e){const t=i.split("\n"),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=r;a<s;a++){const c=a+1;n.push(`${c===e?">":" "} ${c}: ${t[a]}`)}return n.join("\n")}(i.getShaderSource(e),a)}return r}function Rj(i,e){const t=function Dj(i){switch(i){case Wy:return["Linear","( value )"];case yr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",i),["Linear","( value )"]}}(e);return"vec4 "+i+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function Pj(i,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function $E(i){return""!==i}function Kk(i,e){return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Zk(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const kj=/^[ \t]*#include +<([\w\d./]+)>/gm;function $R(i){return i.replace(kj,Fj)}function Fj(i,e){const t=Vi[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return $R(t)}const Vj=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Uj=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Yk(i){return i.replace(Uj,Xk).replace(Vj,Bj)}function Bj(i,e,t,n){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Xk(0,e,t,n)}function Xk(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Jk(i){let e="precision "+i.precision+" float;\nprecision "+i.precision+" int;";return"highp"===i.precision?e+="\n#define HIGH_PRECISION":"mediump"===i.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===i.precision&&(e+="\n#define LOW_PRECISION"),e}function $j(i,e,t,n){const r=i.getContext(),s=t.defines;let a=t.vertexShader,c=t.fragmentShader;const d=function Hj(i){let e="SHADOWMAP_TYPE_BASIC";return 1===i.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===i.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===i.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),f=function zj(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),g=function Gj(i){let e="ENVMAP_MODE_REFLECTION";return i.envMap&&302===i.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),v=function jj(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),b=function Wj(i){const e=i.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}(t),x=t.isWebGL2?"":function Nj(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||"physical"===i.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter($E).join("\n")}(t),C=function Oj(i){const e=[];for(const t in i){const n=i[t];!1!==n&&e.push("#define "+t+" "+n)}return e.join("\n")}(s),I=r.createProgram();let D,L,V=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(D=[C].filter($E).join("\n"),D.length>0&&(D+="\n"),L=[x,C].filter($E).join("\n"),L.length>0&&(L+="\n")):(D=[Jk(t),"#define SHADER_NAME "+t.shaderName,C,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter($E).join("\n"),L=[x,Jk(t),"#define SHADER_NAME "+t.shaderName,C,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.envMap?"#define "+g:"",t.envMap?"#define "+v:"",b?"#define CUBEUV_TEXEL_WIDTH "+b.texelWidth:"",b?"#define CUBEUV_TEXEL_HEIGHT "+b.texelHeight:"",b?"#define CUBEUV_MAX_MIP "+b.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Vi.tonemapping_pars_fragment:"",0!==t.toneMapping?Pj("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Vi.encodings_pars_fragment,Rj("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter($E).join("\n")),a=$R(a),a=Kk(a,t),a=Zk(a,t),c=$R(c),c=Kk(c,t),c=Zk(c,t),a=Yk(a),c=Yk(c),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(V="#version 300 es\n",D=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+D,L=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+L);const U=V+L+c,$=$k(r,35633,V+D+a),Z=$k(r,35632,U);if(r.attachShader(I,$),r.attachShader(I,Z),void 0!==t.index0AttributeName?r.bindAttribLocation(I,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(I,0,"position"),r.linkProgram(I),i.debug.checkShaderErrors){const ie=r.getProgramInfoLog(I).trim(),we=r.getShaderInfoLog($).trim(),Me=r.getShaderInfoLog(Z).trim();let dt=!0,Mt=!0;if(!1===r.getProgramParameter(I,35714)){dt=!1;const Se=qk(r,$,"vertex"),it=qk(r,Z,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(I,35715)+"\n\nProgram Info Log: "+ie+"\n"+Se+"\n"+it)}else""!==ie?console.warn("THREE.WebGLProgram: Program Info Log:",ie):(""===we||""===Me)&&(Mt=!1);Mt&&(this.diagnostics={runnable:dt,programLog:ie,vertexShader:{log:we,prefix:D},fragmentShader:{log:Me,prefix:L}})}let ae,j;return r.deleteShader($),r.deleteShader(Z),this.getUniforms=function(){return void 0===ae&&(ae=new aA(r,I)),ae},this.getAttributes=function(){return void 0===j&&(j=function Lj(i,e){const t={},n=i.getProgramParameter(e,35721);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),a=s.name;let c=1;35674===s.type&&(c=2),35675===s.type&&(c=3),35676===s.type&&(c=4),t[a]={type:s.type,location:i.getAttribLocation(e,a),locationSize:c}}return t}(r,I)),j},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(I),this.program=void 0},this.name=t.shaderName,this.id=Aj++,this.cacheKey=e,this.usedTimes=1,this.program=I,this.vertexShader=$,this.fragmentShader=Z,this}let qj=0;class Kj{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.fragmentShader,r=this._getShaderStage(e.vertexShader),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(s)&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const n=new Zj(e);t.set(e,n)}return t.get(e)}}class Zj{constructor(e){this.id=qj++,this.code=e,this.usedTimes=0}}function Yj(i,e,t,n,r,s,a){const c=new CR,d=new Kj,f=[],g=r.isWebGL2,v=r.logarithmicDepthBuffer,b=r.vertexTextures;let x=r.precision;const C={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function I(j,ie,we,Me,dt){const Mt=Me.fog,Se=dt.geometry,Ge=(j.isMeshStandardMaterial?t:e).get(j.envMap||(j.isMeshStandardMaterial?Me.environment:null)),_t=Ge&&306===Ge.mapping?Ge.image.height:null,vt=C[j.type];null!==j.precision&&(x=r.getMaxPrecision(j.precision),x!==j.precision&&console.warn("THREE.WebGLProgram.getParameters:",j.precision,"not supported, using",x,"instead."));const rt=Se.morphAttributes.position||Se.morphAttributes.normal||Se.morphAttributes.color,ht=void 0!==rt?rt.length:0;let At,ln,Mn,Bn,zt=0;if(void 0!==Se.morphAttributes.position&&(zt=1),void 0!==Se.morphAttributes.normal&&(zt=2),void 0!==Se.morphAttributes.color&&(zt=3),vt){const xi=wh[vt];At=xi.vertexShader,ln=xi.fragmentShader}else At=j.vertexShader,ln=j.fragmentShader,d.update(j),Mn=d.getVertexShaderID(j),Bn=d.getFragmentShaderID(j);const ft=i.getRenderTarget(),oi=j.clearcoat>0,di=j.iridescence>0;return{isWebGL2:g,shaderID:vt,shaderName:j.type,vertexShader:At,fragmentShader:ln,defines:j.defines,customVertexShaderID:Mn,customFragmentShaderID:Bn,isRawShaderMaterial:!0===j.isRawShaderMaterial,glslVersion:j.glslVersion,precision:x,instancing:!0===dt.isInstancedMesh,instancingColor:!0===dt.isInstancedMesh&&null!==dt.instanceColor,supportsVertexTextures:b,outputEncoding:null===ft?i.outputEncoding:!0===ft.isXRRenderTarget?ft.texture.encoding:Wy,map:!!j.map,matcap:!!j.matcap,envMap:!!Ge,envMapMode:Ge&&Ge.mapping,envMapCubeUVHeight:_t,lightMap:!!j.lightMap,aoMap:!!j.aoMap,emissiveMap:!!j.emissiveMap,bumpMap:!!j.bumpMap,normalMap:!!j.normalMap,objectSpaceNormalMap:1===j.normalMapType,tangentSpaceNormalMap:0===j.normalMapType,decodeVideoTexture:!!j.map&&!0===j.map.isVideoTexture&&j.map.encoding===yr,clearcoat:oi,clearcoatMap:oi&&!!j.clearcoatMap,clearcoatRoughnessMap:oi&&!!j.clearcoatRoughnessMap,clearcoatNormalMap:oi&&!!j.clearcoatNormalMap,iridescence:di,iridescenceMap:di&&!!j.iridescenceMap,iridescenceThicknessMap:di&&!!j.iridescenceThicknessMap,displacementMap:!!j.displacementMap,roughnessMap:!!j.roughnessMap,metalnessMap:!!j.metalnessMap,specularMap:!!j.specularMap,specularIntensityMap:!!j.specularIntensityMap,specularColorMap:!!j.specularColorMap,opaque:!1===j.transparent&&1===j.blending,alphaMap:!!j.alphaMap,alphaTest:j.alphaTest>0,gradientMap:!!j.gradientMap,sheen:j.sheen>0,sheenColorMap:!!j.sheenColorMap,sheenRoughnessMap:!!j.sheenRoughnessMap,transmission:j.transmission>0,transmissionMap:!!j.transmissionMap,thicknessMap:!!j.thicknessMap,combine:j.combine,vertexTangents:!!j.normalMap&&!!Se.attributes.tangent,vertexColors:j.vertexColors,vertexAlphas:!0===j.vertexColors&&!!Se.attributes.color&&4===Se.attributes.color.itemSize,vertexUvs:!!(j.map||j.bumpMap||j.normalMap||j.specularMap||j.alphaMap||j.emissiveMap||j.roughnessMap||j.metalnessMap||j.clearcoatMap||j.clearcoatRoughnessMap||j.clearcoatNormalMap||j.iridescenceMap||j.iridescenceThicknessMap||j.displacementMap||j.transmissionMap||j.thicknessMap||j.specularIntensityMap||j.specularColorMap||j.sheenColorMap||j.sheenRoughnessMap),uvsVertexOnly:!(j.map||j.bumpMap||j.normalMap||j.specularMap||j.alphaMap||j.emissiveMap||j.roughnessMap||j.metalnessMap||j.clearcoatNormalMap||j.iridescenceMap||j.iridescenceThicknessMap||j.transmission>0||j.transmissionMap||j.thicknessMap||j.specularIntensityMap||j.specularColorMap||j.sheen>0||j.sheenColorMap||j.sheenRoughnessMap||!j.displacementMap),fog:!!Mt,useFog:!0===j.fog,fogExp2:Mt&&Mt.isFogExp2,flatShading:!!j.flatShading,sizeAttenuation:j.sizeAttenuation,logarithmicDepthBuffer:v,skinning:!0===dt.isSkinnedMesh,morphTargets:void 0!==Se.morphAttributes.position,morphNormals:void 0!==Se.morphAttributes.normal,morphColors:void 0!==Se.morphAttributes.color,morphTargetsCount:ht,morphTextureStride:zt,numDirLights:ie.directional.length,numPointLights:ie.point.length,numSpotLights:ie.spot.length,numRectAreaLights:ie.rectArea.length,numHemiLights:ie.hemi.length,numDirLightShadows:ie.directionalShadowMap.length,numPointLightShadows:ie.pointShadowMap.length,numSpotLightShadows:ie.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:j.dithering,shadowMapEnabled:i.shadowMap.enabled&&we.length>0,shadowMapType:i.shadowMap.type,toneMapping:j.toneMapped?i.toneMapping:0,physicallyCorrectLights:i.physicallyCorrectLights,premultipliedAlpha:j.premultipliedAlpha,doubleSided:2===j.side,flipSided:1===j.side,useDepthPacking:!!j.depthPacking,depthPacking:j.depthPacking||0,index0AttributeName:j.index0AttributeName,extensionDerivatives:j.extensions&&j.extensions.derivatives,extensionFragDepth:j.extensions&&j.extensions.fragDepth,extensionDrawBuffers:j.extensions&&j.extensions.drawBuffers,extensionShaderTextureLOD:j.extensions&&j.extensions.shaderTextureLOD,rendererExtensionFragDepth:g||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:g||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:g||n.has("EXT_shader_texture_lod"),customProgramCacheKey:j.customProgramCacheKey()}},getProgramCacheKey:function D(j){const ie=[];if(j.shaderID?ie.push(j.shaderID):(ie.push(j.customVertexShaderID),ie.push(j.customFragmentShaderID)),void 0!==j.defines)for(const we in j.defines)ie.push(we),ie.push(j.defines[we]);return!1===j.isRawShaderMaterial&&(function L(j,ie){j.push(ie.precision),j.push(ie.outputEncoding),j.push(ie.envMapMode),j.push(ie.envMapCubeUVHeight),j.push(ie.combine),j.push(ie.vertexUvs),j.push(ie.fogExp2),j.push(ie.sizeAttenuation),j.push(ie.morphTargetsCount),j.push(ie.morphAttributeCount),j.push(ie.numDirLights),j.push(ie.numPointLights),j.push(ie.numSpotLights),j.push(ie.numHemiLights),j.push(ie.numRectAreaLights),j.push(ie.numDirLightShadows),j.push(ie.numPointLightShadows),j.push(ie.numSpotLightShadows),j.push(ie.shadowMapType),j.push(ie.toneMapping),j.push(ie.numClippingPlanes),j.push(ie.numClipIntersection),j.push(ie.depthPacking)}(ie,j),function V(j,ie){c.disableAll(),ie.isWebGL2&&c.enable(0),ie.supportsVertexTextures&&c.enable(1),ie.instancing&&c.enable(2),ie.instancingColor&&c.enable(3),ie.map&&c.enable(4),ie.matcap&&c.enable(5),ie.envMap&&c.enable(6),ie.lightMap&&c.enable(7),ie.aoMap&&c.enable(8),ie.emissiveMap&&c.enable(9),ie.bumpMap&&c.enable(10),ie.normalMap&&c.enable(11),ie.objectSpaceNormalMap&&c.enable(12),ie.tangentSpaceNormalMap&&c.enable(13),ie.clearcoat&&c.enable(14),ie.clearcoatMap&&c.enable(15),ie.clearcoatRoughnessMap&&c.enable(16),ie.clearcoatNormalMap&&c.enable(17),ie.iridescence&&c.enable(18),ie.iridescenceMap&&c.enable(19),ie.iridescenceThicknessMap&&c.enable(20),ie.displacementMap&&c.enable(21),ie.specularMap&&c.enable(22),ie.roughnessMap&&c.enable(23),ie.metalnessMap&&c.enable(24),ie.gradientMap&&c.enable(25),ie.alphaMap&&c.enable(26),ie.alphaTest&&c.enable(27),ie.vertexColors&&c.enable(28),ie.vertexAlphas&&c.enable(29),ie.vertexUvs&&c.enable(30),ie.vertexTangents&&c.enable(31),ie.uvsVertexOnly&&c.enable(32),ie.fog&&c.enable(33),j.push(c.mask),c.disableAll(),ie.useFog&&c.enable(0),ie.flatShading&&c.enable(1),ie.logarithmicDepthBuffer&&c.enable(2),ie.skinning&&c.enable(3),ie.morphTargets&&c.enable(4),ie.morphNormals&&c.enable(5),ie.morphColors&&c.enable(6),ie.premultipliedAlpha&&c.enable(7),ie.shadowMapEnabled&&c.enable(8),ie.physicallyCorrectLights&&c.enable(9),ie.doubleSided&&c.enable(10),ie.flipSided&&c.enable(11),ie.useDepthPacking&&c.enable(12),ie.dithering&&c.enable(13),ie.specularIntensityMap&&c.enable(14),ie.specularColorMap&&c.enable(15),ie.transmission&&c.enable(16),ie.transmissionMap&&c.enable(17),ie.thicknessMap&&c.enable(18),ie.sheen&&c.enable(19),ie.sheenColorMap&&c.enable(20),ie.sheenRoughnessMap&&c.enable(21),ie.decodeVideoTexture&&c.enable(22),ie.opaque&&c.enable(23),j.push(c.mask)}(ie,j),ie.push(i.outputEncoding)),ie.push(j.customProgramCacheKey),ie.join()},getUniforms:function z(j){const ie=C[j.type];let we;return we=ie?gz.clone(wh[ie].uniforms):j.uniforms,we},acquireProgram:function U(j,ie){let we;for(let Me=0,dt=f.length;Me<dt;Me++){const Mt=f[Me];if(Mt.cacheKey===ie){we=Mt,++we.usedTimes;break}}return void 0===we&&(we=new $j(i,ie,j,s),f.push(we)),we},releaseProgram:function $(j){if(0==--j.usedTimes){const ie=f.indexOf(j);f[ie]=f[f.length-1],f.pop(),j.destroy()}},releaseShaderCache:function Z(j){d.remove(j)},programs:f,dispose:function ae(){d.dispose()}}}function Xj(){let i=new WeakMap;return{get:function e(s){let a=i.get(s);return void 0===a&&(a={},i.set(s,a)),a},remove:function t(s){i.delete(s)},update:function n(s,a,c){i.get(s)[a]=c},dispose:function r(){i=new WeakMap}}}function Jj(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function Qk(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function eF(){const i=[];let e=0;const t=[],n=[],r=[];function a(v,b,x,C,I,D){let L=i[e];return void 0===L?(L={id:v.id,object:v,geometry:b,material:x,groupOrder:C,renderOrder:v.renderOrder,z:I,group:D},i[e]=L):(L.id=v.id,L.object=v,L.geometry=b,L.material=x,L.groupOrder=C,L.renderOrder=v.renderOrder,L.z=I,L.group=D),e++,L}return{opaque:t,transmissive:n,transparent:r,init:function s(){e=0,t.length=0,n.length=0,r.length=0},push:function c(v,b,x,C,I,D){const L=a(v,b,x,C,I,D);x.transmission>0?n.push(L):!0===x.transparent?r.push(L):t.push(L)},unshift:function d(v,b,x,C,I,D){const L=a(v,b,x,C,I,D);x.transmission>0?n.unshift(L):!0===x.transparent?r.unshift(L):t.unshift(L)},finish:function g(){for(let v=e,b=i.length;v<b;v++){const x=i[v];if(null===x.id)break;x.id=null,x.object=null,x.geometry=null,x.material=null,x.group=null}},sort:function f(v,b){t.length>1&&t.sort(v||Jj),n.length>1&&n.sort(b||Qk),r.length>1&&r.sort(b||Qk)}}}function Qj(){let i=new WeakMap;return{get:function e(n,r){let s;return!1===i.has(n)?(s=new eF,i.set(n,[s])):r>=i.get(n).length?(s=new eF,i.get(n).push(s)):s=i.get(n)[r],s},dispose:function t(){i=new WeakMap}}}function eW(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Q,color:new rn};break;case"SpotLight":t={position:new Q,direction:new Q,color:new rn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Q,color:new rn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Q,skyColor:new rn,groundColor:new rn};break;case"RectAreaLight":t={color:new rn,position:new Q,halfWidth:new Q,halfHeight:new Q}}return i[e.id]=t,t}}}let nW=0;function iW(i,e){return(e.castShadow?1:0)-(i.castShadow?1:0)}function rW(i,e){const t=new eW,n=function tW(){const i={};return{get:function(e){if(void 0!==i[e.id])return i[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt,shadowCameraNear:1,shadowCameraFar:1e3}}return i[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let g=0;g<9;g++)r.probe.push(new Q);const s=new Q,a=new bi,c=new bi;return{setup:function d(g,v){let b=0,x=0,C=0;for(let ie=0;ie<9;ie++)r.probe[ie].set(0,0,0);let I=0,D=0,L=0,V=0,z=0,U=0,$=0,Z=0;g.sort(iW);const ae=!0!==v?Math.PI:1;for(let ie=0,we=g.length;ie<we;ie++){const Me=g[ie],dt=Me.color,Mt=Me.intensity,Se=Me.distance,it=Me.shadow&&Me.shadow.map?Me.shadow.map.texture:null;if(Me.isAmbientLight)b+=dt.r*Mt*ae,x+=dt.g*Mt*ae,C+=dt.b*Mt*ae;else if(Me.isLightProbe)for(let Ge=0;Ge<9;Ge++)r.probe[Ge].addScaledVector(Me.sh.coefficients[Ge],Mt);else if(Me.isDirectionalLight){const Ge=t.get(Me);if(Ge.color.copy(Me.color).multiplyScalar(Me.intensity*ae),Me.castShadow){const _t=Me.shadow,vt=n.get(Me);vt.shadowBias=_t.bias,vt.shadowNormalBias=_t.normalBias,vt.shadowRadius=_t.radius,vt.shadowMapSize=_t.mapSize,r.directionalShadow[I]=vt,r.directionalShadowMap[I]=it,r.directionalShadowMatrix[I]=Me.shadow.matrix,U++}r.directional[I]=Ge,I++}else if(Me.isSpotLight){const Ge=t.get(Me);if(Ge.position.setFromMatrixPosition(Me.matrixWorld),Ge.color.copy(dt).multiplyScalar(Mt*ae),Ge.distance=Se,Ge.coneCos=Math.cos(Me.angle),Ge.penumbraCos=Math.cos(Me.angle*(1-Me.penumbra)),Ge.decay=Me.decay,Me.castShadow){const _t=Me.shadow,vt=n.get(Me);vt.shadowBias=_t.bias,vt.shadowNormalBias=_t.normalBias,vt.shadowRadius=_t.radius,vt.shadowMapSize=_t.mapSize,r.spotShadow[L]=vt,r.spotShadowMap[L]=it,r.spotShadowMatrix[L]=Me.shadow.matrix,Z++}r.spot[L]=Ge,L++}else if(Me.isRectAreaLight){const Ge=t.get(Me);Ge.color.copy(dt).multiplyScalar(Mt),Ge.halfWidth.set(.5*Me.width,0,0),Ge.halfHeight.set(0,.5*Me.height,0),r.rectArea[V]=Ge,V++}else if(Me.isPointLight){const Ge=t.get(Me);if(Ge.color.copy(Me.color).multiplyScalar(Me.intensity*ae),Ge.distance=Me.distance,Ge.decay=Me.decay,Me.castShadow){const _t=Me.shadow,vt=n.get(Me);vt.shadowBias=_t.bias,vt.shadowNormalBias=_t.normalBias,vt.shadowRadius=_t.radius,vt.shadowMapSize=_t.mapSize,vt.shadowCameraNear=_t.camera.near,vt.shadowCameraFar=_t.camera.far,r.pointShadow[D]=vt,r.pointShadowMap[D]=it,r.pointShadowMatrix[D]=Me.shadow.matrix,$++}r.point[D]=Ge,D++}else if(Me.isHemisphereLight){const Ge=t.get(Me);Ge.skyColor.copy(Me.color).multiplyScalar(Mt*ae),Ge.groundColor.copy(Me.groundColor).multiplyScalar(Mt*ae),r.hemi[z]=Ge,z++}}V>0&&(e.isWebGL2||!0===i.has("OES_texture_float_linear")?(r.rectAreaLTC1=un.LTC_FLOAT_1,r.rectAreaLTC2=un.LTC_FLOAT_2):!0===i.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=un.LTC_HALF_1,r.rectAreaLTC2=un.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=b,r.ambient[1]=x,r.ambient[2]=C;const j=r.hash;(j.directionalLength!==I||j.pointLength!==D||j.spotLength!==L||j.rectAreaLength!==V||j.hemiLength!==z||j.numDirectionalShadows!==U||j.numPointShadows!==$||j.numSpotShadows!==Z)&&(r.directional.length=I,r.spot.length=L,r.rectArea.length=V,r.point.length=D,r.hemi.length=z,r.directionalShadow.length=U,r.directionalShadowMap.length=U,r.pointShadow.length=$,r.pointShadowMap.length=$,r.spotShadow.length=Z,r.spotShadowMap.length=Z,r.directionalShadowMatrix.length=U,r.pointShadowMatrix.length=$,r.spotShadowMatrix.length=Z,j.directionalLength=I,j.pointLength=D,j.spotLength=L,j.rectAreaLength=V,j.hemiLength=z,j.numDirectionalShadows=U,j.numPointShadows=$,j.numSpotShadows=Z,r.version=nW++)},setupView:function f(g,v){let b=0,x=0,C=0,I=0,D=0;const L=v.matrixWorldInverse;for(let V=0,z=g.length;V<z;V++){const U=g[V];if(U.isDirectionalLight){const $=r.directional[b];$.direction.setFromMatrixPosition(U.matrixWorld),s.setFromMatrixPosition(U.target.matrixWorld),$.direction.sub(s),$.direction.transformDirection(L),b++}else if(U.isSpotLight){const $=r.spot[C];$.position.setFromMatrixPosition(U.matrixWorld),$.position.applyMatrix4(L),$.direction.setFromMatrixPosition(U.matrixWorld),s.setFromMatrixPosition(U.target.matrixWorld),$.direction.sub(s),$.direction.transformDirection(L),C++}else if(U.isRectAreaLight){const $=r.rectArea[I];$.position.setFromMatrixPosition(U.matrixWorld),$.position.applyMatrix4(L),c.identity(),a.copy(U.matrixWorld),a.premultiply(L),c.extractRotation(a),$.halfWidth.set(.5*U.width,0,0),$.halfHeight.set(0,.5*U.height,0),$.halfWidth.applyMatrix4(c),$.halfHeight.applyMatrix4(c),I++}else if(U.isPointLight){const $=r.point[x];$.position.setFromMatrixPosition(U.matrixWorld),$.position.applyMatrix4(L),x++}else if(U.isHemisphereLight){const $=r.hemi[D];$.direction.setFromMatrixPosition(U.matrixWorld),$.direction.transformDirection(L),D++}}},state:r}}function tF(i,e){const t=new rW(i,e),n=[],r=[];return{init:function s(){n.length=0,r.length=0},state:{lightsArray:n,shadowsArray:r,lights:t},setupLights:function d(v){t.setup(n,v)},setupLightsView:function f(v){t.setupView(n,v)},pushLight:function a(v){n.push(v)},pushShadow:function c(v){r.push(v)}}}function sW(i,e){let t=new WeakMap;return{get:function n(s,a=0){let c;return!1===t.has(s)?(c=new tF(i,e),t.set(s,[c])):a>=t.get(s).length?(c=new tF(i,e),t.get(s).push(c)):c=t.get(s)[a],c},dispose:function r(){t=new WeakMap}}}class nF extends Ro{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class iF extends Ro{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Q,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function lW(i,e,t){let n=new BR;const r=new gt,s=new gt,a=new Ur,c=new nF({depthPacking:3201}),d=new iF,f={},g=t.maxTextureSize,v={0:1,1:0,2:2},b=new qf({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new gt},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),x=b.clone();x.defines.HORIZONTAL_PASS=1;const C=new Li;C.setAttribute("position",new No(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const I=new Cl(C,b),D=this;function L(U,$){const Z=e.update(I);b.defines.VSM_SAMPLES!==U.blurSamples&&(b.defines.VSM_SAMPLES=U.blurSamples,x.defines.VSM_SAMPLES=U.blurSamples,b.needsUpdate=!0,x.needsUpdate=!0),b.uniforms.shadow_pass.value=U.map.texture,b.uniforms.resolution.value=U.mapSize,b.uniforms.radius.value=U.radius,i.setRenderTarget(U.mapPass),i.clear(),i.renderBufferDirect($,null,Z,b,I,null),x.uniforms.shadow_pass.value=U.mapPass.texture,x.uniforms.resolution.value=U.mapSize,x.uniforms.radius.value=U.radius,i.setRenderTarget(U.map),i.clear(),i.renderBufferDirect($,null,Z,x,I,null)}function V(U,$,Z,ae,j,ie){let we=null;const Me=!0===Z.isPointLight?U.customDistanceMaterial:U.customDepthMaterial;if(we=void 0!==Me?Me:!0===Z.isPointLight?d:c,i.localClippingEnabled&&!0===$.clipShadows&&0!==$.clippingPlanes.length||$.displacementMap&&0!==$.displacementScale||$.alphaMap&&$.alphaTest>0){const dt=we.uuid,Mt=$.uuid;let Se=f[dt];void 0===Se&&(Se={},f[dt]=Se);let it=Se[Mt];void 0===it&&(it=we.clone(),Se[Mt]=it),we=it}return we.visible=$.visible,we.wireframe=$.wireframe,we.side=3===ie?null!==$.shadowSide?$.shadowSide:$.side:null!==$.shadowSide?$.shadowSide:v[$.side],we.alphaMap=$.alphaMap,we.alphaTest=$.alphaTest,we.clipShadows=$.clipShadows,we.clippingPlanes=$.clippingPlanes,we.clipIntersection=$.clipIntersection,we.displacementMap=$.displacementMap,we.displacementScale=$.displacementScale,we.displacementBias=$.displacementBias,we.wireframeLinewidth=$.wireframeLinewidth,we.linewidth=$.linewidth,!0===Z.isPointLight&&!0===we.isMeshDistanceMaterial&&(we.referencePosition.setFromMatrixPosition(Z.matrixWorld),we.nearDistance=ae,we.farDistance=j),we}function z(U,$,Z,ae,j){if(!1===U.visible)return;if(U.layers.test($.layers)&&(U.isMesh||U.isLine||U.isPoints)&&(U.castShadow||U.receiveShadow&&3===j)&&(!U.frustumCulled||n.intersectsObject(U))){U.modelViewMatrix.multiplyMatrices(Z.matrixWorldInverse,U.matrixWorld);const Me=e.update(U),dt=U.material;if(Array.isArray(dt)){const Mt=Me.groups;for(let Se=0,it=Mt.length;Se<it;Se++){const Ge=Mt[Se],_t=dt[Ge.materialIndex];if(_t&&_t.visible){const vt=V(U,_t,ae,Z.near,Z.far,j);i.renderBufferDirect(Z,null,Me,vt,U,Ge)}}}else if(dt.visible){const Mt=V(U,dt,ae,Z.near,Z.far,j);i.renderBufferDirect(Z,null,Me,Mt,U,null)}}const we=U.children;for(let Me=0,dt=we.length;Me<dt;Me++)z(we[Me],$,Z,ae,j)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(U,$,Z){if(!1===D.enabled||!1===D.autoUpdate&&!1===D.needsUpdate||0===U.length)return;const ae=i.getRenderTarget(),j=i.getActiveCubeFace(),ie=i.getActiveMipmapLevel(),we=i.state;we.setBlending(0),we.buffers.color.setClear(1,1,1,1),we.buffers.depth.setTest(!0),we.setScissorTest(!1);for(let Me=0,dt=U.length;Me<dt;Me++){const Mt=U[Me],Se=Mt.shadow;if(void 0===Se){console.warn("THREE.WebGLShadowMap:",Mt,"has no shadow.");continue}if(!1===Se.autoUpdate&&!1===Se.needsUpdate)continue;r.copy(Se.mapSize);const it=Se.getFrameExtents();r.multiply(it),s.copy(Se.mapSize),(r.x>g||r.y>g)&&(r.x>g&&(s.x=Math.floor(g/it.x),r.x=s.x*it.x,Se.mapSize.x=s.x),r.y>g&&(s.y=Math.floor(g/it.y),r.y=s.y*it.y,Se.mapSize.y=s.y)),null===Se.map&&!Se.isPointLightShadow&&3===this.type&&(Se.map=new Tm(r.x,r.y),Se.map.texture.name=Mt.name+".shadowMap",Se.mapPass=new Tm(r.x,r.y),Se.camera.updateProjectionMatrix()),null===Se.map&&(Se.map=new Tm(r.x,r.y,{minFilter:Do,magFilter:Do,format:Nu}),Se.map.texture.name=Mt.name+".shadowMap",Se.camera.updateProjectionMatrix()),i.setRenderTarget(Se.map),i.clear();const Ge=Se.getViewportCount();for(let _t=0;_t<Ge;_t++){const vt=Se.getViewport(_t);a.set(s.x*vt.x,s.y*vt.y,s.x*vt.z,s.y*vt.w),we.viewport(a),Se.updateMatrices(Mt,_t),n=Se.getFrustum(),z($,Z,Se.camera,Mt,this.type)}!Se.isPointLightShadow&&3===this.type&&L(Se,Z),Se.needsUpdate=!1}D.needsUpdate=!1,i.setRenderTarget(ae,j,ie)}}function cW(i,e,t){const n=t.isWebGL2,c=new function r(){let _e=!1;const Jt=new Ur;let $t=null;const Jn=new Ur(0,0,0,0);return{setMask:function(pn){$t!==pn&&!_e&&(i.colorMask(pn,pn,pn,pn),$t=pn)},setLocked:function(pn){_e=pn},setClear:function(pn,Hn,Qt,mi,Mr){!0===Mr&&(pn*=mi,Hn*=mi,Qt*=mi),Jt.set(pn,Hn,Qt,mi),!1===Jn.equals(Jt)&&(i.clearColor(pn,Hn,Qt,mi),Jn.copy(Jt))},reset:function(){_e=!1,$t=null,Jn.set(-1,0,0,0)}}},d=new function s(){let _e=!1,Jt=null,$t=null,Jn=null;return{setTest:function(pn){pn?Bn(2929):ft(2929)},setMask:function(pn){Jt!==pn&&!_e&&(i.depthMask(pn),Jt=pn)},setFunc:function(pn){if($t!==pn){if(pn)switch(pn){case 0:i.depthFunc(512);break;case 1:i.depthFunc(519);break;case 2:i.depthFunc(513);break;case 3:default:i.depthFunc(515);break;case 4:i.depthFunc(514);break;case 5:i.depthFunc(518);break;case 6:i.depthFunc(516);break;case 7:i.depthFunc(517)}else i.depthFunc(515);$t=pn}},setLocked:function(pn){_e=pn},setClear:function(pn){Jn!==pn&&(i.clearDepth(pn),Jn=pn)},reset:function(){_e=!1,Jt=null,$t=null,Jn=null}}},f=new function a(){let _e=!1,Jt=null,$t=null,Jn=null,pn=null,Hn=null,Qt=null,mi=null,Mr=null;return{setTest:function(Cr){_e||(Cr?Bn(2960):ft(2960))},setMask:function(Cr){Jt!==Cr&&!_e&&(i.stencilMask(Cr),Jt=Cr)},setFunc:function(Cr,Nl,Th){($t!==Cr||Jn!==Nl||pn!==Th)&&(i.stencilFunc(Cr,Nl,Th),$t=Cr,Jn=Nl,pn=Th)},setOp:function(Cr,Nl,Th){(Hn!==Cr||Qt!==Nl||mi!==Th)&&(i.stencilOp(Cr,Nl,Th),Hn=Cr,Qt=Nl,mi=Th)},setLocked:function(Cr){_e=Cr},setClear:function(Cr){Mr!==Cr&&(i.clearStencil(Cr),Mr=Cr)},reset:function(){_e=!1,Jt=null,$t=null,Jn=null,pn=null,Hn=null,Qt=null,mi=null,Mr=null}}};let g={},v={},b=new WeakMap,x=[],C=null,I=!1,D=null,L=null,V=null,z=null,U=null,$=null,Z=null,ae=!1,j=null,ie=null,we=null,Me=null,dt=null;const Mt=i.getParameter(35661);let Se=!1,it=0;const Ge=i.getParameter(7938);-1!==Ge.indexOf("WebGL")?(it=parseFloat(/^WebGL (\d)/.exec(Ge)[1]),Se=it>=1):-1!==Ge.indexOf("OpenGL ES")&&(it=parseFloat(/^OpenGL ES (\d)/.exec(Ge)[1]),Se=it>=2);let _t=null,vt={};const rt=i.getParameter(3088),ht=i.getParameter(2978),zt=(new Ur).fromArray(rt),At=(new Ur).fromArray(ht);function ln(_e,Jt,$t){const Jn=new Uint8Array(4),pn=i.createTexture();i.bindTexture(_e,pn),i.texParameteri(_e,10241,9728),i.texParameteri(_e,10240,9728);for(let Hn=0;Hn<$t;Hn++)i.texImage2D(Jt+Hn,0,6408,1,1,0,6408,5121,Jn);return pn}const Mn={};function Bn(_e){!0!==g[_e]&&(i.enable(_e),g[_e]=!0)}function ft(_e){!1!==g[_e]&&(i.disable(_e),g[_e]=!1)}Mn[3553]=ln(3553,3553,1),Mn[34067]=ln(34067,34069,6),c.setClear(0,0,0,1),d.setClear(1),f.setClear(0),Bn(2929),d.setFunc(3),Wt(!1),Sn(1),Bn(2884),xt(0);const tn={100:32774,101:32778,102:32779};if(n)tn[103]=32775,tn[104]=32776;else{const _e=e.get("EXT_blend_minmax");null!==_e&&(tn[103]=_e.MIN_EXT,tn[104]=_e.MAX_EXT)}const xi={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function xt(_e,Jt,$t,Jn,pn,Hn,Qt,mi){if(0!==_e){if(!1===I&&(Bn(3042),I=!0),5===_e)pn=pn||Jt,Hn=Hn||$t,Qt=Qt||Jn,(Jt!==L||pn!==U)&&(i.blendEquationSeparate(tn[Jt],tn[pn]),L=Jt,U=pn),($t!==V||Jn!==z||Hn!==$||Qt!==Z)&&(i.blendFuncSeparate(xi[$t],xi[Jn],xi[Hn],xi[Qt]),V=$t,z=Jn,$=Hn,Z=Qt),D=_e,ae=null;else if(_e!==D||mi!==ae){if((100!==L||100!==U)&&(i.blendEquation(32774),L=100,U=100),mi)switch(_e){case 1:i.blendFuncSeparate(1,771,1,771);break;case 2:i.blendFunc(1,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e)}else switch(_e){case 1:i.blendFuncSeparate(770,771,1,771);break;case 2:i.blendFunc(770,1);break;case 3:i.blendFuncSeparate(0,769,0,1);break;case 4:i.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",_e)}V=null,z=null,$=null,Z=null,D=_e,ae=mi}}else!0===I&&(ft(3042),I=!1)}function Wt(_e){j!==_e&&(i.frontFace(_e?2304:2305),j=_e)}function Sn(_e){0!==_e?(Bn(2884),_e!==ie&&i.cullFace(1===_e?1029:2===_e?1028:1032)):ft(2884),ie=_e}function pi(_e,Jt,$t){_e?(Bn(32823),(Me!==Jt||dt!==$t)&&(i.polygonOffset(Jt,$t),Me=Jt,dt=$t)):ft(32823)}function $n(_e){void 0===_e&&(_e=33984+Mt-1),_t!==_e&&(i.activeTexture(_e),_t=_e)}return{buffers:{color:c,depth:d,stencil:f},enable:Bn,disable:ft,bindFramebuffer:function Bi(_e,Jt){return v[_e]!==Jt&&(i.bindFramebuffer(_e,Jt),v[_e]=Jt,n&&(36009===_e&&(v[36160]=Jt),36160===_e&&(v[36009]=Jt)),!0)},drawBuffers:function oi(_e,Jt){let $t=x,Jn=!1;if(_e)if($t=b.get(Jt),void 0===$t&&($t=[],b.set(Jt,$t)),_e.isWebGLMultipleRenderTargets){const pn=_e.texture;if($t.length!==pn.length||36064!==$t[0]){for(let Hn=0,Qt=pn.length;Hn<Qt;Hn++)$t[Hn]=36064+Hn;$t.length=pn.length,Jn=!0}}else 36064!==$t[0]&&($t[0]=36064,Jn=!0);else 1029!==$t[0]&&($t[0]=1029,Jn=!0);Jn&&(t.isWebGL2?i.drawBuffers($t):e.get("WEBGL_draw_buffers").drawBuffersWEBGL($t))},useProgram:function di(_e){return C!==_e&&(i.useProgram(_e),C=_e,!0)},setBlending:xt,setMaterial:function wt(_e,Jt){2===_e.side?ft(2884):Bn(2884);let $t=1===_e.side;Jt&&($t=!$t),Wt($t),1===_e.blending&&!1===_e.transparent?xt(0):xt(_e.blending,_e.blendEquation,_e.blendSrc,_e.blendDst,_e.blendEquationAlpha,_e.blendSrcAlpha,_e.blendDstAlpha,_e.premultipliedAlpha),d.setFunc(_e.depthFunc),d.setTest(_e.depthTest),d.setMask(_e.depthWrite),c.setMask(_e.colorWrite);const Jn=_e.stencilWrite;f.setTest(Jn),Jn&&(f.setMask(_e.stencilWriteMask),f.setFunc(_e.stencilFunc,_e.stencilRef,_e.stencilFuncMask),f.setOp(_e.stencilFail,_e.stencilZFail,_e.stencilZPass)),pi(_e.polygonOffset,_e.polygonOffsetFactor,_e.polygonOffsetUnits),!0===_e.alphaToCoverage?Bn(32926):ft(32926)},setFlipSided:Wt,setCullFace:Sn,setLineWidth:function dn(_e){_e!==we&&(Se&&i.lineWidth(_e),we=_e)},setPolygonOffset:pi,setScissorTest:function Xn(_e){_e?Bn(3089):ft(3089)},activeTexture:$n,bindTexture:function Rr(_e,Jt){null===_t&&$n();let $t=vt[_t];void 0===$t&&($t={type:void 0,texture:void 0},vt[_t]=$t),($t.type!==_e||$t.texture!==Jt)&&(i.bindTexture(_e,Jt||Mn[_e]),$t.type=_e,$t.texture=Jt)},unbindTexture:function _r(){const _e=vt[_t];void 0!==_e&&void 0!==_e.type&&(i.bindTexture(_e.type,null),_e.type=void 0,_e.texture=void 0)},compressedTexImage2D:function se(){try{i.compressedTexImage2D.apply(i,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}},texImage2D:function ti(){try{i.texImage2D.apply(i,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}},texImage3D:function ee(){try{i.texImage3D.apply(i,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}},texStorage2D:function jt(){try{i.texStorage2D.apply(i,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}},texStorage3D:function fn(){try{i.texStorage3D.apply(i,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}},texSubImage2D:function J(){try{i.texSubImage2D.apply(i,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}},texSubImage3D:function Qe(){try{i.texSubImage3D.apply(i,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}},compressedTexSubImage2D:function Ft(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(_e){console.error("THREE.WebGLState:",_e)}},scissor:function Ct(_e){!1===zt.equals(_e)&&(i.scissor(_e.x,_e.y,_e.z,_e.w),zt.copy(_e))},viewport:function Yt(_e){!1===At.equals(_e)&&(i.viewport(_e.x,_e.y,_e.z,_e.w),At.copy(_e))},reset:function Xt(){i.disable(3042),i.disable(2884),i.disable(2929),i.disable(32823),i.disable(3089),i.disable(2960),i.disable(32926),i.blendEquation(32774),i.blendFunc(1,0),i.blendFuncSeparate(1,0,1,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(513),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(519,0,4294967295),i.stencilOp(7680,7680,7680),i.clearStencil(0),i.cullFace(1029),i.frontFace(2305),i.polygonOffset(0,0),i.activeTexture(33984),i.bindFramebuffer(36160,null),!0===n&&(i.bindFramebuffer(36009,null),i.bindFramebuffer(36008,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),g={},_t=null,vt={},v={},b=new WeakMap,x=[],C=null,I=!1,D=null,L=null,V=null,z=null,U=null,$=null,Z=null,ae=!1,j=null,ie=null,we=null,Me=null,dt=null,zt.set(0,0,i.canvas.width,i.canvas.height),At.set(0,0,i.canvas.width,i.canvas.height),c.reset(),d.reset(),f.reset()}}}function uW(i,e,t,n,r,s,a){const c=r.isWebGL2,d=r.maxTextures,f=r.maxCubemapSize,g=r.maxTextureSize,v=r.maxSamples,b=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,x=/OculusBrowser/g.test(navigator.userAgent),C=new WeakMap;let I;const D=new WeakMap;let L=!1;try{L="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(se){}function V(se,J){return L?new OffscreenCanvas(se,J):HE("canvas")}function z(se,J,Qe,Ft){let jt=1;if((se.width>Ft||se.height>Ft)&&(jt=Ft/Math.max(se.width,se.height)),jt<1||!0===J){if("undefined"!=typeof HTMLImageElement&&se instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&se instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&se instanceof ImageBitmap){const fn=J?LC:Math.floor,ti=fn(jt*se.width),ee=fn(jt*se.height);void 0===I&&(I=V(ti,ee));const Ct=Qe?V(ti,ee):I;return Ct.width=ti,Ct.height=ee,Ct.getContext("2d").drawImage(se,0,0,ti,ee),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+se.width+"x"+se.height+") to ("+ti+"x"+ee+")."),Ct}return"data"in se&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+se.width+"x"+se.height+")."),se}return se}function U(se){return mR(se.width)&&mR(se.height)}function Z(se,J){return se.generateMipmaps&&J&&se.minFilter!==Do&&se.minFilter!==$s}function ae(se){i.generateMipmap(se)}function j(se,J,Qe,Ft,jt=!1){if(!1===c)return J;if(null!==se){if(void 0!==i[se])return i[se];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+se+"'")}let fn=J;return 6403===J&&(5126===Qe&&(fn=33326),5131===Qe&&(fn=33325),5121===Qe&&(fn=33321)),33319===J&&(5126===Qe&&(fn=33328),5131===Qe&&(fn=33327),5121===Qe&&(fn=33323)),6408===J&&(5126===Qe&&(fn=34836),5131===Qe&&(fn=34842),5121===Qe&&(fn=Ft===yr&&!1===jt?35907:32856),32819===Qe&&(fn=32854),32820===Qe&&(fn=32855)),(33325===fn||33326===fn||33327===fn||33328===fn||34842===fn||34836===fn)&&e.get("EXT_color_buffer_float"),fn}function ie(se,J,Qe){return!0===Z(se,Qe)||se.isFramebufferTexture&&se.minFilter!==Do&&se.minFilter!==$s?Math.log2(Math.max(J.width,J.height))+1:void 0!==se.mipmaps&&se.mipmaps.length>0?se.mipmaps.length:se.isCompressedTexture&&Array.isArray(se.image)?J.mipmaps.length:1}function we(se){return se===Do||1004===se||1005===se?9728:9729}function Me(se){const J=se.target;J.removeEventListener("dispose",Me),function Mt(se){const J=n.get(se);if(void 0===J.__webglInit)return;const Qe=se.source,Ft=D.get(Qe);if(Ft){const jt=Ft[J.__cacheKey];jt.usedTimes--,0===jt.usedTimes&&Se(se),0===Object.keys(Ft).length&&D.delete(Qe)}n.remove(se)}(J),J.isVideoTexture&&C.delete(J)}function dt(se){const J=se.target;J.removeEventListener("dispose",dt),function it(se){const J=se.texture,Qe=n.get(se),Ft=n.get(J);if(void 0!==Ft.__webglTexture&&(i.deleteTexture(Ft.__webglTexture),a.memory.textures--),se.depthTexture&&se.depthTexture.dispose(),se.isWebGLCubeRenderTarget)for(let jt=0;jt<6;jt++)i.deleteFramebuffer(Qe.__webglFramebuffer[jt]),Qe.__webglDepthbuffer&&i.deleteRenderbuffer(Qe.__webglDepthbuffer[jt]);else{if(i.deleteFramebuffer(Qe.__webglFramebuffer),Qe.__webglDepthbuffer&&i.deleteRenderbuffer(Qe.__webglDepthbuffer),Qe.__webglMultisampledFramebuffer&&i.deleteFramebuffer(Qe.__webglMultisampledFramebuffer),Qe.__webglColorRenderbuffer)for(let jt=0;jt<Qe.__webglColorRenderbuffer.length;jt++)Qe.__webglColorRenderbuffer[jt]&&i.deleteRenderbuffer(Qe.__webglColorRenderbuffer[jt]);Qe.__webglDepthRenderbuffer&&i.deleteRenderbuffer(Qe.__webglDepthRenderbuffer)}if(se.isWebGLMultipleRenderTargets)for(let jt=0,fn=J.length;jt<fn;jt++){const ti=n.get(J[jt]);ti.__webglTexture&&(i.deleteTexture(ti.__webglTexture),a.memory.textures--),n.remove(J[jt])}n.remove(J),n.remove(se)}(J)}function Se(se){const J=n.get(se);i.deleteTexture(J.__webglTexture),delete D.get(se.source)[J.__cacheKey],a.memory.textures--}let Ge=0;function ht(se,J){const Qe=n.get(se);if(se.isVideoTexture&&function Rr(se){const J=a.render.frame;C.get(se)!==J&&(C.set(se,J),se.update())}(se),!1===se.isRenderTargetTexture&&se.version>0&&Qe.__version!==se.version){const Ft=se.image;if(null===Ft)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==Ft.complete)return void oi(Qe,se,J);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+J),t.bindTexture(3553,Qe.__webglTexture)}const Mn={[Hy]:10497,[Ml]:33071,1002:33648},Bn={[Do]:9728,1004:9984,1005:9986,[$s]:9729,1007:9985,[Em]:9987};function ft(se,J,Qe){if(Qe?(i.texParameteri(se,10242,Mn[J.wrapS]),i.texParameteri(se,10243,Mn[J.wrapT]),(32879===se||35866===se)&&i.texParameteri(se,32882,Mn[J.wrapR]),i.texParameteri(se,10240,Bn[J.magFilter]),i.texParameteri(se,10241,Bn[J.minFilter])):(i.texParameteri(se,10242,33071),i.texParameteri(se,10243,33071),(32879===se||35866===se)&&i.texParameteri(se,32882,33071),(J.wrapS!==Ml||J.wrapT!==Ml)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(se,10240,we(J.magFilter)),i.texParameteri(se,10241,we(J.minFilter)),J.minFilter!==Do&&J.minFilter!==$s&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const Ft=e.get("EXT_texture_filter_anisotropic");if(J.type===Sm&&!1===e.has("OES_texture_float_linear")||!1===c&&J.type===FE&&!1===e.has("OES_texture_half_float_linear"))return;(J.anisotropy>1||n.get(J).__currentAnisotropy)&&(i.texParameterf(se,Ft.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(J.anisotropy,r.getMaxAnisotropy())),n.get(J).__currentAnisotropy=J.anisotropy)}}function Bi(se,J){let Qe=!1;void 0===se.__webglInit&&(se.__webglInit=!0,J.addEventListener("dispose",Me));const Ft=J.source;let jt=D.get(Ft);void 0===jt&&(jt={},D.set(Ft,jt));const fn=function rt(se){const J=[];return J.push(se.wrapS),J.push(se.wrapT),J.push(se.magFilter),J.push(se.minFilter),J.push(se.anisotropy),J.push(se.internalFormat),J.push(se.format),J.push(se.type),J.push(se.generateMipmaps),J.push(se.premultiplyAlpha),J.push(se.flipY),J.push(se.unpackAlignment),J.push(se.encoding),J.join()}(J);if(fn!==se.__cacheKey){void 0===jt[fn]&&(jt[fn]={texture:i.createTexture(),usedTimes:0},a.memory.textures++,Qe=!0),jt[fn].usedTimes++;const ti=jt[se.__cacheKey];void 0!==ti&&(jt[se.__cacheKey].usedTimes--,0===ti.usedTimes&&Se(J)),se.__cacheKey=fn,se.__webglTexture=jt[fn].texture}return Qe}function oi(se,J,Qe){let Ft=3553;J.isDataArrayTexture&&(Ft=35866),J.isData3DTexture&&(Ft=32879);const jt=Bi(se,J),fn=J.source;if(t.activeTexture(33984+Qe),t.bindTexture(Ft,se.__webglTexture),fn.version!==fn.__currentVersion||!0===jt){i.pixelStorei(37440,J.flipY),i.pixelStorei(37441,J.premultiplyAlpha),i.pixelStorei(3317,J.unpackAlignment),i.pixelStorei(37443,0);const ti=function $(se){return!c&&(se.wrapS!==Ml||se.wrapT!==Ml||se.minFilter!==Do&&se.minFilter!==$s)}(J)&&!1===U(J.image);let ee=z(J.image,ti,!1,g);ee=_r(J,ee);const Ct=U(ee)||c,Yt=s.convert(J.format,J.encoding);let Jt,Xt=s.convert(J.type),_e=j(J.internalFormat,Yt,Xt,J.encoding,J.isVideoTexture);ft(Ft,J,Ct);const $t=J.mipmaps,Jn=c&&!0!==J.isVideoTexture,pn=void 0===fn.__currentVersion||!0===jt,Hn=ie(J,ee,Ct);if(J.isDepthTexture)_e=6402,c?_e=J.type===Sm?36012:J.type===Gy?33190:J.type===k0?35056:33189:J.type===Sm&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),J.format===jy&&6402===_e&&1012!==J.type&&J.type!==Gy&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),J.type=Gy,Xt=s.convert(J.type)),J.format===F0&&6402===_e&&(_e=34041,J.type!==k0&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),J.type=k0,Xt=s.convert(J.type))),pn&&(Jn?t.texStorage2D(3553,1,_e,ee.width,ee.height):t.texImage2D(3553,0,_e,ee.width,ee.height,0,Yt,Xt,null));else if(J.isDataTexture)if($t.length>0&&Ct){Jn&&pn&&t.texStorage2D(3553,Hn,_e,$t[0].width,$t[0].height);for(let Qt=0,mi=$t.length;Qt<mi;Qt++)Jt=$t[Qt],Jn?t.texSubImage2D(3553,Qt,0,0,Jt.width,Jt.height,Yt,Xt,Jt.data):t.texImage2D(3553,Qt,_e,Jt.width,Jt.height,0,Yt,Xt,Jt.data);J.generateMipmaps=!1}else Jn?(pn&&t.texStorage2D(3553,Hn,_e,ee.width,ee.height),t.texSubImage2D(3553,0,0,0,ee.width,ee.height,Yt,Xt,ee.data)):t.texImage2D(3553,0,_e,ee.width,ee.height,0,Yt,Xt,ee.data);else if(J.isCompressedTexture){Jn&&pn&&t.texStorage2D(3553,Hn,_e,$t[0].width,$t[0].height);for(let Qt=0,mi=$t.length;Qt<mi;Qt++)Jt=$t[Qt],J.format!==Nu?null!==Yt?Jn?t.compressedTexSubImage2D(3553,Qt,0,0,Jt.width,Jt.height,Yt,Jt.data):t.compressedTexImage2D(3553,Qt,_e,Jt.width,Jt.height,0,Jt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Jn?t.texSubImage2D(3553,Qt,0,0,Jt.width,Jt.height,Yt,Xt,Jt.data):t.texImage2D(3553,Qt,_e,Jt.width,Jt.height,0,Yt,Xt,Jt.data)}else if(J.isDataArrayTexture)Jn?(pn&&t.texStorage3D(35866,Hn,_e,ee.width,ee.height,ee.depth),t.texSubImage3D(35866,0,0,0,0,ee.width,ee.height,ee.depth,Yt,Xt,ee.data)):t.texImage3D(35866,0,_e,ee.width,ee.height,ee.depth,0,Yt,Xt,ee.data);else if(J.isData3DTexture)Jn?(pn&&t.texStorage3D(32879,Hn,_e,ee.width,ee.height,ee.depth),t.texSubImage3D(32879,0,0,0,0,ee.width,ee.height,ee.depth,Yt,Xt,ee.data)):t.texImage3D(32879,0,_e,ee.width,ee.height,ee.depth,0,Yt,Xt,ee.data);else if(J.isFramebufferTexture){if(pn)if(Jn)t.texStorage2D(3553,Hn,_e,ee.width,ee.height);else{let Qt=ee.width,mi=ee.height;for(let Mr=0;Mr<Hn;Mr++)t.texImage2D(3553,Mr,_e,Qt,mi,0,Yt,Xt,null),Qt>>=1,mi>>=1}}else if($t.length>0&&Ct){Jn&&pn&&t.texStorage2D(3553,Hn,_e,$t[0].width,$t[0].height);for(let Qt=0,mi=$t.length;Qt<mi;Qt++)Jt=$t[Qt],Jn?t.texSubImage2D(3553,Qt,0,0,Yt,Xt,Jt):t.texImage2D(3553,Qt,_e,Yt,Xt,Jt);J.generateMipmaps=!1}else Jn?(pn&&t.texStorage2D(3553,Hn,_e,ee.width,ee.height),t.texSubImage2D(3553,0,0,0,Yt,Xt,ee)):t.texImage2D(3553,0,_e,Yt,Xt,ee);Z(J,Ct)&&ae(Ft),fn.__currentVersion=fn.version,J.onUpdate&&J.onUpdate(J)}se.__version=J.version}function tn(se,J,Qe,Ft,jt){const fn=s.convert(Qe.format,Qe.encoding),ti=s.convert(Qe.type),ee=j(Qe.internalFormat,fn,ti,Qe.encoding);n.get(J).__hasExternalTextures||(32879===jt||35866===jt?t.texImage3D(jt,0,ee,J.width,J.height,J.depth,0,fn,ti,null):t.texImage2D(jt,0,ee,J.width,J.height,0,fn,ti,null)),t.bindFramebuffer(36160,se),$n(J)?b.framebufferTexture2DMultisampleEXT(36160,Ft,jt,n.get(Qe).__webglTexture,0,Xn(J)):i.framebufferTexture2D(36160,Ft,jt,n.get(Qe).__webglTexture,0),t.bindFramebuffer(36160,null)}function xi(se,J,Qe){if(i.bindRenderbuffer(36161,se),J.depthBuffer&&!J.stencilBuffer){let Ft=33189;if(Qe||$n(J)){const jt=J.depthTexture;jt&&jt.isDepthTexture&&(jt.type===Sm?Ft=36012:jt.type===Gy&&(Ft=33190));const fn=Xn(J);$n(J)?b.renderbufferStorageMultisampleEXT(36161,fn,Ft,J.width,J.height):i.renderbufferStorageMultisample(36161,fn,Ft,J.width,J.height)}else i.renderbufferStorage(36161,Ft,J.width,J.height);i.framebufferRenderbuffer(36160,36096,36161,se)}else if(J.depthBuffer&&J.stencilBuffer){const Ft=Xn(J);Qe&&!1===$n(J)?i.renderbufferStorageMultisample(36161,Ft,35056,J.width,J.height):$n(J)?b.renderbufferStorageMultisampleEXT(36161,Ft,35056,J.width,J.height):i.renderbufferStorage(36161,34041,J.width,J.height),i.framebufferRenderbuffer(36160,33306,36161,se)}else{const Ft=!0===J.isWebGLMultipleRenderTargets?J.texture:[J.texture];for(let jt=0;jt<Ft.length;jt++){const fn=Ft[jt],ti=s.convert(fn.format,fn.encoding),ee=s.convert(fn.type),Ct=j(fn.internalFormat,ti,ee,fn.encoding),Yt=Xn(J);Qe&&!1===$n(J)?i.renderbufferStorageMultisample(36161,Yt,Ct,J.width,J.height):$n(J)?b.renderbufferStorageMultisampleEXT(36161,Yt,Ct,J.width,J.height):i.renderbufferStorage(36161,Ct,J.width,J.height)}}i.bindRenderbuffer(36161,null)}function wt(se){const J=n.get(se),Qe=!0===se.isWebGLCubeRenderTarget;if(se.depthTexture&&!J.__autoAllocateDepthBuffer){if(Qe)throw new Error("target.depthTexture not supported in Cube render targets");!function xt(se,J){if(J&&J.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,se),!J.depthTexture||!J.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(J.depthTexture).__webglTexture||J.depthTexture.image.width!==J.width||J.depthTexture.image.height!==J.height)&&(J.depthTexture.image.width=J.width,J.depthTexture.image.height=J.height,J.depthTexture.needsUpdate=!0),ht(J.depthTexture,0);const Ft=n.get(J.depthTexture).__webglTexture,jt=Xn(J);if(J.depthTexture.format===jy)$n(J)?b.framebufferTexture2DMultisampleEXT(36160,36096,3553,Ft,0,jt):i.framebufferTexture2D(36160,36096,3553,Ft,0);else{if(J.depthTexture.format!==F0)throw new Error("Unknown depthTexture format");$n(J)?b.framebufferTexture2DMultisampleEXT(36160,33306,3553,Ft,0,jt):i.framebufferTexture2D(36160,33306,3553,Ft,0)}}(J.__webglFramebuffer,se)}else if(Qe){J.__webglDepthbuffer=[];for(let Ft=0;Ft<6;Ft++)t.bindFramebuffer(36160,J.__webglFramebuffer[Ft]),J.__webglDepthbuffer[Ft]=i.createRenderbuffer(),xi(J.__webglDepthbuffer[Ft],se,!1)}else t.bindFramebuffer(36160,J.__webglFramebuffer),J.__webglDepthbuffer=i.createRenderbuffer(),xi(J.__webglDepthbuffer,se,!1);t.bindFramebuffer(36160,null)}function Xn(se){return Math.min(v,se.samples)}function $n(se){const J=n.get(se);return c&&se.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==J.__useRenderToTexture}function _r(se,J){const Qe=se.encoding,Ft=se.format,jt=se.type;return!0===se.isCompressedTexture||!0===se.isVideoTexture||1035===se.format||Qe!==Wy&&(Qe===yr?!1===c?!0===e.has("EXT_sRGB")&&Ft===Nu?(se.format=1035,se.minFilter=$s,se.generateMipmaps=!1):J=fk.sRGBToLinear(J):(Ft!==Nu||jt!==zy)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Qe)),J}this.allocateTextureUnit=function vt(){const se=Ge;return se>=d&&console.warn("THREE.WebGLTextures: Trying to use "+se+" texture units while this GPU supports only "+d),Ge+=1,se},this.resetTextureUnits=function _t(){Ge=0},this.setTexture2D=ht,this.setTexture2DArray=function zt(se,J){const Qe=n.get(se);se.version>0&&Qe.__version!==se.version?oi(Qe,se,J):(t.activeTexture(33984+J),t.bindTexture(35866,Qe.__webglTexture))},this.setTexture3D=function At(se,J){const Qe=n.get(se);se.version>0&&Qe.__version!==se.version?oi(Qe,se,J):(t.activeTexture(33984+J),t.bindTexture(32879,Qe.__webglTexture))},this.setTextureCube=function ln(se,J){const Qe=n.get(se);se.version>0&&Qe.__version!==se.version?function di(se,J,Qe){if(6!==J.image.length)return;const Ft=Bi(se,J),jt=J.source;if(t.activeTexture(33984+Qe),t.bindTexture(34067,se.__webglTexture),jt.version!==jt.__currentVersion||!0===Ft){i.pixelStorei(37440,J.flipY),i.pixelStorei(37441,J.premultiplyAlpha),i.pixelStorei(3317,J.unpackAlignment),i.pixelStorei(37443,0);const fn=J.isCompressedTexture||J.image[0].isCompressedTexture,ti=J.image[0]&&J.image[0].isDataTexture,ee=[];for(let Qt=0;Qt<6;Qt++)ee[Qt]=fn||ti?ti?J.image[Qt].image:J.image[Qt]:z(J.image[Qt],!1,!0,f),ee[Qt]=_r(J,ee[Qt]);const Ct=ee[0],Yt=U(Ct)||c,Xt=s.convert(J.format,J.encoding),_e=s.convert(J.type),Jt=j(J.internalFormat,Xt,_e,J.encoding),$t=c&&!0!==J.isVideoTexture,Jn=void 0===jt.__currentVersion||!0===Ft;let Hn,pn=ie(J,Ct,Yt);if(ft(34067,J,Yt),fn){$t&&Jn&&t.texStorage2D(34067,pn,Jt,Ct.width,Ct.height);for(let Qt=0;Qt<6;Qt++){Hn=ee[Qt].mipmaps;for(let mi=0;mi<Hn.length;mi++){const Mr=Hn[mi];J.format!==Nu?null!==Xt?$t?t.compressedTexSubImage2D(34069+Qt,mi,0,0,Mr.width,Mr.height,Xt,Mr.data):t.compressedTexImage2D(34069+Qt,mi,Jt,Mr.width,Mr.height,0,Mr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$t?t.texSubImage2D(34069+Qt,mi,0,0,Mr.width,Mr.height,Xt,_e,Mr.data):t.texImage2D(34069+Qt,mi,Jt,Mr.width,Mr.height,0,Xt,_e,Mr.data)}}}else{Hn=J.mipmaps,$t&&Jn&&(Hn.length>0&&pn++,t.texStorage2D(34067,pn,Jt,ee[0].width,ee[0].height));for(let Qt=0;Qt<6;Qt++)if(ti){$t?t.texSubImage2D(34069+Qt,0,0,0,ee[Qt].width,ee[Qt].height,Xt,_e,ee[Qt].data):t.texImage2D(34069+Qt,0,Jt,ee[Qt].width,ee[Qt].height,0,Xt,_e,ee[Qt].data);for(let mi=0;mi<Hn.length;mi++){const Cr=Hn[mi].image[Qt].image;$t?t.texSubImage2D(34069+Qt,mi+1,0,0,Cr.width,Cr.height,Xt,_e,Cr.data):t.texImage2D(34069+Qt,mi+1,Jt,Cr.width,Cr.height,0,Xt,_e,Cr.data)}}else{$t?t.texSubImage2D(34069+Qt,0,0,0,Xt,_e,ee[Qt]):t.texImage2D(34069+Qt,0,Jt,Xt,_e,ee[Qt]);for(let mi=0;mi<Hn.length;mi++){const Mr=Hn[mi];$t?t.texSubImage2D(34069+Qt,mi+1,0,0,Xt,_e,Mr.image[Qt]):t.texImage2D(34069+Qt,mi+1,Jt,Xt,_e,Mr.image[Qt])}}}Z(J,Yt)&&ae(34067),jt.__currentVersion=jt.version,J.onUpdate&&J.onUpdate(J)}se.__version=J.version}(Qe,se,J):(t.activeTexture(33984+J),t.bindTexture(34067,Qe.__webglTexture))},this.rebindTextures=function Wt(se,J,Qe){const Ft=n.get(se);void 0!==J&&tn(Ft.__webglFramebuffer,se,se.texture,36064,3553),void 0!==Qe&&wt(se)},this.setupRenderTarget=function Sn(se){const J=se.texture,Qe=n.get(se),Ft=n.get(J);se.addEventListener("dispose",dt),!0!==se.isWebGLMultipleRenderTargets&&(void 0===Ft.__webglTexture&&(Ft.__webglTexture=i.createTexture()),Ft.__version=J.version,a.memory.textures++);const jt=!0===se.isWebGLCubeRenderTarget,fn=!0===se.isWebGLMultipleRenderTargets,ti=U(se)||c;if(jt){Qe.__webglFramebuffer=[];for(let ee=0;ee<6;ee++)Qe.__webglFramebuffer[ee]=i.createFramebuffer()}else{if(Qe.__webglFramebuffer=i.createFramebuffer(),fn)if(r.drawBuffers){const ee=se.texture;for(let Ct=0,Yt=ee.length;Ct<Yt;Ct++){const Xt=n.get(ee[Ct]);void 0===Xt.__webglTexture&&(Xt.__webglTexture=i.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(c&&se.samples>0&&!1===$n(se)){const ee=fn?J:[J];Qe.__webglMultisampledFramebuffer=i.createFramebuffer(),Qe.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,Qe.__webglMultisampledFramebuffer);for(let Ct=0;Ct<ee.length;Ct++){const Yt=ee[Ct];Qe.__webglColorRenderbuffer[Ct]=i.createRenderbuffer(),i.bindRenderbuffer(36161,Qe.__webglColorRenderbuffer[Ct]);const Xt=s.convert(Yt.format,Yt.encoding),_e=s.convert(Yt.type),Jt=j(Yt.internalFormat,Xt,_e,Yt.encoding),$t=Xn(se);i.renderbufferStorageMultisample(36161,$t,Jt,se.width,se.height),i.framebufferRenderbuffer(36160,36064+Ct,36161,Qe.__webglColorRenderbuffer[Ct])}i.bindRenderbuffer(36161,null),se.depthBuffer&&(Qe.__webglDepthRenderbuffer=i.createRenderbuffer(),xi(Qe.__webglDepthRenderbuffer,se,!0)),t.bindFramebuffer(36160,null)}}if(jt){t.bindTexture(34067,Ft.__webglTexture),ft(34067,J,ti);for(let ee=0;ee<6;ee++)tn(Qe.__webglFramebuffer[ee],se,J,36064,34069+ee);Z(J,ti)&&ae(34067),t.unbindTexture()}else if(fn){const ee=se.texture;for(let Ct=0,Yt=ee.length;Ct<Yt;Ct++){const Xt=ee[Ct],_e=n.get(Xt);t.bindTexture(3553,_e.__webglTexture),ft(3553,Xt,ti),tn(Qe.__webglFramebuffer,se,Xt,36064+Ct,3553),Z(Xt,ti)&&ae(3553)}t.unbindTexture()}else{let ee=3553;(se.isWebGL3DRenderTarget||se.isWebGLArrayRenderTarget)&&(c?ee=se.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(ee,Ft.__webglTexture),ft(ee,J,ti),tn(Qe.__webglFramebuffer,se,J,36064,ee),Z(J,ti)&&ae(ee),t.unbindTexture()}se.depthBuffer&&wt(se)},this.updateRenderTargetMipmap=function dn(se){const J=U(se)||c,Qe=!0===se.isWebGLMultipleRenderTargets?se.texture:[se.texture];for(let Ft=0,jt=Qe.length;Ft<jt;Ft++){const fn=Qe[Ft];if(Z(fn,J)){const ti=se.isWebGLCubeRenderTarget?34067:3553,ee=n.get(fn).__webglTexture;t.bindTexture(ti,ee),ae(ti),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function pi(se){if(c&&se.samples>0&&!1===$n(se)){const J=se.isWebGLMultipleRenderTargets?se.texture:[se.texture],Qe=se.width,Ft=se.height;let jt=16384;const fn=[],ti=se.stencilBuffer?33306:36096,ee=n.get(se),Ct=!0===se.isWebGLMultipleRenderTargets;if(Ct)for(let Yt=0;Yt<J.length;Yt++)t.bindFramebuffer(36160,ee.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Yt,36161,null),t.bindFramebuffer(36160,ee.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Yt,3553,null,0);t.bindFramebuffer(36008,ee.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,ee.__webglFramebuffer);for(let Yt=0;Yt<J.length;Yt++){fn.push(36064+Yt),se.depthBuffer&&fn.push(ti);const Xt=void 0!==ee.__ignoreDepthValues&&ee.__ignoreDepthValues;if(!1===Xt&&(se.depthBuffer&&(jt|=256),se.stencilBuffer&&(jt|=1024)),Ct&&i.framebufferRenderbuffer(36008,36064,36161,ee.__webglColorRenderbuffer[Yt]),!0===Xt&&(i.invalidateFramebuffer(36008,[ti]),i.invalidateFramebuffer(36009,[ti])),Ct){const _e=n.get(J[Yt]).__webglTexture;i.framebufferTexture2D(36009,36064,3553,_e,0)}i.blitFramebuffer(0,0,Qe,Ft,0,0,Qe,Ft,jt,9728),x&&i.invalidateFramebuffer(36008,fn)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Ct)for(let Yt=0;Yt<J.length;Yt++){t.bindFramebuffer(36160,ee.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(36160,36064+Yt,36161,ee.__webglColorRenderbuffer[Yt]);const Xt=n.get(J[Yt]).__webglTexture;t.bindFramebuffer(36160,ee.__webglFramebuffer),i.framebufferTexture2D(36009,36064+Yt,3553,Xt,0)}t.bindFramebuffer(36009,ee.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=wt,this.setupFrameBufferTexture=tn,this.useMultisampledRTT=$n}function dW(i,e,t){const n=t.isWebGL2;return{convert:function r(s,a=null){let c;if(s===zy)return 5121;if(1017===s)return 32819;if(1018===s)return 32820;if(1010===s)return 5120;if(1011===s)return 5122;if(1012===s)return 5123;if(1013===s)return 5124;if(s===Gy)return 5125;if(s===Sm)return 5126;if(s===FE)return n?5131:(c=e.get("OES_texture_half_float"),null!==c?c.HALF_FLOAT_OES:null);if(1021===s)return 6406;if(s===Nu)return 6408;if(1024===s)return 6409;if(1025===s)return 6410;if(s===jy)return 6402;if(s===F0)return 34041;if(1028===s)return 6403;if(1022===s)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===s)return c=e.get("EXT_sRGB"),null!==c?c.SRGB_ALPHA_EXT:null;if(1029===s)return 36244;if(1030===s)return 33319;if(1031===s)return 33320;if(1033===s)return 36249;if(33776===s||33777===s||33778===s||33779===s)if(a===yr){if(c=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===c)return null;if(33776===s)return c.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===s)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===s)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===s)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(c=e.get("WEBGL_compressed_texture_s3tc"),null===c)return null;if(33776===s)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===s)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===s)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===s)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===s||35841===s||35842===s||35843===s){if(c=e.get("WEBGL_compressed_texture_pvrtc"),null===c)return null;if(35840===s)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===s)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===s)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===s)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===s)return c=e.get("WEBGL_compressed_texture_etc1"),null!==c?c.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===s||37496===s){if(c=e.get("WEBGL_compressed_texture_etc"),null===c)return null;if(37492===s)return a===yr?c.COMPRESSED_SRGB8_ETC2:c.COMPRESSED_RGB8_ETC2;if(37496===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:c.COMPRESSED_RGBA8_ETC2_EAC}if(37808===s||37809===s||37810===s||37811===s||37812===s||37813===s||37814===s||37815===s||37816===s||37817===s||37818===s||37819===s||37820===s||37821===s){if(c=e.get("WEBGL_compressed_texture_astc"),null===c)return null;if(37808===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:c.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:c.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:c.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:c.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:c.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:c.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:c.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:c.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:c.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:c.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:c.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:c.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:c.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===s)return a===yr?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:c.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===s){if(c=e.get("EXT_texture_compression_bptc"),null===c)return null;if(36492===s)return a===yr?c.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:c.COMPRESSED_RGBA_BPTC_UNORM_EXT}return s===k0?n?34042:(c=e.get("WEBGL_depth_texture"),null!==c?c.UNSIGNED_INT_24_8_WEBGL:null):void 0!==i[s]?i[s]:null}}}class hW extends ua{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Nm extends qs{constructor(){super(),this.isGroup=!0,this.type="Group"}}const fW={type:"move"};class qR{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Nm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Nm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Nm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,a=null;const c=this._targetRay,d=this._grip,f=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==c&&(r=t.getPose(e.targetRaySpace,n),null!==r&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(fW))),f&&e.hand){a=!0;for(const I of e.hand.values()){const D=t.getJointPose(I,n);if(void 0===f.joints[I.jointName]){const V=new Nm;V.matrixAutoUpdate=!1,V.visible=!1,f.joints[I.jointName]=V,f.add(V)}const L=f.joints[I.jointName];null!==D&&(L.matrix.fromArray(D.transform.matrix),L.matrix.decompose(L.position,L.rotation,L.scale),L.jointRadius=D.radius),L.visible=null!==D}const b=f.joints["index-finger-tip"].position.distanceTo(f.joints["thumb-tip"].position),x=.02,C=.005;f.inputState.pinching&&b>x+C?(f.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!f.inputState.pinching&&b<=x-C&&(f.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==d&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),null!==s&&(d.matrix.fromArray(s.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),s.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(s.linearVelocity)):d.hasLinearVelocity=!1,s.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(s.angularVelocity)):d.hasAngularVelocity=!1));return null!==c&&(c.visible=null!==r),null!==d&&(d.visible=null!==s),null!==f&&(f.visible=null!==a),this}}class pW extends bd{constructor(e,t,n,r,s,a,c,d,f,g){if((g=void 0!==g?g:jy)!==jy&&g!==F0)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&g===jy&&(n=Gy),void 0===n&&g===F0&&(n=k0),super(null,r,s,a,c,d,g,n,f),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==c?c:Do,this.minFilter=void 0!==d?d:Do,this.flipY=!1,this.generateMipmaps=!1}}class mW extends Ky{constructor(e,t){super();const n=this;let r=null,s=1,a=null,c="local-floor",d=null,f=null,g=null,v=null,b=null,x=null;const C=t.getContextAttributes();let I=null,D=null;const L=[],V=new Map,z=new ua;z.layers.enable(1),z.viewport=new Ur;const U=new ua;U.layers.enable(2),U.viewport=new Ur;const $=[z,U],Z=new hW;Z.layers.enable(1),Z.layers.enable(2);let ae=null,j=null;function ie(rt){const ht=V.get(rt.inputSource);void 0!==ht&&ht.dispatchEvent({type:rt.type,data:rt.inputSource})}function we(){r.removeEventListener("select",ie),r.removeEventListener("selectstart",ie),r.removeEventListener("selectend",ie),r.removeEventListener("squeeze",ie),r.removeEventListener("squeezestart",ie),r.removeEventListener("squeezeend",ie),r.removeEventListener("end",we),r.removeEventListener("inputsourceschange",Me),V.forEach(function(rt,ht){void 0!==rt&&rt.disconnect(ht)}),V.clear(),ae=null,j=null,e.setRenderTarget(I),b=null,v=null,g=null,r=null,D=null,vt.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function Me(rt){const ht=r.inputSources;for(let zt=0;zt<ht.length;zt++)V.set(ht[zt],L["right"===ht[zt].handedness?1:0]);for(let zt=0;zt<rt.removed.length;zt++){const At=rt.removed[zt],ln=V.get(At);ln&&(ln.dispatchEvent({type:"disconnected",data:At}),V.delete(At))}for(let zt=0;zt<rt.added.length;zt++){const At=rt.added[zt],ln=V.get(At);ln&&ln.dispatchEvent({type:"connected",data:At})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(rt){let ht=L[rt];return void 0===ht&&(ht=new qR,L[rt]=ht),ht.getTargetRaySpace()},this.getControllerGrip=function(rt){let ht=L[rt];return void 0===ht&&(ht=new qR,L[rt]=ht),ht.getGripSpace()},this.getHand=function(rt){let ht=L[rt];return void 0===ht&&(ht=new qR,L[rt]=ht),ht.getHandSpace()},this.setFramebufferScaleFactor=function(rt){s=rt,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(rt){c=rt,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return d||a},this.setReferenceSpace=function(rt){d=rt},this.getBaseLayer=function(){return null!==v?v:b},this.getBinding=function(){return g},this.getFrame=function(){return x},this.getSession=function(){return r},this.setSession=function(){var rt=(0,Ke.Z)(function*(ht){if(r=ht,null!==r){if(I=e.getRenderTarget(),r.addEventListener("select",ie),r.addEventListener("selectstart",ie),r.addEventListener("selectend",ie),r.addEventListener("squeeze",ie),r.addEventListener("squeezestart",ie),r.addEventListener("squeezeend",ie),r.addEventListener("end",we),r.addEventListener("inputsourceschange",Me),!0!==C.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)b=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||C.antialias,alpha:C.alpha,depth:C.depth,stencil:C.stencil,framebufferScaleFactor:s}),r.updateRenderState({baseLayer:b}),D=new Tm(b.framebufferWidth,b.framebufferHeight,{format:Nu,type:zy,encoding:e.outputEncoding});else{let zt=null,At=null,ln=null;C.depth&&(ln=C.stencil?35056:33190,zt=C.stencil?F0:jy,At=C.stencil?k0:Gy);const Mn={colorFormat:e.outputEncoding===yr?35907:32856,depthFormat:ln,scaleFactor:s};g=new XRWebGLBinding(r,t),v=g.createProjectionLayer(Mn),r.updateRenderState({layers:[v]}),D=new Tm(v.textureWidth,v.textureHeight,{format:Nu,type:zy,depthTexture:new pW(v.textureWidth,v.textureHeight,At,void 0,void 0,void 0,void 0,void 0,void 0,zt),stencilBuffer:C.stencil,encoding:e.outputEncoding,samples:C.antialias?4:0}),e.properties.get(D).__ignoreDepthValues=v.ignoreDepthValues}D.isXRRenderTarget=!0,this.setFoveation(1),d=null,a=yield r.requestReferenceSpace(c),vt.setContext(r),vt.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}});return function(ht){return rt.apply(this,arguments)}}();const dt=new Q,Mt=new Q;function it(rt,ht){null===ht?rt.matrixWorld.copy(rt.matrix):rt.matrixWorld.multiplyMatrices(ht.matrixWorld,rt.matrix),rt.matrixWorldInverse.copy(rt.matrixWorld).invert()}this.updateCamera=function(rt){if(null===r)return;Z.near=U.near=z.near=rt.near,Z.far=U.far=z.far=rt.far,(ae!==Z.near||j!==Z.far)&&(r.updateRenderState({depthNear:Z.near,depthFar:Z.far}),ae=Z.near,j=Z.far);const ht=rt.parent,zt=Z.cameras;it(Z,ht);for(let ln=0;ln<zt.length;ln++)it(zt[ln],ht);Z.matrixWorld.decompose(Z.position,Z.quaternion,Z.scale),rt.position.copy(Z.position),rt.quaternion.copy(Z.quaternion),rt.scale.copy(Z.scale),rt.matrix.copy(Z.matrix),rt.matrixWorld.copy(Z.matrixWorld);const At=rt.children;for(let ln=0,Mn=At.length;ln<Mn;ln++)At[ln].updateMatrixWorld(!0);2===zt.length?function Se(rt,ht,zt){dt.setFromMatrixPosition(ht.matrixWorld),Mt.setFromMatrixPosition(zt.matrixWorld);const At=dt.distanceTo(Mt),ln=ht.projectionMatrix.elements,Mn=zt.projectionMatrix.elements,Bn=ln[14]/(ln[10]-1),ft=ln[14]/(ln[10]+1),Bi=(ln[9]+1)/ln[5],oi=(ln[9]-1)/ln[5],di=(ln[8]-1)/ln[0],tn=(Mn[8]+1)/Mn[0],xi=Bn*di,xt=Bn*tn,wt=At/(-di+tn),Wt=wt*-di;ht.matrixWorld.decompose(rt.position,rt.quaternion,rt.scale),rt.translateX(Wt),rt.translateZ(wt),rt.matrixWorld.compose(rt.position,rt.quaternion,rt.scale),rt.matrixWorldInverse.copy(rt.matrixWorld).invert();const Sn=Bn+wt,dn=ft+wt;rt.projectionMatrix.makePerspective(xi-Wt,xt+(At-Wt),Bi*ft/dn*Sn,oi*ft/dn*Sn,Sn,dn)}(Z,z,U):Z.projectionMatrix.copy(z.projectionMatrix)},this.getCamera=function(){return Z},this.getFoveation=function(){return null!==v?v.fixedFoveation:null!==b?b.fixedFoveation:void 0},this.setFoveation=function(rt){null!==v&&(v.fixedFoveation=rt),null!==b&&void 0!==b.fixedFoveation&&(b.fixedFoveation=rt)};let Ge=null;const vt=new Ak;vt.setAnimationLoop(function _t(rt,ht){if(f=ht.getViewerPose(d||a),x=ht,null!==f){const At=f.views;null!==b&&(e.setRenderTargetFramebuffer(D,b.framebuffer),e.setRenderTarget(D));let ln=!1;At.length!==Z.cameras.length&&(Z.cameras.length=0,ln=!0);for(let Mn=0;Mn<At.length;Mn++){const Bn=At[Mn];let ft=null;if(null!==b)ft=b.getViewport(Bn);else{const oi=g.getViewSubImage(v,Bn);ft=oi.viewport,0===Mn&&(e.setRenderTargetTextures(D,oi.colorTexture,v.ignoreDepthValues?void 0:oi.depthStencilTexture),e.setRenderTarget(D))}let Bi=$[Mn];void 0===Bi&&(Bi=new ua,Bi.layers.enable(Mn),Bi.viewport=new Ur,$[Mn]=Bi),Bi.matrix.fromArray(Bn.transform.matrix),Bi.projectionMatrix.fromArray(Bn.projectionMatrix),Bi.viewport.set(ft.x,ft.y,ft.width,ft.height),0===Mn&&Z.matrix.copy(Bi.matrix),!0===ln&&Z.cameras.push(Bi)}}const zt=r.inputSources;for(let At=0;At<L.length;At++){const ln=zt[At],Mn=V.get(ln);void 0!==Mn&&Mn.update(ln,ht,d||a)}Ge&&Ge(rt,ht),x=null}),this.setAnimationLoop=function(rt){Ge=rt},this.dispose=function(){}}}function gW(i,e){function r(I,D){I.opacity.value=D.opacity,D.color&&I.diffuse.value.copy(D.color),D.emissive&&I.emissive.value.copy(D.emissive).multiplyScalar(D.emissiveIntensity),D.map&&(I.map.value=D.map),D.alphaMap&&(I.alphaMap.value=D.alphaMap),D.bumpMap&&(I.bumpMap.value=D.bumpMap,I.bumpScale.value=D.bumpScale,1===D.side&&(I.bumpScale.value*=-1)),D.displacementMap&&(I.displacementMap.value=D.displacementMap,I.displacementScale.value=D.displacementScale,I.displacementBias.value=D.displacementBias),D.emissiveMap&&(I.emissiveMap.value=D.emissiveMap),D.normalMap&&(I.normalMap.value=D.normalMap,I.normalScale.value.copy(D.normalScale),1===D.side&&I.normalScale.value.negate()),D.specularMap&&(I.specularMap.value=D.specularMap),D.alphaTest>0&&(I.alphaTest.value=D.alphaTest);const L=e.get(D).envMap;if(L&&(I.envMap.value=L,I.flipEnvMap.value=L.isCubeTexture&&!1===L.isRenderTargetTexture?-1:1,I.reflectivity.value=D.reflectivity,I.ior.value=D.ior,I.refractionRatio.value=D.refractionRatio),D.lightMap){I.lightMap.value=D.lightMap;const U=!0!==i.physicallyCorrectLights?Math.PI:1;I.lightMapIntensity.value=D.lightMapIntensity*U}let V,z;D.aoMap&&(I.aoMap.value=D.aoMap,I.aoMapIntensity.value=D.aoMapIntensity),D.map?V=D.map:D.specularMap?V=D.specularMap:D.displacementMap?V=D.displacementMap:D.normalMap?V=D.normalMap:D.bumpMap?V=D.bumpMap:D.roughnessMap?V=D.roughnessMap:D.metalnessMap?V=D.metalnessMap:D.alphaMap?V=D.alphaMap:D.emissiveMap?V=D.emissiveMap:D.clearcoatMap?V=D.clearcoatMap:D.clearcoatNormalMap?V=D.clearcoatNormalMap:D.clearcoatRoughnessMap?V=D.clearcoatRoughnessMap:D.iridescenceMap?V=D.iridescenceMap:D.iridescenceThicknessMap?V=D.iridescenceThicknessMap:D.specularIntensityMap?V=D.specularIntensityMap:D.specularColorMap?V=D.specularColorMap:D.transmissionMap?V=D.transmissionMap:D.thicknessMap?V=D.thicknessMap:D.sheenColorMap?V=D.sheenColorMap:D.sheenRoughnessMap&&(V=D.sheenRoughnessMap),void 0!==V&&(V.isWebGLRenderTarget&&(V=V.texture),!0===V.matrixAutoUpdate&&V.updateMatrix(),I.uvTransform.value.copy(V.matrix)),D.aoMap?z=D.aoMap:D.lightMap&&(z=D.lightMap),void 0!==z&&(z.isWebGLRenderTarget&&(z=z.texture),!0===z.matrixAutoUpdate&&z.updateMatrix(),I.uv2Transform.value.copy(z.matrix))}return{refreshFogUniforms:function t(I,D){I.fogColor.value.copy(D.color),D.isFog?(I.fogNear.value=D.near,I.fogFar.value=D.far):D.isFogExp2&&(I.fogDensity.value=D.density)},refreshMaterialUniforms:function n(I,D,L,V,z){D.isMeshBasicMaterial||D.isMeshLambertMaterial?r(I,D):D.isMeshToonMaterial?(r(I,D),function g(I,D){D.gradientMap&&(I.gradientMap.value=D.gradientMap)}(I,D)):D.isMeshPhongMaterial?(r(I,D),function f(I,D){I.specular.value.copy(D.specular),I.shininess.value=Math.max(D.shininess,1e-4)}(I,D)):D.isMeshStandardMaterial?(r(I,D),function v(I,D){I.roughness.value=D.roughness,I.metalness.value=D.metalness,D.roughnessMap&&(I.roughnessMap.value=D.roughnessMap),D.metalnessMap&&(I.metalnessMap.value=D.metalnessMap),e.get(D).envMap&&(I.envMapIntensity.value=D.envMapIntensity)}(I,D),D.isMeshPhysicalMaterial&&function b(I,D,L){I.ior.value=D.ior,D.sheen>0&&(I.sheenColor.value.copy(D.sheenColor).multiplyScalar(D.sheen),I.sheenRoughness.value=D.sheenRoughness,D.sheenColorMap&&(I.sheenColorMap.value=D.sheenColorMap),D.sheenRoughnessMap&&(I.sheenRoughnessMap.value=D.sheenRoughnessMap)),D.clearcoat>0&&(I.clearcoat.value=D.clearcoat,I.clearcoatRoughness.value=D.clearcoatRoughness,D.clearcoatMap&&(I.clearcoatMap.value=D.clearcoatMap),D.clearcoatRoughnessMap&&(I.clearcoatRoughnessMap.value=D.clearcoatRoughnessMap),D.clearcoatNormalMap&&(I.clearcoatNormalScale.value.copy(D.clearcoatNormalScale),I.clearcoatNormalMap.value=D.clearcoatNormalMap,1===D.side&&I.clearcoatNormalScale.value.negate())),D.iridescence>0&&(I.iridescence.value=D.iridescence,I.iridescenceIOR.value=D.iridescenceIOR,I.iridescenceThicknessMinimum.value=D.iridescenceThicknessRange[0],I.iridescenceThicknessMaximum.value=D.iridescenceThicknessRange[1],D.iridescenceMap&&(I.iridescenceMap.value=D.iridescenceMap),D.iridescenceThicknessMap&&(I.iridescenceThicknessMap.value=D.iridescenceThicknessMap)),D.transmission>0&&(I.transmission.value=D.transmission,I.transmissionSamplerMap.value=L.texture,I.transmissionSamplerSize.value.set(L.width,L.height),D.transmissionMap&&(I.transmissionMap.value=D.transmissionMap),I.thickness.value=D.thickness,D.thicknessMap&&(I.thicknessMap.value=D.thicknessMap),I.attenuationDistance.value=D.attenuationDistance,I.attenuationColor.value.copy(D.attenuationColor)),I.specularIntensity.value=D.specularIntensity,I.specularColor.value.copy(D.specularColor),D.specularIntensityMap&&(I.specularIntensityMap.value=D.specularIntensityMap),D.specularColorMap&&(I.specularColorMap.value=D.specularColorMap)}(I,D,z)):D.isMeshMatcapMaterial?(r(I,D),function x(I,D){D.matcap&&(I.matcap.value=D.matcap)}(I,D)):D.isMeshDepthMaterial?r(I,D):D.isMeshDistanceMaterial?(r(I,D),function C(I,D){I.referencePosition.value.copy(D.referencePosition),I.nearDistance.value=D.nearDistance,I.farDistance.value=D.farDistance}(I,D)):D.isMeshNormalMaterial?r(I,D):D.isLineBasicMaterial?(function s(I,D){I.diffuse.value.copy(D.color),I.opacity.value=D.opacity}(I,D),D.isLineDashedMaterial&&function a(I,D){I.dashSize.value=D.dashSize,I.totalSize.value=D.dashSize+D.gapSize,I.scale.value=D.scale}(I,D)):D.isPointsMaterial?function c(I,D,L,V){let z;I.diffuse.value.copy(D.color),I.opacity.value=D.opacity,I.size.value=D.size*L,I.scale.value=.5*V,D.map&&(I.map.value=D.map),D.alphaMap&&(I.alphaMap.value=D.alphaMap),D.alphaTest>0&&(I.alphaTest.value=D.alphaTest),D.map?z=D.map:D.alphaMap&&(z=D.alphaMap),void 0!==z&&(!0===z.matrixAutoUpdate&&z.updateMatrix(),I.uvTransform.value.copy(z.matrix))}(I,D,L,V):D.isSpriteMaterial?function d(I,D){let L;I.diffuse.value.copy(D.color),I.opacity.value=D.opacity,I.rotation.value=D.rotation,D.map&&(I.map.value=D.map),D.alphaMap&&(I.alphaMap.value=D.alphaMap),D.alphaTest>0&&(I.alphaTest.value=D.alphaTest),D.map?L=D.map:D.alphaMap&&(L=D.alphaMap),void 0!==L&&(!0===L.matrixAutoUpdate&&L.updateMatrix(),I.uvTransform.value.copy(L.matrix))}(I,D):D.isShadowMaterial?(I.color.value.copy(D.color),I.opacity.value=D.opacity):D.isShaderMaterial&&(D.uniformsNeedUpdate=!1)}}}function rF(i={}){this.isWebGLRenderer=!0;const e=void 0!==i.canvas?i.canvas:function yW(){const i=HE("canvas");return i.style.display="block",i}(),t=void 0!==i.context?i.context:null,n=void 0===i.depth||i.depth,r=void 0===i.stencil||i.stencil,s=void 0!==i.antialias&&i.antialias,a=void 0===i.premultipliedAlpha||i.premultipliedAlpha,c=void 0!==i.preserveDrawingBuffer&&i.preserveDrawingBuffer,d=void 0!==i.powerPreference?i.powerPreference:"default",f=void 0!==i.failIfMajorPerformanceCaveat&&i.failIfMajorPerformanceCaveat;let g;g=null!==t?t.getContextAttributes().alpha:void 0!==i.alpha&&i.alpha;let v=null,b=null;const x=[],C=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Wy,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const I=this;let D=!1,L=0,V=0,z=null,U=-1,$=null;const Z=new Ur,ae=new Ur;let j=null,ie=e.width,we=e.height,Me=1,dt=null,Mt=null;const Se=new Ur(0,0,ie,we),it=new Ur(0,0,ie,we);let Ge=!1;const _t=new BR;let vt=!1,rt=!1,ht=null;const zt=new bi,At=new gt,ln=new Q,Mn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Bn(){return null===z?Me:1}let oi,di,tn,xi,xt,wt,Wt,Sn,dn,pi,Xn,$n,Rr,_r,se,J,Qe,Ft,jt,fn,ti,ee,Ct,ft=t;function Bi(ne,Ue){for(let ot=0;ot<ne.length;ot++){const Et=e.getContext(ne[ot],Ue);if(null!==Et)return Et}return null}try{const ne={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:f};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r141"),e.addEventListener("webglcontextlost",_e,!1),e.addEventListener("webglcontextrestored",Jt,!1),e.addEventListener("webglcontextcreationerror",$t,!1),null===ft){const Ue=["webgl2","webgl","experimental-webgl"];if(!0===I.isWebGL1Renderer&&Ue.shift(),ft=Bi(Ue,ne),null===ft)throw Bi(Ue)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ft.getShaderPrecisionFormat&&(ft.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ne){throw console.error("THREE.WebGLRenderer: "+ne.message),ne}function Yt(){oi=new D4(ft),di=new S4(ft,oi,i),oi.init(di),ee=new dW(ft,oi,di),tn=new cW(ft,oi,di),xi=new N4(ft),xt=new Xj,wt=new uW(ft,oi,tn,xt,di,ee,xi),Wt=new M4(I),Sn=new I4(I),dn=new Ez(ft,di),Ct=new x4(ft,oi,dn,di),pi=new R4(ft,dn,xi,Ct),Xn=new F4(ft,pi,dn,xi),jt=new k4(ft,di,wt),J=new T4(xt),$n=new Yj(I,Wt,Sn,oi,di,Ct,J),Rr=new gW(I,xt),_r=new Qj,se=new sW(oi,di),Ft=new b4(I,Wt,tn,Xn,g,a),Qe=new lW(I,Xn,di),fn=new E4(ft,oi,xi,di),ti=new P4(ft,oi,xi,di),xi.programs=$n.programs,I.capabilities=di,I.extensions=oi,I.properties=xt,I.renderLists=_r,I.shadowMap=Qe,I.state=tn,I.info=xi}Yt();const Xt=new mW(I,ft);function _e(ne){ne.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function Jt(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1;const ne=xi.autoReset,Ue=Qe.enabled,ot=Qe.autoUpdate,$e=Qe.needsUpdate,Et=Qe.type;Yt(),xi.autoReset=ne,Qe.enabled=Ue,Qe.autoUpdate=ot,Qe.needsUpdate=$e,Qe.type=Et}function $t(ne){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ne.statusMessage)}function Jn(ne){const Ue=ne.target;Ue.removeEventListener("dispose",Jn),function pn(ne){(function Hn(ne){const Ue=xt.get(ne).programs;void 0!==Ue&&(Ue.forEach(function(ot){$n.releaseProgram(ot)}),ne.isShaderMaterial&&$n.releaseShaderCache(ne))})(ne),xt.remove(ne)}(Ue)}this.xr=Xt,this.getContext=function(){return ft},this.getContextAttributes=function(){return ft.getContextAttributes()},this.forceContextLoss=function(){const ne=oi.get("WEBGL_lose_context");ne&&ne.loseContext()},this.forceContextRestore=function(){const ne=oi.get("WEBGL_lose_context");ne&&ne.restoreContext()},this.getPixelRatio=function(){return Me},this.setPixelRatio=function(ne){void 0!==ne&&(Me=ne,this.setSize(ie,we,!1))},this.getSize=function(ne){return ne.set(ie,we)},this.setSize=function(ne,Ue,ot){Xt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ie=ne,we=Ue,e.width=Math.floor(ne*Me),e.height=Math.floor(Ue*Me),!1!==ot&&(e.style.width=ne+"px",e.style.height=Ue+"px"),this.setViewport(0,0,ne,Ue))},this.getDrawingBufferSize=function(ne){return ne.set(ie*Me,we*Me).floor()},this.setDrawingBufferSize=function(ne,Ue,ot){ie=ne,we=Ue,Me=ot,e.width=Math.floor(ne*ot),e.height=Math.floor(Ue*ot),this.setViewport(0,0,ne,Ue)},this.getCurrentViewport=function(ne){return ne.copy(Z)},this.getViewport=function(ne){return ne.copy(Se)},this.setViewport=function(ne,Ue,ot,$e){ne.isVector4?Se.set(ne.x,ne.y,ne.z,ne.w):Se.set(ne,Ue,ot,$e),tn.viewport(Z.copy(Se).multiplyScalar(Me).floor())},this.getScissor=function(ne){return ne.copy(it)},this.setScissor=function(ne,Ue,ot,$e){ne.isVector4?it.set(ne.x,ne.y,ne.z,ne.w):it.set(ne,Ue,ot,$e),tn.scissor(ae.copy(it).multiplyScalar(Me).floor())},this.getScissorTest=function(){return Ge},this.setScissorTest=function(ne){tn.setScissorTest(Ge=ne)},this.setOpaqueSort=function(ne){dt=ne},this.setTransparentSort=function(ne){Mt=ne},this.getClearColor=function(ne){return ne.copy(Ft.getClearColor())},this.setClearColor=function(){Ft.setClearColor.apply(Ft,arguments)},this.getClearAlpha=function(){return Ft.getClearAlpha()},this.setClearAlpha=function(){Ft.setClearAlpha.apply(Ft,arguments)},this.clear=function(ne=!0,Ue=!0,ot=!0){let $e=0;ne&&($e|=16384),Ue&&($e|=256),ot&&($e|=1024),ft.clear($e)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",_e,!1),e.removeEventListener("webglcontextrestored",Jt,!1),e.removeEventListener("webglcontextcreationerror",$t,!1),_r.dispose(),se.dispose(),xt.dispose(),Wt.dispose(),Sn.dispose(),Xn.dispose(),Ct.dispose(),$n.dispose(),Xt.dispose(),Xt.removeEventListener("sessionstart",Mr),Xt.removeEventListener("sessionend",Cr),ht&&(ht.dispose(),ht=null),Nl.stop()},this.renderBufferDirect=function(ne,Ue,ot,$e,Et,hi){null===Ue&&(Ue=Mn);const Ei=Et.isMesh&&Et.matrixWorld.determinant()<0,ki=function U$(ne,Ue,ot,$e,Et){!0!==Ue.isScene&&(Ue=Mn),wt.resetTextureUnits();const hi=Ue.fog,ki=null===z?I.outputEncoding:!0===z.isXRRenderTarget?z.texture.encoding:Wy,Di=($e.isMeshStandardMaterial?Sn:Wt).get($e.envMap||($e.isMeshStandardMaterial?Ue.environment:null)),Ar=!0===$e.vertexColors&&!!ot.attributes.color&&4===ot.attributes.color.itemSize,tr=!!$e.normalMap&&!!ot.attributes.tangent,or=!!ot.morphAttributes.position,Zs=!!ot.morphAttributes.normal,y_=!!ot.morphAttributes.color,_w=$e.toneMapped?I.toneMapping:0,vw=ot.morphAttributes.position||ot.morphAttributes.normal||ot.morphAttributes.color,Mh=void 0!==vw?vw.length:0,vr=xt.get($e),ww=b.state.lights;!0!==vt||!0!==rt&&ne===$||J.setState($e,ne,ne===$&&$e.id===U);let Oo=!1;$e.version===vr.__version?(vr.needsLights&&vr.lightsStateVersion!==ww.state.version||vr.outputEncoding!==ki||Et.isInstancedMesh&&!1===vr.instancing||!Et.isInstancedMesh&&!0===vr.instancing||Et.isSkinnedMesh&&!1===vr.skinning||!Et.isSkinnedMesh&&!0===vr.skinning||vr.envMap!==Di||!0===$e.fog&&vr.fog!==hi||void 0!==vr.numClippingPlanes&&(vr.numClippingPlanes!==J.numPlanes||vr.numIntersection!==J.numIntersection)||vr.vertexAlphas!==Ar||vr.vertexTangents!==tr||vr.morphTargets!==or||vr.morphNormals!==Zs||vr.morphColors!==y_||vr.toneMapping!==_w||!0===di.isWebGL2&&vr.morphTargetsCount!==Mh)&&(Oo=!0):(Oo=!0,vr.__version=$e.version);let Ch=vr.currentProgram;!0===Oo&&(Ch=XP($e,Ue,Et));let zm=!1,bS=!1,JP=!1;const Ol=Ch.getUniforms(),xS=vr.uniforms;if(tn.useProgram(Ch.program)&&(zm=!0,bS=!0,JP=!0),$e.id!==U&&(U=$e.id,bS=!0),zm||$!==ne){if(Ol.setValue(ft,"projectionMatrix",ne.projectionMatrix),di.logarithmicDepthBuffer&&Ol.setValue(ft,"logDepthBufFC",2/(Math.log(ne.far+1)/Math.LN2)),$!==ne&&($=ne,bS=!0,JP=!0),$e.isShaderMaterial||$e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshStandardMaterial||$e.envMap){const Ah=Ol.map.cameraPosition;void 0!==Ah&&Ah.setValue(ft,ln.setFromMatrixPosition(ne.matrixWorld))}($e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshLambertMaterial||$e.isMeshBasicMaterial||$e.isMeshStandardMaterial||$e.isShaderMaterial)&&Ol.setValue(ft,"isOrthographic",!0===ne.isOrthographicCamera),($e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshLambertMaterial||$e.isMeshBasicMaterial||$e.isMeshStandardMaterial||$e.isShaderMaterial||$e.isShadowMaterial||Et.isSkinnedMesh)&&Ol.setValue(ft,"viewMatrix",ne.matrixWorldInverse)}if(Et.isSkinnedMesh){Ol.setOptional(ft,Et,"bindMatrix"),Ol.setOptional(ft,Et,"bindMatrixInverse");const Ah=Et.skeleton;Ah&&(di.floatVertexTextures?(null===Ah.boneTexture&&Ah.computeBoneTexture(),Ol.setValue(ft,"boneTexture",Ah.boneTexture,wt),Ol.setValue(ft,"boneTextureSize",Ah.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const QP=ot.morphAttributes;return(void 0!==QP.position||void 0!==QP.normal||void 0!==QP.color&&!0===di.isWebGL2)&&jt.update(Et,ot,$e,Ch),(bS||vr.receiveShadow!==Et.receiveShadow)&&(vr.receiveShadow=Et.receiveShadow,Ol.setValue(ft,"receiveShadow",Et.receiveShadow)),bS&&(Ol.setValue(ft,"toneMappingExposure",I.toneMappingExposure),vr.needsLights&&function B$(ne,Ue){ne.ambientLightColor.needsUpdate=Ue,ne.lightProbe.needsUpdate=Ue,ne.directionalLights.needsUpdate=Ue,ne.directionalLightShadows.needsUpdate=Ue,ne.pointLights.needsUpdate=Ue,ne.pointLightShadows.needsUpdate=Ue,ne.spotLights.needsUpdate=Ue,ne.spotLightShadows.needsUpdate=Ue,ne.rectAreaLights.needsUpdate=Ue,ne.hemisphereLights.needsUpdate=Ue}(xS,JP),hi&&!0===$e.fog&&Rr.refreshFogUniforms(xS,hi),Rr.refreshMaterialUniforms(xS,$e,Me,we,ht),aA.upload(ft,vr.uniformsList,xS,wt)),$e.isShaderMaterial&&!0===$e.uniformsNeedUpdate&&(aA.upload(ft,vr.uniformsList,xS,wt),$e.uniformsNeedUpdate=!1),$e.isSpriteMaterial&&Ol.setValue(ft,"center",Et.center),Ol.setValue(ft,"modelViewMatrix",Et.modelViewMatrix),Ol.setValue(ft,"normalMatrix",Et.normalMatrix),Ol.setValue(ft,"modelMatrix",Et.matrixWorld),Ch}(ne,Ue,ot,$e,Et);tn.setMaterial($e,Ei);let Di=ot.index;const Ar=ot.attributes.position;if(null===Di){if(void 0===Ar||0===Ar.count)return}else if(0===Di.count)return;let tr=1;!0===$e.wireframe&&(Di=pi.getWireframeAttribute(ot),tr=2),Ct.setup(Et,$e,ki,ot,Di);let or,Zs=fn;null!==Di&&(or=dn.get(Di),Zs=ti,Zs.setIndex(or));const y_=null!==Di?Di.count:Ar.count,_w=ot.drawRange.start*tr,vw=ot.drawRange.count*tr,Mh=null!==hi?hi.start*tr:0,vr=null!==hi?hi.count*tr:1/0,ww=Math.max(_w,Mh),Oo=Math.min(y_,_w+vw,Mh+vr)-1,Ch=Math.max(0,Oo-ww+1);if(0!==Ch){if(Et.isMesh)!0===$e.wireframe?(tn.setLineWidth($e.wireframeLinewidth*Bn()),Zs.setMode(1)):Zs.setMode(4);else if(Et.isLine){let zm=$e.linewidth;void 0===zm&&(zm=1),tn.setLineWidth(zm*Bn()),Zs.setMode(Et.isLineSegments?1:Et.isLineLoop?2:3)}else Et.isPoints?Zs.setMode(0):Et.isSprite&&Zs.setMode(4);if(Et.isInstancedMesh)Zs.renderInstances(ww,Ch,Et.count);else if(ot.isInstancedBufferGeometry){const zm=Math.min(ot.instanceCount,ot._maxInstanceCount);Zs.renderInstances(ww,Ch,zm)}else Zs.render(ww,Ch)}},this.compile=function(ne,Ue){b=se.get(ne),b.init(),C.push(b),ne.traverseVisible(function(ot){ot.isLight&&ot.layers.test(Ue.layers)&&(b.pushLight(ot),ot.castShadow&&b.pushShadow(ot))}),b.setupLights(I.physicallyCorrectLights),ne.traverse(function(ot){const $e=ot.material;if($e)if(Array.isArray($e))for(let Et=0;Et<$e.length;Et++)XP($e[Et],ne,ot);else XP($e,ne,ot)}),C.pop(),b=null};let Qt=null;function Mr(){Nl.stop()}function Cr(){Nl.start()}const Nl=new Ak;function Th(ne,Ue,ot,$e){if(!1===ne.visible)return;if(ne.layers.test(Ue.layers))if(ne.isGroup)ot=ne.renderOrder;else if(ne.isLOD)!0===ne.autoUpdate&&ne.update(Ue);else if(ne.isLight)b.pushLight(ne),ne.castShadow&&b.pushShadow(ne);else if(ne.isSprite){if(!ne.frustumCulled||_t.intersectsSprite(ne)){$e&&ln.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(zt);const Ei=Xn.update(ne),ki=ne.material;ki.visible&&v.push(ne,Ei,ki,ot,ln.z,null)}}else if((ne.isMesh||ne.isLine||ne.isPoints)&&(ne.isSkinnedMesh&&ne.skeleton.frame!==xi.render.frame&&(ne.skeleton.update(),ne.skeleton.frame=xi.render.frame),!ne.frustumCulled||_t.intersectsObject(ne))){$e&&ln.setFromMatrixPosition(ne.matrixWorld).applyMatrix4(zt);const Ei=Xn.update(ne),ki=ne.material;if(Array.isArray(ki)){const Di=Ei.groups;for(let Ar=0,tr=Di.length;Ar<tr;Ar++){const or=Di[Ar],Zs=ki[or.materialIndex];Zs&&Zs.visible&&v.push(ne,Ei,Zs,ot,ln.z,or)}}else ki.visible&&v.push(ne,Ei,ki,ot,ln.z,null)}const hi=ne.children;for(let Ei=0,ki=hi.length;Ei<ki;Ei++)Th(hi[Ei],Ue,ot,$e)}function U3(ne,Ue,ot,$e){const Et=ne.opaque,hi=ne.transmissive,Ei=ne.transparent;b.setupLightsView(ot),hi.length>0&&function F$(ne,Ue,ot){const $e=di.isWebGL2;null===ht&&(ht=new Tm(1,1,{generateMipmaps:!0,type:oi.has("EXT_color_buffer_half_float")?FE:zy,minFilter:Em,samples:$e&&!0===s?4:0})),I.getDrawingBufferSize(At),$e?ht.setSize(At.x,At.y):ht.setSize(LC(At.x),LC(At.y));const Et=I.getRenderTarget();I.setRenderTarget(ht),I.clear();const hi=I.toneMapping;I.toneMapping=0,nI(ne,Ue,ot),I.toneMapping=hi,wt.updateMultisampleRenderTarget(ht),wt.updateRenderTargetMipmap(ht),I.setRenderTarget(Et)}(Et,Ue,ot),$e&&tn.viewport(Z.copy($e)),Et.length>0&&nI(Et,Ue,ot),hi.length>0&&nI(hi,Ue,ot),Ei.length>0&&nI(Ei,Ue,ot),tn.buffers.depth.setTest(!0),tn.buffers.depth.setMask(!0),tn.buffers.color.setMask(!0),tn.setPolygonOffset(!1)}function nI(ne,Ue,ot){const $e=!0===Ue.isScene?Ue.overrideMaterial:null;for(let Et=0,hi=ne.length;Et<hi;Et++){const Ei=ne[Et],ki=Ei.object,Di=Ei.geometry,Ar=null===$e?Ei.material:$e,tr=Ei.group;ki.layers.test(ot.layers)&&V$(ki,Ue,ot,Di,Ar,tr)}}function V$(ne,Ue,ot,$e,Et,hi){ne.onBeforeRender(I,Ue,ot,$e,Et,hi),ne.modelViewMatrix.multiplyMatrices(ot.matrixWorldInverse,ne.matrixWorld),ne.normalMatrix.getNormalMatrix(ne.modelViewMatrix),Et.onBeforeRender(I,Ue,ot,$e,ne,hi),!0===Et.transparent&&2===Et.side?(Et.side=1,Et.needsUpdate=!0,I.renderBufferDirect(ot,Ue,$e,Et,ne,hi),Et.side=0,Et.needsUpdate=!0,I.renderBufferDirect(ot,Ue,$e,Et,ne,hi),Et.side=2):I.renderBufferDirect(ot,Ue,$e,Et,ne,hi),ne.onAfterRender(I,Ue,ot,$e,Et,hi)}function XP(ne,Ue,ot){!0!==Ue.isScene&&(Ue=Mn);const $e=xt.get(ne),Et=b.state.lights,Ei=Et.state.version,ki=$n.getParameters(ne,Et.state,b.state.shadowsArray,Ue,ot),Di=$n.getProgramCacheKey(ki);let Ar=$e.programs;$e.environment=ne.isMeshStandardMaterial?Ue.environment:null,$e.fog=Ue.fog,$e.envMap=(ne.isMeshStandardMaterial?Sn:Wt).get(ne.envMap||$e.environment),void 0===Ar&&(ne.addEventListener("dispose",Jn),Ar=new Map,$e.programs=Ar);let tr=Ar.get(Di);if(void 0!==tr){if($e.currentProgram===tr&&$e.lightsStateVersion===Ei)return B3(ne,ki),tr}else ki.uniforms=$n.getUniforms(ne),ne.onBuild(ot,ki,I),ne.onBeforeCompile(ki,I),tr=$n.acquireProgram(ki,Di),Ar.set(Di,tr),$e.uniforms=ki.uniforms;const or=$e.uniforms;(!ne.isShaderMaterial&&!ne.isRawShaderMaterial||!0===ne.clipping)&&(or.clippingPlanes=J.uniform),B3(ne,ki),$e.needsLights=function H$(ne){return ne.isMeshLambertMaterial||ne.isMeshToonMaterial||ne.isMeshPhongMaterial||ne.isMeshStandardMaterial||ne.isShadowMaterial||ne.isShaderMaterial&&!0===ne.lights}(ne),$e.lightsStateVersion=Ei,$e.needsLights&&(or.ambientLightColor.value=Et.state.ambient,or.lightProbe.value=Et.state.probe,or.directionalLights.value=Et.state.directional,or.directionalLightShadows.value=Et.state.directionalShadow,or.spotLights.value=Et.state.spot,or.spotLightShadows.value=Et.state.spotShadow,or.rectAreaLights.value=Et.state.rectArea,or.ltc_1.value=Et.state.rectAreaLTC1,or.ltc_2.value=Et.state.rectAreaLTC2,or.pointLights.value=Et.state.point,or.pointLightShadows.value=Et.state.pointShadow,or.hemisphereLights.value=Et.state.hemi,or.directionalShadowMap.value=Et.state.directionalShadowMap,or.directionalShadowMatrix.value=Et.state.directionalShadowMatrix,or.spotShadowMap.value=Et.state.spotShadowMap,or.spotShadowMatrix.value=Et.state.spotShadowMatrix,or.pointShadowMap.value=Et.state.pointShadowMap,or.pointShadowMatrix.value=Et.state.pointShadowMatrix);const Zs=tr.getUniforms(),y_=aA.seqWithValue(Zs.seq,or);return $e.currentProgram=tr,$e.uniformsList=y_,tr}function B3(ne,Ue){const ot=xt.get(ne);ot.outputEncoding=Ue.outputEncoding,ot.instancing=Ue.instancing,ot.skinning=Ue.skinning,ot.morphTargets=Ue.morphTargets,ot.morphNormals=Ue.morphNormals,ot.morphColors=Ue.morphColors,ot.morphTargetsCount=Ue.morphTargetsCount,ot.numClippingPlanes=Ue.numClippingPlanes,ot.numIntersection=Ue.numClipIntersection,ot.vertexAlphas=Ue.vertexAlphas,ot.vertexTangents=Ue.vertexTangents,ot.toneMapping=Ue.toneMapping}Nl.setAnimationLoop(function mi(ne){Qt&&Qt(ne)}),"undefined"!=typeof self&&Nl.setContext(self),this.setAnimationLoop=function(ne){Qt=ne,Xt.setAnimationLoop(ne),null===ne?Nl.stop():Nl.start()},Xt.addEventListener("sessionstart",Mr),Xt.addEventListener("sessionend",Cr),this.render=function(ne,Ue){if(void 0===Ue||!0===Ue.isCamera){if(!0!==D){if(!0===ne.autoUpdate&&ne.updateMatrixWorld(),null===Ue.parent&&Ue.updateMatrixWorld(),!0===Xt.enabled&&!0===Xt.isPresenting&&(!0===Xt.cameraAutoUpdate&&Xt.updateCamera(Ue),Ue=Xt.getCamera()),!0===ne.isScene&&ne.onBeforeRender(I,ne,Ue,z),b=se.get(ne,C.length),b.init(),C.push(b),zt.multiplyMatrices(Ue.projectionMatrix,Ue.matrixWorldInverse),_t.setFromProjectionMatrix(zt),rt=this.localClippingEnabled,vt=J.init(this.clippingPlanes,rt,Ue),v=_r.get(ne,x.length),v.init(),x.push(v),Th(ne,Ue,0,I.sortObjects),v.finish(),!0===I.sortObjects&&v.sort(dt,Mt),!0===vt&&J.beginShadows(),Qe.render(b.state.shadowsArray,ne,Ue),!0===vt&&J.endShadows(),!0===this.info.autoReset&&this.info.reset(),Ft.render(v,ne),b.setupLights(I.physicallyCorrectLights),Ue.isArrayCamera){const $e=Ue.cameras;for(let Et=0,hi=$e.length;Et<hi;Et++){const Ei=$e[Et];U3(v,ne,Ei,Ei.viewport)}}else U3(v,ne,Ue);null!==z&&(wt.updateMultisampleRenderTarget(z),wt.updateRenderTargetMipmap(z)),!0===ne.isScene&&ne.onAfterRender(I,ne,Ue),Ct.resetDefaultState(),U=-1,$=null,C.pop(),b=C.length>0?C[C.length-1]:null,x.pop(),v=x.length>0?x[x.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return L},this.getActiveMipmapLevel=function(){return V},this.getRenderTarget=function(){return z},this.setRenderTargetTextures=function(ne,Ue,ot){xt.get(ne.texture).__webglTexture=Ue,xt.get(ne.depthTexture).__webglTexture=ot;const $e=xt.get(ne);$e.__hasExternalTextures=!0,$e.__hasExternalTextures&&($e.__autoAllocateDepthBuffer=void 0===ot,$e.__autoAllocateDepthBuffer||!0===oi.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),$e.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ne,Ue){const ot=xt.get(ne);ot.__webglFramebuffer=Ue,ot.__useDefaultFramebuffer=void 0===Ue},this.setRenderTarget=function(ne,Ue=0,ot=0){z=ne,L=Ue,V=ot;let $e=!0;if(ne){const Di=xt.get(ne);void 0!==Di.__useDefaultFramebuffer?(tn.bindFramebuffer(36160,null),$e=!1):void 0===Di.__webglFramebuffer?wt.setupRenderTarget(ne):Di.__hasExternalTextures&&wt.rebindTextures(ne,xt.get(ne.texture).__webglTexture,xt.get(ne.depthTexture).__webglTexture)}let Et=null,hi=!1,Ei=!1;if(ne){const Di=ne.texture;(Di.isData3DTexture||Di.isDataArrayTexture)&&(Ei=!0);const Ar=xt.get(ne).__webglFramebuffer;ne.isWebGLCubeRenderTarget?(Et=Ar[Ue],hi=!0):Et=di.isWebGL2&&ne.samples>0&&!1===wt.useMultisampledRTT(ne)?xt.get(ne).__webglMultisampledFramebuffer:Ar,Z.copy(ne.viewport),ae.copy(ne.scissor),j=ne.scissorTest}else Z.copy(Se).multiplyScalar(Me).floor(),ae.copy(it).multiplyScalar(Me).floor(),j=Ge;if(tn.bindFramebuffer(36160,Et)&&di.drawBuffers&&$e&&tn.drawBuffers(ne,Et),tn.viewport(Z),tn.scissor(ae),tn.setScissorTest(j),hi){const Di=xt.get(ne.texture);ft.framebufferTexture2D(36160,36064,34069+Ue,Di.__webglTexture,ot)}else if(Ei){const Di=xt.get(ne.texture);ft.framebufferTextureLayer(36160,36064,Di.__webglTexture,ot||0,Ue||0)}U=-1},this.readRenderTargetPixels=function(ne,Ue,ot,$e,Et,hi,Ei){if(!ne||!ne.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ki=xt.get(ne).__webglFramebuffer;if(ne.isWebGLCubeRenderTarget&&void 0!==Ei&&(ki=ki[Ei]),ki){tn.bindFramebuffer(36160,ki);try{const Di=ne.texture,Ar=Di.format,tr=Di.type;if(Ar!==Nu&&ee.convert(Ar)!==ft.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const or=tr===FE&&(oi.has("EXT_color_buffer_half_float")||di.isWebGL2&&oi.has("EXT_color_buffer_float"));if(!(tr===zy||ee.convert(tr)===ft.getParameter(35738)||tr===Sm&&(di.isWebGL2||oi.has("OES_texture_float")||oi.has("WEBGL_color_buffer_float"))||or))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Ue>=0&&Ue<=ne.width-$e&&ot>=0&&ot<=ne.height-Et&&ft.readPixels(Ue,ot,$e,Et,ee.convert(Ar),ee.convert(tr),hi)}finally{const Di=null!==z?xt.get(z).__webglFramebuffer:null;tn.bindFramebuffer(36160,Di)}}},this.copyFramebufferToTexture=function(ne,Ue,ot=0){const $e=Math.pow(2,-ot),Et=Math.floor(Ue.image.width*$e),hi=Math.floor(Ue.image.height*$e);wt.setTexture2D(Ue,0),ft.copyTexSubImage2D(3553,ot,0,0,ne.x,ne.y,Et,hi),tn.unbindTexture()},this.copyTextureToTexture=function(ne,Ue,ot,$e=0){const Et=Ue.image.width,hi=Ue.image.height,Ei=ee.convert(ot.format),ki=ee.convert(ot.type);wt.setTexture2D(ot,0),ft.pixelStorei(37440,ot.flipY),ft.pixelStorei(37441,ot.premultiplyAlpha),ft.pixelStorei(3317,ot.unpackAlignment),Ue.isDataTexture?ft.texSubImage2D(3553,$e,ne.x,ne.y,Et,hi,Ei,ki,Ue.image.data):Ue.isCompressedTexture?ft.compressedTexSubImage2D(3553,$e,ne.x,ne.y,Ue.mipmaps[0].width,Ue.mipmaps[0].height,Ei,Ue.mipmaps[0].data):ft.texSubImage2D(3553,$e,ne.x,ne.y,Ei,ki,Ue.image),0===$e&&ot.generateMipmaps&&ft.generateMipmap(3553),tn.unbindTexture()},this.copyTextureToTexture3D=function(ne,Ue,ot,$e,Et=0){if(I.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const hi=ne.max.x-ne.min.x+1,Ei=ne.max.y-ne.min.y+1,ki=ne.max.z-ne.min.z+1,Di=ee.convert($e.format),Ar=ee.convert($e.type);let tr;if($e.isData3DTexture)wt.setTexture3D($e,0),tr=32879;else{if(!$e.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");wt.setTexture2DArray($e,0),tr=35866}ft.pixelStorei(37440,$e.flipY),ft.pixelStorei(37441,$e.premultiplyAlpha),ft.pixelStorei(3317,$e.unpackAlignment);const or=ft.getParameter(3314),Zs=ft.getParameter(32878),y_=ft.getParameter(3316),_w=ft.getParameter(3315),vw=ft.getParameter(32877),Mh=ot.isCompressedTexture?ot.mipmaps[0]:ot.image;ft.pixelStorei(3314,Mh.width),ft.pixelStorei(32878,Mh.height),ft.pixelStorei(3316,ne.min.x),ft.pixelStorei(3315,ne.min.y),ft.pixelStorei(32877,ne.min.z),ot.isDataTexture||ot.isData3DTexture?ft.texSubImage3D(tr,Et,Ue.x,Ue.y,Ue.z,hi,Ei,ki,Di,Ar,Mh.data):ot.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ft.compressedTexSubImage3D(tr,Et,Ue.x,Ue.y,Ue.z,hi,Ei,ki,Di,Mh.data)):ft.texSubImage3D(tr,Et,Ue.x,Ue.y,Ue.z,hi,Ei,ki,Di,Ar,Mh),ft.pixelStorei(3314,or),ft.pixelStorei(32878,Zs),ft.pixelStorei(3316,y_),ft.pixelStorei(3315,_w),ft.pixelStorei(32877,vw),0===Et&&$e.generateMipmaps&&ft.generateMipmap(tr),tn.unbindTexture()},this.initTexture=function(ne){wt.setTexture2D(ne,0),tn.unbindTexture()},this.resetState=function(){L=0,V=0,z=null,tn.reset(),Ct.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class _W extends rF{}).prototype.isWebGL1Renderer=!0;class sF extends qs{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}class YR{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Zc()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Zc()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Zc()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Dl=new Q;class o_{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Dl.fromBufferAttribute(this,t),Dl.applyMatrix4(e),this.setXYZ(t,Dl.x,Dl.y,Dl.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Dl.fromBufferAttribute(this,t),Dl.applyNormalMatrix(e),this.setXYZ(t,Dl.x,Dl.y,Dl.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Dl.fromBufferAttribute(this,t),Dl.transformDirection(e),this.setXYZ(t,Dl.x,Dl.y,Dl.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,n){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return this.data.array[(e=e*this.data.stride+this.offset)+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new No(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new o_(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const dF=new Q,hF=new Ur,fF=new Ur,bW=new Q,pF=new bi;class mF extends Cl{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new bi,this.bindMatrixInverse=new bi}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Ur,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const n=this.skeleton,r=this.geometry;hF.fromBufferAttribute(r.attributes.skinIndex,e),fF.fromBufferAttribute(r.attributes.skinWeight,e),dF.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=fF.getComponent(s);if(0!==a){const c=hF.getComponent(s);pF.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(bW.copy(dF).applyMatrix4(pF),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class JR extends qs{constructor(){super(),this.isBone=!0,this.type="Bone"}}class YE extends bd{constructor(e=null,t=1,n=1,r,s,a,c,d,f=Do,g=Do,v,b){super(null,a,c,d,f,g,r,s,v,b),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const gF=new bi,xW=new bi;class hA{constructor(e=[],t=[]){this.uuid=Zc(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new bi)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new bi;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++)gF.multiplyMatrices(e[s]?e[s].matrixWorld:xW,t[s]),gF.toArray(n,16*s);null!==r&&(r.needsUpdate=!0)}clone(){return new hA(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=uk(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new YE(t,e,e,Nu,Sm);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let a=t[s];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new JR),this.bones.push(a),this.boneInverses.push((new bi).fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++)e.bones.push(t[r].uuid),e.boneInverses.push(n[r].toArray());return e}}class Rl extends Ro{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new rn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const vF=new Q,wF=new Q,bF=new bi,QR=new jC,pA=new t_;class a_ extends qs{constructor(e=new Li,t=new Rl){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)vF.fromBufferAttribute(t,r-1),wF.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=vF.distanceTo(wF);e.setAttribute("lineDistance",new Dn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),pA.copy(n.boundingSphere),pA.applyMatrix4(r),pA.radius+=s,!1===e.ray.intersectsSphere(pA))return;bF.copy(r).invert(),QR.copy(e.ray).applyMatrix4(bF);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,f=new Q,g=new Q,v=new Q,b=new Q,x=this.isLineSegments?2:1,C=n.index,D=n.attributes.position;if(null!==C)for(let z=Math.max(0,a.start),U=Math.min(C.count,a.start+a.count)-1;z<U;z+=x){const $=C.getX(z),Z=C.getX(z+1);if(f.fromBufferAttribute(D,$),g.fromBufferAttribute(D,Z),QR.distanceSqToSegment(f,g,b,v)>d)continue;b.applyMatrix4(this.matrixWorld);const j=e.ray.origin.distanceTo(b);j<e.near||j>e.far||t.push({distance:j,point:v.clone().applyMatrix4(this.matrixWorld),index:z,face:null,faceIndex:null,object:this})}else for(let z=Math.max(0,a.start),U=Math.min(D.count,a.start+a.count)-1;z<U;z+=x){if(f.fromBufferAttribute(D,z),g.fromBufferAttribute(D,z+1),QR.distanceSqToSegment(f,g,b,v)>d)continue;b.applyMatrix4(this.matrixWorld);const Z=e.ray.origin.distanceTo(b);Z<e.near||Z>e.far||t.push({distance:Z,point:v.clone().applyMatrix4(this.matrixWorld),index:z,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}}const xF=new Q,EF=new Q;class eP extends a_{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)xF.fromBufferAttribute(t,r),EF.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+xF.distanceTo(EF);e.setAttribute("lineDistance",new Dn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class SF extends a_{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class tP extends Ro{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new rn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const TF=new bi,nP=new jC,mA=new t_,gA=new Q;class MF extends qs{constructor(e=new Li,t=new tP){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),mA.copy(n.boundingSphere),mA.applyMatrix4(r),mA.radius+=s,!1===e.ray.intersectsSphere(mA))return;TF.copy(r).invert(),nP.copy(e.ray).applyMatrix4(TF);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,f=n.index,v=n.attributes.position;if(null!==f)for(let C=Math.max(0,a.start),I=Math.min(f.count,a.start+a.count);C<I;C++){const D=f.getX(C);gA.fromBufferAttribute(v,D),CF(gA,D,d,r,e,t,this)}else for(let C=Math.max(0,a.start),I=Math.min(v.count,a.start+a.count);C<I;C++)gA.fromBufferAttribute(v,C),CF(gA,C,d,r,e,t,this)}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}}function CF(i,e,t,n,r,s,a){const c=nP.distanceSqToPoint(i);if(c<t){const d=new Q;nP.closestPointToPoint(i,d),d.applyMatrix4(n);const f=r.ray.origin.distanceTo(d);if(f<r.near||f>r.far)return;s.push({distance:f,distanceToRay:Math.sqrt(c),point:d,index:e,face:null,object:a})}}function rP(){let i=0,e=0,t=0,n=0;function r(s,a,c,d){i=s,e=c,t=-3*s+3*a-2*c-d,n=2*s-2*a+c+d}return{initCatmullRom:function(s,a,c,d,f){r(a,c,f*(c-s),f*(d-a))},initNonuniformCatmullRom:function(s,a,c,d,f,g,v){let b=(a-s)/f-(c-s)/(f+g)+(c-a)/g,x=(c-a)/g-(d-a)/(g+v)+(d-c)/v;b*=g,x*=g,r(a,c,b,x)},calc:function(s){const a=s*s;return i+e*s+t*a+n*(a*s)}}}new Q,new rP,new rP,new rP,new Q,new Q,new Q,new Sd;class aS extends Ro{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new rn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new rn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class km extends aS{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new gt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ho(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new rn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new rn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new rn(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}const f5={ShadowMaterial:class s5 extends Ro{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new rn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}},SpriteMaterial:class oF extends Ro{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new rn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},RawShaderMaterial:class o5 extends qf{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}},ShaderMaterial:qf,PointsMaterial:tP,MeshPhysicalMaterial:km,MeshStandardMaterial:aS,MeshPhongMaterial:class a5 extends Ro{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new rn(16777215),this.specular=new rn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new rn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},MeshToonMaterial:class l5 extends Ro{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new rn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new rn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},MeshNormalMaterial:class c5 extends Ro{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},MeshLambertMaterial:class u5 extends Ro{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new rn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new rn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},MeshDepthMaterial:nF,MeshDistanceMaterial:iF,MeshBasicMaterial:Ou,MeshMatcapMaterial:class d5 extends Ro{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new rn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}},LineDashedMaterial:class h5 extends Rl{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}},LineBasicMaterial:Rl,Material:Ro};Ro.fromType=function(i){return new f5[i]};const bs={arraySlice:function(i,e,t){return bs.isTypedArray(i)?new i.constructor(i.subarray(e,void 0!==t?t:i.length)):i.slice(e,t)},convertArray:function(i,e,t){return!i||!t&&i.constructor===e?i:"number"==typeof e.BYTES_PER_ELEMENT?new e(i):Array.prototype.slice.call(i)},isTypedArray:function(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)},getKeyframeOrder:function(i){const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(function e(r,s){return i[r]-i[s]}),n},sortedArray:function(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,a=0;a!==n;++s){const c=t[s]*e;for(let d=0;d!==e;++d)r[a++]=i[c+d]}return r},flattenJSON:function(i,e,t,n){let r=1,s=i[0];for(;void 0!==s&&void 0===s[n];)s=i[r++];if(void 0===s)return;let a=s[n];if(void 0!==a)if(Array.isArray(a))do{a=s[n],void 0!==a&&(e.push(s.time),t.push.apply(t,a)),s=i[r++]}while(void 0!==s);else if(void 0!==a.toArray)do{a=s[n],void 0!==a&&(e.push(s.time),a.toArray(t,t.length)),s=i[r++]}while(void 0!==s);else do{a=s[n],void 0!==a&&(e.push(s.time),t.push(a)),s=i[r++]}while(void 0!==s)},subclip:function(i,e,t,n,r=30){const s=i.clone();s.name=e;const a=[];for(let d=0;d<s.tracks.length;++d){const f=s.tracks[d],g=f.getValueSize(),v=[],b=[];for(let x=0;x<f.times.length;++x){const C=f.times[x]*r;if(!(C<t||C>=n)){v.push(f.times[x]);for(let I=0;I<g;++I)b.push(f.values[x*g+I])}}0!==v.length&&(f.times=bs.convertArray(v,f.times.constructor),f.values=bs.convertArray(b,f.values.constructor),a.push(f))}s.tracks=a;let c=1/0;for(let d=0;d<s.tracks.length;++d)c>s.tracks[d].times[0]&&(c=s.tracks[d].times[0]);for(let d=0;d<s.tracks.length;++d)s.tracks[d].shift(-1*c);return s.resetDuration(),s},makeClipAdditive:function(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let a=0;a<r;++a){const c=t.tracks[a],d=c.ValueTypeName;if("bool"===d||"string"===d)continue;const f=i.tracks.find(function(L){return L.name===c.name&&L.ValueTypeName===d});if(void 0===f)continue;let g=0;const v=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=v/3);let b=0;const x=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(b=x/3);const C=c.times.length-1;let I;if(s<=c.times[0])I=bs.arraySlice(c.values,g,v-g);else if(s>=c.times[C]){const L=C*v+g;I=bs.arraySlice(c.values,L,L+v-g)}else{const L=c.createInterpolant(),V=g,z=v-g;L.evaluate(s),I=bs.arraySlice(L.resultBuffer,V,z)}"quaternion"===d&&(new Ya).fromArray(I).normalize().conjugate().toArray(I);const D=f.times.length;for(let L=0;L<D;++L){const V=L*x+b;if("quaternion"===d)Ya.multiplyQuaternionsFlat(f.values,V,I,0,f.values,V);else{const z=x-2*b;for(let U=0;U<z;++U)f.values[V+U]-=I[U]}}}return i.blendMode=2501,i}};class lS{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let a;n:{i:if(!(e<r)){for(let c=n+2;;){if(void 0===r){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(s=r,r=t[++n],e<r)break t}a=t.length;break n}if(e>=s)break e;{const c=t[1];e<c&&(n=2,s=c);for(let d=n-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(r=s,s=t[--n-1],e>=s)break t}a=n,n=0}}for(;n<a;){const c=n+a>>>1;e<t[c]?a=c:n=c+1}if(r=t[n],s=t[n-1],void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)t[a]=n[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class p5 extends lS{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,a=e+1,c=r[s],d=r[a];if(void 0===c)switch(this.getSettings_().endingStart){case 2401:s=e,c=2*t-n;break;case 2402:s=r.length-2,c=t+r[s]-r[s+1];break;default:s=e,c=n}if(void 0===d)switch(this.getSettings_().endingEnd){case 2401:a=e,d=2*n-t;break;case 2402:a=1,d=n+r[1]-r[0];break;default:a=e-1,d=t}const f=.5*(n-t),g=this.valueSize;this._weightPrev=f/(t-c),this._weightNext=f/(d-n),this._offsetPrev=s*g,this._offsetNext=a*g}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=e*c,f=d-c,g=this._offsetPrev,v=this._offsetNext,b=this._weightPrev,x=this._weightNext,C=(n-t)/(r-t),I=C*C,D=I*C,L=-b*D+2*b*I-b*C,V=(1+b)*D+(-1.5-2*b)*I+(-.5+b)*C+1,z=(-1-x)*D+(1.5+x)*I+.5*C,U=x*D-x*I;for(let $=0;$!==c;++$)s[$]=L*a[g+$]+V*a[f+$]+z*a[d+$]+U*a[v+$];return s}}class HF extends lS{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=e*c,f=d-c,g=(n-t)/(r-t),v=1-g;for(let b=0;b!==c;++b)s[b]=a[f+b]*v+a[d+b]*g;return s}}class m5 extends lS{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class xh{constructor(e,t,n,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=bs.convertArray(t,this.TimeBufferType),this.values=bs.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:bs.convertArray(e.times,Array),values:bs.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new m5(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new HF(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new p5(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case VE:t=this.InterpolantFactoryMethodDiscrete;break;case V0:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return VE;case this.InterpolantFactoryMethodLinear:return V0;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,a=r-1;for(;s!==r&&n[s]<e;)++s;for(;-1!==a&&n[a]>t;)--a;if(++a,0!==s||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const c=this.getValueSize();this.times=bs.arraySlice(n,s,a),this.values=bs.arraySlice(this.values,s*c,a*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;0===s&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let c=0;c!==s;c++){const d=n[c];if("number"==typeof d&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,d),e=!1;break}if(null!==a&&a>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,d,a),e=!1;break}a=d}if(void 0!==r&&bs.isTypedArray(r))for(let c=0,d=r.length;c!==d;++c){const f=r[c];if(isNaN(f)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,f),e=!1;break}}return e}optimize(){const e=bs.arraySlice(this.times),t=bs.arraySlice(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),s=e.length-1;let a=1;for(let c=1;c<s;++c){let d=!1;const f=e[c];if(f!==e[c+1]&&(1!==c||f!==e[0]))if(r)d=!0;else{const v=c*n,b=v-n,x=v+n;for(let C=0;C!==n;++C){const I=t[v+C];if(I!==t[b+C]||I!==t[x+C]){d=!0;break}}}if(d){if(c!==a){e[a]=e[c];const v=c*n,b=a*n;for(let x=0;x!==n;++x)t[b+x]=t[v+x]}++a}}if(s>0){e[a]=e[s];for(let c=s*n,d=a*n,f=0;f!==n;++f)t[d+f]=t[c+f];++a}return a!==e.length?(this.times=bs.arraySlice(e,0,a),this.values=bs.arraySlice(t,0,a*n)):(this.times=e,this.values=t),this}clone(){const e=bs.arraySlice(this.times,0),t=bs.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}xh.prototype.TimeBufferType=Float32Array,xh.prototype.ValueBufferType=Float32Array,xh.prototype.DefaultInterpolation=V0;class fw extends xh{}fw.prototype.ValueTypeName="bool",fw.prototype.ValueBufferType=Array,fw.prototype.DefaultInterpolation=VE,fw.prototype.InterpolantFactoryMethodLinear=void 0,fw.prototype.InterpolantFactoryMethodSmooth=void 0;class zF extends xh{}zF.prototype.ValueTypeName="color";class cS extends xh{}cS.prototype.ValueTypeName="number";class g5 extends lS{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=(n-t)/(r-t);let f=e*c;for(let g=f+c;f!==g;f+=4)Ya.slerpFlat(s,0,a,f-c,a,f,d);return s}}class l_ extends xh{InterpolantFactoryMethodLinear(e){return new g5(this.times,this.values,this.getValueSize(),e)}}l_.prototype.ValueTypeName="quaternion",l_.prototype.DefaultInterpolation=V0,l_.prototype.InterpolantFactoryMethodSmooth=void 0;class pw extends xh{}pw.prototype.ValueTypeName="string",pw.prototype.ValueBufferType=Array,pw.prototype.DefaultInterpolation=VE,pw.prototype.InterpolantFactoryMethodLinear=void 0,pw.prototype.InterpolantFactoryMethodSmooth=void 0;class uS extends xh{}uS.prototype.ValueTypeName="vector";class dS{constructor(e,t=-1,n,r=2500){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=Zc(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,c=n.length;a!==c;++a)t.push(_5(n[a]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=n.length;s!==a;++s)t.push(xh.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,a=[];for(let c=0;c<s;c++){let d=[],f=[];d.push((c+s-1)%s,c,(c+1)%s),f.push(0,1,0);const g=bs.getKeyframeOrder(d);d=bs.sortedArray(d,1,g),f=bs.sortedArray(f,1,g),!r&&0===d[0]&&(d.push(s),f.push(f[0])),a.push(new cS(".morphTargetInfluences["+t[c].name+"]",d,f).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let c=0,d=e.length;c<d;c++){const f=e[c],g=f.name.match(s);if(g&&g.length>1){const v=g[1];let b=r[v];b||(r[v]=b=[]),b.push(f)}}const a=[];for(const c in r)a.push(this.CreateFromMorphTargetSequence(c,r[c],t,n));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(v,b,x,C,I){if(0!==x.length){const D=[],L=[];bs.flattenJSON(x,D,L,C),0!==D.length&&I.push(new v(b,D,L))}},r=[],s=e.name||"default",a=e.fps||30,c=e.blendMode;let d=e.length||-1;const f=e.hierarchy||[];for(let v=0;v<f.length;v++){const b=f[v].keys;if(b&&0!==b.length)if(b[0].morphTargets){const x={};let C;for(C=0;C<b.length;C++)if(b[C].morphTargets)for(let I=0;I<b[C].morphTargets.length;I++)x[b[C].morphTargets[I]]=-1;for(const I in x){const D=[],L=[];for(let V=0;V!==b[C].morphTargets.length;++V){const z=b[C];D.push(z.time),L.push(z.morphTarget===I?1:0)}r.push(new cS(".morphTargetInfluence["+I+"]",D,L))}d=x.length*a}else{const x=".bones["+t[v].name+"]";n(uS,x+".position",b,"pos",r),n(l_,x+".quaternion",b,"rot",r),n(uS,x+".scale",b,"scl",r)}}return 0===r.length?null:new this(s,d,r,c)}resetDuration(){let t=0;for(let n=0,r=this.tracks.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function _5(i){if(void 0===i.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function y5(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return cS;case"vector":case"vector2":case"vector3":case"vector4":return uS;case"color":return zF;case"quaternion":return l_;case"bool":case"boolean":return fw;case"string":return pw}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}(i.type);if(void 0===i.times){const t=[],n=[];bs.flattenJSON(i.keys,t,n,"value"),i.times=t,i.values=n}return void 0!==e.parse?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const mw={enabled:!1,files:{},add:function(i,e){!1!==this.enabled&&(this.files[i]=e)},get:function(i){if(!1!==this.enabled)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};const v5=new class GF{constructor(e,t,n){const r=this;let d,s=!1,a=0,c=0;const f=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(g){c++,!1===s&&void 0!==r.onStart&&r.onStart(g,a,c),s=!0},this.itemEnd=function(g){a++,void 0!==r.onProgress&&r.onProgress(g,a,c),a===c&&(s=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(g){void 0!==r.onError&&r.onError(g)},this.resolveURL=function(g){return d?d(g):g},this.setURLModifier=function(g){return d=g,this},this.addHandler=function(g,v){return f.push(g,v),this},this.removeHandler=function(g){const v=f.indexOf(g);return-1!==v&&f.splice(v,2),this},this.getHandler=function(g){for(let v=0,b=f.length;v<b;v+=2){const x=f[v],C=f[v+1];if(x.global&&(x.lastIndex=0),x.test(g))return C}return null}}};class hS{constructor(e){this.manager=void 0!==e?e:v5,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Zf={};class Eh extends hS{constructor(e){super(e)}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=mw.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(void 0!==Zf[e])return void Zf[e].push({onLoad:t,onProgress:n,onError:r});Zf[e]=[],Zf[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),c=this.mimeType,d=this.responseType;fetch(a).then(f=>{if(200===f.status||0===f.status){if(0===f.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===f.body||void 0===f.body.getReader)return f;const g=Zf[e],v=f.body.getReader(),b=f.headers.get("Content-Length"),x=b?parseInt(b):0,C=0!==x;let I=0;const D=new ReadableStream({start(L){!function V(){v.read().then(({done:z,value:U})=>{if(z)L.close();else{I+=U.byteLength;const $=new ProgressEvent("progress",{lengthComputable:C,loaded:I,total:x});for(let Z=0,ae=g.length;Z<ae;Z++){const j=g[Z];j.onProgress&&j.onProgress($)}L.enqueue(U),V()}})}()}});return new Response(D)}throw Error(`fetch for "${f.url}" responded with ${f.status}: ${f.statusText}`)}).then(f=>{switch(d){case"arraybuffer":return f.arrayBuffer();case"blob":return f.blob();case"document":return f.text().then(g=>(new DOMParser).parseFromString(g,c));case"json":return f.json();default:if(void 0===c)return f.text();{const v=/charset="?([^;"\s]*)"?/i.exec(c),b=v&&v[1]?v[1].toLowerCase():void 0,x=new TextDecoder(b);return f.arrayBuffer().then(C=>x.decode(C))}}}).then(f=>{mw.add(e,f);const g=Zf[e];delete Zf[e];for(let v=0,b=g.length;v<b;v++){const x=g[v];x.onLoad&&x.onLoad(f)}}).catch(f=>{const g=Zf[e];if(void 0===g)throw this.manager.itemError(e),f;delete Zf[e];for(let v=0,b=g.length;v<b;v++){const x=g[v];x.onError&&x.onError(f)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class FA extends hS{constructor(e){super(e)}load(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=mw.get(e);if(void 0!==a)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const c=HE("img");function d(){g(),mw.add(e,this),t&&t(this),s.manager.itemEnd(e)}function f(v){g(),r&&r(v),s.manager.itemError(e),s.manager.itemEnd(e)}function g(){c.removeEventListener("load",d,!1),c.removeEventListener("error",f,!1)}return c.addEventListener("load",d,!1),c.addEventListener("error",f,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(c.crossOrigin=this.crossOrigin),s.manager.itemStart(e),c.src=e,c}}class w5 extends hS{constructor(e){super(e)}load(e,t,n,r){const s=new bd,a=new FA(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(c){s.image=c,s.needsUpdate=!0,void 0!==t&&t(s)},n,r),s}}class VA extends qs{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new rn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}const jF=new bi,WF=new Q,$F=new Q;class fP{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new gt(512,512),this.map=null,this.mapPass=null,this.matrix=new bi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new BR,this._frameExtents=new gt(1,1),this._viewportCount=1,this._viewports=[new Ur(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;WF.setFromMatrixPosition(e.matrixWorld),t.position.copy(WF),$F.setFromMatrixPosition(e.target.matrixWorld),t.lookAt($F),t.updateMatrixWorld(),jF.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jF),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class x5 extends fP{constructor(){super(new ua(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,n=2*UE*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class qF extends VA{constructor(e,t,n=0,r=Math.PI/3,s=0,a=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(qs.DefaultUp),this.updateMatrix(),this.target=new qs,this.distance=n,this.angle=r,this.penumbra=s,this.decay=a,this.shadow=new x5}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const KF=new bi,fS=new Q,pP=new Q;class E5 extends fP{constructor(){super(new ua(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new gt(4,2),this._viewportCount=6,this._viewports=[new Ur(2,1,1,1),new Ur(0,1,1,1),new Ur(3,1,1,1),new Ur(1,1,1,1),new Ur(3,0,1,1),new Ur(1,0,1,1)],this._cubeDirections=[new Q(1,0,0),new Q(-1,0,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,1,0),new Q(0,-1,0)],this._cubeUps=[new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,1,0),new Q(0,0,1),new Q(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),fS.setFromMatrixPosition(e.matrixWorld),n.position.copy(fS),pP.copy(n.position),pP.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(pP),n.updateMatrixWorld(),r.makeTranslation(-fS.x,-fS.y,-fS.z),KF.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(KF)}}class ZF extends VA{constructor(e,t,n=0,r=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new E5}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class S5 extends fP{constructor(){super(new rA(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class YF extends VA{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(qs.DefaultUp),this.updateMatrix(),this.target=new qs,this.shadow=new S5}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class XF extends VA{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class Yf{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(n){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class P5 extends hS{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=mw.get(e);if(void 0!==a)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const c={};c.credentials="anonymous"===this.crossOrigin?"same-origin":"include",c.headers=this.requestHeader,fetch(e,c).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(d){mw.add(e,d),t&&t(d),s.manager.itemEnd(e)}).catch(function(d){r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}const mP="\\[\\]\\.:\\/",F5=new RegExp("["+mP+"]","g"),gP="[^"+mP+"]",V5="[^"+mP.replace("\\.","")+"]",U5=/((?:WC+[\/:])*)/.source.replace("WC",gP),B5=/(WCOD+)?/.source.replace("WCOD",V5),H5=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gP),z5=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gP),G5=new RegExp("^"+U5+B5+H5+z5+"$"),j5=["material","materials","bones"];class W5{constructor(e,t,n){const r=n||Xr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}let Xr=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(F5,"")}static parseTrackName(t){const n=G5.exec(t);if(null===n)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==s&&-1!==s){const a=r.nodeName.substring(s+1);-1!==j5.indexOf(a)&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=a)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(void 0===n||""===n||"."===n||-1===n||n===t.name||n===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(n);if(void 0!==r)return r}if(t.children){const r=function(a){for(let c=0;c<a.length;c++){const d=a[c];if(d.name===n||d.uuid===n)return d;const f=r(d.children);if(f)return f}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const r=this.resolvedProperty;for(let s=0,a=r.length;s!==a;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,r=n.objectName,s=n.propertyName;let a=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let g=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let v=0;v<t.length;v++)if(t[v].name===g){g=v;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==g){if(void 0===t[g])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[g]}}const c=t[s];if(void 0===c)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+n.nodeName+"."+s+" but it wasn't found.",t);let d=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?d=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(d=this.Versioning.MatrixWorldNeedsUpdate);let f=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===s){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[a]&&(a=t.morphTargetDictionary[a])}f=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=a}else void 0!==c.fromArray&&void 0!==c.toArray?(f=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(f=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=s;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][d]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=W5,i})();Xr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Xr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Xr.prototype.GetterByBindingType=[Xr.prototype._getValue_direct,Xr.prototype._getValue_array,Xr.prototype._getValue_arrayElement,Xr.prototype._getValue_toArray],Xr.prototype.SetterByBindingTypeAndVersioning=[[Xr.prototype._setValue_direct,Xr.prototype._setValue_direct_setNeedsUpdate,Xr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xr.prototype._setValue_array,Xr.prototype._setValue_array_setNeedsUpdate,Xr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xr.prototype._setValue_arrayElement,Xr.prototype._setValue_arrayElement_setNeedsUpdate,Xr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xr.prototype._setValue_fromArray,Xr.prototype._setValue_fromArray_setNeedsUpdate,Xr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class l2{constructor(e=1,t=0,n=0){return this.radius=e,this.phi=t,this.theta=n,this}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(ho(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const _2=new ArrayBuffer(4),Td=(new Float32Array(_2),new Uint32Array(_2),new Uint32Array(512)),Md=new Uint32Array(512);for(let i=0;i<256;++i){const e=i-127;e<-27?(Td[i]=0,Td[256|i]=32768,Md[i]=24,Md[256|i]=24):e<-14?(Td[i]=1024>>-e-14,Td[256|i]=1024>>-e-14|32768,Md[i]=-e-1,Md[256|i]=-e-1):e<=15?(Td[i]=e+15<<10,Td[256|i]=e+15<<10|32768,Md[i]=13,Md[256|i]=13):e<128?(Td[i]=31744,Td[256|i]=64512,Md[i]=24,Md[256|i]=24):(Td[i]=31744,Td[256|i]=64512,Md[i]=13,Md[256|i]=13)}const wP=new Uint32Array(2048),gw=new Uint32Array(64),b2=new Uint32Array(64);for(let i=1;i<1024;++i){let e=i<<13,t=0;for(;0==(8388608&e);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,wP[i]=e|t}for(let i=1024;i<2048;++i)wP[i]=939524096+(i-1024<<13);for(let i=1;i<31;++i)gw[i]=i<<23;gw[31]=1199570944,gw[32]=2147483648;for(let i=33;i<63;++i)gw[i]=2147483648+(i-32<<23);gw[63]=3347054592;for(let i=1;i<64;++i)32!==i&&(b2[i]=1024);"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"141"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="141");class Z5 extends hS{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new e6(t)}),this.register(function(t){return new a6(t)}),this.register(function(t){return new l6(t)}),this.register(function(t){return new n6(t)}),this.register(function(t){return new i6(t)}),this.register(function(t){return new r6(t)}),this.register(function(t){return new s6(t)}),this.register(function(t){return new Q5(t)}),this.register(function(t){return new o6(t)}),this.register(function(t){return new t6(t)}),this.register(function(t){return new X5(t)}),this.register(function(t){return new c6(t)})}load(e,t,n,r){const s=this;let a;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:Yf.extractUrlBase(e),this.manager.itemStart(e);const c=function(f){r?r(f):console.error(f),s.manager.itemError(e),s.manager.itemEnd(e)},d=new Eh(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(this.withCredentials),d.load(e,function(f){try{s.parse(f,a,function(g){t(g),s.manager.itemEnd(e)},c)}catch(g){c(g)}},n,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,r){let s;const a={},c={};if("string"==typeof e)s=e;else if(Yf.decodeText(new Uint8Array(e,0,4))===x2){try{a[Ui.KHR_BINARY_GLTF]=new u6(e)}catch(v){return void(r&&r(v))}s=a[Ui.KHR_BINARY_GLTF].content}else s=Yf.decodeText(new Uint8Array(e));const d=JSON.parse(s);if(void 0===d.asset||d.asset.version[0]<2)return void(r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const f=new E6(d,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});f.fileLoader.setRequestHeader(this.requestHeader);for(let g=0;g<this.pluginCallbacks.length;g++){const v=this.pluginCallbacks[g](f);c[v.name]=v,a[v.name]=!0}if(d.extensionsUsed)for(let g=0;g<d.extensionsUsed.length;++g){const v=d.extensionsUsed[g],b=d.extensionsRequired||[];switch(v){case Ui.KHR_MATERIALS_UNLIT:a[v]=new J5;break;case Ui.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:a[v]=new f6;break;case Ui.KHR_DRACO_MESH_COMPRESSION:a[v]=new d6(d,this.dracoLoader);break;case Ui.KHR_TEXTURE_TRANSFORM:a[v]=new h6;break;case Ui.KHR_MESH_QUANTIZATION:a[v]=new p6;break;default:b.indexOf(v)>=0&&void 0===c[v]&&console.warn('THREE.GLTFLoader: Unknown extension "'+v+'".')}}f.setExtensions(a),f.setPlugins(c),f.parse(n,r)}parseAsync(e,t){const n=this;return new Promise(function(r,s){n.parse(e,t,r,s)})}}function Y5(){let i={};return{get:function(e){return i[e]},add:function(e,t){i[e]=t},remove:function(e){delete i[e]},removeAll:function(){i={}}}}const Ui={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class X5{constructor(e){this.parser=e,this.name=Ui.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const s=t[n];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let r=t.cache.get(n);if(r)return r;const s=t.json,d=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let f;const g=new rn(16777215);void 0!==d.color&&g.fromArray(d.color);const v=void 0!==d.range?d.range:0;switch(d.type){case"directional":f=new YF(g),f.target.position.set(0,0,-1),f.add(f.target);break;case"point":f=new ZF(g),f.distance=v;break;case"spot":f=new qF(g),f.distance=v,d.spot=d.spot||{},d.spot.innerConeAngle=void 0!==d.spot.innerConeAngle?d.spot.innerConeAngle:0,d.spot.outerConeAngle=void 0!==d.spot.outerConeAngle?d.spot.outerConeAngle:Math.PI/4,f.angle=d.spot.outerConeAngle,f.penumbra=1-d.spot.innerConeAngle/d.spot.outerConeAngle,f.target.position.set(0,0,-1),f.add(f.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+d.type)}return f.position.set(0,0,0),f.decay=2,void 0!==d.intensity&&(f.intensity=d.intensity),f.name=t.createUniqueName(d.name||"light_"+e),r=Promise.resolve(f),t.cache.add(n,r),r}createNodeAttachment(e){const t=this,n=this.parser,s=n.json.nodes[e],c=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===c?null:this._loadLight(c).then(function(d){return n._getNodeRef(t.cache,c,d)})}}class J5{constructor(){this.name=Ui.KHR_MATERIALS_UNLIT}getMaterialType(){return Ou}extendParams(e,t,n){const r=[];e.color=new rn(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}void 0!==s.baseColorTexture&&r.push(n.assignTexture(e,"map",s.baseColorTexture,yr))}return Promise.all(r)}}class Q5{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class e6{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?km:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&s.push(n.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&s.push(n.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(s.push(n.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){const c=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new gt(c,c)}return Promise.all(s)}}class t6{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?km:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return void 0!==a.iridescenceFactor&&(t.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&s.push(n.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(t.iridescenceIOR=a.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&s.push(n.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class n6{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?km:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new rn(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=r.extensions[this.name];return void 0!==a.sheenColorFactor&&t.sheenColor.fromArray(a.sheenColorFactor),void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&s.push(n.assignTexture(t,"sheenColorMap",a.sheenColorTexture,yr)),void 0!==a.sheenRoughnessTexture&&s.push(n.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class i6{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?km:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];return void 0!==a.transmissionFactor&&(t.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&s.push(n.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class r6{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?km:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&s.push(n.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||0;const c=a.attenuationColor||[1,1,1];return t.attenuationColor=new rn(c[0],c[1],c[2]),Promise.all(s)}}class s6{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?km:null}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class o6{constructor(e){this.parser=e,this.name=Ui.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?km:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],a=r.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&s.push(n.assignTexture(t,"specularIntensityMap",a.specularTexture));const c=a.specularColorFactor||[1,1,1];return t.specularColor=new rn(c[0],c[1],c[2]),void 0!==a.specularColorTexture&&s.push(n.assignTexture(t,"specularColorMap",a.specularColorTexture,yr)),Promise.all(s)}}class a6{constructor(e){this.parser=e,this.name=Ui.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class l6{constructor(e){this.parser=e,this.name=Ui.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],c=r.images[a.source];let d=n.textureLoader;if(c.uri){const f=n.options.manager.getHandler(c.uri);null!==f&&(d=f)}return this.detectSupport().then(function(f){if(f)return n.loadTextureImage(e,a.source,d);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}}class c6{constructor(e){this.name=Ui.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const r=n.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([s,a.ready]).then(function(c){const d=r.byteOffset||0,f=r.byteLength||0,g=r.count,v=r.byteStride,b=new ArrayBuffer(g*v),x=new Uint8Array(c[0],d,f);return a.decodeGltfBuffer(new Uint8Array(b),g,v,x,r.mode,r.filter),b})}return null}}const x2="glTF";class u6{constructor(e){this.name=Ui.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:Yf.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==x2)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-12,r=new DataView(e,12);let s=0;for(;s<n;){const a=r.getUint32(s,!0);s+=4;const c=r.getUint32(s,!0);if(s+=4,1313821514===c){const d=new Uint8Array(e,12+s,a);this.content=Yf.decodeText(d)}else if(5130562===c){const d=12+s;this.body=e.slice(d,d+a)}s+=a}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class d6{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ui.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,c={},d={},f={};for(const g in a){const v=EP[g]||g.toLowerCase();c[v]=a[g]}for(const g in e.attributes){const v=EP[g]||g.toLowerCase();if(void 0!==a[g]){const b=n.accessors[e.attributes[g]];f[v]=mS[b.componentType],d[v]=!0===b.normalized}}return t.getDependency("bufferView",s).then(function(g){return new Promise(function(v){r.decodeDracoFile(g,function(b){for(const x in b.attributes){const C=b.attributes[x],I=d[x];void 0!==I&&(C.normalized=I)}v(b)},c,f)})})}}class h6{constructor(){this.name=Ui.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class bP extends aS{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),a=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),c={specular:{value:(new rn).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=c,this.onBeforeCompile=function(d){for(const f in c)d.uniforms[f]=c[f];d.fragmentShader=d.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",a)},Object.defineProperties(this,{specular:{get:function(){return c.specular.value},set:function(d){c.specular.value=d}},specularMap:{get:function(){return c.specularMap.value},set:function(d){c.specularMap.value=d,d?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return c.glossiness.value},set:function(d){c.glossiness.value=d}},glossinessMap:{get:function(){return c.glossinessMap.value},set:function(d){c.glossinessMap.value=d,d?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class f6{constructor(){this.name=Ui.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity"]}getMaterialType(){return bP}extendParams(e,t,n){const r=t.extensions[this.name];e.color=new rn(1,1,1),e.opacity=1;const s=[];if(Array.isArray(r.diffuseFactor)){const a=r.diffuseFactor;e.color.fromArray(a),e.opacity=a[3]}if(void 0!==r.diffuseTexture&&s.push(n.assignTexture(e,"map",r.diffuseTexture,yr)),e.emissive=new rn(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new rn(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){const a=r.specularGlossinessTexture;s.push(n.assignTexture(e,"glossinessMap",a)),s.push(n.assignTexture(e,"specularMap",a,yr))}return Promise.all(s)}createMaterial(e){const t=new bP(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=void 0===e.emissiveIntensity?1:e.emissiveIntensity,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=0,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t}}class p6{constructor(){this.name=Ui.KHR_MESH_QUANTIZATION}}class xP extends lS{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let a=0;a!==r;a++)t[a]=n[s+a];return t}}xP.prototype.interpolate_=function(i,e,t,n){const r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,c=2*a,d=3*a,f=n-e,g=(t-e)/f,v=g*g,b=v*g,x=i*d,C=x-d,I=-2*b+3*v,D=b-v,L=1-I,V=D-v+g;for(let z=0;z!==a;z++)r[z]=L*s[C+z+a]+V*(s[C+z+c]*f)+I*s[x+z+a]+D*(s[x+z]*f);return r};const m6=new Ya;class g6 extends xP{interpolate_(e,t,n,r){const s=super.interpolate_(e,t,n,r);return m6.fromArray(s).normalize().toArray(s),s}}const mS={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},S2={9728:Do,9729:$s,9984:1004,9985:1007,9986:1005,9987:Em},T2={33071:Ml,33648:1002,10497:Hy},M2={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},EP={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Vm={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},y6={CUBICSPLINE:void 0,LINEAR:V0,STEP:VE};function _6(i){return void 0===i.DefaultMaterial&&(i.DefaultMaterial=new aS({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),i.DefaultMaterial}function gS(i,e,t){for(const n in t.extensions)void 0===i[n]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function p_(i,e){void 0!==e.extras&&("object"==typeof e.extras?Object.assign(i.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function w6(i,e){if(i.updateMorphTargets(),void 0!==e.weights)for(let t=0,n=e.weights.length;t<n;t++)i.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(i.morphTargetInfluences.length===t.length){i.morphTargetDictionary={};for(let n=0,r=t.length;n<r;n++)i.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function b6(i){const e=i.extensions&&i.extensions[Ui.KHR_DRACO_MESH_COMPRESSION];let t;return t=e?"draco:"+e.bufferView+":"+e.indices+":"+C2(e.attributes):i.indices+":"+C2(i.attributes)+":"+i.mode,t}function C2(i){let e="";const t=Object.keys(i).sort();for(let n=0,r=t.length;n<r;n++)e+=t[n]+":"+i[t[n]]+";";return e}function TP(i){switch(i){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class E6{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Y5,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};const n=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;this.textureLoader="undefined"==typeof createImageBitmap||n||r&&s<98?new w5(this.options.manager):new P5(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Eh(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(a){const c={scene:a[0][r.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:r.asset,parser:n,userData:{}};gS(s,c,r),p_(c,r),Promise.all(n._invokeAll(function(d){return d.afterRoot&&d.afterRoot(c)})).then(function(){e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const a=t[r].joints;for(let c=0,d=a.length;c<d;c++)e[a[c]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const a=e[r];void 0!==a.mesh&&(this._addNodeRef(this.meshCache,a.mesh),void 0!==a.skin&&(n[a.mesh].isSkinnedMesh=!0)),void 0!==a.camera&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone(),s=(a,c)=>{const d=this.associations.get(a);null!=d&&this.associations.set(c,d);for(const[f,g]of a.children.entries())s(g,c.children[f])};return s(n,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&n.push(s)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(s,a){return n.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Ui.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,a){n.load(Yf.resolveURL(t.uri,r.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const s=t.byteOffset||0;return n.slice(s,s+(t.byteLength||0))})}loadAccessor(e){const t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);const s=[];return s.push(void 0!==r.bufferView?this.getDependency("bufferView",r.bufferView):null),void 0!==r.sparse&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(a){const c=a[0],d=M2[r.type],f=mS[r.componentType],g=f.BYTES_PER_ELEMENT,b=r.byteOffset||0,x=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,C=!0===r.normalized;let I,D;if(x&&x!==g*d){const L=Math.floor(b/x),V="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+L+":"+r.count;let z=t.cache.get(V);z||(I=new f(c,L*x,r.count*x/g),z=new YR(I,x/g),t.cache.add(V,z)),D=new o_(z,d,b%x/g,C)}else I=null===c?new f(r.count*d):new f(c,b,r.count*d),D=new No(I,d,C);if(void 0!==r.sparse){const U=r.sparse.values.byteOffset||0,$=new(0,mS[r.sparse.indices.componentType])(a[1],r.sparse.indices.byteOffset||0,r.sparse.count*M2.SCALAR),Z=new f(a[2],U,r.sparse.count*d);null!==c&&(D=new No(D.array.slice(),D.itemSize,D.normalized));for(let ae=0,j=$.length;ae<j;ae++){const ie=$[ae];if(D.setX(ie,Z[ae*d]),d>=2&&D.setY(ie,Z[ae*d+1]),d>=3&&D.setZ(ie,Z[ae*d+2]),d>=4&&D.setW(ie,Z[ae*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return D})}loadTexture(e){const t=this.json,s=t.textures[e].source,a=t.images[s];let c=this.textureLoader;if(a.uri){const d=this.options.manager.getHandler(a.uri);null!==d&&(c=d)}return this.loadTextureImage(e,s,c)}loadTextureImage(e,t,n){const r=this,s=this.json,a=s.textures[e],c=s.images[t],d=(c.uri||c.bufferView)+":"+a.sampler;if(this.textureCache[d])return this.textureCache[d];const f=this.loadImageSource(t,n).then(function(g){g.flipY=!1,a.name&&(g.name=a.name);const b=(s.samplers||{})[a.sampler]||{};return g.magFilter=S2[b.magFilter]||$s,g.minFilter=S2[b.minFilter]||Em,g.wrapS=T2[b.wrapS]||Hy,g.wrapT=T2[b.wrapT]||Hy,r.associations.set(g,{textures:e}),g}).catch(function(){return null});return this.textureCache[d]=f,f}loadImageSource(e,t){const r=this.json,s=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(v=>v.clone());const a=r.images[e],c=self.URL||self.webkitURL;let d=a.uri||"",f=!1;if(void 0!==a.bufferView)d=this.getDependency("bufferView",a.bufferView).then(function(v){f=!0;const b=new Blob([v],{type:a.mimeType});return d=c.createObjectURL(b),d});else if(void 0===a.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const g=Promise.resolve(d).then(function(v){return new Promise(function(b,x){let C=b;!0===t.isImageBitmapLoader&&(C=function(I){const D=new bd(I);D.needsUpdate=!0,b(D)}),t.load(Yf.resolveURL(v,s.path),C,void 0,x)})}).then(function(v){return!0===f&&c.revokeObjectURL(d),v.userData.mimeType=a.mimeType||function x6(i){return i.search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"}(a.uri),v}).catch(function(v){throw console.error("THREE.GLTFLoader: Couldn't load texture",d),v});return this.sourceCache[e]=g,g}assignTexture(e,t,n,r){const s=this;return this.getDependency("texture",n.index).then(function(a){if(void 0!==n.texCoord&&0!=n.texCoord&&!("aoMap"===t&&1==n.texCoord)&&console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),s.extensions[Ui.KHR_TEXTURE_TRANSFORM]){const c=void 0!==n.extensions?n.extensions[Ui.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const d=s.associations.get(a);a=s.extensions[Ui.KHR_TEXTURE_TRANSFORM].extendTexture(a,c),s.associations.set(a,d)}}return void 0!==r&&(a.encoding=r),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const r=void 0===t.attributes.tangent,s=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let d=this.cache.get(c);d||(d=new tP,Ro.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,d.sizeAttenuation=!1,this.cache.add(c,d)),n=d}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let d=this.cache.get(c);d||(d=new Rl,Ro.prototype.copy.call(d,n),d.color.copy(n.color),this.cache.add(c,d)),n=d}if(r||s||a){let c="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(c+="specular-glossiness:"),r&&(c+="derivative-tangents:"),s&&(c+="vertex-colors:"),a&&(c+="flat-shading:");let d=this.cache.get(c);d||(d=n.clone(),s&&(d.vertexColors=!0),a&&(d.flatShading=!0),r&&(d.normalScale&&(d.normalScale.y*=-1),d.clearcoatNormalScale&&(d.clearcoatNormalScale.y*=-1)),this.cache.add(c,d),this.associations.set(d,this.associations.get(n))),n=d}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n}getMaterialType(){return aS}loadMaterial(e){const t=this,r=this.extensions,s=this.json.materials[e];let a;const c={},d=s.extensions||{},f=[];if(d[Ui.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const v=r[Ui.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];a=v.getMaterialType(),f.push(v.extendParams(c,s,t))}else if(d[Ui.KHR_MATERIALS_UNLIT]){const v=r[Ui.KHR_MATERIALS_UNLIT];a=v.getMaterialType(),f.push(v.extendParams(c,s,t))}else{const v=s.pbrMetallicRoughness||{};if(c.color=new rn(1,1,1),c.opacity=1,Array.isArray(v.baseColorFactor)){const b=v.baseColorFactor;c.color.fromArray(b),c.opacity=b[3]}void 0!==v.baseColorTexture&&f.push(t.assignTexture(c,"map",v.baseColorTexture,yr)),c.metalness=void 0!==v.metallicFactor?v.metallicFactor:1,c.roughness=void 0!==v.roughnessFactor?v.roughnessFactor:1,void 0!==v.metallicRoughnessTexture&&(f.push(t.assignTexture(c,"metalnessMap",v.metallicRoughnessTexture)),f.push(t.assignTexture(c,"roughnessMap",v.metallicRoughnessTexture))),a=this._invokeOne(function(b){return b.getMaterialType&&b.getMaterialType(e)}),f.push(Promise.all(this._invokeAll(function(b){return b.extendMaterialParams&&b.extendMaterialParams(e,c)})))}!0===s.doubleSided&&(c.side=2);const g=s.alphaMode||"OPAQUE";if("BLEND"===g?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,"MASK"===g&&(c.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&a!==Ou&&(f.push(t.assignTexture(c,"normalMap",s.normalTexture)),c.normalScale=new gt(1,1),void 0!==s.normalTexture.scale)){const v=s.normalTexture.scale;c.normalScale.set(v,v)}return void 0!==s.occlusionTexture&&a!==Ou&&(f.push(t.assignTexture(c,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(c.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&a!==Ou&&(c.emissive=(new rn).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&a!==Ou&&f.push(t.assignTexture(c,"emissiveMap",s.emissiveTexture,yr)),Promise.all(f).then(function(){let v;return v=a===bP?r[Ui.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(c):new a(c),s.name&&(v.name=s.name),p_(v,s),t.associations.set(v,{materials:e}),s.extensions&&gS(r,v,s),v})}createUniqueName(e){const t=Xr.sanitizeNodeName(e||"");let n=t;for(let r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n}loadGeometries(e){const t=this,n=this.extensions,r=this.primitiveCache;function s(c){return n[Ui.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(d){return I2(d,c,t)})}const a=[];for(let c=0,d=e.length;c<d;c++){const f=e[c],g=b6(f),v=r[g];if(v)a.push(v.promise);else{let b;b=f.extensions&&f.extensions[Ui.KHR_DRACO_MESH_COMPRESSION]?s(f):I2(new Li,f,t),r[g]={primitive:f,promise:b},a.push(b)}}return Promise.all(a)}loadMesh(e){const t=this,r=this.extensions,s=this.json.meshes[e],a=s.primitives,c=[];for(let d=0,f=a.length;d<f;d++){const g=void 0===a[d].material?_6(this.cache):this.getDependency("material",a[d].material);c.push(g)}return c.push(t.loadGeometries(a)),Promise.all(c).then(function(d){const f=d.slice(0,d.length-1),g=d[d.length-1],v=[];for(let x=0,C=g.length;x<C;x++){const I=g[x],D=a[x];let L;const V=f[x];if(4===D.mode||5===D.mode||6===D.mode||void 0===D.mode)L=!0===s.isSkinnedMesh?new mF(I,V):new Cl(I,V),!0===L.isSkinnedMesh&&!L.geometry.attributes.skinWeight.normalized&&L.normalizeSkinWeights(),5===D.mode?L.geometry=D2(L.geometry,1):6===D.mode&&(L.geometry=D2(L.geometry,2));else if(1===D.mode)L=new eP(I,V);else if(3===D.mode)L=new a_(I,V);else if(2===D.mode)L=new SF(I,V);else{if(0!==D.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+D.mode);L=new MF(I,V)}Object.keys(L.geometry.morphAttributes).length>0&&w6(L,s),L.name=t.createUniqueName(s.name||"mesh_"+e),p_(L,s),D.extensions&&gS(r,L,D),t.assignFinalMaterial(L),v.push(L)}for(let x=0,C=v.length;x<C;x++)t.associations.set(v[x],{meshes:e,primitives:x});if(1===v.length)return v[0];const b=new Nm;t.associations.set(b,{meshes:e});for(let x=0,C=v.length;x<C;x++)b.add(v[x]);return b})}loadCamera(e){let t;const n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new ua(nz.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new rA(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),p_(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(r){return n.inverseBindMatrices=r,n})}loadAnimation(e){const n=this.json.animations[e],r=[],s=[],a=[],c=[],d=[];for(let f=0,g=n.channels.length;f<g;f++){const v=n.channels[f],b=n.samplers[v.sampler],x=v.target,I=void 0!==n.parameters?n.parameters[b.input]:b.input,D=void 0!==n.parameters?n.parameters[b.output]:b.output;r.push(this.getDependency("node",void 0!==x.node?x.node:x.id)),s.push(this.getDependency("accessor",I)),a.push(this.getDependency("accessor",D)),c.push(b),d.push(x)}return Promise.all([Promise.all(r),Promise.all(s),Promise.all(a),Promise.all(c),Promise.all(d)]).then(function(f){const g=f[0],v=f[1],b=f[2],x=f[3],C=f[4],I=[];for(let L=0,V=g.length;L<V;L++){const z=g[L],U=v[L],$=b[L],Z=x[L],ae=C[L];if(void 0===z)continue;let j;switch(z.updateMatrix(),z.matrixAutoUpdate=!0,Vm[ae.path]){case Vm.weights:j=cS;break;case Vm.rotation:j=l_;break;default:j=uS}const ie=z.name?z.name:z.uuid,we=void 0!==Z.interpolation?y6[Z.interpolation]:V0,Me=[];Vm[ae.path]===Vm.weights?z.traverse(function(Mt){Mt.morphTargetInfluences&&Me.push(Mt.name?Mt.name:Mt.uuid)}):Me.push(ie);let dt=$.array;if($.normalized){const Mt=TP(dt.constructor),Se=new Float32Array(dt.length);for(let it=0,Ge=dt.length;it<Ge;it++)Se[it]=dt[it]*Mt;dt=Se}for(let Mt=0,Se=Me.length;Mt<Se;Mt++){const it=new j(Me[Mt]+"."+Vm[ae.path],U.array,dt,we);"CUBICSPLINE"===Z.interpolation&&(it.createInterpolant=function(_t){return new(this instanceof l_?g6:xP)(this.times,this.values,this.getValueSize()/3,_t)},it.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),I.push(it)}}return new dS(n.name?n.name:"animation_"+e,void 0,I)})}createNodeMesh(e){const n=this,r=this.json.nodes[e];return void 0===r.mesh?null:n.getDependency("mesh",r.mesh).then(function(s){const a=n._getNodeRef(n.meshCache,r.mesh,s);return void 0!==r.weights&&a.traverse(function(c){if(c.isMesh)for(let d=0,f=r.weights.length;d<f;d++)c.morphTargetInfluences[d]=r.weights[d]}),a})}loadNode(e){const n=this.extensions,r=this,s=this.json.nodes[e],a=s.name?r.createUniqueName(s.name):"";return function(){const c=[],d=r._invokeOne(function(f){return f.createNodeMesh&&f.createNodeMesh(e)});return d&&c.push(d),void 0!==s.camera&&c.push(r.getDependency("camera",s.camera).then(function(f){return r._getNodeRef(r.cameraCache,s.camera,f)})),r._invokeAll(function(f){return f.createNodeAttachment&&f.createNodeAttachment(e)}).forEach(function(f){c.push(f)}),Promise.all(c)}().then(function(c){let d;if(d=!0===s.isBone?new JR:c.length>1?new Nm:1===c.length?c[0]:new qs,d!==c[0])for(let f=0,g=c.length;f<g;f++)d.add(c[f]);if(s.name&&(d.userData.name=s.name,d.name=a),p_(d,s),s.extensions&&gS(n,d,s),void 0!==s.matrix){const f=new bi;f.fromArray(s.matrix),d.applyMatrix4(f)}else void 0!==s.translation&&d.position.fromArray(s.translation),void 0!==s.rotation&&d.quaternion.fromArray(s.rotation),void 0!==s.scale&&d.scale.fromArray(s.scale);return r.associations.has(d)||r.associations.set(d,{}),r.associations.get(d).nodes=e,d})}loadScene(e){const t=this.json,n=this.extensions,r=this.json.scenes[e],s=this,a=new Nm;r.name&&(a.name=s.createUniqueName(r.name)),p_(a,r),r.extensions&&gS(n,a,r);const c=r.nodes||[],d=[];for(let f=0,g=c.length;f<g;f++)d.push(A2(c[f],a,t,s));return Promise.all(d).then(function(){return s.associations=(g=>{const v=new Map;for(const[b,x]of s.associations)(b instanceof Ro||b instanceof bd)&&v.set(b,x);return g.traverse(b=>{const x=s.associations.get(b);null!=x&&v.set(b,x)}),v})(a),a})}}function A2(i,e,t,n){const r=t.nodes[i];return n.getDependency("node",i).then(function(s){if(void 0===r.skin)return s;let a;return n.getDependency("skin",r.skin).then(function(c){a=c;const d=[];for(let f=0,g=a.joints.length;f<g;f++)d.push(n.getDependency("node",a.joints[f]));return Promise.all(d)}).then(function(c){return s.traverse(function(d){if(!d.isMesh)return;const f=[],g=[];for(let v=0,b=c.length;v<b;v++){const x=c[v];if(x){f.push(x);const C=new bi;void 0!==a.inverseBindMatrices&&C.fromArray(a.inverseBindMatrices.array,16*v),g.push(C)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',a.joints[v])}d.bind(new hA(f,g),d.matrixWorld)}),s})}).then(function(s){e.add(s);const a=[];if(r.children){const c=r.children;for(let d=0,f=c.length;d<f;d++)a.push(A2(c[d],s,t,n))}return Promise.all(a)})}function I2(i,e,t){const n=e.attributes,r=[];function s(a,c){return t.getDependency("accessor",a).then(function(d){i.setAttribute(c,d)})}for(const a in n){const c=EP[a]||a.toLowerCase();c in i.attributes||r.push(s(n[a],c))}if(void 0!==e.indices&&!i.index){const a=t.getDependency("accessor",e.indices).then(function(c){i.setIndex(c)});r.push(a)}return p_(i,e),function S6(i,e,t){const n=e.attributes,r=new Xy;if(void 0===n.POSITION)return;{const c=t.json.accessors[n.POSITION],d=c.min,f=c.max;if(void 0===d||void 0===f)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(r.set(new Q(d[0],d[1],d[2]),new Q(f[0],f[1],f[2])),c.normalized){const g=TP(mS[c.componentType]);r.min.multiplyScalar(g),r.max.multiplyScalar(g)}}const s=e.targets;if(void 0!==s){const c=new Q,d=new Q;for(let f=0,g=s.length;f<g;f++){const v=s[f];if(void 0!==v.POSITION){const b=t.json.accessors[v.POSITION],x=b.min,C=b.max;if(void 0!==x&&void 0!==C){if(d.setX(Math.max(Math.abs(x[0]),Math.abs(C[0]))),d.setY(Math.max(Math.abs(x[1]),Math.abs(C[1]))),d.setZ(Math.max(Math.abs(x[2]),Math.abs(C[2]))),b.normalized){const I=TP(mS[b.componentType]);d.multiplyScalar(I)}c.max(d)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(c)}i.boundingBox=r;const a=new t_;r.getCenter(a.center),a.radius=r.min.distanceTo(r.max)/2,i.boundingSphere=a}(i,e,t),Promise.all(r).then(function(){return void 0!==e.targets?function v6(i,e,t){let n=!1,r=!1,s=!1;for(let f=0,g=e.length;f<g;f++){const v=e[f];if(void 0!==v.POSITION&&(n=!0),void 0!==v.NORMAL&&(r=!0),void 0!==v.COLOR_0&&(s=!0),n&&r&&s)break}if(!n&&!r&&!s)return Promise.resolve(i);const a=[],c=[],d=[];for(let f=0,g=e.length;f<g;f++){const v=e[f];if(n){const b=void 0!==v.POSITION?t.getDependency("accessor",v.POSITION):i.attributes.position;a.push(b)}if(r){const b=void 0!==v.NORMAL?t.getDependency("accessor",v.NORMAL):i.attributes.normal;c.push(b)}if(s){const b=void 0!==v.COLOR_0?t.getDependency("accessor",v.COLOR_0):i.attributes.color;d.push(b)}}return Promise.all([Promise.all(a),Promise.all(c),Promise.all(d)]).then(function(f){const v=f[1],b=f[2];return n&&(i.morphAttributes.position=f[0]),r&&(i.morphAttributes.normal=v),s&&(i.morphAttributes.color=b),i.morphTargetsRelative=!0,i})}(i,e.targets,t):i})}function D2(i,e){let t=i.getIndex();if(null===t){const a=[],c=i.getAttribute("position");if(void 0===c)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i;for(let d=0;d<c.count;d++)a.push(d);i.setIndex(a),t=i.getIndex()}const n=t.count-2,r=[];if(2===e)for(let a=1;a<=n;a++)r.push(t.getX(0)),r.push(t.getX(a)),r.push(t.getX(a+1));else for(let a=0;a<n;a++)a%2==0?(r.push(t.getX(a)),r.push(t.getX(a+1)),r.push(t.getX(a+2))):(r.push(t.getX(a+2)),r.push(t.getX(a+1)),r.push(t.getX(a)));r.length/3!==n&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=i.clone();return s.setIndex(r),s}const R2={type:"change"},MP={type:"start"},P2={type:"end"};class T6 extends Ky{constructor(e,t){super(),void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Q,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:0,MIDDLE:1,RIGHT:2},this.touches={ONE:0,TWO:2},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return c.phi},this.getAzimuthalAngle=function(){return c.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(ee){ee.addEventListener("keydown",_r),this._domElementKeyEvents=ee},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(R2),n.update(),s=r.NONE},this.update=function(){const ee=new Q,Ct=(new Ya).setFromUnitVectors(e.up,new Q(0,1,0)),Yt=Ct.clone().invert(),Xt=new Q,_e=new Ya,Jt=2*Math.PI;return function(){const Jn=n.object.position;ee.copy(Jn).sub(n.target),ee.applyQuaternion(Ct),c.setFromVector3(ee),n.autoRotate&&s===r.NONE&&ie(function ae(){return 2*Math.PI/60/60*n.autoRotateSpeed}()),n.enableDamping?(c.theta+=d.theta*n.dampingFactor,c.phi+=d.phi*n.dampingFactor):(c.theta+=d.theta,c.phi+=d.phi);let pn=n.minAzimuthAngle,Hn=n.maxAzimuthAngle;return isFinite(pn)&&isFinite(Hn)&&(pn<-Math.PI?pn+=Jt:pn>Math.PI&&(pn-=Jt),Hn<-Math.PI?Hn+=Jt:Hn>Math.PI&&(Hn-=Jt),c.theta=pn<=Hn?Math.max(pn,Math.min(Hn,c.theta)):c.theta>(pn+Hn)/2?Math.max(pn,c.theta):Math.min(Hn,c.theta)),c.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,c.phi)),c.makeSafe(),c.radius*=f,c.radius=Math.max(n.minDistance,Math.min(n.maxDistance,c.radius)),!0===n.enableDamping?n.target.addScaledVector(g,n.dampingFactor):n.target.add(g),ee.setFromSpherical(c),ee.applyQuaternion(Yt),Jn.copy(n.target).add(ee),n.object.lookAt(n.target),!0===n.enableDamping?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,g.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),g.set(0,0,0)),f=1,!!(v||Xt.distanceToSquared(n.object.position)>a||8*(1-_e.dot(n.object.quaternion))>a)&&(n.dispatchEvent(R2),Xt.copy(n.object.position),_e.copy(n.object.quaternion),v=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Qe),n.domElement.removeEventListener("pointerdown",Wt),n.domElement.removeEventListener("pointercancel",pi),n.domElement.removeEventListener("wheel",Rr),n.domElement.removeEventListener("pointermove",Sn),n.domElement.removeEventListener("pointerup",dn),null!==n._domElementKeyEvents&&n._domElementKeyEvents.removeEventListener("keydown",_r)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const a=1e-6,c=new l2,d=new l2;let f=1;const g=new Q;let v=!1;const b=new gt,x=new gt,C=new gt,I=new gt,D=new gt,L=new gt,V=new gt,z=new gt,U=new gt,$=[],Z={};function j(){return Math.pow(.95,n.zoomSpeed)}function ie(ee){d.theta-=ee}function we(ee){d.phi-=ee}const Me=function(){const ee=new Q;return function(Yt,Xt){ee.setFromMatrixColumn(Xt,0),ee.multiplyScalar(-Yt),g.add(ee)}}(),dt=function(){const ee=new Q;return function(Yt,Xt){!0===n.screenSpacePanning?ee.setFromMatrixColumn(Xt,1):(ee.setFromMatrixColumn(Xt,0),ee.crossVectors(n.object.up,ee)),ee.multiplyScalar(Yt),g.add(ee)}}(),Mt=function(){const ee=new Q;return function(Yt,Xt){const _e=n.domElement;if(n.object.isPerspectiveCamera){ee.copy(n.object.position).sub(n.target);let $t=ee.length();$t*=Math.tan(n.object.fov/2*Math.PI/180),Me(2*Yt*$t/_e.clientHeight,n.object.matrix),dt(2*Xt*$t/_e.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(Me(Yt*(n.object.right-n.object.left)/n.object.zoom/_e.clientWidth,n.object.matrix),dt(Xt*(n.object.top-n.object.bottom)/n.object.zoom/_e.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function Se(ee){n.object.isPerspectiveCamera?f/=ee:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*ee)),n.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function it(ee){n.object.isPerspectiveCamera?f*=ee:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/ee)),n.object.updateProjectionMatrix(),v=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Ge(ee){b.set(ee.clientX,ee.clientY)}function vt(ee){I.set(ee.clientX,ee.clientY)}function Mn(){1===$.length?b.set($[0].pageX,$[0].pageY):b.set(.5*($[0].pageX+$[1].pageX),.5*($[0].pageY+$[1].pageY))}function Bn(){1===$.length?I.set($[0].pageX,$[0].pageY):I.set(.5*($[0].pageX+$[1].pageX),.5*($[0].pageY+$[1].pageY))}function ft(){const ee=$[0].pageX-$[1].pageX,Ct=$[0].pageY-$[1].pageY,Yt=Math.sqrt(ee*ee+Ct*Ct);V.set(0,Yt)}function di(ee){if(1==$.length)x.set(ee.pageX,ee.pageY);else{const Yt=ti(ee);x.set(.5*(ee.pageX+Yt.x),.5*(ee.pageY+Yt.y))}C.subVectors(x,b).multiplyScalar(n.rotateSpeed);const Ct=n.domElement;ie(2*Math.PI*C.x/Ct.clientHeight),we(2*Math.PI*C.y/Ct.clientHeight),b.copy(x)}function tn(ee){if(1===$.length)D.set(ee.pageX,ee.pageY);else{const Ct=ti(ee);D.set(.5*(ee.pageX+Ct.x),.5*(ee.pageY+Ct.y))}L.subVectors(D,I).multiplyScalar(n.panSpeed),Mt(L.x,L.y),I.copy(D)}function xi(ee){const Ct=ti(ee),Yt=ee.pageX-Ct.x,Xt=ee.pageY-Ct.y,_e=Math.sqrt(Yt*Yt+Xt*Xt);z.set(0,_e),U.set(0,Math.pow(z.y/V.y,n.zoomSpeed)),Se(U.y),V.copy(z)}function Wt(ee){!1!==n.enabled&&(0===$.length&&(n.domElement.setPointerCapture(ee.pointerId),n.domElement.addEventListener("pointermove",Sn),n.domElement.addEventListener("pointerup",dn)),function Ft(ee){$.push(ee)}(ee),"touch"===ee.pointerType?function se(ee){switch(fn(ee),$.length){case 1:switch(n.touches.ONE){case 0:if(!1===n.enableRotate)return;Mn(),s=r.TOUCH_ROTATE;break;case 1:if(!1===n.enablePan)return;Bn(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case 2:if(!1===n.enableZoom&&!1===n.enablePan)return;(function Bi(){n.enableZoom&&ft(),n.enablePan&&Bn()})(),s=r.TOUCH_DOLLY_PAN;break;case 3:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function oi(){n.enableZoom&&ft(),n.enableRotate&&Mn()})(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(MP)}(ee):function Xn(ee){let Ct;switch(ee.button){case 0:Ct=n.mouseButtons.LEFT;break;case 1:Ct=n.mouseButtons.MIDDLE;break;case 2:Ct=n.mouseButtons.RIGHT;break;default:Ct=-1}switch(Ct){case 1:if(!1===n.enableZoom)return;(function _t(ee){V.set(ee.clientX,ee.clientY)})(ee),s=r.DOLLY;break;case 0:if(ee.ctrlKey||ee.metaKey||ee.shiftKey){if(!1===n.enablePan)return;vt(ee),s=r.PAN}else{if(!1===n.enableRotate)return;Ge(ee),s=r.ROTATE}break;case 2:if(ee.ctrlKey||ee.metaKey||ee.shiftKey){if(!1===n.enableRotate)return;Ge(ee),s=r.ROTATE}else{if(!1===n.enablePan)return;vt(ee),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(MP)}(ee))}function Sn(ee){!1!==n.enabled&&("touch"===ee.pointerType?function J(ee){switch(fn(ee),s){case r.TOUCH_ROTATE:if(!1===n.enableRotate)return;di(ee),n.update();break;case r.TOUCH_PAN:if(!1===n.enablePan)return;tn(ee),n.update();break;case r.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;(function xt(ee){n.enableZoom&&xi(ee),n.enablePan&&tn(ee)})(ee),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;(function wt(ee){n.enableZoom&&xi(ee),n.enableRotate&&di(ee)})(ee),n.update();break;default:s=r.NONE}}(ee):function $n(ee){if(!1!==n.enabled)switch(s){case r.ROTATE:if(!1===n.enableRotate)return;!function rt(ee){x.set(ee.clientX,ee.clientY),C.subVectors(x,b).multiplyScalar(n.rotateSpeed);const Ct=n.domElement;ie(2*Math.PI*C.x/Ct.clientHeight),we(2*Math.PI*C.y/Ct.clientHeight),b.copy(x),n.update()}(ee);break;case r.DOLLY:if(!1===n.enableZoom)return;!function ht(ee){z.set(ee.clientX,ee.clientY),U.subVectors(z,V),U.y>0?Se(j()):U.y<0&&it(j()),V.copy(z),n.update()}(ee);break;case r.PAN:if(!1===n.enablePan)return;!function zt(ee){D.set(ee.clientX,ee.clientY),L.subVectors(D,I).multiplyScalar(n.panSpeed),Mt(L.x,L.y),I.copy(D),n.update()}(ee)}}(ee))}function dn(ee){jt(ee),0===$.length&&(n.domElement.releasePointerCapture(ee.pointerId),n.domElement.removeEventListener("pointermove",Sn),n.domElement.removeEventListener("pointerup",dn)),n.dispatchEvent(P2),s=r.NONE}function pi(ee){jt(ee)}function Rr(ee){!1===n.enabled||!1===n.enableZoom||s!==r.NONE||(ee.preventDefault(),n.dispatchEvent(MP),function At(ee){ee.deltaY<0?it(j()):ee.deltaY>0&&Se(j()),n.update()}(ee),n.dispatchEvent(P2))}function _r(ee){!1===n.enabled||!1===n.enablePan||function ln(ee){let Ct=!1;switch(ee.code){case n.keys.UP:Mt(0,n.keyPanSpeed),Ct=!0;break;case n.keys.BOTTOM:Mt(0,-n.keyPanSpeed),Ct=!0;break;case n.keys.LEFT:Mt(n.keyPanSpeed,0),Ct=!0;break;case n.keys.RIGHT:Mt(-n.keyPanSpeed,0),Ct=!0}Ct&&(ee.preventDefault(),n.update())}(ee)}function Qe(ee){!1!==n.enabled&&ee.preventDefault()}function jt(ee){delete Z[ee.pointerId];for(let Ct=0;Ct<$.length;Ct++)if($[Ct].pointerId==ee.pointerId)return void $.splice(Ct,1)}function fn(ee){let Ct=Z[ee.pointerId];void 0===Ct&&(Ct=new gt,Z[ee.pointerId]=Ct),Ct.set(ee.pageX,ee.pageY)}function ti(ee){return Z[(ee.pointerId===$[0].pointerId?$[1]:$[0]).pointerId]}n.domElement.addEventListener("contextmenu",Qe),n.domElement.addEventListener("pointerdown",Wt),n.domElement.addEventListener("pointercancel",pi),n.domElement.addEventListener("wheel",Rr,{passive:!1}),this.update()}}let CP=(()=>{class i{constructor(t,n){this.http=t,this.fs=n,this.baseApiUrl="http://localhost:4000/models"}uploadModelFile(t,n){this.fs.collection("model").add({modelstring:t,filename:n}).then(r=>console.log(r)).catch(r=>console.log(r)).finally(()=>console.log("completed"))}receiveModelFile(){return this.fs.collection("model").snapshotChanges()}getIndex(t){this.index=t}setIndex(){return this.index}}return i.\u0275fac=function(t){return new(t||i)(w.LFG(ul),w.LFG(wO))},i.\u0275prov=w.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const M6=["canvas"];let C6=(()=>{class i{constructor(t,n){this.mcrs=t,this.router=n,this.cameraZ=400,this.fieldOfView=1,this.nearClippingPlane=1,this.farClippingPlane=1e3,this.scene=new sF,this.loader=new Z5,this.light=new XF(16777215,1),this.modelfile=new Array,this.modelString=""}get canvas(){return this.canvasref.nativeElement}ngOnInit(){this.index=this.mcrs.setIndex(),this.getModelList()}getModelList(){return this.mcrs.receiveModelFile().subscribe(t=>{this.modelfile=t.map(n=>n.payload.doc.data())},t=>console.log(t),()=>console.log("completed"))}createScene(){this.modelString=this.modelfile[this.index].modelstring,this.loader.load("data:application/octet-stream;base64,"+this.modelString,n=>{this.scene.background=new rn(0),this.scene.add(n.scene),this.light.position.set(5,5,5),this.scene.add(this.light),console.log(`gltf : ${n}`)},n=>{console.log(n.loaded/n.total*100+"% loaded")},n=>{console.log(`gltf loading error : ${n}`)});let t=this.getAspectRatio();this.camera=new ua(this.fieldOfView,t,this.nearClippingPlane,this.farClippingPlane),this.camera.position.z=this.cameraZ}getAspectRatio(){return this.canvas.clientWidth/this.canvas.clientHeight}startRenderingLoop(){this.renderer=new rF({canvas:this.canvas}),this.renderer.setPixelRatio(devicePixelRatio),this.renderer.setSize(this.canvas.clientWidth,this.canvas.clientHeight);let t=new T6(this.camera,this.renderer.domElement),n=this;!function r(){requestAnimationFrame(r),t.update(),n.renderer.render(n.scene,n.camera)}()}render(){this.createScene(),this.startRenderingLoop()}return(){this.router.navigate(["/"])}}return i.\u0275fac=function(t){return new(t||i)(w.Y36(CP),w.Y36(Tl))},i.\u0275cmp=w.Xpm({type:i,selectors:[["app-model-render"]],viewQuery:function(t,n){if(1&t&&w.Gf(M6,5),2&t){let r;w.iGM(r=w.CRH())&&(n.canvasref=r.first)}},inputs:{cameraZ:"cameraZ",fieldOfView:"fieldOfView",nearClippingPlane:["nearClipping","nearClippingPlane"],farClippingPlane:["farClipping","farClippingPlane"]},decls:14,vars:0,consts:[[1,"container"],[1,"card","bg-secondary","m-5"],[1,"row","text-center"],[1,"col-6","my-2"],[1,"btn","btn-primary",3,"click"],[1,"row","text-center","text-white"],["id","canvas",2,"height","100%","width","100%"],["canvas",""]],template:function(t,n){1&t&&(w.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),w.NdJ("click",function(){return n.render()}),w._uU(5,"Render"),w.qZA()(),w.TgZ(6,"div",3)(7,"button",4),w.NdJ("click",function(){return n.return()}),w._uU(8,"Return to List"),w.qZA()()(),w.TgZ(9,"div",5)(10,"p"),w._uU(11,"Once the render button is clicked, scroll up & down with mouse to zoom in & out and move mouse to rotate the rendered object below"),w.qZA()()(),w._UZ(12,"canvas",6,7),w.qZA())},styles:[""]}),i})(),N2=(()=>{class i{constructor(t,n){this._renderer=t,this._elementRef=n,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,n){this._renderer.setProperty(this._elementRef.nativeElement,t,n)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return i.\u0275fac=function(t){return new(t||i)(w.Y36(w.Qsj),w.Y36(w.SBq))},i.\u0275dir=w.lG2({type:i}),i})(),m_=(()=>{class i extends N2{}return i.\u0275fac=function(){let e;return function(n){return(e||(e=w.n5z(i)))(n||i)}}(),i.\u0275dir=w.lG2({type:i,features:[w.qOj]}),i})();const Sh=new w.OlP("NgValueAccessor"),D6={provide:Sh,useExisting:(0,w.Gpc)(()=>$A),multi:!0},P6=new w.OlP("CompositionEventMode");let $A=(()=>{class i extends N2{constructor(t,n,r){super(t,n),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function R6(){const i=Y()?Y().getUserAgent():"";return/android (\d+)/.test(i.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return i.\u0275fac=function(t){return new(t||i)(w.Y36(w.Qsj),w.Y36(w.SBq),w.Y36(P6,8))},i.\u0275dir=w.lG2({type:i,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,n){1&t&&w.NdJ("input",function(s){return n._handleInput(s.target.value)})("blur",function(){return n.onTouched()})("compositionstart",function(){return n._compositionStart()})("compositionend",function(s){return n._compositionEnd(s.target.value)})},features:[w._Bn([D6]),w.qOj]}),i})();const Ja=new w.OlP("NgValidators"),Bm=new w.OlP("NgAsyncValidators");function j2(i){return null!=i}function W2(i){const e=(0,w.QGY)(i)?(0,Rt.D)(i):i;return(0,w.CqO)(e),e}function $2(i){let e={};return i.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function q2(i,e){return e.map(t=>t(i))}function K2(i){return i.map(e=>function O6(i){return!i.validate}(e)?e:t=>e.validate(t))}function AP(i){return null!=i?function Z2(i){if(!i)return null;const e=i.filter(j2);return 0==e.length?null:function(t){return $2(q2(t,e))}}(K2(i)):null}function IP(i){return null!=i?function Y2(i){if(!i)return null;const e=i.filter(j2);return 0==e.length?null:function(t){return function A6(...i){const e=(0,Nt.jO)(i),{args:t,keys:n}=bO(i),r=new Tt.y(s=>{const{length:a}=t;if(!a)return void s.complete();const c=new Array(a);let d=a,f=a;for(let g=0;g<a;g++){let v=!1;(0,pE.Xf)(t[g]).subscribe((0,cn.x)(s,b=>{v||(v=!0,f--),c[g]=b},()=>d--,void 0,()=>{(!d||!v)&&(f||s.next(n?EO(n,c):c),s.complete())}))}});return e?r.pipe(xO(e)):r}(q2(t,e).map(W2)).pipe((0,St.U)($2))}}(K2(i)):null}function X2(i,e){return null===i?[e]:Array.isArray(i)?[...i,e]:[i,e]}function DP(i){return i?Array.isArray(i)?i:[i]:[]}function KA(i,e){return Array.isArray(i)?i.includes(e):i===e}function e3(i,e){const t=DP(e);return DP(i).forEach(r=>{KA(t,r)||t.push(r)}),t}function t3(i,e){return DP(e).filter(t=>!KA(i,t))}class n3{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=AP(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=IP(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Hm extends n3{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Pl extends n3{get formDirective(){return null}get path(){return null}}let r3=(()=>{class i extends class i3{constructor(e){this._cd=e}is(e){var t,n,r;return"submitted"===e?!!(null===(t=this._cd)||void 0===t?void 0:t.submitted):!!(null===(r=null===(n=this._cd)||void 0===n?void 0:n.control)||void 0===r?void 0:r[e])}}{constructor(t){super(t)}}return i.\u0275fac=function(t){return new(t||i)(w.Y36(Hm,2))},i.\u0275dir=w.lG2({type:i,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,n){2&t&&w.ekj("ng-untouched",n.is("untouched"))("ng-touched",n.is("touched"))("ng-pristine",n.is("pristine"))("ng-dirty",n.is("dirty"))("ng-valid",n.is("valid"))("ng-invalid",n.is("invalid"))("ng-pending",n.is("pending"))},features:[w.qOj]}),i})();function yS(i,e){(function NP(i,e){const t=function J2(i){return i._rawValidators}(i);null!==e.validator?i.setValidators(X2(t,e.validator)):"function"==typeof t&&i.setValidators([t]);const n=function Q2(i){return i._rawAsyncValidators}(i);null!==e.asyncValidator?i.setAsyncValidators(X2(n,e.asyncValidator)):"function"==typeof n&&i.setAsyncValidators([n]);const r=()=>i.updateValueAndValidity();JA(e._rawValidators,r),JA(e._rawAsyncValidators,r)})(i,e),e.valueAccessor.writeValue(i.value),function G6(i,e){e.valueAccessor.registerOnChange(t=>{i._pendingValue=t,i._pendingChange=!0,i._pendingDirty=!0,"change"===i.updateOn&&o3(i,e)})}(i,e),function W6(i,e){const t=(n,r)=>{e.valueAccessor.writeValue(n),r&&e.viewToModelUpdate(n)};i.registerOnChange(t),e._registerOnDestroy(()=>{i._unregisterOnChange(t)})}(i,e),function j6(i,e){e.valueAccessor.registerOnTouched(()=>{i._pendingTouched=!0,"blur"===i.updateOn&&i._pendingChange&&o3(i,e),"submit"!==i.updateOn&&i.markAsTouched()})}(i,e),function z6(i,e){if(e.valueAccessor.setDisabledState){const t=n=>{e.valueAccessor.setDisabledState(n)};i.registerOnDisabledChange(t),e._registerOnDestroy(()=>{i._unregisterOnDisabledChange(t)})}}(i,e)}function JA(i,e){i.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function o3(i,e){i._pendingDirty&&i.markAsDirty(),i.setValue(i._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1}function kP(i,e){const t=i.indexOf(e);t>-1&&i.splice(t,1)}const _S="VALID",eI="INVALID",yw="PENDING",vS="DISABLED";function VP(i){return(tI(i)?i.validators:i)||null}function u3(i){return Array.isArray(i)?AP(i):i||null}function UP(i,e){return(tI(e)?e.asyncValidators:i)||null}function d3(i){return Array.isArray(i)?IP(i):i||null}function tI(i){return null!=i&&!Array.isArray(i)&&"object"==typeof i}const BP=i=>i instanceof zP;function f3(i){return(i=>i instanceof g3)(i)?i.value:i.getRawValue()}function p3(i,e){const t=BP(i),n=i.controls;if(!(t?Object.keys(n):n).length)throw new w.vHH(1e3,"");if(!n[e])throw new w.vHH(1001,"")}function m3(i,e){BP(i),i._forEachChild((n,r)=>{if(void 0===e[r])throw new w.vHH(1002,"")})}class HP{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=u3(this._rawValidators),this._composedAsyncValidatorFn=d3(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===_S}get invalid(){return this.status===eI}get pending(){return this.status==yw}get disabled(){return this.status===vS}get enabled(){return this.status!==vS}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=u3(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=d3(e)}addValidators(e){this.setValidators(e3(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(e3(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(t3(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(t3(e,this._rawAsyncValidators))}hasValidator(e){return KA(this._rawValidators,e)}hasAsyncValidator(e){return KA(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=yw,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=vS,this.errors=null,this._forEachChild(n=>{n.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=_S,this._forEachChild(n=>{n.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===_S||this.status===yw)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?vS:_S}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=yw,this._hasOwnPendingAsyncValidator=!0;const t=W2(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function Z6(i,e,t){if(null==e||(Array.isArray(e)||(e=e.split(t)),Array.isArray(e)&&0===e.length))return null;let n=i;return e.forEach(r=>{n=BP(n)?n.controls.hasOwnProperty(r)?n.controls[r]:null:(i=>i instanceof X6)(n)&&n.at(r)||null}),n}(this,e,".")}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new w.vpe,this.statusChanges=new w.vpe}_calculateStatus(){return this._allControlsDisabled()?vS:this.errors?eI:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yw)?yw:this._anyControlsHaveStatus(eI)?eI:_S}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){tI(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class g3 extends HP{constructor(e=null,t,n){super(VP(t),UP(n,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),tI(t)&&t.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(n=>n(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){kP(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){kP(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class zP extends HP{constructor(e,t,n){super(VP(t),UP(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,n={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){m3(this,e),Object.keys(e).forEach(n=>{p3(this,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=f3(t),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,n)=>!!n._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const n=this.controls[t];if(this.contains(t)&&e(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,n)=>((t.enabled||this.disabled)&&(e[n]=t.value),e))}_reduceChildren(e,t){let n=e;return this._forEachChild((r,s)=>{n=t(n,r,s)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class X6 extends HP{constructor(e,t,n){super(VP(t),UP(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[e]}push(e,t={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(e,t,n={}){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(e,t,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){m3(this,e),e.forEach((n,r)=>{p3(this,r),this.at(r).setValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((n,r)=>{this.at(r)&&this.at(r).patchValue(n,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,r)=>{n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>f3(e))}clear(e={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_syncPendingControls(){let e=this.controls.reduce((t,n)=>!!n._syncPendingControls()||t,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const e$={provide:Hm,useExisting:(0,w.Gpc)(()=>jP)},v3=(()=>Promise.resolve(null))();let jP=(()=>{class i extends Hm{constructor(t,n,r,s,a){super(),this._changeDetectorRef=a,this.control=new g3,this._registered=!1,this.update=new w.vpe,this._parent=t,this._setValidators(n),this._setAsyncValidators(r),this.valueAccessor=function LP(i,e){if(!e)return null;let t,n,r;return Array.isArray(e),e.forEach(s=>{s.constructor===$A?t=s:function K6(i){return Object.getPrototypeOf(i.constructor)===m_}(s)?n=s:r=s}),r||n||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const n=t.name.previousValue;this.formDirective.removeControl({name:n,path:this._getPath(n)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function OP(i,e){if(!i.hasOwnProperty("model"))return!1;const t=i.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){yS(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){v3.then(()=>{var n;this.control.setValue(t,{emitViewToModelChange:!1}),null===(n=this._changeDetectorRef)||void 0===n||n.markForCheck()})}_updateDisabled(t){const n=t.isDisabled.currentValue,r=""===n||n&&"false"!==n;v3.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(t){return this._parent?function YA(i,e){return[...e.path,i]}(t,this._parent):[t]}}return i.\u0275fac=function(t){return new(t||i)(w.Y36(Pl,9),w.Y36(Ja,10),w.Y36(Bm,10),w.Y36(Sh,10),w.Y36(w.sBO,8))},i.\u0275dir=w.lG2({type:i,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[w._Bn([e$]),w.qOj,w.TTD]}),i})(),b3=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({}),i})(),M$=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({imports:[[b3]]}),i})(),C$=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({imports:[M$]}),i})();function A$(i,e){if(1&i){const t=w.EpF();w.TgZ(0,"tbody")(1,"tr")(2,"th",5),w._uU(3),w.qZA(),w.TgZ(4,"td"),w._uU(5),w.qZA(),w.TgZ(6,"td")(7,"button",6),w.NdJ("click",function(){const s=w.CHM(t).index;return w.oxw().render(s)}),w._uU(8,"Render"),w.qZA()()()()}if(2&i){const t=e.$implicit,n=e.index;w.xp6(3),w.Oqu(n+1),w.xp6(2),w.Oqu(t.filename)}}let I$=(()=>{class i{constructor(t,n){this.mcrs=t,this.router=n,this.modelfile=new Array}ngOnInit(){this.getModelList()}getModelList(){return this.mcrs.receiveModelFile().subscribe(t=>{this.modelfile=t.map(n=>n.payload.doc.data())},t=>console.log(t),()=>console.log("completed"))}render(t){this.mcrs.getIndex(t),this.router.navigate(["/render"])}}return i.\u0275fac=function(t){return new(t||i)(w.Y36(CP),w.Y36(Tl))},i.\u0275cmp=w.Xpm({type:i,selectors:[["app-model-list"]],decls:12,vars:1,consts:[[1,"container","col-8"],[1,"card","bg-secondary"],[1,"table","table-hover","table-striped","text-center","text-white"],["scope","col"],[4,"ngFor","ngForOf"],["scope","row"],[1,"btn","btn-primary",3,"click"]],template:function(t,n){1&t&&(w.TgZ(0,"div",0)(1,"div",1)(2,"table",2)(3,"thead")(4,"tr")(5,"th",3),w._uU(6,"S.No."),w.qZA(),w.TgZ(7,"th",3),w._uU(8,"FileName"),w.qZA(),w.TgZ(9,"th",3),w._uU(10,"Operation"),w.qZA()()(),w.YNc(11,A$,9,2,"tbody",4),w.qZA()()()),2&t&&(w.xp6(11),w.Q6J("ngForOf",n.modelfile))},directives:[ts],styles:[""]}),i})();const D$=[{path:"",component:(()=>{class i{constructor(t){this.mcrs=t,this.filename="",this.modelString="",this.msg=""}ngOnInit(){}onFileChange(t){if(t.target.files.length>0){this.file=t.target.files[0];let n=new FileReader;n.readAsBinaryString(this.file),n.onload=()=>{this.modelString=btoa(n.result)}}}submit(){this.mcrs.uploadModelFile(this.modelString,this.filename),this.msg="File uploaded successfully"}}return i.\u0275fac=function(t){return new(t||i)(w.Y36(CP))},i.\u0275cmp=w.Xpm({type:i,selectors:[["app-model-upload"]],decls:15,vars:2,consts:[[1,"container","col-8","my-5"],[1,"card","bg-secondary","p-3"],[1,"form-group"],["for","name"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["for","file"],["id","file","type","file",1,"form-control",3,"change"],[1,"btn","btn-primary","my-2",3,"click"],[1,"text-white","text-center"]],template:function(t,n){1&t&&(w.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"label",3),w._uU(4,"Name"),w.qZA(),w.TgZ(5,"input",4),w.NdJ("ngModelChange",function(s){return n.filename=s}),w.qZA()(),w.TgZ(6,"div",2)(7,"label",5),w._uU(8,"File"),w.qZA(),w.TgZ(9,"input",6),w.NdJ("change",function(s){return n.onFileChange(s)}),w.qZA()(),w.TgZ(10,"button",7),w.NdJ("click",function(){return n.submit()}),w._uU(11,"Submit"),w.qZA(),w.TgZ(12,"p",8),w._uU(13),w.qZA()()(),w._UZ(14,"app-model-list")),2&t&&(w.xp6(5),w.Q6J("ngModel",n.filename),w.xp6(8),w.Oqu(n.msg))},directives:[$A,r3,jP,I$],styles:[""]}),i})()},{path:"render",component:C6}];let R$=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({imports:[[ML.forRoot(D$,{useHash:!0})],ML]}),i})(),P$=(()=>{class i{constructor(){this.title="modelapp"}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=w.Xpm({type:i,selectors:[["app-root"]],decls:1,vars:0,template:function(t,n){1&t&&w._UZ(0,"router-outlet")},directives:[$1],styles:[""]}),i})(),N$=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i}),i.\u0275inj=w.cJS({imports:[[nu,C$]]}),i})();const O$_firebaseConfig={apiKey:"AIzaSyAQhFnsYmN59nTvOdueKnxwJzLOtaMinZA",authDomain:"threedmodelapp.firebaseapp.com",projectId:"threedmodelapp",storageBucket:"threedmodelapp.appspot.com",messagingSenderId:"717687884805",appId:"1:717687884805:web:13d0e21b51bafb991fe06c"};let L$=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=w.oAB({type:i,bootstrap:[P$]}),i.\u0275inj=w.cJS({providers:[],imports:[[Wl,R$,N$,Rc,Dr.hO.initializeApp(O$_firebaseConfig),SV]]}),i})();K(3722),(0,w.G48)(),Cc().bootstrapModule(L$).catch(i=>console.error(i))},3722:function(hn){hn.exports=function(){"use strict";const Ze="transitionend",K=H=>{let T=H.getAttribute("data-bs-target");if(!T||"#"===T){let N=H.getAttribute("href");if(!N||!N.includes("#")&&!N.startsWith("."))return null;N.includes("#")&&!N.startsWith("#")&&(N=`#${N.split("#")[1]}`),T=N&&"#"!==N?N.trim():null}return T},w=H=>{const T=K(H);return T&&document.querySelector(T)?T:null},be=H=>{const T=K(H);return T?document.querySelector(T):null},Y=H=>{H.dispatchEvent(new Event(Ze))},Oe=H=>!(!H||"object"!=typeof H)&&(void 0!==H.jquery&&(H=H[0]),void 0!==H.nodeType),Ae=H=>Oe(H)?H.jquery?H[0]:H:"string"==typeof H&&H.length>0?document.querySelector(H):null,Ve=(H,T,N)=>{Object.keys(N).forEach(q=>{const re=N[q],me=T[q],De=me&&Oe(me)?"element":null==(yt=me)?`${yt}`:{}.toString.call(yt).match(/\s([a-z]+)/i)[1].toLowerCase();var yt;if(!new RegExp(re).test(De))throw new TypeError(`${H.toUpperCase()}: Option "${q}" provided type "${De}" but expected type "${re}".`)})},Fe=H=>!(!Oe(H)||0===H.getClientRects().length)&&"visible"===getComputedStyle(H).getPropertyValue("visibility"),Ne=H=>!H||H.nodeType!==Node.ELEMENT_NODE||!!H.classList.contains("disabled")||(void 0!==H.disabled?H.disabled:H.hasAttribute("disabled")&&"false"!==H.getAttribute("disabled")),Be=H=>{if(!document.documentElement.attachShadow)return null;if("function"==typeof H.getRootNode){const T=H.getRootNode();return T instanceof ShadowRoot?T:null}return H instanceof ShadowRoot?H:H.parentNode?Be(H.parentNode):null},ue=()=>{},Ce=()=>{const{jQuery:H}=window;return H&&!document.body.hasAttribute("data-bs-no-jquery")?H:null},Gt=[],tt=()=>"rtl"===document.documentElement.dir,pt=H=>{var T;T=()=>{const N=Ce();if(N){const q=H.NAME,re=N.fn[q];N.fn[q]=H.jQueryInterface,N.fn[q].Constructor=H,N.fn[q].noConflict=()=>(N.fn[q]=re,H.jQueryInterface)}},"loading"===document.readyState?(Gt.length||document.addEventListener("DOMContentLoaded",()=>{Gt.forEach(N=>N())}),Gt.push(T)):T()},Ot=H=>{"function"==typeof H&&H()},ze=(H,T,N=!0)=>{if(!N)return void Ot(H);const q=(De=>{if(!De)return 0;let{transitionDuration:yt,transitionDelay:Nt}=window.getComputedStyle(De);const Rt=Number.parseFloat(yt),qe=Number.parseFloat(Nt);return Rt||qe?(yt=yt.split(",")[0],Nt=Nt.split(",")[0],1e3*(Number.parseFloat(yt)+Number.parseFloat(Nt))):0})(T)+5;let re=!1;const me=({target:De})=>{De===T&&(re=!0,T.removeEventListener(Ze,me),Ot(H))};T.addEventListener(Ze,me),setTimeout(()=>{re||Y(T)},q)},at=(H,T,N,q)=>{let re=H.indexOf(T);if(-1===re)return H[!N&&q?H.length-1:0];const me=H.length;return re+=N?1:-1,q&&(re=(re+me)%me),H[Math.max(0,Math.min(re,me-1))]},qt=/[^.]*(?=\..*)\.|.*/,nn=/\..*/,lt=/::\d+$/,Ye={};let st=1;const Bt={mouseenter:"mouseover",mouseleave:"mouseout"},Ut=/^(mouseenter|mouseleave)/i,ce=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Xe(H,T){return T&&`${T}::${st++}`||H.uidEvent||st++}function ve(H){const T=Xe(H);return H.uidEvent=T,Ye[T]=Ye[T]||{},Ye[T]}function Re(H,T,N=null){const q=Object.keys(H);for(let re=0,me=q.length;re<me;re++){const De=H[q[re]];if(De.originalHandler===T&&De.delegationSelector===N)return De}return null}function Te(H,T,N){const q="string"==typeof T,re=q?N:T;let me=It(H);return ce.has(me)||(me=H),[q,re,me]}function We(H,T,N,q,re){if("string"!=typeof T||!H)return;if(N||(N=q,q=null),Ut.test(T)){const mn=bn=>function(vn){if(!vn.relatedTarget||vn.relatedTarget!==vn.delegateTarget&&!vn.delegateTarget.contains(vn.relatedTarget))return bn.call(this,vn)};q?q=mn(q):N=mn(N)}const[me,De,yt]=Te(T,N,q),Nt=ve(H),Rt=Nt[yt]||(Nt[yt]={}),qe=Re(Rt,De,me?N:null);if(qe)return void(qe.oneOff=qe.oneOff&&re);const Tt=Xe(De,T.replace(qt,"")),En=me?(mn=H,bn=N,vn=q,function cn(ri){const St=mn.querySelectorAll(bn);for(let{target:Gn}=ri;Gn&&Gn!==this;Gn=Gn.parentNode)for(let Qn=St.length;Qn--;)if(St[Qn]===Gn)return ri.delegateTarget=Gn,cn.oneOff&&Pe.off(mn,ri.type,bn,vn),vn.apply(Gn,[ri]);return null}):function(mn,bn){return function vn(cn){return cn.delegateTarget=mn,vn.oneOff&&Pe.off(mn,cn.type,bn),bn.apply(mn,[cn])}}(H,N);var mn,bn,vn;En.delegationSelector=me?N:null,En.originalHandler=De,En.oneOff=re,En.uidEvent=Tt,Rt[Tt]=En,H.addEventListener(yt,En,me)}function ke(H,T,N,q,re){const me=Re(T[N],q,re);me&&(H.removeEventListener(N,me,Boolean(re)),delete T[N][me.uidEvent])}function It(H){return H=H.replace(nn,""),Bt[H]||H}const Pe={on(H,T,N,q){We(H,T,N,q,!1)},one(H,T,N,q){We(H,T,N,q,!0)},off(H,T,N,q){if("string"!=typeof T||!H)return;const[re,me,De]=Te(T,N,q),yt=De!==T,Nt=ve(H),Rt=T.startsWith(".");if(void 0!==me)return Nt&&Nt[De]?void ke(H,Nt,De,me,re?N:null):void 0;Rt&&Object.keys(Nt).forEach(Tt=>{!function(En,mn,bn,vn){const cn=mn[bn]||{};Object.keys(cn).forEach(ri=>{if(ri.includes(vn)){const St=cn[ri];ke(En,mn,bn,St.originalHandler,St.delegationSelector)}})}(H,Nt,Tt,T.slice(1))});const qe=Nt[De]||{};Object.keys(qe).forEach(Tt=>{const En=Tt.replace(lt,"");if(!yt||T.includes(En)){const mn=qe[Tt];ke(H,Nt,De,mn.originalHandler,mn.delegationSelector)}})},trigger(H,T,N){if("string"!=typeof T||!H)return null;const q=Ce(),re=It(T),me=T!==re,De=ce.has(re);let yt,Nt=!0,Rt=!0,qe=!1,Tt=null;return me&&q&&(yt=q.Event(T,N),q(H).trigger(yt),Nt=!yt.isPropagationStopped(),Rt=!yt.isImmediatePropagationStopped(),qe=yt.isDefaultPrevented()),De?(Tt=document.createEvent("HTMLEvents"),Tt.initEvent(re,Nt,!0)):Tt=new CustomEvent(T,{bubbles:Nt,cancelable:!0}),void 0!==N&&Object.keys(N).forEach(En=>{Object.defineProperty(Tt,En,{get:()=>N[En]})}),qe&&Tt.preventDefault(),Rt&&H.dispatchEvent(Tt),Tt.defaultPrevented&&void 0!==yt&&yt.preventDefault(),Tt}},ni=new Map,ii={set(H,T,N){ni.has(H)||ni.set(H,new Map);const q=ni.get(H);q.has(T)||0===q.size?q.set(T,N):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(q.keys())[0]}.`)},get:(H,T)=>ni.has(H)&&ni.get(H).get(T)||null,remove(H,T){if(!ni.has(H))return;const N=ni.get(H);N.delete(T),0===N.size&&ni.delete(H)}};class Ht{constructor(T){(T=Ae(T))&&(this._element=T,ii.set(this._element,this.constructor.DATA_KEY,this))}dispose(){ii.remove(this._element,this.constructor.DATA_KEY),Pe.off(this._element,this.constructor.EVENT_KEY),Object.getOwnPropertyNames(this).forEach(T=>{this[T]=null})}_queueCallback(T,N,q=!0){ze(T,N,q)}static getInstance(T){return ii.get(Ae(T),this.DATA_KEY)}static getOrCreateInstance(T,N={}){return this.getInstance(T)||new this(T,"object"==typeof N?N:null)}static get VERSION(){return"5.1.3"}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}}const Ci=(H,T="hide")=>{const q=H.NAME;Pe.on(document,`click.dismiss${H.EVENT_KEY}`,`[data-bs-dismiss="${q}"]`,function(re){if(["A","AREA"].includes(this.tagName)&&re.preventDefault(),Ne(this))return;const me=be(this)||this.closest(`.${q}`);H.getOrCreateInstance(me)[T]()})};class nr extends Ht{static get NAME(){return"alert"}close(){if(Pe.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const T=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,T)}_destroyElement(){this._element.remove(),Pe.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(T){return this.each(function(){const N=nr.getOrCreateInstance(this);if("string"==typeof T){if(void 0===N[T]||T.startsWith("_")||"constructor"===T)throw new TypeError(`No method named "${T}"`);N[T](this)}})}}Ci(nr,"close"),pt(nr);const $i='[data-bs-toggle="button"]';class _i extends Ht{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(T){return this.each(function(){const N=_i.getOrCreateInstance(this);"toggle"===T&&N[T]()})}}function xs(H){return"true"===H||"false"!==H&&(H===Number(H).toString()?Number(H):""===H||"null"===H?null:H)}function vi(H){return H.replace(/[A-Z]/g,T=>`-${T.toLowerCase()}`)}Pe.on(document,"click.bs.button.data-api",$i,H=>{H.preventDefault();const T=H.target.closest($i);_i.getOrCreateInstance(T).toggle()}),pt(_i);const An={setDataAttribute(H,T,N){H.setAttribute(`data-bs-${vi(T)}`,N)},removeDataAttribute(H,T){H.removeAttribute(`data-bs-${vi(T)}`)},getDataAttributes(H){if(!H)return{};const T={};return Object.keys(H.dataset).filter(N=>N.startsWith("bs")).forEach(N=>{let q=N.replace(/^bs/,"");q=q.charAt(0).toLowerCase()+q.slice(1,q.length),T[q]=xs(H.dataset[N])}),T},getDataAttribute:(H,T)=>xs(H.getAttribute(`data-bs-${vi(T)}`)),offset(H){const T=H.getBoundingClientRect();return{top:T.top+window.pageYOffset,left:T.left+window.pageXOffset}},position:H=>({top:H.offsetTop,left:H.offsetLeft})},Tn={find:(H,T=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(T,H)),findOne:(H,T=document.documentElement)=>Element.prototype.querySelector.call(T,H),children:(H,T)=>[].concat(...H.children).filter(N=>N.matches(T)),parents(H,T){const N=[];let q=H.parentNode;for(;q&&q.nodeType===Node.ELEMENT_NODE&&3!==q.nodeType;)q.matches(T)&&N.push(q),q=q.parentNode;return N},prev(H,T){let N=H.previousElementSibling;for(;N;){if(N.matches(T))return[N];N=N.previousElementSibling}return[]},next(H,T){let N=H.nextElementSibling;for(;N;){if(N.matches(T))return[N];N=N.nextElementSibling}return[]},focusableChildren(H){const T=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(N=>`${N}:not([tabindex^="-"])`).join(", ");return this.find(T,H).filter(N=>!Ne(N)&&Fe(N))}},Ys="carousel",as={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},Ls={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},ls="next",ks="prev",Br="left",Es="right",Pn={ArrowLeft:Es,ArrowRight:Br},Xs="slid.bs.carousel",qi="active",ar=".active.carousel-item";class cs extends Ht{constructor(T,N){super(T),this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(N),this._indicatorsElement=Tn.findOne(".carousel-indicators",this._element),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent),this._addEventListeners()}static get Default(){return as}static get NAME(){return Ys}next(){this._slide(ls)}nextWhenVisible(){!document.hidden&&Fe(this._element)&&this.next()}prev(){this._slide(ks)}pause(T){T||(this._isPaused=!0),Tn.findOne(".carousel-item-next, .carousel-item-prev",this._element)&&(Y(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null}cycle(T){T||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config&&this._config.interval&&!this._isPaused&&(this._updateInterval(),this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))}to(T){this._activeElement=Tn.findOne(ar,this._element);const N=this._getItemIndex(this._activeElement);if(!(T>this._items.length-1||T<0)){if(!this._isSliding)return N===T?(this.pause(),void this.cycle()):void this._slide(T>N?ls:ks,this._items[T]);Pe.one(this._element,Xs,()=>this.to(T))}}_getConfig(T){return T=Si(Si(Si({},as),An.getDataAttributes(this._element)),"object"==typeof T?T:{}),Ve(Ys,T,Ls),T}_handleSwipe(){const T=Math.abs(this.touchDeltaX);if(T<=40)return;const N=T/this.touchDeltaX;this.touchDeltaX=0,N&&this._slide(N>0?Es:Br)}_addEventListeners(){this._config.keyboard&&Pe.on(this._element,"keydown.bs.carousel",T=>this._keydown(T)),"hover"===this._config.pause&&(Pe.on(this._element,"mouseenter.bs.carousel",T=>this.pause(T)),Pe.on(this._element,"mouseleave.bs.carousel",T=>this.cycle(T))),this._config.touch&&this._touchSupported&&this._addTouchEventListeners()}_addTouchEventListeners(){const T=me=>this._pointerEvent&&("pen"===me.pointerType||"touch"===me.pointerType),N=me=>{T(me)?this.touchStartX=me.clientX:this._pointerEvent||(this.touchStartX=me.touches[0].clientX)},q=me=>{this.touchDeltaX=me.touches&&me.touches.length>1?0:me.touches[0].clientX-this.touchStartX},re=me=>{T(me)&&(this.touchDeltaX=me.clientX-this.touchStartX),this._handleSwipe(),"hover"===this._config.pause&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(De=>this.cycle(De),500+this._config.interval))};Tn.find(".carousel-item img",this._element).forEach(me=>{Pe.on(me,"dragstart.bs.carousel",De=>De.preventDefault())}),this._pointerEvent?(Pe.on(this._element,"pointerdown.bs.carousel",me=>N(me)),Pe.on(this._element,"pointerup.bs.carousel",me=>re(me)),this._element.classList.add("pointer-event")):(Pe.on(this._element,"touchstart.bs.carousel",me=>N(me)),Pe.on(this._element,"touchmove.bs.carousel",me=>q(me)),Pe.on(this._element,"touchend.bs.carousel",me=>re(me)))}_keydown(T){if(/input|textarea/i.test(T.target.tagName))return;const N=Pn[T.key];N&&(T.preventDefault(),this._slide(N))}_getItemIndex(T){return this._items=T&&T.parentNode?Tn.find(".carousel-item",T.parentNode):[],this._items.indexOf(T)}_getItemByOrder(T,N){return at(this._items,N,T===ls,this._config.wrap)}_triggerSlideEvent(T,N){const q=this._getItemIndex(T),re=this._getItemIndex(Tn.findOne(ar,this._element));return Pe.trigger(this._element,"slide.bs.carousel",{relatedTarget:T,direction:N,from:re,to:q})}_setActiveIndicatorElement(T){if(this._indicatorsElement){const N=Tn.findOne(".active",this._indicatorsElement);N.classList.remove(qi),N.removeAttribute("aria-current");const q=Tn.find("[data-bs-target]",this._indicatorsElement);for(let re=0;re<q.length;re++)if(Number.parseInt(q[re].getAttribute("data-bs-slide-to"),10)===this._getItemIndex(T)){q[re].classList.add(qi),q[re].setAttribute("aria-current","true");break}}}_updateInterval(){const T=this._activeElement||Tn.findOne(ar,this._element);if(!T)return;const N=Number.parseInt(T.getAttribute("data-bs-interval"),10);N?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=N):this._config.interval=this._config.defaultInterval||this._config.interval}_slide(T,N){const q=this._directionToOrder(T),re=Tn.findOne(ar,this._element),me=this._getItemIndex(re),De=N||this._getItemByOrder(q,re),yt=this._getItemIndex(De),Nt=Boolean(this._interval),Rt=q===ls,qe=Rt?"carousel-item-start":"carousel-item-end",Tt=Rt?"carousel-item-next":"carousel-item-prev",En=this._orderToDirection(q);if(De&&De.classList.contains(qi))return void(this._isSliding=!1);if(this._isSliding||this._triggerSlideEvent(De,En).defaultPrevented||!re||!De)return;this._isSliding=!0,Nt&&this.pause(),this._setActiveIndicatorElement(De),this._activeElement=De;const mn=()=>{Pe.trigger(this._element,Xs,{relatedTarget:De,direction:En,from:me,to:yt})};this._element.classList.contains("slide")?(De.classList.add(Tt),re.classList.add(qe),De.classList.add(qe),this._queueCallback(()=>{De.classList.remove(qe,Tt),De.classList.add(qi),re.classList.remove(qi,Tt,qe),this._isSliding=!1,setTimeout(mn,0)},re,!0)):(re.classList.remove(qi),De.classList.add(qi),this._isSliding=!1,mn()),Nt&&this.cycle()}_directionToOrder(T){return[Es,Br].includes(T)?tt()?T===Br?ks:ls:T===Br?ls:ks:T}_orderToDirection(T){return[ls,ks].includes(T)?tt()?T===ks?Br:Es:T===ks?Es:Br:T}static carouselInterface(T,N){const q=cs.getOrCreateInstance(T,N);let{_config:re}=q;"object"==typeof N&&(re=Si(Si({},re),N));const me="string"==typeof N?N:re.slide;if("number"==typeof N)q.to(N);else if("string"==typeof me){if(void 0===q[me])throw new TypeError(`No method named "${me}"`);q[me]()}else re.interval&&re.ride&&(q.pause(),q.cycle())}static jQueryInterface(T){return this.each(function(){cs.carouselInterface(this,T)})}static dataApiClickHandler(T){const N=be(this);if(!N||!N.classList.contains("carousel"))return;const q=Si(Si({},An.getDataAttributes(N)),An.getDataAttributes(this)),re=this.getAttribute("data-bs-slide-to");re&&(q.interval=!1),cs.carouselInterface(N,q),re&&cs.getInstance(N).to(re),T.preventDefault()}}Pe.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",cs.dataApiClickHandler),Pe.on(window,"load.bs.carousel.data-api",()=>{const H=Tn.find('[data-bs-ride="carousel"]');for(let T=0,N=H.length;T<N;T++)cs.carouselInterface(H[T],cs.getInstance(H[T]))}),pt(cs);const Js="collapse",Hr={toggle:!0,parent:null},Pr={toggle:"boolean",parent:"(null|element)"},Qs="show",da="collapse",gi="collapsing",_n="collapsed",On=":scope .collapse .collapse",Jr='[data-bs-toggle="collapse"]';class zr extends Ht{constructor(T,N){super(T),this._isTransitioning=!1,this._config=this._getConfig(N),this._triggerArray=[];const q=Tn.find(Jr);for(let re=0,me=q.length;re<me;re++){const De=q[re],yt=w(De),Nt=Tn.find(yt).filter(Rt=>Rt===this._element);null!==yt&&Nt.length&&(this._selector=yt,this._triggerArray.push(De))}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Hr}static get NAME(){return Js}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let T,N=[];if(this._config.parent){const De=Tn.find(On,this._config.parent);N=Tn.find(".collapse.show, .collapse.collapsing",this._config.parent).filter(yt=>!De.includes(yt))}const q=Tn.findOne(this._selector);if(N.length){const De=N.find(yt=>q!==yt);if(T=De?zr.getInstance(De):null,T&&T._isTransitioning)return}if(Pe.trigger(this._element,"show.bs.collapse").defaultPrevented)return;N.forEach(De=>{q!==De&&zr.getOrCreateInstance(De,{toggle:!1}).hide(),T||ii.set(De,"bs.collapse",null)});const re=this._getDimension();this._element.classList.remove(da),this._element.classList.add(gi),this._element.style[re]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const me=`scroll${re[0].toUpperCase()+re.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(gi),this._element.classList.add(da,Qs),this._element.style[re]="",Pe.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[re]=`${this._element[me]}px`}hide(){if(this._isTransitioning||!this._isShown()||Pe.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const T=this._getDimension();this._element.style[T]=`${this._element.getBoundingClientRect()[T]}px`,this._element.classList.add(gi),this._element.classList.remove(da,Qs);const N=this._triggerArray.length;for(let q=0;q<N;q++){const re=this._triggerArray[q],me=be(re);me&&!this._isShown(me)&&this._addAriaAndCollapsedClass([re],!1)}this._isTransitioning=!0,this._element.style[T]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(gi),this._element.classList.add(da),Pe.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}_isShown(T=this._element){return T.classList.contains(Qs)}_getConfig(T){return(T=Si(Si(Si({},Hr),An.getDataAttributes(this._element)),T)).toggle=Boolean(T.toggle),T.parent=Ae(T.parent),Ve(Js,T,Pr),T}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const T=Tn.find(On,this._config.parent);Tn.find(Jr,this._config.parent).filter(N=>!T.includes(N)).forEach(N=>{const q=be(N);q&&this._addAriaAndCollapsedClass([N],this._isShown(q))})}_addAriaAndCollapsedClass(T,N){T.length&&T.forEach(q=>{N?q.classList.remove(_n):q.classList.add(_n),q.setAttribute("aria-expanded",N)})}static jQueryInterface(T){return this.each(function(){const N={};"string"==typeof T&&/show|hide/.test(T)&&(N.toggle=!1);const q=zr.getOrCreateInstance(this,N);if("string"==typeof T){if(void 0===q[T])throw new TypeError(`No method named "${T}"`);q[T]()}})}}Pe.on(document,"click.bs.collapse.data-api",Jr,function(H){("A"===H.target.tagName||H.delegateTarget&&"A"===H.delegateTarget.tagName)&&H.preventDefault();const T=w(this);Tn.find(T).forEach(N=>{zr.getOrCreateInstance(N,{toggle:!1}).toggle()})}),pt(zr);var kn="top",Nr="bottom",Ki="right",Hi="left",oe="auto",fe=[kn,Nr,Ki,Hi],pe="start",et="end",he="clippingParents",Ee="viewport",ct="popper",sn="reference",wn=fe.reduce(function(H,T){return H.concat([T+"-"+pe,T+"-"+et])},[]),Ln=[].concat(fe,[oe]).reduce(function(H,T){return H.concat([T,T+"-"+pe,T+"-"+et])},[]),Ji="beforeRead",Or="afterRead",Ss="beforeMain",Ll="afterMain",mc="beforeWrite",Lr="afterWrite",Ts=[Ji,"read",Or,Ss,"main",Ll,mc,"write",Lr];function Gr(H){return H?(H.nodeName||"").toLowerCase():null}function zi(H){if(null==H)return window;if("[object Window]"!==H.toString()){var T=H.ownerDocument;return T&&T.defaultView||window}return H}function Qr(H){return H instanceof zi(H).Element||H instanceof Element}function eo(H){return H instanceof zi(H).HTMLElement||H instanceof HTMLElement}function Da(H){return"undefined"!=typeof ShadowRoot&&(H instanceof zi(H).ShadowRoot||H instanceof ShadowRoot)}const Qa={name:"applyStyles",enabled:!0,phase:"write",fn:function(H){var T=H.state;Object.keys(T.elements).forEach(function(N){var q=T.styles[N]||{},re=T.attributes[N]||{},me=T.elements[N];eo(me)&&Gr(me)&&(Object.assign(me.style,q),Object.keys(re).forEach(function(De){var yt=re[De];!1===yt?me.removeAttribute(De):me.setAttribute(De,!0===yt?"":yt)}))})},effect:function(H){var T=H.state,N={popper:{position:T.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(T.elements.popper.style,N.popper),T.styles=N,T.elements.arrow&&Object.assign(T.elements.arrow.style,N.arrow),function(){Object.keys(T.elements).forEach(function(q){var re=T.elements[q],me=T.attributes[q]||{},De=Object.keys(T.styles.hasOwnProperty(q)?T.styles[q]:N[q]).reduce(function(yt,Nt){return yt[Nt]="",yt},{});eo(re)&&Gr(re)&&(Object.assign(re.style,De),Object.keys(me).forEach(function(yt){re.removeAttribute(yt)}))})}},requires:["computeStyles"]};function es(H){return H.split("-")[0]}function wr(H,T){var N=H.getBoundingClientRect();return{width:N.width/1,height:N.height/1,top:N.top/1,right:N.right/1,bottom:N.bottom/1,left:N.left/1,x:N.left/1,y:N.top/1}}function Ra(H){var T=wr(H),N=H.offsetWidth,q=H.offsetHeight;return Math.abs(T.width-N)<=1&&(N=T.width),Math.abs(T.height-q)<=1&&(q=T.height),{x:H.offsetLeft,y:H.offsetTop,width:N,height:q}}function Fs(H,T){var N=T.getRootNode&&T.getRootNode();if(H.contains(T))return!0;if(N&&Da(N)){var q=T;do{if(q&&H.isSameNode(q))return!0;q=q.parentNode||q.host}while(q)}return!1}function Vt(H){return zi(H).getComputedStyle(H)}function xn(H){return["table","td","th"].indexOf(Gr(H))>=0}function yi(H){return((Qr(H)?H.ownerDocument:H.document)||window.document).documentElement}function us(H){return"html"===Gr(H)?H:H.assignedSlot||H.parentNode||(Da(H)?H.host:null)||yi(H)}function Lo(H){return eo(H)&&"fixed"!==Vt(H).position?H.offsetParent:null}function lr(H){for(var T=zi(H),N=Lo(H);N&&xn(N)&&"static"===Vt(N).position;)N=Lo(N);return N&&("html"===Gr(N)||"body"===Gr(N)&&"static"===Vt(N).position)?T:N||function(q){var re=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&eo(q)&&"fixed"===Vt(q).position)return null;for(var me=us(q);eo(me)&&["html","body"].indexOf(Gr(me))<0;){var De=Vt(me);if("none"!==De.transform||"none"!==De.perspective||"paint"===De.contain||-1!==["transform","perspective"].indexOf(De.willChange)||re&&"filter"===De.willChange||re&&De.filter&&"none"!==De.filter)return me;me=me.parentNode}return null}(H)||T}function po(H){return["top","bottom"].indexOf(H)>=0?"x":"y"}var Ai=Math.max,Ms=Math.min,cr=Math.round;function zn(H,T,N){return Ai(H,Ms(T,N))}function el(H){return Object.assign({},{top:0,right:0,bottom:0,left:0},H)}function ha(H,T){return T.reduce(function(N,q){return N[q]=H,N},{})}const gc={name:"arrow",enabled:!0,phase:"main",fn:function(H){var T,Pi,Xi,N=H.state,q=H.name,re=H.options,me=N.elements.arrow,De=N.modifiersData.popperOffsets,yt=es(N.placement),Nt=po(yt),Rt=[Hi,Ki].indexOf(yt)>=0?"height":"width";if(me&&De){var qe=(Xi=N,el("number"!=typeof(Pi="function"==typeof(Pi=re.padding)?Pi(Object.assign({},Xi.rects,{placement:Xi.placement})):Pi)?Pi:ha(Pi,fe))),Tt=Ra(me),En="y"===Nt?kn:Hi,mn="y"===Nt?Nr:Ki,bn=N.rects.reference[Rt]+N.rects.reference[Nt]-De[Nt]-N.rects.popper[Rt],vn=De[Nt]-N.rects.reference[Nt],cn=lr(me),ri=cn?"y"===Nt?cn.clientHeight||0:cn.clientWidth||0:0,qn=ri/2-Tt[Rt]/2+(bn/2-vn/2),li=zn(qe[En],qn,ri-Tt[Rt]-qe[mn]);N.modifiersData[q]=((T={})[Nt]=li,T.centerOffset=li-qn,T)}},effect:function(H){var T=H.state,N=H.options.element,q=void 0===N?"[data-popper-arrow]":N;null!=q&&("string"!=typeof q||(q=T.elements.popper.querySelector(q)))&&Fs(T.elements.popper,q)&&(T.elements.arrow=q)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function to(H){return H.split("-")[1]}var ts={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Pa(H){var T,dr,rr,Zi,N=H.popper,q=H.popperRect,re=H.placement,me=H.variation,De=H.offsets,yt=H.position,Nt=H.gpuAcceleration,Rt=H.adaptive,qe=H.roundOffsets,Tt=!0===qe?(rr=(dr=De).y,Zi=window.devicePixelRatio||1,{x:cr(cr(dr.x*Zi)/Zi)||0,y:cr(cr(rr*Zi)/Zi)||0}):"function"==typeof qe?qe(De):De,En=Tt.x,mn=void 0===En?0:En,bn=Tt.y,vn=void 0===bn?0:bn,cn=De.hasOwnProperty("x"),ri=De.hasOwnProperty("y"),St=Hi,Gn=kn,Qn=window;if(Rt){var qn=lr(N),li="clientHeight",Ii="clientWidth";qn===zi(N)&&"static"!==Vt(qn=yi(N)).position&&"absolute"===yt&&(li="scrollHeight",Ii="scrollWidth"),qn=qn,re!==kn&&(re!==Hi&&re!==Ki||me!==et)||(Gn=Nr,vn-=qn[li]-q.height,vn*=Nt?1:-1),re!==Hi&&(re!==kn&&re!==Nr||me!==et)||(St=Ki,mn-=qn[Ii]-q.width,mn*=Nt?1:-1)}var Pi,Xi=Object.assign({position:yt},Rt&&ts);return Object.assign({},Xi,Nt?((Pi={})[Gn]=ri?"0":"",Pi[St]=cn?"0":"",Pi.transform=(Qn.devicePixelRatio||1)<=1?"translate("+mn+"px, "+vn+"px)":"translate3d("+mn+"px, "+vn+"px, 0)",Pi):((T={})[Gn]=ri?vn+"px":"",T[St]=cn?mn+"px":"",T.transform="",T))}const Yo={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(H){var T=H.state,N=H.options,q=N.gpuAcceleration,re=void 0===q||q,me=N.adaptive,De=void 0===me||me,yt=N.roundOffsets,Nt=void 0===yt||yt,Rt={placement:es(T.placement),variation:to(T.placement),popper:T.elements.popper,popperRect:T.rects.popper,gpuAcceleration:re};null!=T.modifiersData.popperOffsets&&(T.styles.popper=Object.assign({},T.styles.popper,Pa(Object.assign({},Rt,{offsets:T.modifiersData.popperOffsets,position:T.options.strategy,adaptive:De,roundOffsets:Nt})))),null!=T.modifiersData.arrow&&(T.styles.arrow=Object.assign({},T.styles.arrow,Pa(Object.assign({},Rt,{offsets:T.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:Nt})))),T.attributes.popper=Object.assign({},T.attributes.popper,{"data-popper-placement":T.placement})},data:{}};var jr={passive:!0};const Gi={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(H){var T=H.state,N=H.instance,q=H.options,re=q.scroll,me=void 0===re||re,De=q.resize,yt=void 0===De||De,Nt=zi(T.elements.popper),Rt=[].concat(T.scrollParents.reference,T.scrollParents.popper);return me&&Rt.forEach(function(qe){qe.addEventListener("scroll",N.update,jr)}),yt&&Nt.addEventListener("resize",N.update,jr),function(){me&&Rt.forEach(function(qe){qe.removeEventListener("scroll",N.update,jr)}),yt&&Nt.removeEventListener("resize",N.update,jr)}},data:{}};var Jc={left:"right",right:"left",bottom:"top",top:"bottom"};function Na(H){return H.replace(/left|right|bottom|top/g,function(T){return Jc[T]})}var no={start:"end",end:"start"};function ko(H){return H.replace(/start|end/g,function(T){return no[T]})}function Fl(H){var T=zi(H);return{scrollLeft:T.pageXOffset,scrollTop:T.pageYOffset}}function Qc(H){return wr(yi(H)).left+Fl(H).scrollLeft}function mo(H){var T=Vt(H);return/auto|scroll|overlay|hidden/.test(T.overflow+T.overflowY+T.overflowX)}function Fo(H){return["html","body","#document"].indexOf(Gr(H))>=0?H.ownerDocument.body:eo(H)&&mo(H)?H:Fo(us(H))}function tl(H,T){var N;void 0===T&&(T=[]);var q=Fo(H),re=q===(null==(N=H.ownerDocument)?void 0:N.body),me=zi(q),De=re?[me].concat(me.visualViewport||[],mo(q)?q:[]):q,yt=T.concat(De);return re?yt:yt.concat(tl(us(De)))}function Cd(H){return Object.assign({},H,{left:H.x,top:H.y,right:H.x+H.width,bottom:H.y+H.height})}function ku(H,T){return T===Ee?Cd((q=zi(N=H),De=(re=yi(N)).clientWidth,yt=re.clientHeight,Nt=0,Rt=0,(me=q.visualViewport)&&(De=me.width,yt=me.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(Nt=me.offsetLeft,Rt=me.offsetTop)),{width:De,height:yt,x:Nt+Qc(N),y:Rt})):eo(T)?function(N){var q=wr(N);return q.top=q.top+N.clientTop,q.left=q.left+N.clientLeft,q.bottom=q.top+N.clientHeight,q.right=q.left+N.clientWidth,q.width=N.clientWidth,q.height=N.clientHeight,q.x=q.left,q.y=q.top,q}(T):Cd(function(N){var q,re=yi(N),me=Fl(N),De=null==(q=N.ownerDocument)?void 0:q.body,yt=Ai(re.scrollWidth,re.clientWidth,De?De.scrollWidth:0,De?De.clientWidth:0),Nt=Ai(re.scrollHeight,re.clientHeight,De?De.scrollHeight:0,De?De.clientHeight:0),Rt=-me.scrollLeft+Qc(N),qe=-me.scrollTop;return"rtl"===Vt(De||re).direction&&(Rt+=Ai(re.clientWidth,De?De.clientWidth:0)-yt),{width:yt,height:Nt,x:Rt,y:qe}}(yi(H)));var N,q,re,me,De,yt,Nt,Rt}function ds(H){var T,N=H.reference,q=H.element,re=H.placement,me=re?es(re):null,De=re?to(re):null,yt=N.x+N.width/2-q.width/2,Nt=N.y+N.height/2-q.height/2;switch(me){case kn:T={x:yt,y:N.y-q.height};break;case Nr:T={x:yt,y:N.y+N.height};break;case Ki:T={x:N.x+N.width,y:Nt};break;case Hi:T={x:N.x-q.width,y:Nt};break;default:T={x:N.x,y:N.y}}var Rt=me?po(me):null;if(null!=Rt){var qe="y"===Rt?"height":"width";switch(De){case pe:T[Rt]=T[Rt]-(N[qe]/2-q[qe]/2);break;case et:T[Rt]=T[Rt]+(N[qe]/2-q[qe]/2)}}return T}function io(H,T){void 0===T&&(T={});var br,rr,Zi,Yi,ya,sr,xr,ta,mr,q=T.placement,re=void 0===q?H.placement:q,me=T.boundary,De=void 0===me?he:me,yt=T.rootBoundary,Nt=void 0===yt?Ee:yt,Rt=T.elementContext,qe=void 0===Rt?ct:Rt,Tt=T.altBoundary,En=void 0!==Tt&&Tt,mn=T.padding,bn=void 0===mn?0:mn,vn=el("number"!=typeof bn?bn:ha(bn,fe)),ri=H.rects.popper,St=H.elements[En?qe===ct?sn:ct:qe],Gn=(br=Qr(St)?St:St.contextElement||yi(H.elements.popper),Zi=Nt,xr="clippingParents"===(rr=De)?(ya=tl(us(Yi=br)),Qr(sr=["absolute","fixed"].indexOf(Vt(Yi).position)>=0&&eo(Yi)?lr(Yi):Yi)?ya.filter(function(ci){return Qr(ci)&&Fs(ci,sr)&&"body"!==Gr(ci)}):[]):[].concat(rr),mr=(ta=[].concat(xr,[Zi])).reduce(function(Yi,ya){var sr=ku(br,ya);return Yi.top=Ai(sr.top,Yi.top),Yi.right=Ms(sr.right,Yi.right),Yi.bottom=Ms(sr.bottom,Yi.bottom),Yi.left=Ai(sr.left,Yi.left),Yi},ku(br,ta[0])),mr.width=mr.right-mr.left,mr.height=mr.bottom-mr.top,mr.x=mr.left,mr.y=mr.top,mr),Qn=wr(H.elements.reference),qn=ds({reference:Qn,element:ri,strategy:"absolute",placement:re}),li=Cd(Object.assign({},ri,qn)),Ii=qe===ct?li:Qn,Pi={top:Gn.top-Ii.top+vn.top,bottom:Ii.bottom-Gn.bottom+vn.bottom,left:Gn.left-Ii.left+vn.left,right:Ii.right-Gn.right+vn.right},Xi=H.modifiersData.offset;if(qe===ct&&Xi){var dr=Xi[re];Object.keys(Pi).forEach(function(br){var rr=[Ki,Nr].indexOf(br)>=0?1:-1,Zi=[kn,Nr].indexOf(br)>=0?"y":"x";Pi[br]+=dr[Zi]*rr})}return Pi}const Ih={name:"flip",enabled:!0,phase:"main",fn:function(H){var T=H.state,N=H.options,q=H.name;if(!T.modifiersData[q]._skip){for(var re=N.mainAxis,me=void 0===re||re,De=N.altAxis,yt=void 0===De||De,Nt=N.fallbackPlacements,Rt=N.padding,qe=N.boundary,Tt=N.rootBoundary,En=N.altBoundary,mn=N.flipVariations,bn=void 0===mn||mn,vn=N.allowedAutoPlacements,cn=T.options.placement,ri=es(cn),St=Nt||(ri!==cn&&bn?function(ci){if(es(ci)===oe)return[];var ps=Na(ci);return[ko(ci),ps,ko(ps)]}(cn):[Na(cn)]),Gn=[cn].concat(St).reduce(function(ci,ps){return ci.concat(es(ps)===oe?function Ad(H,T){void 0===T&&(T={});var re=T.boundary,me=T.rootBoundary,De=T.padding,yt=T.flipVariations,Nt=T.allowedAutoPlacements,Rt=void 0===Nt?Ln:Nt,qe=to(T.placement),Tt=qe?yt?wn:wn.filter(function(bn){return to(bn)===qe}):fe,En=Tt.filter(function(bn){return Rt.indexOf(bn)>=0});0===En.length&&(En=Tt);var mn=En.reduce(function(bn,vn){return bn[vn]=io(H,{placement:vn,boundary:re,rootBoundary:me,padding:De})[es(vn)],bn},{});return Object.keys(mn).sort(function(bn,vn){return mn[bn]-mn[vn]})}(T,{placement:ps,boundary:qe,rootBoundary:Tt,padding:Rt,flipVariations:bn,allowedAutoPlacements:vn}):ps)},[]),Qn=T.rects.reference,qn=T.rects.popper,li=new Map,Ii=!0,Pi=Gn[0],Xi=0;Xi<Gn.length;Xi++){var dr=Gn[Xi],br=es(dr),rr=to(dr)===pe,Zi=[kn,Nr].indexOf(br)>=0,xr=Zi?"width":"height",ta=io(T,{placement:dr,boundary:qe,rootBoundary:Tt,altBoundary:En,padding:Rt}),zs=Zi?rr?Ki:Hi:rr?Nr:kn;Qn[xr]>qn[xr]&&(zs=Na(zs));var mr=Na(zs),Yi=[];if(me&&Yi.push(ta[br]<=0),yt&&Yi.push(ta[zs]<=0,ta[mr]<=0),Yi.every(function(ci){return ci})){Pi=dr,Ii=!1;break}li.set(dr,Yi)}if(Ii)for(var ya=function(ci){var ps=Gn.find(function(na){var cl=li.get(na);if(cl)return cl.slice(0,ci).every(function(ro){return ro})});if(ps)return Pi=ps,"break"},sr=bn?3:1;sr>0&&"break"!==ya(sr);sr--);T.placement!==Pi&&(T.modifiersData[q]._skip=!0,T.placement=Pi,T.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Xo(H,T,N){return void 0===N&&(N={x:0,y:0}),{top:H.top-T.height-N.y,right:H.right-T.width+N.x,bottom:H.bottom-T.height+N.y,left:H.left-T.width-N.x}}function Dh(H){return[kn,Ki,Nr,Hi].some(function(T){return H[T]>=0})}const Fu={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(H){var T=H.state,N=H.name,q=T.rects.reference,re=T.rects.popper,me=T.modifiersData.preventOverflow,De=io(T,{elementContext:"reference"}),yt=io(T,{altBoundary:!0}),Nt=Xo(De,q),Rt=Xo(yt,re,me),qe=Dh(Nt),Tt=Dh(Rt);T.modifiersData[N]={referenceClippingOffsets:Nt,popperEscapeOffsets:Rt,isReferenceHidden:qe,hasPopperEscaped:Tt},T.attributes.popper=Object.assign({},T.attributes.popper,{"data-popper-reference-hidden":qe,"data-popper-escaped":Tt})}},eu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(H){var T=H.state,q=H.name,re=H.options.offset,me=void 0===re?[0,0]:re,De=Ln.reduce(function(qe,Tt){return qe[Tt]=(mn=T.rects,bn=me,vn=es(En=Tt),cn=[Hi,kn].indexOf(vn)>=0?-1:1,St=(St=(ri="function"==typeof bn?bn(Object.assign({},mn,{placement:En})):bn)[0])||0,Gn=((Gn=ri[1])||0)*cn,[Hi,Ki].indexOf(vn)>=0?{x:Gn,y:St}:{x:St,y:Gn}),qe;var En,mn,bn,vn,cn,ri,St,Gn},{}),yt=De[T.placement],Rt=yt.y;null!=T.modifiersData.popperOffsets&&(T.modifiersData.popperOffsets.x+=yt.x,T.modifiersData.popperOffsets.y+=Rt),T.modifiersData[q]=De}},Jo={name:"popperOffsets",enabled:!0,phase:"read",fn:function(H){var T=H.state;T.modifiersData[H.name]=ds({reference:T.rects.reference,element:T.rects.popper,strategy:"absolute",placement:T.placement})},data:{}},Rh={name:"preventOverflow",enabled:!0,phase:"main",fn:function(H){var T=H.state,N=H.options,q=H.name,re=N.mainAxis,me=void 0===re||re,De=N.altAxis,yt=void 0!==De&&De,En=N.tether,mn=void 0===En||En,bn=N.tetherOffset,vn=void 0===bn?0:bn,cn=io(T,{boundary:N.boundary,rootBoundary:N.rootBoundary,padding:N.padding,altBoundary:N.altBoundary}),ri=es(T.placement),St=to(T.placement),Gn=!St,Qn=po(ri),qn="x"===Qn?"y":"x",li=T.modifiersData.popperOffsets,Ii=T.rects.reference,Pi=T.rects.popper,Xi="function"==typeof vn?vn(Object.assign({},T.rects,{placement:T.placement})):vn,dr={x:0,y:0};if(li){if(me||yt){var br="y"===Qn?kn:Hi,rr="y"===Qn?Nr:Ki,Zi="y"===Qn?"height":"width",xr=li[Qn],ta=li[Qn]+cn[br],zs=li[Qn]-cn[rr],mr=mn?-Pi[Zi]/2:0,Yi=St===pe?Ii[Zi]:Pi[Zi],ya=St===pe?-Pi[Zi]:-Ii[Zi],sr=T.elements.arrow,ci=mn&&sr?Ra(sr):{width:0,height:0},ps=T.modifiersData["arrow#persistent"]?T.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},na=ps[br],cl=ps[rr],ro=zn(0,Ii[Zi],ci[Zi]),Ql=Gn?Ii[Zi]/2-mr-ro-na-Xi:Yi-ro-na-Xi,ul=Gn?-Ii[Zi]/2+mr+ro+cl+Xi:ya+ro+cl+Xi,dl=T.elements.arrow&&lr(T.elements.arrow),tc=T.modifiersData.offset?T.modifiersData.offset[T.placement][Qn]:0,hl=li[Qn]+Ql-tc-(dl?"y"===Qn?dl.clientTop||0:dl.clientLeft||0:0),_a=li[Qn]+ul-tc;if(me){var nc=zn(mn?Ms(ta,hl):ta,xr,mn?Ai(zs,_a):zs);li[Qn]=nc,dr[Qn]=nc-xr}if(yt){var Ba=li[qn],tp=Ba+cn["x"===Qn?kn:Hi],Ku=Ba-cn["x"===Qn?Nr:Ki],hr=zn(mn?Ms(tp,hl):tp,Ba,mn?Ai(Ku,_a):Ku);li[qn]=hr,dr[qn]=hr-Ba}}T.modifiersData[q]=dr}},requiresIfExists:["offset"]};function Id(H,T,N){void 0===N&&(N=!1);var q=eo(T);eo(T)&&T.getBoundingClientRect();var re,me,De=yi(T),yt=wr(H),Nt={scrollLeft:0,scrollTop:0},Rt={x:0,y:0};return(q||!q&&!N)&&(("body"!==Gr(T)||mo(De))&&(Nt=(re=T)!==zi(re)&&eo(re)?{scrollLeft:(me=re).scrollLeft,scrollTop:me.scrollTop}:Fl(re)),eo(T)?((Rt=wr(T)).x+=T.clientLeft,Rt.y+=T.clientTop):De&&(Rt.x=Qc(De))),{x:yt.left+Nt.scrollLeft-Rt.x,y:yt.top+Nt.scrollTop-Rt.y,width:yt.width,height:yt.height}}function Jf(H){var T=new Map,N=new Set,q=[];function re(me){N.add(me.name),[].concat(me.requires||[],me.requiresIfExists||[]).forEach(function(De){if(!N.has(De)){var yt=T.get(De);yt&&re(yt)}}),q.push(me)}return H.forEach(function(me){T.set(me.name,me)}),H.forEach(function(me){N.has(me.name)||re(me)}),q}var Ph={placement:"bottom",modifiers:[],strategy:"absolute"};function Vu(){for(var H=arguments.length,T=new Array(H),N=0;N<H;N++)T[N]=arguments[N];return!T.some(function(q){return!(q&&"function"==typeof q.getBoundingClientRect)})}function fa(H){void 0===H&&(H={});var N=H.defaultModifiers,q=void 0===N?[]:N,re=H.defaultOptions,me=void 0===re?Ph:re;return function(De,yt,Nt){void 0===Nt&&(Nt=me);var Rt,qe,Tt={placement:"bottom",orderedModifiers:[],options:Object.assign({},Ph,me),modifiersData:{},elements:{reference:De,popper:yt},attributes:{},styles:{}},En=[],mn=!1,bn={state:Tt,setOptions:function(cn){var ri="function"==typeof cn?cn(Tt.options):cn;vn(),Tt.options=Object.assign({},me,Tt.options,ri),Tt.scrollParents={reference:Qr(De)?tl(De):De.contextElement?tl(De.contextElement):[],popper:tl(yt)};var St,Gn,qn,li,Qn=(St=[].concat(q,Tt.options.modifiers),Gn=St.reduce(function(qn,li){var Ii=qn[li.name];return qn[li.name]=Ii?Object.assign({},Ii,li,{options:Object.assign({},Ii.options,li.options),data:Object.assign({},Ii.data,li.data)}):li,qn},{}),qn=Object.keys(Gn).map(function(qn){return Gn[qn]}),li=Jf(qn),Ts.reduce(function(Ii,Pi){return Ii.concat(li.filter(function(Xi){return Xi.phase===Pi}))},[]));return Tt.orderedModifiers=Qn.filter(function(qn){return qn.enabled}),Tt.orderedModifiers.forEach(function(qn){var Ii=qn.options,Xi=qn.effect;if("function"==typeof Xi){var dr=Xi({state:Tt,name:qn.name,instance:bn,options:void 0===Ii?{}:Ii});En.push(dr||function(){})}}),bn.update()},forceUpdate:function(){if(!mn){var cn=Tt.elements,ri=cn.reference,St=cn.popper;if(Vu(ri,St)){Tt.rects={reference:Id(ri,lr(St),"fixed"===Tt.options.strategy),popper:Ra(St)},Tt.reset=!1,Tt.placement=Tt.options.placement,Tt.orderedModifiers.forEach(function(Xi){return Tt.modifiersData[Xi.name]=Object.assign({},Xi.data)});for(var Gn=0;Gn<Tt.orderedModifiers.length;Gn++)if(!0!==Tt.reset){var Qn=Tt.orderedModifiers[Gn],qn=Qn.fn,li=Qn.options;"function"==typeof qn&&(Tt=qn({state:Tt,options:void 0===li?{}:li,name:Qn.name,instance:bn})||Tt)}else Tt.reset=!1,Gn=-1}}},update:(Rt=function(){return new Promise(function(cn){bn.forceUpdate(),cn(Tt)})},function(){return qe||(qe=new Promise(function(cn){Promise.resolve().then(function(){qe=void 0,cn(Rt())})})),qe}),destroy:function(){vn(),mn=!0}};if(!Vu(De,yt))return bn;function vn(){En.forEach(function(cn){return cn()}),En=[]}return bn.setOptions(Nt).then(function(cn){!mn&&Nt.onFirstUpdate&&Nt.onFirstUpdate(cn)}),bn}}var Nh=fa(),yc=fa({defaultModifiers:[Gi,Jo,Yo,Qa]}),Vl=fa({defaultModifiers:[Gi,Jo,Yo,Qa,eu,Ih,Rh,gc,Fu]});const Uu=Object.freeze({__proto__:null,popperGenerator:fa,detectOverflow:io,createPopperBase:Nh,createPopper:Vl,createPopperLite:yc,top:kn,bottom:Nr,right:Ki,left:Hi,auto:oe,basePlacements:fe,start:pe,end:et,clippingParents:he,viewport:Ee,popper:ct,reference:sn,variationPlacements:wn,placements:Ln,beforeRead:Ji,read:"read",afterRead:Or,beforeMain:Ss,main:"main",afterMain:Ll,beforeWrite:mc,write:"write",afterWrite:Lr,modifierPhases:Ts,applyStyles:Qa,arrow:gc,computeStyles:Yo,eventListeners:Gi,flip:Ih,hide:Fu,offset:eu,popperOffsets:Jo,preventOverflow:Rh}),tu="dropdown",ns="Escape",Vo="ArrowUp",La="ArrowDown",Dd=new RegExp("ArrowUp|ArrowDown|Escape"),Rd="click.bs.dropdown.data-api",nu="keydown.bs.dropdown.data-api",go="show",Qo='[data-bs-toggle="dropdown"]',hs=".dropdown-menu",Pd=tt()?"top-end":"top-start",Vs=tt()?"top-start":"top-end",Ul=tt()?"bottom-end":"bottom-start",yo=tt()?"bottom-start":"bottom-end",Bu=tt()?"left-start":"right-start",Nd=tt()?"right-start":"left-start",Hu={offset:[0,2],boundary:"clippingParents",reference:"toggle",display:"dynamic",popperConfig:null,autoClose:!0},Bl={offset:"(array|string|function)",boundary:"(string|element)",reference:"(string|element|object)",display:"string",popperConfig:"(null|object|function)",autoClose:"(boolean|string)"};class Cs extends Ht{constructor(T,N){super(T),this._popper=null,this._config=this._getConfig(N),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar()}static get Default(){return Hu}static get DefaultType(){return Bl}static get NAME(){return tu}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Ne(this._element)||this._isShown(this._menu))return;const T={relatedTarget:this._element};if(Pe.trigger(this._element,"show.bs.dropdown",T).defaultPrevented)return;const N=Cs.getParentFromElement(this._element);this._inNavbar?An.setDataAttribute(this._menu,"popper","none"):this._createPopper(N),"ontouchstart"in document.documentElement&&!N.closest(".navbar-nav")&&[].concat(...document.body.children).forEach(q=>Pe.on(q,"mouseover",ue)),this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(go),this._element.classList.add(go),Pe.trigger(this._element,"shown.bs.dropdown",T)}hide(){!Ne(this._element)&&this._isShown(this._menu)&&this._completeHide({relatedTarget:this._element})}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(T){Pe.trigger(this._element,"hide.bs.dropdown",T).defaultPrevented||("ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(N=>Pe.off(N,"mouseover",ue)),this._popper&&this._popper.destroy(),this._menu.classList.remove(go),this._element.classList.remove(go),this._element.setAttribute("aria-expanded","false"),An.removeDataAttribute(this._menu,"popper"),Pe.trigger(this._element,"hidden.bs.dropdown",T))}_getConfig(T){if(T=Si(Si(Si({},this.constructor.Default),An.getDataAttributes(this._element)),T),Ve(tu,T,this.constructor.DefaultType),"object"==typeof T.reference&&!Oe(T.reference)&&"function"!=typeof T.reference.getBoundingClientRect)throw new TypeError(`${tu.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return T}_createPopper(T){if(void 0===Uu)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let N=this._element;"parent"===this._config.reference?N=T:Oe(this._config.reference)?N=Ae(this._config.reference):"object"==typeof this._config.reference&&(N=this._config.reference);const q=this._getPopperConfig(),re=q.modifiers.find(me=>"applyStyles"===me.name&&!1===me.enabled);this._popper=Vl(N,this._menu,q),re&&An.setDataAttribute(this._menu,"popper","static")}_isShown(T=this._element){return T.classList.contains(go)}_getMenuElement(){return Tn.next(this._element,hs)[0]}_getPlacement(){const T=this._element.parentNode;if(T.classList.contains("dropend"))return Bu;if(T.classList.contains("dropstart"))return Nd;const N="end"===getComputedStyle(this._menu).getPropertyValue("--bs-position").trim();return T.classList.contains("dropup")?N?Vs:Pd:N?yo:Ul}_detectNavbar(){return null!==this._element.closest(".navbar")}_getOffset(){const{offset:T}=this._config;return"string"==typeof T?T.split(",").map(N=>Number.parseInt(N,10)):"function"==typeof T?N=>T(N,this._element):T}_getPopperConfig(){const T={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return"static"===this._config.display&&(T.modifiers=[{name:"applyStyles",enabled:!1}]),Si(Si({},T),"function"==typeof this._config.popperConfig?this._config.popperConfig(T):this._config.popperConfig)}_selectMenuItem({key:T,target:N}){const q=Tn.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(Fe);q.length&&at(q,N,T===La,!q.includes(N)).focus()}static jQueryInterface(T){return this.each(function(){const N=Cs.getOrCreateInstance(this,T);if("string"==typeof T){if(void 0===N[T])throw new TypeError(`No method named "${T}"`);N[T]()}})}static clearMenus(T){if(T&&(2===T.button||"keyup"===T.type&&"Tab"!==T.key))return;const N=Tn.find(Qo);for(let q=0,re=N.length;q<re;q++){const me=Cs.getInstance(N[q]);if(!me||!1===me._config.autoClose||!me._isShown())continue;const De={relatedTarget:me._element};if(T){const yt=T.composedPath(),Nt=yt.includes(me._menu);if(yt.includes(me._element)||"inside"===me._config.autoClose&&!Nt||"outside"===me._config.autoClose&&Nt||me._menu.contains(T.target)&&("keyup"===T.type&&"Tab"===T.key||/input|select|option|textarea|form/i.test(T.target.tagName)))continue;"click"===T.type&&(De.clickEvent=T)}me._completeHide(De)}}static getParentFromElement(T){return be(T)||T.parentNode}static dataApiKeydownHandler(T){if(/input|textarea/i.test(T.target.tagName)?"Space"===T.key||T.key!==ns&&(T.key!==La&&T.key!==Vo||T.target.closest(hs)):!Dd.test(T.key))return;const N=this.classList.contains(go);if(!N&&T.key===ns||(T.preventDefault(),T.stopPropagation(),Ne(this)))return;const q=this.matches(Qo)?this:Tn.prev(this,Qo)[0],re=Cs.getOrCreateInstance(q);if(T.key!==ns)return T.key===Vo||T.key===La?(N||re.show(),void re._selectMenuItem(T)):void(N&&"Space"!==T.key||Cs.clearMenus());re.hide()}}Pe.on(document,nu,Qo,Cs.dataApiKeydownHandler),Pe.on(document,nu,hs,Cs.dataApiKeydownHandler),Pe.on(document,Rd,Cs.clearMenus),Pe.on(document,"keyup.bs.dropdown.data-api",Cs.clearMenus),Pe.on(document,Rd,Qo,function(H){H.preventDefault(),Cs.getOrCreateInstance(this).toggle()}),pt(Cs);const Uo=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Od=".sticky-top";class Fi{constructor(){this._element=document.body}getWidth(){const T=document.documentElement.clientWidth;return Math.abs(window.innerWidth-T)}hide(){const T=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,"paddingRight",N=>N+T),this._setElementAttributes(Uo,"paddingRight",N=>N+T),this._setElementAttributes(Od,"marginRight",N=>N-T)}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(T,N,q){const re=this.getWidth();this._applyManipulationCallback(T,me=>{if(me!==this._element&&window.innerWidth>me.clientWidth+re)return;this._saveInitialAttribute(me,N);const De=window.getComputedStyle(me)[N];me.style[N]=`${q(Number.parseFloat(De))}px`})}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,"paddingRight"),this._resetElementAttributes(Uo,"paddingRight"),this._resetElementAttributes(Od,"marginRight")}_saveInitialAttribute(T,N){const q=T.style[N];q&&An.setDataAttribute(T,N,q)}_resetElementAttributes(T,N){this._applyManipulationCallback(T,q=>{const re=An.getDataAttribute(q,N);void 0===re?q.style.removeProperty(N):(An.removeDataAttribute(q,N),q.style[N]=re)})}_applyManipulationCallback(T,N){Oe(T)?N(T):Tn.find(T,this._element).forEach(N)}isOverflowing(){return this.getWidth()>0}}const _c={className:"modal-backdrop",isVisible:!0,isAnimated:!1,rootElement:"body",clickCallback:null},nl={className:"string",isVisible:"boolean",isAnimated:"boolean",rootElement:"(element|string)",clickCallback:"(function|null)"},Hl="mousedown.bs.backdrop";class vc{constructor(T){this._config=this._getConfig(T),this._isAppended=!1,this._element=null}show(T){this._config.isVisible?(this._append(),this._config.isAnimated&&this._getElement(),this._getElement().classList.add("show"),this._emulateAnimation(()=>{Ot(T)})):Ot(T)}hide(T){this._config.isVisible?(this._getElement().classList.remove("show"),this._emulateAnimation(()=>{this.dispose(),Ot(T)})):Ot(T)}_getElement(){if(!this._element){const T=document.createElement("div");T.className=this._config.className,this._config.isAnimated&&T.classList.add("fade"),this._element=T}return this._element}_getConfig(T){return(T=Si(Si({},_c),"object"==typeof T?T:{})).rootElement=Ae(T.rootElement),Ve("backdrop",T,nl),T}_append(){this._isAppended||(this._config.rootElement.append(this._getElement()),Pe.on(this._getElement(),Hl,()=>{Ot(this._config.clickCallback)}),this._isAppended=!0)}dispose(){this._isAppended&&(Pe.off(this._element,Hl),this._element.remove(),this._isAppended=!1)}_emulateAnimation(T){ze(T,this._getElement(),this._config.isAnimated)}}const ka={trapElement:null,autofocus:!0},fs={trapElement:"element",autofocus:"boolean"},iu=".bs.focustrap",ur="backward";class Bo{constructor(T){this._config=this._getConfig(T),this._isActive=!1,this._lastTabNavDirection=null}activate(){const{trapElement:T,autofocus:N}=this._config;this._isActive||(N&&T.focus(),Pe.off(document,iu),Pe.on(document,"focusin.bs.focustrap",q=>this._handleFocusin(q)),Pe.on(document,"keydown.tab.bs.focustrap",q=>this._handleKeydown(q)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,Pe.off(document,iu))}_handleFocusin(T){const{target:N}=T,{trapElement:q}=this._config;if(N===document||N===q||q.contains(N))return;const re=Tn.focusableChildren(q);0===re.length?q.focus():this._lastTabNavDirection===ur?re[re.length-1].focus():re[0].focus()}_handleKeydown(T){"Tab"===T.key&&(this._lastTabNavDirection=T.shiftKey?ur:"forward")}_getConfig(T){return T=Si(Si({},ka),"object"==typeof T?T:{}),Ve("focustrap",T,fs),T}}const ea={backdrop:!0,keyboard:!0,focus:!0},wc={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean"},_o="hidden.bs.modal",Ho="show.bs.modal",il="resize.bs.modal",Cn="click.dismiss.bs.modal",rl="keydown.dismiss.bs.modal",bc="mousedown.dismiss.bs.modal",zl="modal-open",sl="modal-static";class pa extends Ht{constructor(T,N){super(T),this._config=this._getConfig(N),this._dialog=Tn.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollBar=new Fi}static get Default(){return ea}static get NAME(){return"modal"}toggle(T){return this._isShown?this.hide():this.show(T)}show(T){this._isShown||this._isTransitioning||Pe.trigger(this._element,Ho,{relatedTarget:T}).defaultPrevented||(this._isShown=!0,this._isAnimated()&&(this._isTransitioning=!0),this._scrollBar.hide(),document.body.classList.add(zl),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),Pe.on(this._dialog,bc,()=>{Pe.one(this._element,"mouseup.dismiss.bs.modal",N=>{N.target===this._element&&(this._ignoreBackdropClick=!0)})}),this._showBackdrop(()=>this._showElement(T)))}hide(){if(!this._isShown||this._isTransitioning||Pe.trigger(this._element,"hide.bs.modal").defaultPrevented)return;this._isShown=!1;const T=this._isAnimated();T&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),this._focustrap.deactivate(),this._element.classList.remove("show"),Pe.off(this._element,Cn),Pe.off(this._dialog,bc),this._queueCallback(()=>this._hideModal(),this._element,T)}dispose(){[window,this._dialog].forEach(T=>Pe.off(T,".bs.modal")),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new vc({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new Bo({trapElement:this._element})}_getConfig(T){return T=Si(Si(Si({},ea),An.getDataAttributes(this._element)),"object"==typeof T?T:{}),Ve("modal",T,wc),T}_showElement(T){const N=this._isAnimated(),q=Tn.findOne(".modal-body",this._dialog);this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0,q&&(q.scrollTop=0),this._element.classList.add("show"),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,Pe.trigger(this._element,"shown.bs.modal",{relatedTarget:T})},this._dialog,N)}_setEscapeEvent(){this._isShown?Pe.on(this._element,rl,T=>{this._config.keyboard&&"Escape"===T.key?(T.preventDefault(),this.hide()):this._config.keyboard||"Escape"!==T.key||this._triggerBackdropTransition()}):Pe.off(this._element,rl)}_setResizeEvent(){this._isShown?Pe.on(window,il,()=>this._adjustDialog()):Pe.off(window,il)}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(zl),this._resetAdjustments(),this._scrollBar.reset(),Pe.trigger(this._element,_o)})}_showBackdrop(T){Pe.on(this._element,Cn,N=>{this._ignoreBackdropClick?this._ignoreBackdropClick=!1:N.target===N.currentTarget&&(!0===this._config.backdrop?this.hide():"static"===this._config.backdrop&&this._triggerBackdropTransition())}),this._backdrop.show(T)}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(Pe.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const{classList:T,scrollHeight:N,style:q}=this._element,re=N>document.documentElement.clientHeight;!re&&"hidden"===q.overflowY||T.contains(sl)||(re||(q.overflowY="hidden"),T.add(sl),this._queueCallback(()=>{T.remove(sl),re||this._queueCallback(()=>{q.overflowY=""},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const T=this._element.scrollHeight>document.documentElement.clientHeight,N=this._scrollBar.getWidth(),q=N>0;(!q&&T&&!tt()||q&&!T&&tt())&&(this._element.style.paddingLeft=`${N}px`),(q&&!T&&!tt()||!q&&T&&tt())&&(this._element.style.paddingRight=`${N}px`)}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(T,N){return this.each(function(){const q=pa.getOrCreateInstance(this,T);if("string"==typeof T){if(void 0===q[T])throw new TypeError(`No method named "${T}"`);q[T](N)}})}}Pe.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(H){const T=be(this);["A","AREA"].includes(this.tagName)&&H.preventDefault(),Pe.one(T,Ho,q=>{q.defaultPrevented||Pe.one(T,_o,()=>{Fe(this)&&this.focus()})});const N=Tn.findOne(".modal.show");N&&pa.getInstance(N).hide(),pa.getOrCreateInstance(T).toggle(this)}),Ci(pa),pt(pa);const su="offcanvas",ut={backdrop:!0,keyboard:!0,scroll:!1},ai={backdrop:"boolean",keyboard:"boolean",scroll:"boolean"},ir=".offcanvas.show",ol="hidden.bs.offcanvas";class Us extends Ht{constructor(T,N){super(T),this._config=this._getConfig(N),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get NAME(){return su}static get Default(){return ut}toggle(T){return this._isShown?this.hide():this.show(T)}show(T){this._isShown||Pe.trigger(this._element,"show.bs.offcanvas",{relatedTarget:T}).defaultPrevented||(this._isShown=!0,this._element.style.visibility="visible",this._backdrop.show(),this._config.scroll||(new Fi).hide(),this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add("show"),this._queueCallback(()=>{this._config.scroll||this._focustrap.activate(),Pe.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:T})},this._element,!0))}hide(){this._isShown&&(Pe.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.remove("show"),this._backdrop.hide(),this._queueCallback(()=>{this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._element.style.visibility="hidden",this._config.scroll||(new Fi).reset(),Pe.trigger(this._element,ol)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_getConfig(T){return T=Si(Si(Si({},ut),An.getDataAttributes(this._element)),"object"==typeof T?T:{}),Ve(su,T,ai),T}_initializeBackDrop(){return new vc({className:"offcanvas-backdrop",isVisible:this._config.backdrop,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:()=>this.hide()})}_initializeFocusTrap(){return new Bo({trapElement:this._element})}_addEventListeners(){Pe.on(this._element,"keydown.dismiss.bs.offcanvas",T=>{this._config.keyboard&&"Escape"===T.key&&this.hide()})}static jQueryInterface(T){return this.each(function(){const N=Us.getOrCreateInstance(this,T);if("string"==typeof T){if(void 0===N[T]||T.startsWith("_")||"constructor"===T)throw new TypeError(`No method named "${T}"`);N[T](this)}})}}Pe.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(H){const T=be(this);if(["A","AREA"].includes(this.tagName)&&H.preventDefault(),Ne(this))return;Pe.one(T,ol,()=>{Fe(this)&&this.focus()});const N=Tn.findOne(ir);N&&N!==T&&Us.getInstance(N).hide(),Us.getOrCreateInstance(T).toggle(this)}),Pe.on(window,"load.bs.offcanvas.data-api",()=>Tn.find(ir).forEach(H=>Us.getOrCreateInstance(H).show())),Ci(Us),pt(Us);const vo=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Ec=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,zu=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,Qf=(H,T)=>{const N=H.nodeName.toLowerCase();if(T.includes(N))return!vo.has(N)||Boolean(Ec.test(H.nodeValue)||zu.test(H.nodeValue));const q=T.filter(re=>re instanceof RegExp);for(let re=0,me=q.length;re<me;re++)if(q[re].test(N))return!0;return!1};function Sc(H,T,N){if(!H.length)return H;if(N&&"function"==typeof N)return N(H);const q=(new window.DOMParser).parseFromString(H,"text/html"),re=[].concat(...q.body.querySelectorAll("*"));for(let me=0,De=re.length;me<De;me++){const yt=re[me],Nt=yt.nodeName.toLowerCase();if(!Object.keys(T).includes(Nt)){yt.remove();continue}const Rt=[].concat(...yt.attributes),qe=[].concat(T["*"]||[],T[Nt]||[]);Rt.forEach(Tt=>{Qf(Tt,qe)||yt.removeAttribute(Tt.nodeName)})}return q.body.innerHTML}const Gl="tooltip",ou=new Set(["sanitize","allowList","sanitizeFn"]),Ir={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(array|string|function)",container:"(string|element|boolean)",fallbackPlacements:"array",boundary:"(string|element)",customClass:"(string|function)",sanitize:"boolean",sanitizeFn:"(null|function)",allowList:"object",popperConfig:"(null|object|function)"},ma={AUTO:"auto",TOP:"top",RIGHT:tt()?"left":"right",BOTTOM:"bottom",LEFT:tt()?"right":"left"},Tc={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:[0,0],container:!1,fallbackPlacements:["top","right","bottom","left"],boundary:"clippingParents",customClass:"",sanitize:!0,sanitizeFn:null,allowList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},Va={HIDE:"hide.bs.tooltip",HIDDEN:"hidden.bs.tooltip",SHOW:"show.bs.tooltip",SHOWN:"shown.bs.tooltip",INSERTED:"inserted.bs.tooltip",CLICK:"click.bs.tooltip",FOCUSIN:"focusin.bs.tooltip",FOCUSOUT:"focusout.bs.tooltip",MOUSEENTER:"mouseenter.bs.tooltip",MOUSELEAVE:"mouseleave.bs.tooltip"},Bs="fade",al="show",Ua="show",Cc=".tooltip-inner",Wl="hide.bs.modal",$l="hover";class Kl extends Ht{constructor(T,N){if(void 0===Uu)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(T),this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this._config=this._getConfig(N),this.tip=null,this._setListeners()}static get Default(){return Tc}static get NAME(){return Gl}static get Event(){return Va}static get DefaultType(){return Ir}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(T){if(this._isEnabled)if(T){const N=this._initializeOnDelegatedTarget(T);N._activeTrigger.click=!N._activeTrigger.click,N._isWithActiveTrigger()?N._enter(null,N):N._leave(null,N)}else{if(this.getTipElement().classList.contains(al))return void this._leave(null,this);this._enter(null,this)}}dispose(){clearTimeout(this._timeout),Pe.off(this._element.closest(".modal"),Wl,this._hideModalHandler),this.tip&&this.tip.remove(),this._disposePopper(),super.dispose()}show(){if("none"===this._element.style.display)throw new Error("Please use show on visible elements");if(!this.isWithContent()||!this._isEnabled)return;const T=Pe.trigger(this._element,this.constructor.Event.SHOW),N=Be(this._element),q=null===N?this._element.ownerDocument.documentElement.contains(this._element):N.contains(this._element);if(T.defaultPrevented||!q)return;"tooltip"===this.constructor.NAME&&this.tip&&this.getTitle()!==this.tip.querySelector(Cc).innerHTML&&(this._disposePopper(),this.tip.remove(),this.tip=null);const re=this.getTipElement(),me=(Tt=>{do{Tt+=Math.floor(1e6*Math.random())}while(document.getElementById(Tt));return Tt})(this.constructor.NAME);re.setAttribute("id",me),this._element.setAttribute("aria-describedby",me),this._config.animation&&re.classList.add(Bs);const De="function"==typeof this._config.placement?this._config.placement.call(this,re,this._element):this._config.placement,yt=this._getAttachment(De);this._addAttachmentClass(yt);const{container:Nt}=this._config;ii.set(re,this.constructor.DATA_KEY,this),this._element.ownerDocument.documentElement.contains(this.tip)||(Nt.append(re),Pe.trigger(this._element,this.constructor.Event.INSERTED)),this._popper?this._popper.update():this._popper=Vl(this._element,re,this._getPopperConfig(yt)),re.classList.add(al);const Rt=this._resolvePossibleFunction(this._config.customClass);Rt&&re.classList.add(...Rt.split(" ")),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(Tt=>{Pe.on(Tt,"mouseover",ue)});const qe=this.tip.classList.contains(Bs);this._queueCallback(()=>{const Tt=this._hoverState;this._hoverState=null,Pe.trigger(this._element,this.constructor.Event.SHOWN),"out"===Tt&&this._leave(null,this)},this.tip,qe)}hide(){if(!this._popper)return;const T=this.getTipElement();if(Pe.trigger(this._element,this.constructor.Event.HIDE).defaultPrevented)return;T.classList.remove(al),"ontouchstart"in document.documentElement&&[].concat(...document.body.children).forEach(q=>Pe.off(q,"mouseover",ue)),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1;const N=this.tip.classList.contains(Bs);this._queueCallback(()=>{this._isWithActiveTrigger()||(this._hoverState!==Ua&&T.remove(),this._cleanTipClass(),this._element.removeAttribute("aria-describedby"),Pe.trigger(this._element,this.constructor.Event.HIDDEN),this._disposePopper())},this.tip,N),this._hoverState=""}update(){null!==this._popper&&this._popper.update()}isWithContent(){return Boolean(this.getTitle())}getTipElement(){if(this.tip)return this.tip;const T=document.createElement("div");T.innerHTML=this._config.template;const N=T.children[0];return this.setContent(N),N.classList.remove(Bs,al),this.tip=N,this.tip}setContent(T){this._sanitizeAndSetContent(T,this.getTitle(),Cc)}_sanitizeAndSetContent(T,N,q){const re=Tn.findOne(q,T);N||!re?this.setElementContent(re,N):re.remove()}setElementContent(T,N){if(null!==T)return Oe(N)?(N=Ae(N),void(this._config.html?N.parentNode!==T&&(T.innerHTML="",T.append(N)):T.textContent=N.textContent)):void(this._config.html?(this._config.sanitize&&(N=Sc(N,this._config.allowList,this._config.sanitizeFn)),T.innerHTML=N):T.textContent=N)}getTitle(){const T=this._element.getAttribute("data-bs-original-title")||this._config.title;return this._resolvePossibleFunction(T)}updateAttachment(T){return"right"===T?"end":"left"===T?"start":T}_initializeOnDelegatedTarget(T,N){return N||this.constructor.getOrCreateInstance(T.delegateTarget,this._getDelegateConfig())}_getOffset(){const{offset:T}=this._config;return"string"==typeof T?T.split(",").map(N=>Number.parseInt(N,10)):"function"==typeof T?N=>T(N,this._element):T}_resolvePossibleFunction(T){return"function"==typeof T?T.call(this._element):T}_getPopperConfig(T){const N={placement:T,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"onChange",enabled:!0,phase:"afterWrite",fn:q=>this._handlePopperPlacementChange(q)}],onFirstUpdate:q=>{q.options.placement!==q.placement&&this._handlePopperPlacementChange(q)}};return Si(Si({},N),"function"==typeof this._config.popperConfig?this._config.popperConfig(N):this._config.popperConfig)}_addAttachmentClass(T){this.getTipElement().classList.add(`${this._getBasicClassPrefix()}-${this.updateAttachment(T)}`)}_getAttachment(T){return ma[T.toUpperCase()]}_setListeners(){this._config.trigger.split(" ").forEach(T=>{if("click"===T)Pe.on(this._element,this.constructor.Event.CLICK,this._config.selector,N=>this.toggle(N));else if("manual"!==T){const q=T===$l?this.constructor.Event.MOUSELEAVE:this.constructor.Event.FOCUSOUT;Pe.on(this._element,T===$l?this.constructor.Event.MOUSEENTER:this.constructor.Event.FOCUSIN,this._config.selector,re=>this._enter(re)),Pe.on(this._element,q,this._config.selector,re=>this._leave(re))}}),this._hideModalHandler=()=>{this._element&&this.hide()},Pe.on(this._element.closest(".modal"),Wl,this._hideModalHandler),this._config.selector?this._config=ES(Si({},this._config),{trigger:"manual",selector:""}):this._fixTitle()}_fixTitle(){const T=this._element.getAttribute("title"),N=typeof this._element.getAttribute("data-bs-original-title");(T||"string"!==N)&&(this._element.setAttribute("data-bs-original-title",T||""),!T||this._element.getAttribute("aria-label")||this._element.textContent||this._element.setAttribute("aria-label",T),this._element.setAttribute("title",""))}_enter(T,N){N=this._initializeOnDelegatedTarget(T,N),T&&(N._activeTrigger["focusin"===T.type?"focus":$l]=!0),N.getTipElement().classList.contains(al)||N._hoverState===Ua?N._hoverState=Ua:(clearTimeout(N._timeout),N._hoverState=Ua,N._config.delay&&N._config.delay.show?N._timeout=setTimeout(()=>{N._hoverState===Ua&&N.show()},N._config.delay.show):N.show())}_leave(T,N){N=this._initializeOnDelegatedTarget(T,N),T&&(N._activeTrigger["focusout"===T.type?"focus":$l]=N._element.contains(T.relatedTarget)),N._isWithActiveTrigger()||(clearTimeout(N._timeout),N._hoverState="out",N._config.delay&&N._config.delay.hide?N._timeout=setTimeout(()=>{"out"===N._hoverState&&N.hide()},N._config.delay.hide):N.hide())}_isWithActiveTrigger(){for(const T in this._activeTrigger)if(this._activeTrigger[T])return!0;return!1}_getConfig(T){const N=An.getDataAttributes(this._element);return Object.keys(N).forEach(q=>{ou.has(q)&&delete N[q]}),(T=Si(Si(Si({},this.constructor.Default),N),"object"==typeof T&&T?T:{})).container=!1===T.container?document.body:Ae(T.container),"number"==typeof T.delay&&(T.delay={show:T.delay,hide:T.delay}),"number"==typeof T.title&&(T.title=T.title.toString()),"number"==typeof T.content&&(T.content=T.content.toString()),Ve(Gl,T,this.constructor.DefaultType),T.sanitize&&(T.template=Sc(T.template,T.allowList,T.sanitizeFn)),T}_getDelegateConfig(){const T={};for(const N in this._config)this.constructor.Default[N]!==this._config[N]&&(T[N]=this._config[N]);return T}_cleanTipClass(){const T=this.getTipElement(),N=new RegExp(`(^|\\s)${this._getBasicClassPrefix()}\\S+`,"g"),q=T.getAttribute("class").match(N);null!==q&&q.length>0&&q.map(re=>re.trim()).forEach(re=>T.classList.remove(re))}_getBasicClassPrefix(){return"bs-tooltip"}_handlePopperPlacementChange(T){const{state:N}=T;N&&(this.tip=N.elements.popper,this._cleanTipClass(),this._addAttachmentClass(this._getAttachment(N.placement)))}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null)}static jQueryInterface(T){return this.each(function(){const N=Kl.getOrCreateInstance(this,T);if("string"==typeof T){if(void 0===N[T])throw new TypeError(`No method named "${T}"`);N[T]()}})}}pt(Kl);const Gu=ES(Si({},Kl.Default),{placement:"right",offset:[0,8],trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),Zl=ES(Si({},Kl.DefaultType),{content:"(string|element|function)"}),Ac={HIDE:"hide.bs.popover",HIDDEN:"hidden.bs.popover",SHOW:"show.bs.popover",SHOWN:"shown.bs.popover",INSERTED:"inserted.bs.popover",CLICK:"click.bs.popover",FOCUSIN:"focusin.bs.popover",FOCUSOUT:"focusout.bs.popover",MOUSEENTER:"mouseenter.bs.popover",MOUSELEAVE:"mouseleave.bs.popover"};class Ic extends Kl{static get Default(){return Gu}static get NAME(){return"popover"}static get Event(){return Ac}static get DefaultType(){return Zl}isWithContent(){return this.getTitle()||this._getContent()}setContent(T){this._sanitizeAndSetContent(T,this.getTitle(),".popover-header"),this._sanitizeAndSetContent(T,this._getContent(),".popover-body")}_getContent(){return this._resolvePossibleFunction(this._config.content)}_getBasicClassPrefix(){return"bs-popover"}static jQueryInterface(T){return this.each(function(){const N=Ic.getOrCreateInstance(this,T);if("string"==typeof T){if(void 0===N[T])throw new TypeError(`No method named "${T}"`);N[T]()}})}}pt(Ic);const ll="scrollspy",ju={offset:10,method:"auto",target:""},Yl={offset:"number",method:"string",target:"(string|element)"},As="active",Wu=".nav-link, .list-group-item, .dropdown-item",Wr="position";class Hs extends Ht{constructor(T,N){super(T),this._scrollElement="BODY"===this._element.tagName?window:this._element,this._config=this._getConfig(N),this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,Pe.on(this._scrollElement,"scroll.bs.scrollspy",()=>this._process()),this.refresh(),this._process()}static get Default(){return ju}static get NAME(){return ll}refresh(){const N="auto"===this._config.method?this._scrollElement===this._scrollElement.window?"offset":Wr:this._config.method,q=N===Wr?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),Tn.find(Wu,this._config.target).map(re=>{const me=w(re),De=me?Tn.findOne(me):null;if(De){const yt=De.getBoundingClientRect();if(yt.width||yt.height)return[An[N](De).top+q,me]}return null}).filter(re=>re).sort((re,me)=>re[0]-me[0]).forEach(re=>{this._offsets.push(re[0]),this._targets.push(re[1])})}dispose(){Pe.off(this._scrollElement,".bs.scrollspy"),super.dispose()}_getConfig(T){return(T=Si(Si(Si({},ju),An.getDataAttributes(this._element)),"object"==typeof T&&T?T:{})).target=Ae(T.target)||document.documentElement,Ve(ll,T,Yl),T}_getScrollTop(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop}_getScrollHeight(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)}_getOffsetHeight(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height}_process(){const T=this._getScrollTop()+this._config.offset,N=this._getScrollHeight(),q=this._config.offset+N-this._getOffsetHeight();if(this._scrollHeight!==N&&this.refresh(),T>=q){const re=this._targets[this._targets.length-1];this._activeTarget!==re&&this._activate(re)}else{if(this._activeTarget&&T<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(let re=this._offsets.length;re--;)this._activeTarget!==this._targets[re]&&T>=this._offsets[re]&&(void 0===this._offsets[re+1]||T<this._offsets[re+1])&&this._activate(this._targets[re])}}_activate(T){this._activeTarget=T,this._clear();const N=Wu.split(",").map(re=>`${re}[data-bs-target="${T}"],${re}[href="${T}"]`),q=Tn.findOne(N.join(","),this._config.target);q.classList.add(As),q.classList.contains("dropdown-item")?Tn.findOne(".dropdown-toggle",q.closest(".dropdown")).classList.add(As):Tn.parents(q,".nav, .list-group").forEach(re=>{Tn.prev(re,".nav-link, .list-group-item").forEach(me=>me.classList.add(As)),Tn.prev(re,".nav-item").forEach(me=>{Tn.children(me,".nav-link").forEach(De=>De.classList.add(As))})}),Pe.trigger(this._scrollElement,"activate.bs.scrollspy",{relatedTarget:T})}_clear(){Tn.find(Wu,this._config.target).filter(T=>T.classList.contains(As)).forEach(T=>T.classList.remove(As))}static jQueryInterface(T){return this.each(function(){const N=Hs.getOrCreateInstance(this,T);if("string"==typeof T){if(void 0===N[T])throw new TypeError(`No method named "${T}"`);N[T]()}})}}Pe.on(window,"load.bs.scrollspy.data-api",()=>{Tn.find('[data-bs-spy="scroll"]').forEach(H=>new Hs(H))}),pt(Hs);const Qi="active",jm=".active",ep=":scope > li > .active";class Xl extends Ht{static get NAME(){return"tab"}show(){if(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&this._element.classList.contains(Qi))return;let T;const N=be(this._element),q=this._element.closest(".nav, .list-group");q&&(T=Tn.find("UL"===q.nodeName||"OL"===q.nodeName?ep:jm,q),T=T[T.length-1]);const re=T?Pe.trigger(T,"hide.bs.tab",{relatedTarget:this._element}):null;if(Pe.trigger(this._element,"show.bs.tab",{relatedTarget:T}).defaultPrevented||null!==re&&re.defaultPrevented)return;this._activate(this._element,q);const me=()=>{Pe.trigger(T,"hidden.bs.tab",{relatedTarget:this._element}),Pe.trigger(this._element,"shown.bs.tab",{relatedTarget:T})};N?this._activate(N,N.parentNode,me):me()}_activate(T,N,q){const re=(!N||"UL"!==N.nodeName&&"OL"!==N.nodeName?Tn.children(N,jm):Tn.find(ep,N))[0],me=q&&re&&re.classList.contains("fade"),De=()=>this._transitionComplete(T,re,q);re&&me?(re.classList.remove("show"),this._queueCallback(De,T,!0)):De()}_transitionComplete(T,N,q){if(N){N.classList.remove(Qi);const me=Tn.findOne(":scope > .dropdown-menu .active",N.parentNode);me&&me.classList.remove(Qi),"tab"===N.getAttribute("role")&&N.setAttribute("aria-selected",!1)}T.classList.add(Qi),"tab"===T.getAttribute("role")&&T.setAttribute("aria-selected",!0),T.classList.contains("fade")&&T.classList.add("show");let re=T.parentNode;if(re&&"LI"===re.nodeName&&(re=re.parentNode),re&&re.classList.contains("dropdown-menu")){const me=T.closest(".dropdown");me&&Tn.find(".dropdown-toggle",me).forEach(De=>De.classList.add(Qi)),T.setAttribute("aria-expanded",!0)}q&&q()}static jQueryInterface(T){return this.each(function(){const N=Xl.getOrCreateInstance(this);if("string"==typeof T){if(void 0===N[T])throw new TypeError(`No method named "${T}"`);N[T]()}})}}Pe.on(document,"click.bs.tab.data-api",'[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',function(H){["A","AREA"].includes(this.tagName)&&H.preventDefault(),Ne(this)||Xl.getOrCreateInstance(this).show()}),pt(Xl);const ga="show",wo="showing",Jl={animation:"boolean",autohide:"boolean",delay:"number"},$r={animation:!0,autohide:!0,delay:5e3};class Dc extends Ht{constructor(T,N){super(T),this._config=this._getConfig(N),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get DefaultType(){return Jl}static get Default(){return $r}static get NAME(){return"toast"}show(){Pe.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove("hide"),this._element.classList.add(ga),this._element.classList.add(wo),this._queueCallback(()=>{this._element.classList.remove(wo),Pe.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this._element.classList.contains(ga)&&(Pe.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(wo),this._queueCallback(()=>{this._element.classList.add("hide"),this._element.classList.remove(wo),this._element.classList.remove(ga),Pe.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this._element.classList.contains(ga)&&this._element.classList.remove(ga),super.dispose()}_getConfig(T){return T=Si(Si(Si({},$r),An.getDataAttributes(this._element)),"object"==typeof T&&T?T:{}),Ve("toast",T,this.constructor.DefaultType),T}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(T,N){switch(T.type){case"mouseover":case"mouseout":this._hasMouseInteraction=N;break;case"focusin":case"focusout":this._hasKeyboardInteraction=N}if(N)return void this._clearTimeout();const q=T.relatedTarget;this._element===q||this._element.contains(q)||this._maybeScheduleHide()}_setListeners(){Pe.on(this._element,"mouseover.bs.toast",T=>this._onInteraction(T,!0)),Pe.on(this._element,"mouseout.bs.toast",T=>this._onInteraction(T,!1)),Pe.on(this._element,"focusin.bs.toast",T=>this._onInteraction(T,!0)),Pe.on(this._element,"focusout.bs.toast",T=>this._onInteraction(T,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(T){return this.each(function(){const N=Dc.getOrCreateInstance(this,T);if("string"==typeof T){if(void 0===N[T])throw new TypeError(`No method named "${T}"`);N[T](this)}})}}return Ci(Dc),pt(Dc),{Alert:nr,Button:_i,Carousel:cs,Collapse:zr,Dropdown:Cs,Modal:pa,Offcanvas:Us,Popover:Ic,ScrollSpy:Hs,Tab:Xl,Toast:Dc,Tooltip:Kl}}()},5867:(hn,Ze,K)=>{"use strict";K.d(Ze,{Mq:()=>w.getApp,C6:()=>w.getApps});var w=K(9681);(0,w.registerVersion)("firebase","9.8.3","app")},127:(hn,Ze,K)=>{"use strict";K.d(Ze,{Z:()=>w.Z});var w=K(3942);w.Z.registerVersion("firebase","9.8.3","app-compat")},9916:(hn,Ze,K)=>{"use strict";K.r(Ze);var w=K(5861),be=K(3942),Y=K(2090),Oe=K(9681),Ae=K(655),Ve=K(1877),Fe=K(4859);const pt=function Gt(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},Ot=function tt(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ze=new Y.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),qt=new Ve.Yd("@firebase/auth");function nn(E,...m){qt.logLevel<=Ve.in.ERROR&&qt.error(`Auth (${Oe.SDK_VERSION}): ${E}`,...m)}function lt(E,...m){throw Ut(E,...m)}function Ye(E,...m){return Ut(E,...m)}function st(E,m,_){const M=Object.assign(Object.assign({},Ot()),{[m]:_});return new Y.LL("auth","Firebase",M).create(m,{appName:E.name})}function Bt(E,m,_){if(!(m instanceof _))throw _.name!==m.constructor.name&&lt(E,"argument-error"),st(E,"argument-error",`Type of ${m.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ut(E,...m){if("string"!=typeof E){const _=m[0],M=[...m.slice(1)];return M[0]&&(M[0].appName=E.name),E._errorFactory.create(_,...M)}return ze.create(E,...m)}function ce(E,m,..._){if(!E)throw Ut(m,..._)}function Xe(E){const m="INTERNAL ASSERTION FAILED: "+E;throw nn(m),new Error(m)}function ve(E,m){E||Xe(m)}const Re=new Map;function Te(E){ve(E instanceof Function,"Expected a class definition");let m=Re.get(E);return m?(ve(m instanceof E,"Instance stored in cache mismatched with class"),m):(m=new E,Re.set(E,m),m)}function It(){var E;return"undefined"!=typeof self&&(null===(E=self.location)||void 0===E?void 0:E.href)||""}function Pe(){return"http:"===ni()||"https:"===ni()}function ni(){var E;return"undefined"!=typeof self&&(null===(E=self.location)||void 0===E?void 0:E.protocol)||null}class Ci{constructor(m,_){this.shortDelay=m,this.longDelay=_,ve(_>m,"Short delay should be less than long delay!"),this.isMobile=(0,Y.uI)()||(0,Y.b$)()}get(){return function ii(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(Pe()||(0,Y.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function nr(E,m){ve(E.emulator,"Emulator should always be set here");const{url:_}=E.emulator;return m?`${_}${m.startsWith("/")?m.slice(1):m}`:_}class $i{static initialize(m,_,M){this.fetchImpl=m,_&&(this.headersImpl=_),M&&(this.responseImpl=M)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void Xe("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void Xe("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void Xe("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const _i={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},xs=new Ci(3e4,6e4);function vi(E,m){return E.tenantId&&!m.tenantId?Object.assign(Object.assign({},m),{tenantId:E.tenantId}):m}function An(E,m,_,M){return Tn.apply(this,arguments)}function Tn(){return(Tn=(0,w.Z)(function*(E,m,_,M,k={}){return Ys(E,k,(0,w.Z)(function*(){let W={},ye={};M&&("GET"===m?ye=M:W={body:JSON.stringify(M)});const je=(0,Y.xO)(Object.assign({key:E.config.apiKey},ye)).slice(1),kt=yield E._getAdditionalHeaders();return kt["Content-Type"]="application/json",E.languageCode&&(kt["X-Firebase-Locale"]=E.languageCode),$i.fetch()(ks(E,E.config.apiHost,_,je),Object.assign({method:m,headers:kt,referrerPolicy:"no-referrer"},W))}))})).apply(this,arguments)}function Ys(E,m,_){return as.apply(this,arguments)}function as(){return(as=(0,w.Z)(function*(E,m,_){E._canInitEmulator=!1;const M=Object.assign(Object.assign({},_i),m);try{const k=new Br(E),W=yield Promise.race([_(),k.promise]);k.clearNetworkTimeout();const ye=yield W.json();if("needConfirmation"in ye)throw Es(E,"account-exists-with-different-credential",ye);if(W.ok&&!("errorMessage"in ye))return ye;{const je=W.ok?ye.errorMessage:ye.error.message,[kt,on]=je.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===kt)throw Es(E,"credential-already-in-use",ye);if("EMAIL_EXISTS"===kt)throw Es(E,"email-already-in-use",ye);if("USER_DISABLED"===kt)throw Es(E,"user-disabled",ye);const Vn=M[kt]||kt.toLowerCase().replace(/[_\s]+/g,"-");if(on)throw st(E,Vn,on);lt(E,Vn)}}catch(k){if(k instanceof Y.ZR)throw k;lt(E,"network-request-failed")}})).apply(this,arguments)}function Ls(E,m,_,M){return ls.apply(this,arguments)}function ls(){return(ls=(0,w.Z)(function*(E,m,_,M,k={}){const W=yield An(E,m,_,M,k);return"mfaPendingCredential"in W&&lt(E,"multi-factor-auth-required",{_serverResponse:W}),W})).apply(this,arguments)}function ks(E,m,_,M){const k=`${m}${_}?${M}`;return E.config.emulator?nr(E.config,k):`${E.config.apiScheme}://${k}`}class Br{constructor(m){this.auth=m,this.timer=null,this.promise=new Promise((_,M)=>{this.timer=setTimeout(()=>M(Ye(this.auth,"network-request-failed")),xs.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Es(E,m,_){const M={appName:E.name};_.email&&(M.email=_.email),_.phoneNumber&&(M.phoneNumber=_.phoneNumber);const k=Ye(E,m,M);return k.customData._tokenResponse=_,k}function Xs(){return(Xs=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:delete",m)})).apply(this,arguments)}function qi(E,m){return ar.apply(this,arguments)}function ar(){return(ar=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:update",m)})).apply(this,arguments)}function cs(E,m){return Js.apply(this,arguments)}function Js(){return(Js=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:lookup",m)})).apply(this,arguments)}function Hr(E){if(E)try{const m=new Date(Number(E));if(!isNaN(m.getTime()))return m.toUTCString()}catch(m){}}function da(){return(da=(0,w.Z)(function*(E,m=!1){const _=(0,Y.m9)(E),M=yield _.getIdToken(m),k=_n(M);ce(k&&k.exp&&k.auth_time&&k.iat,_.auth,"internal-error");const W="object"==typeof k.firebase?k.firebase:void 0,ye=null==W?void 0:W.sign_in_provider;return{claims:k,token:M,authTime:Hr(gi(k.auth_time)),issuedAtTime:Hr(gi(k.iat)),expirationTime:Hr(gi(k.exp)),signInProvider:ye||null,signInSecondFactor:(null==W?void 0:W.sign_in_second_factor)||null}})).apply(this,arguments)}function gi(E){return 1e3*Number(E)}function _n(E){const[m,_,M]=E.split(".");if(void 0===m||void 0===_||void 0===M)return nn("JWT malformed, contained fewer than 3 sections"),null;try{const k=(0,Y.tV)(_);return k?JSON.parse(k):(nn("Failed to decode base64 JWT payload"),null)}catch(k){return nn("Caught error parsing JWT payload as JSON",k),null}}function Jr(E,m){return zr.apply(this,arguments)}function zr(){return(zr=(0,w.Z)(function*(E,m,_=!1){if(_)return m;try{return yield m}catch(M){throw M instanceof Y.ZR&&kn(M)&&E.auth.currentUser===E&&(yield E.auth.signOut()),M}})).apply(this,arguments)}function kn({code:E}){return"auth/user-disabled"===E||"auth/user-token-expired"===E}class Nr{constructor(m){this.user=m,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(m){var _;if(m){const M=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),M}{this.errorBackoff=3e4;const k=(null!==(_=this.user.stsTokenManager.expirationTime)&&void 0!==_?_:0)-Date.now()-3e5;return Math.max(0,k)}}schedule(m=!1){var _=this;if(!this.isRunning)return;const M=this.getInterval(m);this.timerId=setTimeout((0,w.Z)(function*(){yield _.iteration()}),M)}iteration(){var m=this;return(0,w.Z)(function*(){try{yield m.user.getIdToken(!0)}catch(_){return void("auth/network-request-failed"===_.code&&m.schedule(!0))}m.schedule()})()}}class Ki{constructor(m,_){this.createdAt=m,this.lastLoginAt=_,this._initializeTime()}_initializeTime(){this.lastSignInTime=Hr(this.lastLoginAt),this.creationTime=Hr(this.createdAt)}_copy(m){this.createdAt=m.createdAt,this.lastLoginAt=m.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function Hi(E){return oe.apply(this,arguments)}function oe(){return(oe=(0,w.Z)(function*(E){var m;const _=E.auth,M=yield E.getIdToken(),k=yield Jr(E,cs(_,{idToken:M}));ce(null==k?void 0:k.users.length,_,"internal-error");const W=k.users[0];E._notifyReloadListener(W);const ye=(null===(m=W.providerUserInfo)||void 0===m?void 0:m.length)?he(W.providerUserInfo):[],je=et(E.providerData,ye),Vn=!!E.isAnonymous&&!(E.email&&W.passwordHash||(null==je?void 0:je.length)),In={uid:W.localId,displayName:W.displayName||null,photoURL:W.photoUrl||null,email:W.email||null,emailVerified:W.emailVerified||!1,phoneNumber:W.phoneNumber||null,tenantId:W.tenantId||null,providerData:je,metadata:new Ki(W.createdAt,W.lastLoginAt),isAnonymous:Vn};Object.assign(E,In)})).apply(this,arguments)}function pe(){return(pe=(0,w.Z)(function*(E){const m=(0,Y.m9)(E);yield Hi(m),yield m.auth._persistUserIfCurrent(m),m.auth._notifyListenersIfCurrent(m)})).apply(this,arguments)}function et(E,m){return[...E.filter(M=>!m.some(k=>k.providerId===M.providerId)),...m]}function he(E){return E.map(m=>{var{providerId:_}=m,M=(0,Ae._T)(m,["providerId"]);return{providerId:_,uid:M.rawId||"",displayName:M.displayName||null,email:M.email||null,phoneNumber:M.phoneNumber||null,photoURL:M.photoUrl||null}})}function ct(){return(ct=(0,w.Z)(function*(E,m){const _=yield Ys(E,{},(0,w.Z)(function*(){const M=(0,Y.xO)({grant_type:"refresh_token",refresh_token:m}).slice(1),{tokenApiHost:k,apiKey:W}=E.config,ye=ks(E,k,"/v1/token",`key=${W}`),je=yield E._getAdditionalHeaders();return je["Content-Type"]="application/x-www-form-urlencoded",$i.fetch()(ye,{method:"POST",headers:je,body:M})}));return{accessToken:_.access_token,expiresIn:_.expires_in,refreshToken:_.refresh_token}})).apply(this,arguments)}class sn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(m){ce(m.idToken,"internal-error"),ce(void 0!==m.idToken,"internal-error"),ce(void 0!==m.refreshToken,"internal-error");const _="expiresIn"in m&&void 0!==m.expiresIn?Number(m.expiresIn):function On(E){const m=_n(E);return ce(m,"internal-error"),ce(void 0!==m.exp,"internal-error"),ce(void 0!==m.iat,"internal-error"),Number(m.exp)-Number(m.iat)}(m.idToken);this.updateTokensAndExpiration(m.idToken,m.refreshToken,_)}getToken(m,_=!1){var M=this;return(0,w.Z)(function*(){return ce(!M.accessToken||M.refreshToken,m,"user-token-expired"),_||!M.accessToken||M.isExpired?M.refreshToken?(yield M.refresh(m,M.refreshToken),M.accessToken):null:M.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(m,_){var M=this;return(0,w.Z)(function*(){const{accessToken:k,refreshToken:W,expiresIn:ye}=yield function Ee(E,m){return ct.apply(this,arguments)}(m,_);M.updateTokensAndExpiration(k,W,Number(ye))})()}updateTokensAndExpiration(m,_,M){this.refreshToken=_||null,this.accessToken=m||null,this.expirationTime=Date.now()+1e3*M}static fromJSON(m,_){const{refreshToken:M,accessToken:k,expirationTime:W}=_,ye=new sn;return M&&(ce("string"==typeof M,"internal-error",{appName:m}),ye.refreshToken=M),k&&(ce("string"==typeof k,"internal-error",{appName:m}),ye.accessToken=k),W&&(ce("number"==typeof W,"internal-error",{appName:m}),ye.expirationTime=W),ye}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(m){this.accessToken=m.accessToken,this.refreshToken=m.refreshToken,this.expirationTime=m.expirationTime}_clone(){return Object.assign(new sn,this.toJSON())}_performRefresh(){return Xe("not implemented")}}function wn(E,m){ce("string"==typeof E||void 0===E,"internal-error",{appName:m})}class Ln{constructor(m){var{uid:_,auth:M,stsTokenManager:k}=m,W=(0,Ae._T)(m,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Nr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=_,this.auth=M,this.stsTokenManager=k,this.accessToken=k.accessToken,this.displayName=W.displayName||null,this.email=W.email||null,this.emailVerified=W.emailVerified||!1,this.phoneNumber=W.phoneNumber||null,this.photoURL=W.photoURL||null,this.isAnonymous=W.isAnonymous||!1,this.tenantId=W.tenantId||null,this.providerData=W.providerData?[...W.providerData]:[],this.metadata=new Ki(W.createdAt||void 0,W.lastLoginAt||void 0)}getIdToken(m){var _=this;return(0,w.Z)(function*(){const M=yield Jr(_,_.stsTokenManager.getToken(_.auth,m));return ce(M,_.auth,"internal-error"),_.accessToken!==M&&(_.accessToken=M,yield _.auth._persistUserIfCurrent(_),_.auth._notifyListenersIfCurrent(_)),M})()}getIdTokenResult(m){return function Qs(E){return da.apply(this,arguments)}(this,m)}reload(){return function fe(E){return pe.apply(this,arguments)}(this)}_assign(m){this!==m&&(ce(this.uid===m.uid,this.auth,"internal-error"),this.displayName=m.displayName,this.photoURL=m.photoURL,this.email=m.email,this.emailVerified=m.emailVerified,this.phoneNumber=m.phoneNumber,this.isAnonymous=m.isAnonymous,this.tenantId=m.tenantId,this.providerData=m.providerData.map(_=>Object.assign({},_)),this.metadata._copy(m.metadata),this.stsTokenManager._assign(m.stsTokenManager))}_clone(m){return new Ln(Object.assign(Object.assign({},this),{auth:m,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(m){ce(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=m,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(m){this.reloadListener?this.reloadListener(m):this.reloadUserInfo=m}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(m,_=!1){var M=this;return(0,w.Z)(function*(){let k=!1;m.idToken&&m.idToken!==M.stsTokenManager.accessToken&&(M.stsTokenManager.updateFromServerResponse(m),k=!0),_&&(yield Hi(M)),yield M.auth._persistUserIfCurrent(M),k&&M.auth._notifyListenersIfCurrent(M)})()}delete(){var m=this;return(0,w.Z)(function*(){const _=yield m.getIdToken();return yield Jr(m,function Pn(E,m){return Xs.apply(this,arguments)}(m.auth,{idToken:_})),m.stsTokenManager.clearRefreshToken(),m.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(m=>Object.assign({},m)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(m,_){var M,k,W,ye,je,kt,on,Vn;const In=null!==(M=_.displayName)&&void 0!==M?M:void 0,ss=null!==(k=_.email)&&void 0!==k?k:void 0,ao=null!==(W=_.phoneNumber)&&void 0!==W?W:void 0,$a=null!==(ye=_.photoURL)&&void 0!==ye?ye:void 0,F_=null!==(je=_.tenantId)&&void 0!==je?je:void 0,Bc=null!==(kt=_._redirectEventId)&&void 0!==kt?kt:void 0,Qh=null!==(on=_.createdAt)&&void 0!==on?on:void 0,pu=null!==(Vn=_.lastLoginAt)&&void 0!==Vn?Vn:void 0,{uid:dg,emailVerified:Tp,isAnonymous:hg,providerData:fg,stsTokenManager:pg}=_;ce(dg&&pg,m,"internal-error");const V_=sn.fromJSON(this.name,pg);ce("string"==typeof dg,m,"internal-error"),wn(In,m.name),wn(ss,m.name),ce("boolean"==typeof Tp,m,"internal-error"),ce("boolean"==typeof hg,m,"internal-error"),wn(ao,m.name),wn($a,m.name),wn(F_,m.name),wn(Bc,m.name),wn(Qh,m.name),wn(pu,m.name);const ef=new Ln({uid:dg,auth:m,email:ss,emailVerified:Tp,displayName:In,isAnonymous:hg,photoURL:$a,phoneNumber:ao,tenantId:F_,stsTokenManager:V_,createdAt:Qh,lastLoginAt:pu});return fg&&Array.isArray(fg)&&(ef.providerData=fg.map(mg=>Object.assign({},mg))),Bc&&(ef._redirectEventId=Bc),ef}static _fromIdTokenResponse(m,_,M=!1){return(0,w.Z)(function*(){const k=new sn;k.updateFromServerResponse(_);const W=new Ln({uid:_.localId,auth:m,stsTokenManager:k,isAnonymous:M});return yield Hi(W),W})()}}const Fn=(()=>{class E{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,w.Z)(function*(){return!0})()}_set(_,M){var k=this;return(0,w.Z)(function*(){k.storage[_]=M})()}_get(_){var M=this;return(0,w.Z)(function*(){const k=M.storage[_];return void 0===k?null:k})()}_remove(_){var M=this;return(0,w.Z)(function*(){delete M.storage[_]})()}_addListener(_,M){}_removeListener(_,M){}}return E.type="NONE",E})();function Or(E,m,_){return`firebase:${E}:${m}:${_}`}class Ss{constructor(m,_,M){this.persistence=m,this.auth=_,this.userKey=M;const{config:k,name:W}=this.auth;this.fullUserKey=Or(this.userKey,k.apiKey,W),this.fullPersistenceKey=Or("persistence",k.apiKey,W),this.boundEventHandler=_._onStorageEvent.bind(_),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(m){return this.persistence._set(this.fullUserKey,m.toJSON())}getCurrentUser(){var m=this;return(0,w.Z)(function*(){const _=yield m.persistence._get(m.fullUserKey);return _?Ln._fromJSON(m.auth,_):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(m){var _=this;return(0,w.Z)(function*(){if(_.persistence===m)return;const M=yield _.getCurrentUser();return yield _.removeCurrentUser(),_.persistence=m,M?_.setCurrentUser(M):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(m,_,M="authUser"){return(0,w.Z)(function*(){if(!_.length)return new Ss(Te(Fn),m,M);const k=(yield Promise.all(_.map(function(){var on=(0,w.Z)(function*(Vn){if(yield Vn._isAvailable())return Vn});return function(Vn){return on.apply(this,arguments)}}()))).filter(on=>on);let W=k[0]||Te(Fn);const ye=Or(M,m.config.apiKey,m.name);let je=null;for(const on of _)try{const Vn=yield on._get(ye);if(Vn){const In=Ln._fromJSON(m,Vn);on!==W&&(je=In),W=on;break}}catch(Vn){}const kt=k.filter(on=>on._shouldAllowMigration);return W._shouldAllowMigration&&kt.length?(W=kt[0],je&&(yield W._set(ye,je.toJSON())),yield Promise.all(_.map(function(){var on=(0,w.Z)(function*(Vn){if(Vn!==W)try{yield Vn._remove(ye)}catch(In){}});return function(Vn){return on.apply(this,arguments)}}())),new Ss(W,m,M)):new Ss(W,m,M)})()}}function pc(E){const m=E.toLowerCase();if(m.includes("opera/")||m.includes("opr/")||m.includes("opios/"))return"Opera";if(Lr(m))return"IEMobile";if(m.includes("msie")||m.includes("trident/"))return"IE";if(m.includes("edge/"))return"Edge";if(Ll(m))return"Firefox";if(m.includes("silk/"))return"Silk";if(Gr(m))return"Blackberry";if(zi(m))return"Webos";if(mc(m))return"Safari";if((m.includes("chrome/")||kl(m))&&!m.includes("edge/"))return"Chrome";if(Ts(m))return"Android";{const M=E.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==M?void 0:M.length))return M[1]}return"Other"}function Ll(E=(0,Y.z$)()){return/firefox\//i.test(E)}function mc(E=(0,Y.z$)()){const m=E.toLowerCase();return m.includes("safari/")&&!m.includes("chrome/")&&!m.includes("crios/")&&!m.includes("android")}function kl(E=(0,Y.z$)()){return/crios\//i.test(E)}function Lr(E=(0,Y.z$)()){return/iemobile/i.test(E)}function Ts(E=(0,Y.z$)()){return/android/i.test(E)}function Gr(E=(0,Y.z$)()){return/blackberry/i.test(E)}function zi(E=(0,Y.z$)()){return/webos/i.test(E)}function Qr(E=(0,Y.z$)()){return/iphone|ipad|ipod/i.test(E)}function es(E=(0,Y.z$)()){return Qr(E)||Ts(E)||zi(E)||Gr(E)||/windows phone/i.test(E)||Lr(E)}function Ra(E,m=[]){let _;switch(E){case"Browser":_=pc((0,Y.z$)());break;case"Worker":_=`${pc((0,Y.z$)())}-${E}`;break;default:_=E}const M=m.length?m.join(","):"FirebaseCore-web";return`${_}/JsCore/${Oe.SDK_VERSION}/${M}`}class Fs{constructor(m){this.auth=m,this.queue=[]}pushCallback(m,_){const M=W=>new Promise((ye,je)=>{try{ye(m(W))}catch(kt){je(kt)}});M.onAbort=_,this.queue.push(M);const k=this.queue.length-1;return()=>{this.queue[k]=()=>Promise.resolve()}}runMiddleware(m){var _=this;return(0,w.Z)(function*(){var M;if(_.auth.currentUser===m)return;const k=[];try{for(const W of _.queue)yield W(m),W.onAbort&&k.push(W.onAbort)}catch(W){k.reverse();for(const ye of k)try{ye()}catch(je){}throw _.auth._errorFactory.create("login-blocked",{originalMessage:null===(M=W)||void 0===M?void 0:M.message})}})()}}class Vt{constructor(m,_,M){this.app=m,this.heartbeatServiceProvider=_,this.config=M,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new yi(this),this.idTokenSubscription=new yi(this),this.beforeStateQueue=new Fs(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ze,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=m.name,this.clientVersion=M.sdkClientVersion}_initializeWithPersistence(m,_){var M=this;return _&&(this._popupRedirectResolver=Te(_)),this._initializationPromise=this.queue((0,w.Z)(function*(){var k,W;if(!M._deleted&&(M.persistenceManager=yield Ss.create(M,m),!M._deleted)){if(null===(k=M._popupRedirectResolver)||void 0===k?void 0:k._shouldInitProactively)try{yield M._popupRedirectResolver._initialize(M)}catch(ye){}yield M.initializeCurrentUser(_),M.lastNotifiedUid=(null===(W=M.currentUser)||void 0===W?void 0:W.uid)||null,!M._deleted&&(M._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var m=this;return(0,w.Z)(function*(){if(m._deleted)return;const _=yield m.assertedPersistence.getCurrentUser();if(m.currentUser||_){if(m.currentUser&&_&&m.currentUser.uid===_.uid)return m._currentUser._assign(_),void(yield m.currentUser.getIdToken());yield m._updateCurrentUser(_,!0)}})()}initializeCurrentUser(m){var _=this;return(0,w.Z)(function*(){var M;const k=yield _.assertedPersistence.getCurrentUser();let W=k,ye=!1;if(m&&_.config.authDomain){yield _.getOrInitRedirectPersistenceManager();const je=null===(M=_.redirectUser)||void 0===M?void 0:M._redirectEventId,kt=null==W?void 0:W._redirectEventId,on=yield _.tryRedirectSignIn(m);(!je||je===kt)&&(null==on?void 0:on.user)&&(W=on.user,ye=!0)}if(!W)return _.directlySetCurrentUser(null);if(!W._redirectEventId){if(ye)try{yield _.beforeStateQueue.runMiddleware(W)}catch(je){W=k,_._popupRedirectResolver._overrideRedirectResult(_,()=>Promise.reject(je))}return W?_.reloadAndSetCurrentUserOrClear(W):_.directlySetCurrentUser(null)}return ce(_._popupRedirectResolver,_,"argument-error"),yield _.getOrInitRedirectPersistenceManager(),_.redirectUser&&_.redirectUser._redirectEventId===W._redirectEventId?_.directlySetCurrentUser(W):_.reloadAndSetCurrentUserOrClear(W)})()}tryRedirectSignIn(m){var _=this;return(0,w.Z)(function*(){let M=null;try{M=yield _._popupRedirectResolver._completeRedirectFn(_,m,!0)}catch(k){yield _._setRedirectUser(null)}return M})()}reloadAndSetCurrentUserOrClear(m){var _=this;return(0,w.Z)(function*(){try{yield Hi(m)}catch(M){if("auth/network-request-failed"!==M.code)return _.directlySetCurrentUser(null)}return _.directlySetCurrentUser(m)})()}useDeviceLanguage(){this.languageCode=function Ht(){if("undefined"==typeof navigator)return null;const E=navigator;return E.languages&&E.languages[0]||E.language||null}()}_delete(){var m=this;return(0,w.Z)(function*(){m._deleted=!0})()}updateCurrentUser(m){var _=this;return(0,w.Z)(function*(){const M=m?(0,Y.m9)(m):null;return M&&ce(M.auth.config.apiKey===_.config.apiKey,_,"invalid-user-token"),_._updateCurrentUser(M&&M._clone(_))})()}_updateCurrentUser(m,_=!1){var M=this;return(0,w.Z)(function*(){if(!M._deleted)return m&&ce(M.tenantId===m.tenantId,M,"tenant-id-mismatch"),_||(yield M.beforeStateQueue.runMiddleware(m)),M.queue((0,w.Z)(function*(){yield M.directlySetCurrentUser(m),M.notifyAuthListeners()}))})()}signOut(){var m=this;return(0,w.Z)(function*(){return yield m.beforeStateQueue.runMiddleware(null),(m.redirectPersistenceManager||m._popupRedirectResolver)&&(yield m._setRedirectUser(null)),m._updateCurrentUser(null,!0)})()}setPersistence(m){var _=this;return this.queue((0,w.Z)(function*(){yield _.assertedPersistence.setPersistence(Te(m))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(m){this._errorFactory=new Y.LL("auth","Firebase",m())}onAuthStateChanged(m,_,M){return this.registerStateListener(this.authStateSubscription,m,_,M)}beforeAuthStateChanged(m,_){return this.beforeStateQueue.pushCallback(m,_)}onIdTokenChanged(m,_,M){return this.registerStateListener(this.idTokenSubscription,m,_,M)}toJSON(){var m;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(m=this._currentUser)||void 0===m?void 0:m.toJSON()}}_setRedirectUser(m,_){var M=this;return(0,w.Z)(function*(){const k=yield M.getOrInitRedirectPersistenceManager(_);return null===m?k.removeCurrentUser():k.setCurrentUser(m)})()}getOrInitRedirectPersistenceManager(m){var _=this;return(0,w.Z)(function*(){if(!_.redirectPersistenceManager){const M=m&&Te(m)||_._popupRedirectResolver;ce(M,_,"argument-error"),_.redirectPersistenceManager=yield Ss.create(_,[Te(M._redirectPersistence)],"redirectUser"),_.redirectUser=yield _.redirectPersistenceManager.getCurrentUser()}return _.redirectPersistenceManager})()}_redirectUserForId(m){var _=this;return(0,w.Z)(function*(){var M,k;return _._isInitialized&&(yield _.queue((0,w.Z)(function*(){}))),(null===(M=_._currentUser)||void 0===M?void 0:M._redirectEventId)===m?_._currentUser:(null===(k=_.redirectUser)||void 0===k?void 0:k._redirectEventId)===m?_.redirectUser:null})()}_persistUserIfCurrent(m){var _=this;return(0,w.Z)(function*(){if(m===_.currentUser)return _.queue((0,w.Z)(function*(){return _.directlySetCurrentUser(m)}))})()}_notifyListenersIfCurrent(m){m===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var m,_;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const M=null!==(_=null===(m=this.currentUser)||void 0===m?void 0:m.uid)&&void 0!==_?_:null;this.lastNotifiedUid!==M&&(this.lastNotifiedUid=M,this.authStateSubscription.next(this.currentUser))}registerStateListener(m,_,M,k){if(this._deleted)return()=>{};const W="function"==typeof _?_:_.next.bind(_),ye=this._isInitialized?Promise.resolve():this._initializationPromise;return ce(ye,this,"internal-error"),ye.then(()=>W(this.currentUser)),"function"==typeof _?m.addObserver(_,M,k):m.addObserver(_)}directlySetCurrentUser(m){var _=this;return(0,w.Z)(function*(){_.currentUser&&_.currentUser!==m&&(_._currentUser._stopProactiveRefresh(),m&&_.isProactiveRefreshEnabled&&m._startProactiveRefresh()),_.currentUser=m,m?yield _.assertedPersistence.setCurrentUser(m):yield _.assertedPersistence.removeCurrentUser()})()}queue(m){return this.operations=this.operations.then(m,m),this.operations}get assertedPersistence(){return ce(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(m){!m||this.frameworks.includes(m)||(this.frameworks.push(m),this.frameworks.sort(),this.clientVersion=Ra(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var m=this;return(0,w.Z)(function*(){var _;const M={"X-Client-Version":m.clientVersion};m.app.options.appId&&(M["X-Firebase-gmpid"]=m.app.options.appId);const k=yield null===(_=m.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===_?void 0:_.getHeartbeatsHeader();return k&&(M["X-Firebase-Client"]=k),M})()}}function xn(E){return(0,Y.m9)(E)}class yi{constructor(m){this.auth=m,this.observer=null,this.addObserver=(0,Y.ne)(_=>this.observer=_)}get next(){return ce(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Lo(E){const m=E.indexOf(":");return m<0?"":E.substr(0,m+1)}function po(E){if(!E)return null;const m=Number(E);return isNaN(m)?null:m}class Ms{constructor(m,_){this.providerId=m,this.signInMethod=_}toJSON(){return Xe("not implemented")}_getIdTokenResponse(m){return Xe("not implemented")}_linkToIdToken(m,_){return Xe("not implemented")}_getReauthenticationResolver(m){return Xe("not implemented")}}function cr(E,m){return zn.apply(this,arguments)}function zn(){return(zn=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:resetPassword",vi(E,m))})).apply(this,arguments)}function el(E,m){return ha.apply(this,arguments)}function ha(){return(ha=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:update",m)})).apply(this,arguments)}function gc(E,m){return to.apply(this,arguments)}function to(){return(to=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:update",vi(E,m))})).apply(this,arguments)}function Pa(){return(Pa=(0,w.Z)(function*(E,m){return Ls(E,"POST","/v1/accounts:signInWithPassword",vi(E,m))})).apply(this,arguments)}function Yo(E,m){return jr.apply(this,arguments)}function jr(){return(jr=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:sendOobCode",vi(E,m))})).apply(this,arguments)}function Gi(E,m){return Jc.apply(this,arguments)}function Jc(){return(Jc=(0,w.Z)(function*(E,m){return Yo(E,m)})).apply(this,arguments)}function Na(E,m){return no.apply(this,arguments)}function no(){return(no=(0,w.Z)(function*(E,m){return Yo(E,m)})).apply(this,arguments)}function ko(E,m){return Fl.apply(this,arguments)}function Fl(){return(Fl=(0,w.Z)(function*(E,m){return Yo(E,m)})).apply(this,arguments)}function Qc(E,m){return mo.apply(this,arguments)}function mo(){return(mo=(0,w.Z)(function*(E,m){return Yo(E,m)})).apply(this,arguments)}function tl(){return(tl=(0,w.Z)(function*(E,m){return Ls(E,"POST","/v1/accounts:signInWithEmailLink",vi(E,m))})).apply(this,arguments)}function ku(){return(ku=(0,w.Z)(function*(E,m){return Ls(E,"POST","/v1/accounts:signInWithEmailLink",vi(E,m))})).apply(this,arguments)}class ds extends Ms{constructor(m,_,M,k=null){super("password",M),this._email=m,this._password=_,this._tenantId=k}static _fromEmailAndPassword(m,_){return new ds(m,_,"password")}static _fromEmailAndCode(m,_,M=null){return new ds(m,_,"emailLink",M)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(m){const _="string"==typeof m?JSON.parse(m):m;if((null==_?void 0:_.email)&&(null==_?void 0:_.password)){if("password"===_.signInMethod)return this._fromEmailAndPassword(_.email,_.password);if("emailLink"===_.signInMethod)return this._fromEmailAndCode(_.email,_.password,_.tenantId)}return null}_getIdTokenResponse(m){var _=this;return(0,w.Z)(function*(){switch(_.signInMethod){case"password":return function ts(E,m){return Pa.apply(this,arguments)}(m,{returnSecureToken:!0,email:_._email,password:_._password});case"emailLink":return function Fo(E,m){return tl.apply(this,arguments)}(m,{email:_._email,oobCode:_._password});default:lt(m,"internal-error")}})()}_linkToIdToken(m,_){var M=this;return(0,w.Z)(function*(){switch(M.signInMethod){case"password":return el(m,{idToken:_,returnSecureToken:!0,email:M._email,password:M._password});case"emailLink":return function Cd(E,m){return ku.apply(this,arguments)}(m,{idToken:_,email:M._email,oobCode:M._password});default:lt(m,"internal-error")}})()}_getReauthenticationResolver(m){return this._getIdTokenResponse(m)}}function io(E,m){return Ad.apply(this,arguments)}function Ad(){return(Ad=(0,w.Z)(function*(E,m){return Ls(E,"POST","/v1/accounts:signInWithIdp",vi(E,m))})).apply(this,arguments)}class Xo extends Ms{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(m){const _=new Xo(m.providerId,m.signInMethod);return m.idToken||m.accessToken?(m.idToken&&(_.idToken=m.idToken),m.accessToken&&(_.accessToken=m.accessToken),m.nonce&&!m.pendingToken&&(_.nonce=m.nonce),m.pendingToken&&(_.pendingToken=m.pendingToken)):m.oauthToken&&m.oauthTokenSecret?(_.accessToken=m.oauthToken,_.secret=m.oauthTokenSecret):lt("argument-error"),_}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(m){const _="string"==typeof m?JSON.parse(m):m,{providerId:M,signInMethod:k}=_,W=(0,Ae._T)(_,["providerId","signInMethod"]);if(!M||!k)return null;const ye=new Xo(M,k);return ye.idToken=W.idToken||void 0,ye.accessToken=W.accessToken||void 0,ye.secret=W.secret,ye.nonce=W.nonce,ye.pendingToken=W.pendingToken||null,ye}_getIdTokenResponse(m){return io(m,this.buildRequest())}_linkToIdToken(m,_){const M=this.buildRequest();return M.idToken=_,io(m,M)}_getReauthenticationResolver(m){const _=this.buildRequest();return _.autoCreate=!1,io(m,_)}buildRequest(){const m={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)m.pendingToken=this.pendingToken;else{const _={};this.idToken&&(_.id_token=this.idToken),this.accessToken&&(_.access_token=this.accessToken),this.secret&&(_.oauth_token_secret=this.secret),_.providerId=this.providerId,this.nonce&&!this.pendingToken&&(_.nonce=this.nonce),m.postBody=(0,Y.xO)(_)}return m}}function Dh(E,m){return Fu.apply(this,arguments)}function Fu(){return(Fu=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:sendVerificationCode",vi(E,m))})).apply(this,arguments)}function Jo(){return(Jo=(0,w.Z)(function*(E,m){return Ls(E,"POST","/v1/accounts:signInWithPhoneNumber",vi(E,m))})).apply(this,arguments)}function Id(){return(Id=(0,w.Z)(function*(E,m){const _=yield Ls(E,"POST","/v1/accounts:signInWithPhoneNumber",vi(E,m));if(_.temporaryProof)throw Es(E,"account-exists-with-different-credential",_);return _})).apply(this,arguments)}const Jf={USER_NOT_FOUND:"user-not-found"};function Vu(){return(Vu=(0,w.Z)(function*(E,m){return Ls(E,"POST","/v1/accounts:signInWithPhoneNumber",vi(E,Object.assign(Object.assign({},m),{operation:"REAUTH"})),Jf)})).apply(this,arguments)}class fa extends Ms{constructor(m){super("phone","phone"),this.params=m}static _fromVerification(m,_){return new fa({verificationId:m,verificationCode:_})}static _fromTokenResponse(m,_){return new fa({phoneNumber:m,temporaryProof:_})}_getIdTokenResponse(m){return function eu(E,m){return Jo.apply(this,arguments)}(m,this._makeVerificationRequest())}_linkToIdToken(m,_){return function Rh(E,m){return Id.apply(this,arguments)}(m,Object.assign({idToken:_},this._makeVerificationRequest()))}_getReauthenticationResolver(m){return function Ph(E,m){return Vu.apply(this,arguments)}(m,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:m,phoneNumber:_,verificationId:M,verificationCode:k}=this.params;return m&&_?{temporaryProof:m,phoneNumber:_}:{sessionInfo:M,code:k}}toJSON(){const m={providerId:this.providerId};return this.params.phoneNumber&&(m.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(m.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(m.verificationCode=this.params.verificationCode),this.params.verificationId&&(m.verificationId=this.params.verificationId),m}static fromJSON(m){"string"==typeof m&&(m=JSON.parse(m));const{verificationId:_,verificationCode:M,phoneNumber:k,temporaryProof:W}=m;return M||_||k||W?new fa({verificationId:_,verificationCode:M,phoneNumber:k,temporaryProof:W}):null}}class Vl{constructor(m){var _,M,k,W,ye,je;const kt=(0,Y.zd)((0,Y.pd)(m)),on=null!==(_=kt.apiKey)&&void 0!==_?_:null,Vn=null!==(M=kt.oobCode)&&void 0!==M?M:null,In=function Nh(E){switch(E){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(k=kt.mode)&&void 0!==k?k:null);ce(on&&Vn&&In,"argument-error"),this.apiKey=on,this.operation=In,this.code=Vn,this.continueUrl=null!==(W=kt.continueUrl)&&void 0!==W?W:null,this.languageCode=null!==(ye=kt.languageCode)&&void 0!==ye?ye:null,this.tenantId=null!==(je=kt.tenantId)&&void 0!==je?je:null}static parseLink(m){const _=function yc(E){const m=(0,Y.zd)((0,Y.pd)(E)).link,_=m?(0,Y.zd)((0,Y.pd)(m)).deep_link_id:null,M=(0,Y.zd)((0,Y.pd)(E)).deep_link_id;return(M?(0,Y.zd)((0,Y.pd)(M)).link:null)||M||_||m||E}(m);try{return new Vl(_)}catch(M){return null}}}let tu=(()=>{class E{constructor(){this.providerId=E.PROVIDER_ID}static credential(_,M){return ds._fromEmailAndPassword(_,M)}static credentialWithLink(_,M){const k=Vl.parseLink(M);return ce(k,"argument-error"),ds._fromEmailAndCode(_,k.code,k.tenantId)}}return E.PROVIDER_ID="password",E.EMAIL_PASSWORD_SIGN_IN_METHOD="password",E.EMAIL_LINK_SIGN_IN_METHOD="emailLink",E})();class ns{constructor(m){this.providerId=m,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(m){this.defaultLanguageCode=m}setCustomParameters(m){return this.customParameters=m,this}getCustomParameters(){return this.customParameters}}class Oa extends ns{constructor(){super(...arguments),this.scopes=[]}addScope(m){return this.scopes.includes(m)||this.scopes.push(m),this}getScopes(){return[...this.scopes]}}class Vo extends Oa{static credentialFromJSON(m){const _="string"==typeof m?JSON.parse(m):m;return ce("providerId"in _&&"signInMethod"in _,"argument-error"),Xo._fromParams(_)}credential(m){return this._credential(Object.assign(Object.assign({},m),{nonce:m.rawNonce}))}_credential(m){return ce(m.idToken||m.accessToken,"argument-error"),Xo._fromParams(Object.assign(Object.assign({},m),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(m){return Vo.oauthCredentialFromTaggedObject(m)}static credentialFromError(m){return Vo.oauthCredentialFromTaggedObject(m.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthIdToken:_,oauthAccessToken:M,oauthTokenSecret:k,pendingToken:W,nonce:ye,providerId:je}=m;if(!M&&!k&&!_&&!W||!je)return null;try{return new Vo(je)._credential({idToken:_,accessToken:M,nonce:ye,pendingToken:W})}catch(kt){return null}}}let La=(()=>{class E extends Oa{constructor(){super("facebook.com")}static credential(_){return Xo._fromParams({providerId:E.PROVIDER_ID,signInMethod:E.FACEBOOK_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return E.credential(_.oauthAccessToken)}catch(M){return null}}}return E.FACEBOOK_SIGN_IN_METHOD="facebook.com",E.PROVIDER_ID="facebook.com",E})(),Dd=(()=>{class E extends Oa{constructor(){super("google.com"),this.addScope("profile")}static credential(_,M){return Xo._fromParams({providerId:E.PROVIDER_ID,signInMethod:E.GOOGLE_SIGN_IN_METHOD,idToken:_,accessToken:M})}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthIdToken:M,oauthAccessToken:k}=_;if(!M&&!k)return null;try{return E.credential(M,k)}catch(W){return null}}}return E.GOOGLE_SIGN_IN_METHOD="google.com",E.PROVIDER_ID="google.com",E})(),Rd=(()=>{class E extends Oa{constructor(){super("github.com")}static credential(_){return Xo._fromParams({providerId:E.PROVIDER_ID,signInMethod:E.GITHUB_SIGN_IN_METHOD,accessToken:_})}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_||!("oauthAccessToken"in _)||!_.oauthAccessToken)return null;try{return E.credential(_.oauthAccessToken)}catch(M){return null}}}return E.GITHUB_SIGN_IN_METHOD="github.com",E.PROVIDER_ID="github.com",E})();class go extends Ms{constructor(m,_){super(m,m),this.pendingToken=_}_getIdTokenResponse(m){return io(m,this.buildRequest())}_linkToIdToken(m,_){const M=this.buildRequest();return M.idToken=_,io(m,M)}_getReauthenticationResolver(m){const _=this.buildRequest();return _.autoCreate=!1,io(m,_)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(m){const _="string"==typeof m?JSON.parse(m):m,{providerId:M,signInMethod:k,pendingToken:W}=_;return M&&k&&W&&M===k?new go(M,W):null}static _create(m,_){return new go(m,_)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class hs extends ns{constructor(m){ce(m.startsWith("saml."),"argument-error"),super(m)}static credentialFromResult(m){return hs.samlCredentialFromTaggedObject(m)}static credentialFromError(m){return hs.samlCredentialFromTaggedObject(m.customData||{})}static credentialFromJSON(m){const _=go.fromJSON(m);return ce(_,"argument-error"),_}static samlCredentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{pendingToken:_,providerId:M}=m;if(!_||!M)return null;try{return go._create(M,_)}catch(k){return null}}}let Pd=(()=>{class E extends Oa{constructor(){super("twitter.com")}static credential(_,M){return Xo._fromParams({providerId:E.PROVIDER_ID,signInMethod:E.TWITTER_SIGN_IN_METHOD,oauthToken:_,oauthTokenSecret:M})}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{oauthAccessToken:M,oauthTokenSecret:k}=_;if(!M||!k)return null;try{return E.credential(M,k)}catch(W){return null}}}return E.TWITTER_SIGN_IN_METHOD="twitter.com",E.PROVIDER_ID="twitter.com",E})();function Vs(E,m){return Ul.apply(this,arguments)}function Ul(){return(Ul=(0,w.Z)(function*(E,m){return Ls(E,"POST","/v1/accounts:signUp",vi(E,m))})).apply(this,arguments)}class yo{constructor(m){this.user=m.user,this.providerId=m.providerId,this._tokenResponse=m._tokenResponse,this.operationType=m.operationType}static _fromIdTokenResponse(m,_,M,k=!1){return(0,w.Z)(function*(){const W=yield Ln._fromIdTokenResponse(m,M,k),ye=Bu(M);return new yo({user:W,providerId:ye,_tokenResponse:M,operationType:_})})()}static _forOperation(m,_,M){return(0,w.Z)(function*(){yield m._updateTokensIfNecessary(M,!0);const k=Bu(M);return new yo({user:m,providerId:k,_tokenResponse:M,operationType:_})})()}}function Bu(E){return E.providerId?E.providerId:"phoneNumber"in E?"phone":null}function Hu(){return(Hu=(0,w.Z)(function*(E){var m;const _=xn(E);if(yield _._initializationPromise,null===(m=_.currentUser)||void 0===m?void 0:m.isAnonymous)return new yo({user:_.currentUser,providerId:null,operationType:"signIn"});const M=yield Vs(_,{returnSecureToken:!0}),k=yield yo._fromIdTokenResponse(_,"signIn",M,!0);return yield _._updateCurrentUser(k.user),k})).apply(this,arguments)}class Bl extends Y.ZR{constructor(m,_,M,k){var W;super(_.code,_.message),this.operationType=M,this.user=k,Object.setPrototypeOf(this,Bl.prototype),this.customData={appName:m.name,tenantId:null!==(W=m.tenantId)&&void 0!==W?W:void 0,_serverResponse:_.customData._serverResponse,operationType:M}}static _fromErrorAndOperation(m,_,M,k){return new Bl(m,_,M,k)}}function Cs(E,m,_,M){return("reauthenticate"===m?_._getReauthenticationResolver(E):_._getIdTokenResponse(E)).catch(W=>{throw"auth/multi-factor-auth-required"===W.code?Bl._fromErrorAndOperation(E,W,m,M):W})}function Uo(E){return new Set(E.map(({providerId:m})=>m).filter(m=>!!m))}function Fi(){return(Fi=(0,w.Z)(function*(E,m){const _=(0,Y.m9)(E);yield Ri(!0,_,m);const{providerUserInfo:M}=yield qi(_.auth,{idToken:yield _.getIdToken(),deleteProvider:[m]}),k=Uo(M||[]);return _.providerData=_.providerData.filter(W=>k.has(W.providerId)),k.has("phone")||(_.phoneNumber=null),yield _.auth._persistUserIfCurrent(_),_})).apply(this,arguments)}function _c(E,m){return nl.apply(this,arguments)}function nl(){return(nl=(0,w.Z)(function*(E,m,_=!1){const M=yield Jr(E,m._linkToIdToken(E.auth,yield E.getIdToken()),_);return yo._forOperation(E,"link",M)})).apply(this,arguments)}function Ri(E,m,_){return Hl.apply(this,arguments)}function Hl(){return(Hl=(0,w.Z)(function*(E,m,_){yield Hi(m);const k=!1===E?"provider-already-linked":"no-such-provider";ce(Uo(m.providerData).has(_)===E,m.auth,k)})).apply(this,arguments)}function vc(E,m){return ka.apply(this,arguments)}function ka(){return(ka=(0,w.Z)(function*(E,m,_=!1){const{auth:M}=E,k="reauthenticate";try{const W=yield Jr(E,Cs(M,k,m,E),_);ce(W.idToken,M,"internal-error");const ye=_n(W.idToken);ce(ye,M,"internal-error");const{sub:je}=ye;return ce(E.uid===je,M,"user-mismatch"),yo._forOperation(E,k,W)}catch(W){throw"auth/user-not-found"===(null==W?void 0:W.code)&&lt(M,"user-mismatch"),W}})).apply(this,arguments)}function fs(E,m){return iu.apply(this,arguments)}function iu(){return(iu=(0,w.Z)(function*(E,m,_=!1){const M="signIn",k=yield Cs(E,M,m),W=yield yo._fromIdTokenResponse(E,M,k);return _||(yield E._updateCurrentUser(W.user)),W})).apply(this,arguments)}function ur(E,m){return Bo.apply(this,arguments)}function Bo(){return(Bo=(0,w.Z)(function*(E,m){return fs(xn(E),m)})).apply(this,arguments)}function is(E,m){return Fa.apply(this,arguments)}function Fa(){return(Fa=(0,w.Z)(function*(E,m){const _=(0,Y.m9)(E);return yield Ri(!1,_,m.providerId),_c(_,m)})).apply(this,arguments)}function ea(E,m){return wc.apply(this,arguments)}function wc(){return(wc=(0,w.Z)(function*(E,m){return vc((0,Y.m9)(E),m)})).apply(this,arguments)}function _o(E,m){return Ho.apply(this,arguments)}function Ho(){return(Ho=(0,w.Z)(function*(E,m){return Ls(E,"POST","/v1/accounts:signInWithCustomToken",vi(E,m))})).apply(this,arguments)}function Cn(){return(Cn=(0,w.Z)(function*(E,m){const _=xn(E),M=yield _o(_,{token:m,returnSecureToken:!0}),k=yield yo._fromIdTokenResponse(_,"signIn",M);return yield _._updateCurrentUser(k.user),k})).apply(this,arguments)}class rl{constructor(m,_){this.factorId=m,this.uid=_.mfaEnrollmentId,this.enrollmentTime=new Date(_.enrolledAt).toUTCString(),this.displayName=_.displayName}static _fromServerResponse(m,_){return"phoneInfo"in _?bc._fromServerResponse(m,_):lt(m,"internal-error")}}class bc extends rl{constructor(m){super("phone",m),this.phoneNumber=m.phoneInfo}static _fromServerResponse(m,_){return new bc(_)}}function zl(E,m,_){var M;ce((null===(M=_.url)||void 0===M?void 0:M.length)>0,E,"invalid-continue-uri"),ce(void 0===_.dynamicLinkDomain||_.dynamicLinkDomain.length>0,E,"invalid-dynamic-link-domain"),m.continueUrl=_.url,m.dynamicLinkDomain=_.dynamicLinkDomain,m.canHandleCodeInApp=_.handleCodeInApp,_.iOS&&(ce(_.iOS.bundleId.length>0,E,"missing-ios-bundle-id"),m.iOSBundleId=_.iOS.bundleId),_.android&&(ce(_.android.packageName.length>0,E,"missing-android-pkg-name"),m.androidInstallApp=_.android.installApp,m.androidMinimumVersionCode=_.android.minimumVersion,m.androidPackageName=_.android.packageName)}function sl(){return(sl=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E),k={requestType:"PASSWORD_RESET",email:m};_&&zl(M,k,_),yield Na(M,k)})).apply(this,arguments)}function su(){return(su=(0,w.Z)(function*(E,m,_){yield cr((0,Y.m9)(E),{oobCode:m,newPassword:_})})).apply(this,arguments)}function ai(){return(ai=(0,w.Z)(function*(E,m){yield gc((0,Y.m9)(E),{oobCode:m})})).apply(this,arguments)}function xc(E,m){return ir.apply(this,arguments)}function ir(){return(ir=(0,w.Z)(function*(E,m){const _=(0,Y.m9)(E),M=yield cr(_,{oobCode:m}),k=M.requestType;switch(ce(k,_,"internal-error"),k){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":ce(M.newEmail,_,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":ce(M.mfaInfo,_,"internal-error");default:ce(M.email,_,"internal-error")}let W=null;return M.mfaInfo&&(W=rl._fromServerResponse(xn(_),M.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===M.requestType?M.newEmail:M.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===M.requestType?M.email:M.newEmail)||null,multiFactorInfo:W},operation:k}})).apply(this,arguments)}function Us(){return(Us=(0,w.Z)(function*(E,m){const{data:_}=yield xc((0,Y.m9)(E),m);return _.email})).apply(this,arguments)}function Ec(){return(Ec=(0,w.Z)(function*(E,m,_){const M=xn(E),k=yield Vs(M,{returnSecureToken:!0,email:m,password:_}),W=yield yo._fromIdTokenResponse(M,"signIn",k);return yield M._updateCurrentUser(W.user),W})).apply(this,arguments)}function Sc(){return(Sc=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E),k={requestType:"EMAIL_SIGNIN",email:m};ce(_.handleCodeInApp,M,"argument-error"),_&&zl(M,k,_),yield ko(M,k)})).apply(this,arguments)}function Ir(){return(Ir=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E),k=tu.credentialWithLink(m,_||It());return ce(k._tenantId===(M.tenantId||null),M,"tenant-id-mismatch"),ur(M,k)})).apply(this,arguments)}function ma(E,m){return Tc.apply(this,arguments)}function Tc(){return(Tc=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:createAuthUri",vi(E,m))})).apply(this,arguments)}function Bs(){return(Bs=(0,w.Z)(function*(E,m){const M={identifier:m,continueUri:Pe()?It():"http://localhost"},{signinMethods:k}=yield ma((0,Y.m9)(E),M);return k||[]})).apply(this,arguments)}function Ua(){return(Ua=(0,w.Z)(function*(E,m){const _=(0,Y.m9)(E),k={requestType:"VERIFY_EMAIL",idToken:yield E.getIdToken()};m&&zl(_.auth,k,m);const{email:W}=yield Gi(_.auth,k);W!==E.email&&(yield E.reload())})).apply(this,arguments)}function Cc(){return(Cc=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E),W={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield E.getIdToken(),newEmail:m};_&&zl(M.auth,W,_);const{email:ye}=yield Qc(M.auth,W);ye!==E.email&&(yield E.reload())})).apply(this,arguments)}function jl(E,m){return Wl.apply(this,arguments)}function Wl(){return(Wl=(0,w.Z)(function*(E,m){return An(E,"POST","/v1/accounts:update",m)})).apply(this,arguments)}function ql(){return(ql=(0,w.Z)(function*(E,{displayName:m,photoURL:_}){if(void 0===m&&void 0===_)return;const M=(0,Y.m9)(E),W={idToken:yield M.getIdToken(),displayName:m,photoUrl:_,returnSecureToken:!0},ye=yield Jr(M,jl(M.auth,W));M.displayName=ye.displayName||null,M.photoURL=ye.photoUrl||null;const je=M.providerData.find(({providerId:kt})=>"password"===kt);je&&(je.displayName=M.displayName,je.photoURL=M.photoURL),yield M._updateTokensIfNecessary(ye)})).apply(this,arguments)}function Zl(E,m,_){return Ac.apply(this,arguments)}function Ac(){return(Ac=(0,w.Z)(function*(E,m,_){const{auth:M}=E,W={idToken:yield E.getIdToken(),returnSecureToken:!0};m&&(W.email=m),_&&(W.password=_);const ye=yield Jr(E,el(M,W));yield E._updateTokensIfNecessary(ye,!0)})).apply(this,arguments)}class ll{constructor(m,_,M={}){this.isNewUser=m,this.providerId=_,this.profile=M}}class ju extends ll{constructor(m,_,M,k){super(m,_,M),this.username=k}}class Yl extends ll{constructor(m,_){super(m,"facebook.com",_)}}class As extends ju{constructor(m,_){super(m,"github.com",_,"string"==typeof(null==_?void 0:_.login)?null==_?void 0:_.login:null)}}class Wu extends ll{constructor(m,_){super(m,"google.com",_)}}class Wr extends ju{constructor(m,_,M){super(m,"twitter.com",_,M)}}function Hs(E){const{user:m,_tokenResponse:_}=E;return m.isAnonymous&&!_?{providerId:null,isNewUser:!1,profile:null}:function Ic(E){var m,_;if(!E)return null;const{providerId:M}=E,k=E.rawUserInfo?JSON.parse(E.rawUserInfo):{},W=E.isNewUser||"identitytoolkit#SignupNewUserResponse"===E.kind;if(!M&&(null==E?void 0:E.idToken)){const ye=null===(_=null===(m=_n(E.idToken))||void 0===m?void 0:m.firebase)||void 0===_?void 0:_.sign_in_provider;if(ye)return new ll(W,"anonymous"!==ye&&"custom"!==ye?ye:null)}if(!M)return null;switch(M){case"facebook.com":return new Yl(W,k);case"github.com":return new As(W,k);case"google.com":return new Wu(W,k);case"twitter.com":return new Wr(W,k,E.screenName||null);case"custom":case"anonymous":return new ll(W,null);default:return new ll(W,M,k)}}(_)}class wo{constructor(m,_){this.type=m,this.credential=_}static _fromIdtoken(m){return new wo("enroll",m)}static _fromMfaPendingCredential(m){return new wo("signin",m)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(m){var _,M;if(null==m?void 0:m.multiFactorSession){if(null===(_=m.multiFactorSession)||void 0===_?void 0:_.pendingCredential)return wo._fromMfaPendingCredential(m.multiFactorSession.pendingCredential);if(null===(M=m.multiFactorSession)||void 0===M?void 0:M.idToken)return wo._fromIdtoken(m.multiFactorSession.idToken)}return null}}class Jl{constructor(m,_,M){this.session=m,this.hints=_,this.signInResolver=M}static _fromError(m,_){const M=xn(m),k=_.customData._serverResponse,W=(k.mfaInfo||[]).map(je=>rl._fromServerResponse(M,je));ce(k.mfaPendingCredential,M,"internal-error");const ye=wo._fromMfaPendingCredential(k.mfaPendingCredential);return new Jl(ye,W,function(){var je=(0,w.Z)(function*(kt){const on=yield kt._process(M,ye);delete k.mfaInfo,delete k.mfaPendingCredential;const Vn=Object.assign(Object.assign({},k),{idToken:on.idToken,refreshToken:on.refreshToken});switch(_.operationType){case"signIn":const In=yield yo._fromIdTokenResponse(M,_.operationType,Vn);return yield M._updateCurrentUser(In.user),In;case"reauthenticate":return ce(_.user,M,"internal-error"),yo._forOperation(_.user,_.operationType,Vn);default:lt(M,"internal-error")}});return function(kt){return je.apply(this,arguments)}}())}resolveSignIn(m){var _=this;return(0,w.Z)(function*(){return _.signInResolver(m)})()}}function Dc(E,m){return An(E,"POST","/v2/accounts/mfaEnrollment:start",vi(E,m))}class N{constructor(m){this.user=m,this.enrolledFactors=[],m._onReload(_=>{_.mfaInfo&&(this.enrolledFactors=_.mfaInfo.map(M=>rl._fromServerResponse(m.auth,M)))})}static _fromUser(m){return new N(m)}getSession(){var m=this;return(0,w.Z)(function*(){return wo._fromIdtoken(yield m.user.getIdToken())})()}enroll(m,_){var M=this;return(0,w.Z)(function*(){const k=m,W=yield M.getSession(),ye=yield Jr(M.user,k._process(M.user.auth,W,_));return yield M.user._updateTokensIfNecessary(ye),M.user.reload()})()}unenroll(m){var _=this;return(0,w.Z)(function*(){const M="string"==typeof m?m:m.uid,k=yield _.user.getIdToken(),W=yield Jr(_.user,function T(E,m){return An(E,"POST","/v2/accounts/mfaEnrollment:withdraw",vi(E,m))}(_.user.auth,{idToken:k,mfaEnrollmentId:M}));_.enrolledFactors=_.enrolledFactors.filter(({uid:ye})=>ye!==M),yield _.user._updateTokensIfNecessary(W);try{yield _.user.reload()}catch(ye){if("auth/user-token-expired"!==ye.code)throw ye}})()}}const q=new WeakMap,me="__sak";class De{constructor(m,_){this.storageRetriever=m,this.type=_}_isAvailable(){try{return this.storage?(this.storage.setItem(me,"1"),this.storage.removeItem(me),Promise.resolve(!0)):Promise.resolve(!1)}catch(m){return Promise.resolve(!1)}}_set(m,_){return this.storage.setItem(m,JSON.stringify(_)),Promise.resolve()}_get(m){const _=this.storage.getItem(m);return Promise.resolve(_?JSON.parse(_):null)}_remove(m){return this.storage.removeItem(m),Promise.resolve()}get storage(){return this.storageRetriever()}}const Tt=(()=>{class E extends De{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(_,M)=>this.onStorageEvent(_,M),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function yt(){const E=(0,Y.z$)();return mc(E)||Qr(E)}()&&function wr(){try{return!(!window||window===window.top)}catch(E){return!1}}(),this.fallbackToPolling=es(),this._shouldAllowMigration=!0}forAllChangedKeys(_){for(const M of Object.keys(this.listeners)){const k=this.storage.getItem(M),W=this.localCache[M];k!==W&&_(M,W,k)}}onStorageEvent(_,M=!1){if(!_.key)return void this.forAllChangedKeys((je,kt,on)=>{this.notifyListeners(je,on)});const k=_.key;if(M?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const je=this.storage.getItem(k);if(_.newValue!==je)null!==_.newValue?this.storage.setItem(k,_.newValue):this.storage.removeItem(k);else if(this.localCache[k]===_.newValue&&!M)return}const W=()=>{const je=this.storage.getItem(k);!M&&this.localCache[k]===je||this.notifyListeners(k,je)},ye=this.storage.getItem(k);!function Qa(){return(0,Y.w1)()&&10===document.documentMode}()||ye===_.newValue||_.newValue===_.oldValue?W():setTimeout(W,10)}notifyListeners(_,M){this.localCache[_]=M;const k=this.listeners[_];if(k)for(const W of Array.from(k))W(M&&JSON.parse(M))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((_,M,k)=>{this.onStorageEvent(new StorageEvent("storage",{key:_,oldValue:M,newValue:k}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(_,M){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[_]||(this.listeners[_]=new Set,this.localCache[_]=this.storage.getItem(_)),this.listeners[_].add(M)}_removeListener(_,M){this.listeners[_]&&(this.listeners[_].delete(M),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(_,M){var k=()=>super._set,W=this;return(0,w.Z)(function*(){yield k().call(W,_,M),W.localCache[_]=JSON.stringify(M)})()}_get(_){var M=()=>super._get,k=this;return(0,w.Z)(function*(){const W=yield M().call(k,_);return k.localCache[_]=JSON.stringify(W),W})()}_remove(_){var M=()=>super._remove,k=this;return(0,w.Z)(function*(){yield M().call(k,_),delete k.localCache[_]})()}}return E.type="LOCAL",E})(),mn=(()=>{class E extends De{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(_,M){}_removeListener(_,M){}}return E.type="SESSION",E})();let vn=(()=>{class E{constructor(_){this.eventTarget=_,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(_){const M=this.receivers.find(W=>W.isListeningto(_));if(M)return M;const k=new E(_);return this.receivers.push(k),k}isListeningto(_){return this.eventTarget===_}handleEvent(_){var M=this;return(0,w.Z)(function*(){const k=_,{eventId:W,eventType:ye,data:je}=k.data,kt=M.handlersMap[ye];if(!(null==kt?void 0:kt.size))return;k.ports[0].postMessage({status:"ack",eventId:W,eventType:ye});const on=Array.from(kt).map(function(){var In=(0,w.Z)(function*(ss){return ss(k.origin,je)});return function(ss){return In.apply(this,arguments)}}()),Vn=yield function bn(E){return Promise.all(E.map(function(){var m=(0,w.Z)(function*(_){try{return{fulfilled:!0,value:yield _}}catch(M){return{fulfilled:!1,reason:M}}});return function(_){return m.apply(this,arguments)}}()))}(on);k.ports[0].postMessage({status:"done",eventId:W,eventType:ye,response:Vn})})()}_subscribe(_,M){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[_]||(this.handlersMap[_]=new Set),this.handlersMap[_].add(M)}_unsubscribe(_,M){this.handlersMap[_]&&M&&this.handlersMap[_].delete(M),(!M||0===this.handlersMap[_].size)&&delete this.handlersMap[_],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return E.receivers=[],E})();function cn(E="",m=10){let _="";for(let M=0;M<m;M++)_+=Math.floor(10*Math.random());return E+_}class ri{constructor(m){this.target=m,this.handlers=new Set}removeMessageHandler(m){m.messageChannel&&(m.messageChannel.port1.removeEventListener("message",m.onMessage),m.messageChannel.port1.close()),this.handlers.delete(m)}_send(m,_,M=50){var k=this;return(0,w.Z)(function*(){const W="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!W)throw new Error("connection_unavailable");let ye,je;return new Promise((kt,on)=>{const Vn=cn("",20);W.port1.start();const In=setTimeout(()=>{on(new Error("unsupported_event"))},M);je={messageChannel:W,onMessage(ss){const ao=ss;if(ao.data.eventId===Vn)switch(ao.data.status){case"ack":clearTimeout(In),ye=setTimeout(()=>{on(new Error("timeout"))},3e3);break;case"done":clearTimeout(ye),kt(ao.data.response);break;default:clearTimeout(In),clearTimeout(ye),on(new Error("invalid_response"))}}},k.handlers.add(je),W.port1.addEventListener("message",je.onMessage),k.target.postMessage({eventType:m,eventId:Vn,data:_},[W.port2])}).finally(()=>{je&&k.removeMessageHandler(je)})})()}}function St(){return window}function Qn(){return void 0!==St().WorkerGlobalScope&&"function"==typeof St().importScripts}function li(){return(li=(0,w.Z)(function*(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{return(yield navigator.serviceWorker.ready).active}catch(E){return null}})).apply(this,arguments)}const Xi="firebaseLocalStorageDb",br="firebaseLocalStorage",rr="fbase_key";class Zi{constructor(m){this.request=m}toPromise(){return new Promise((m,_)=>{this.request.addEventListener("success",()=>{m(this.request.result)}),this.request.addEventListener("error",()=>{_(this.request.error)})})}}function xr(E,m){return E.transaction([br],m?"readwrite":"readonly").objectStore(br)}function zs(){const E=indexedDB.open(Xi,1);return new Promise((m,_)=>{E.addEventListener("error",()=>{_(E.error)}),E.addEventListener("upgradeneeded",()=>{const M=E.result;try{M.createObjectStore(br,{keyPath:rr})}catch(k){_(k)}}),E.addEventListener("success",(0,w.Z)(function*(){const M=E.result;M.objectStoreNames.contains(br)?m(M):(M.close(),yield function ta(){const E=indexedDB.deleteDatabase(Xi);return new Zi(E).toPromise()}(),m(yield zs()))}))})}function mr(E,m,_){return Yi.apply(this,arguments)}function Yi(){return(Yi=(0,w.Z)(function*(E,m,_){const M=xr(E,!0).put({[rr]:m,value:_});return new Zi(M).toPromise()})).apply(this,arguments)}function sr(){return(sr=(0,w.Z)(function*(E,m){const _=xr(E,!1).get(m),M=yield new Zi(_).toPromise();return void 0===M?null:M.value})).apply(this,arguments)}function ci(E,m){const _=xr(E,!0).delete(m);return new Zi(_).toPromise()}const ro=(()=>{class E{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var _=this;return(0,w.Z)(function*(){return _.db||(_.db=yield zs()),_.db})()}_withRetries(_){var M=this;return(0,w.Z)(function*(){let k=0;for(;;)try{const W=yield M._openDb();return yield _(W)}catch(W){if(k++>3)throw W;M.db&&(M.db.close(),M.db=void 0)}})()}initializeServiceWorkerMessaging(){var _=this;return(0,w.Z)(function*(){return Qn()?_.initializeReceiver():_.initializeSender()})()}initializeReceiver(){var _=this;return(0,w.Z)(function*(){_.receiver=vn._getInstance(function Pi(){return Qn()?self:null}()),_.receiver._subscribe("keyChanged",function(){var M=(0,w.Z)(function*(k,W){return{keyProcessed:(yield _._poll()).includes(W.key)}});return function(k,W){return M.apply(this,arguments)}}()),_.receiver._subscribe("ping",function(){var M=(0,w.Z)(function*(k,W){return["keyChanged"]});return function(k,W){return M.apply(this,arguments)}}())})()}initializeSender(){var _=this;return(0,w.Z)(function*(){var M,k;if(_.activeServiceWorker=yield function qn(){return li.apply(this,arguments)}(),!_.activeServiceWorker)return;_.sender=new ri(_.activeServiceWorker);const W=yield _.sender._send("ping",{},800);!W||(null===(M=W[0])||void 0===M?void 0:M.fulfilled)&&(null===(k=W[0])||void 0===k?void 0:k.value.includes("keyChanged"))&&(_.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(_){var M=this;return(0,w.Z)(function*(){if(M.sender&&M.activeServiceWorker&&function Ii(){var E;return(null===(E=null==navigator?void 0:navigator.serviceWorker)||void 0===E?void 0:E.controller)||null}()===M.activeServiceWorker)try{yield M.sender._send("keyChanged",{key:_},M.serviceWorkerReceiverAvailable?800:50)}catch(k){}})()}_isAvailable(){return(0,w.Z)(function*(){try{if(!indexedDB)return!1;const _=yield zs();return yield mr(_,me,"1"),yield ci(_,me),!0}catch(_){}return!1})()}_withPendingWrite(_){var M=this;return(0,w.Z)(function*(){M.pendingWrites++;try{yield _()}finally{M.pendingWrites--}})()}_set(_,M){var k=this;return(0,w.Z)(function*(){return k._withPendingWrite((0,w.Z)(function*(){return yield k._withRetries(W=>mr(W,_,M)),k.localCache[_]=M,k.notifyServiceWorker(_)}))})()}_get(_){var M=this;return(0,w.Z)(function*(){const k=yield M._withRetries(W=>function ya(E,m){return sr.apply(this,arguments)}(W,_));return M.localCache[_]=k,k})()}_remove(_){var M=this;return(0,w.Z)(function*(){return M._withPendingWrite((0,w.Z)(function*(){return yield M._withRetries(k=>ci(k,_)),delete M.localCache[_],M.notifyServiceWorker(_)}))})()}_poll(){var _=this;return(0,w.Z)(function*(){const M=yield _._withRetries(ye=>{const je=xr(ye,!1).getAll();return new Zi(je).toPromise()});if(!M)return[];if(0!==_.pendingWrites)return[];const k=[],W=new Set;for(const{fbase_key:ye,value:je}of M)W.add(ye),JSON.stringify(_.localCache[ye])!==JSON.stringify(je)&&(_.notifyListeners(ye,je),k.push(ye));for(const ye of Object.keys(_.localCache))_.localCache[ye]&&!W.has(ye)&&(_.notifyListeners(ye,null),k.push(ye));return k})()}notifyListeners(_,M){this.localCache[_]=M;const k=this.listeners[_];if(k)for(const W of Array.from(k))W(M)}startPolling(){var _=this;this.stopPolling(),this.pollTimer=setInterval((0,w.Z)(function*(){return _._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(_,M){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[_]||(this.listeners[_]=new Set,this._get(_)),this.listeners[_].add(M)}_removeListener(_,M){this.listeners[_]&&(this.listeners[_].delete(M),0===this.listeners[_].size&&delete this.listeners[_]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return E.type="LOCAL",E})();function Ql(E,m){return An(E,"POST","/v2/accounts/mfaSignIn:start",vi(E,m))}function ec(){return(ec=(0,w.Z)(function*(E){return(yield An(E,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function hl(E){return new Promise((m,_)=>{const M=document.createElement("script");M.setAttribute("src",E),M.onload=m,M.onerror=k=>{const W=Ye("internal-error");W.customData=k,_(W)},M.type="text/javascript",M.charset="UTF-8",function tc(){var E,m;return null!==(m=null===(E=document.getElementsByTagName("head"))||void 0===E?void 0:E[0])&&void 0!==m?m:document}().appendChild(M)})}function _a(E){return`__${E}${Math.floor(1e6*Math.random())}`}const au=1e12;class Ba{constructor(m){this.auth=m,this.counter=au,this._widgets=new Map}render(m,_){const M=this.counter;return this._widgets.set(M,new tp(m,this.auth.name,_||{})),this.counter++,M}reset(m){var _;const M=m||au;null===(_=this._widgets.get(M))||void 0===_||_.delete(),this._widgets.delete(M)}getResponse(m){var _;return(null===(_=this._widgets.get(m||au))||void 0===_?void 0:_.getResponse())||""}execute(m){var _=this;return(0,w.Z)(function*(){var M;return null===(M=_._widgets.get(m||au))||void 0===M||M.execute(),""})()}}class tp{constructor(m,_,M){this.params=M,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const k="string"==typeof m?document.getElementById(m):m;ce(k,"argument-error",{appName:_}),this.container=k,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Ku(E){const m=[],_="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let M=0;M<E;M++)m.push(_.charAt(Math.floor(Math.random()*_.length)));return m.join("")}(50);const{callback:m,"expired-callback":_}=this.params;if(m)try{m(this.responseToken)}catch(M){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,_)try{_()}catch(M){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const hr=_a("rcb"),__=new Ci(3e4,6e4);class Wm{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!St().grecaptcha}load(m,_=""){return ce(function np(E){return E.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(E)}(_),m,"argument-error"),this.shouldResolveImmediately(_)?Promise.resolve(St().grecaptcha):new Promise((M,k)=>{const W=St().setTimeout(()=>{k(Ye(m,"network-request-failed"))},__.get());St()[hr]=()=>{St().clearTimeout(W),delete St()[hr];const je=St().grecaptcha;if(!je)return void k(Ye(m,"internal-error"));const kt=je.render;je.render=(on,Vn)=>{const In=kt(on,Vn);return this.counter++,In},this.hostLanguage=_,M(je)},hl(`https://www.google.com/recaptcha/api.js??${(0,Y.xO)({onload:hr,render:"explicit",hl:_})}`).catch(()=>{clearTimeout(W),k(Ye(m,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(m){return!!St().grecaptcha&&(m===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ip{load(m){return(0,w.Z)(function*(){return new Ba(m)})()}clearedOneInstance(){}}const rp="recaptcha",sp={theme:"light",type:"image"};class Zu{constructor(m,_=Object.assign({},sp),M){this.parameters=_,this.type=rp,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=xn(M),this.isInvisible="invisible"===this.parameters.size,ce("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const k="string"==typeof m?document.getElementById(m):m;ce(k,this.auth,"argument-error"),this.container=k,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ip:new Wm,this.validateStartingState()}verify(){var m=this;return(0,w.Z)(function*(){m.assertNotDestroyed();const _=yield m.render(),M=m.getAssertedRecaptcha();return M.getResponse(_)||new Promise(W=>{const ye=je=>{!je||(m.tokenChangeListeners.delete(ye),W(je))};m.tokenChangeListeners.add(ye),m.isInvisible&&M.execute(_)})})()}render(){try{this.assertNotDestroyed()}catch(m){return Promise.reject(m)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(m=>{throw this.renderPromise=null,m})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(m=>{this.container.removeChild(m)})}validateStartingState(){ce(!this.parameters.sitekey,this.auth,"argument-error"),ce(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),ce("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(m){return _=>{if(this.tokenChangeListeners.forEach(M=>M(_)),"function"==typeof m)m(_);else if("string"==typeof m){const M=St()[m];"function"==typeof M&&M(_)}}}assertNotDestroyed(){ce(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var m=this;return(0,w.Z)(function*(){if(yield m.init(),!m.widgetId){let _=m.container;if(!m.isInvisible){const M=document.createElement("div");_.appendChild(M),_=M}m.widgetId=m.getAssertedRecaptcha().render(_,m.parameters)}return m.widgetId})()}init(){var m=this;return(0,w.Z)(function*(){ce(Pe()&&!Qn(),m.auth,"internal-error"),yield function bw(){let E=null;return new Promise(m=>{"complete"!==document.readyState?(E=()=>m(),window.addEventListener("load",E)):m()}).catch(m=>{throw E&&window.removeEventListener("load",E),m})}(),m.recaptcha=yield m._recaptchaLoader.load(m.auth,m.auth.languageCode||void 0);const _=yield function dl(E){return ec.apply(this,arguments)}(m.auth);ce(_,m.auth,"internal-error"),m.parameters.sitekey=_})()}getAssertedRecaptcha(){return ce(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class qr{constructor(m,_){this.verificationId=m,this.onConfirmation=_}confirm(m){const _=fa._fromVerification(this.verificationId,m);return this.onConfirmation(_)}}function Rc(){return(Rc=(0,w.Z)(function*(E,m,_){const M=xn(E),k=yield kr(M,m,(0,Y.m9)(_));return new qr(k,W=>ur(M,W))})).apply(this,arguments)}function op(){return(op=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E);yield Ri(!1,M,"phone");const k=yield kr(M.auth,m,(0,Y.m9)(_));return new qr(k,W=>is(M,W))})).apply(this,arguments)}function ia(){return(ia=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E),k=yield kr(M.auth,m,(0,Y.m9)(_));return new qr(k,W=>ea(M,W))})).apply(this,arguments)}function kr(E,m,_){return fl.apply(this,arguments)}function fl(){return(fl=(0,w.Z)(function*(E,m,_){var M;const k=yield _.verify();try{let W;if(ce("string"==typeof k,E,"argument-error"),ce(_.type===rp,E,"argument-error"),W="string"==typeof m?{phoneNumber:m}:m,"session"in W){const ye=W.session;if("phoneNumber"in W)return ce("enroll"===ye.type,E,"internal-error"),(yield Dc(E,{idToken:ye.credential,phoneEnrollmentInfo:{phoneNumber:W.phoneNumber,recaptchaToken:k}})).phoneSessionInfo.sessionInfo;{ce("signin"===ye.type,E,"internal-error");const je=(null===(M=W.multiFactorHint)||void 0===M?void 0:M.uid)||W.multiFactorUid;return ce(je,E,"missing-multi-factor-info"),(yield Ql(E,{mfaPendingCredential:ye.credential,mfaEnrollmentId:je,phoneSignInInfo:{recaptchaToken:k}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:ye}=yield Dh(E,{phoneNumber:W.phoneNumber,recaptchaToken:k});return ye}}finally{_._reset()}})).apply(this,arguments)}function ic(){return(ic=(0,w.Z)(function*(E,m){yield _c((0,Y.m9)(E),m)})).apply(this,arguments)}let Ha=(()=>{class E{constructor(_){this.providerId=E.PROVIDER_ID,this.auth=xn(_)}verifyPhoneNumber(_,M){return kr(this.auth,_,(0,Y.m9)(M))}static credential(_,M){return fa._fromVerification(_,M)}static credentialFromResult(_){return E.credentialFromTaggedObject(_)}static credentialFromError(_){return E.credentialFromTaggedObject(_.customData||{})}static credentialFromTaggedObject({_tokenResponse:_}){if(!_)return null;const{phoneNumber:M,temporaryProof:k}=_;return M&&k?fa._fromTokenResponse(M,k):null}}return E.PROVIDER_ID="phone",E.PHONE_SIGN_IN_METHOD="phone",E})();function va(E,m){return m?Te(m):(ce(E._popupRedirectResolver,E,"argument-error"),E._popupRedirectResolver)}class kd extends Ms{constructor(m){super("custom","custom"),this.params=m}_getIdTokenResponse(m){return io(m,this._buildIdpRequest())}_linkToIdToken(m,_){return io(m,this._buildIdpRequest(_))}_getReauthenticationResolver(m){return io(m,this._buildIdpRequest())}_buildIdpRequest(m){const _={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return m&&(_.idToken=m),_}}function lu(E){return fs(E.auth,new kd(E),E.bypassAuthState)}function rc(E){const{auth:m,user:_}=E;return ce(_,m,"internal-error"),vc(_,new kd(E),E.bypassAuthState)}function ra(E){return Fd.apply(this,arguments)}function Fd(){return(Fd=(0,w.Z)(function*(E){const{auth:m,user:_}=E;return ce(_,m,"internal-error"),_c(_,new kd(E),E.bypassAuthState)})).apply(this,arguments)}class Yu{constructor(m,_,M,k,W=!1){this.auth=m,this.resolver=M,this.user=k,this.bypassAuthState=W,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(_)?_:[_]}execute(){var m=this;return new Promise(function(){var _=(0,w.Z)(function*(M,k){m.pendingPromise={resolve:M,reject:k};try{m.eventManager=yield m.resolver._initialize(m.auth),yield m.onExecution(),m.eventManager.registerConsumer(m)}catch(W){m.reject(W)}});return function(M,k){return _.apply(this,arguments)}}())}onAuthEvent(m){var _=this;return(0,w.Z)(function*(){const{urlResponse:M,sessionId:k,postBody:W,tenantId:ye,error:je,type:kt}=m;if(je)return void _.reject(je);const on={auth:_.auth,requestUri:M,sessionId:k,tenantId:ye||void 0,postBody:W||void 0,user:_.user,bypassAuthState:_.bypassAuthState};try{_.resolve(yield _.getIdpTask(kt)(on))}catch(Vn){_.reject(Vn)}})()}onError(m){this.reject(m)}getIdpTask(m){switch(m){case"signInViaPopup":case"signInViaRedirect":return lu;case"linkViaPopup":case"linkViaRedirect":return ra;case"reauthViaPopup":case"reauthViaRedirect":return rc;default:lt(this.auth,"internal-error")}}resolve(m){ve(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(m),this.unregisterAndCleanUp()}reject(m){ve(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(m),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const w_=new Ci(2e3,1e4);function bo(){return(bo=(0,w.Z)(function*(E,m,_){const M=xn(E);Bt(E,m,ns);const k=va(M,_);return new sa(M,"signInViaPopup",m,k).executeNotNull()})).apply(this,arguments)}function za(){return(za=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E);Bt(M.auth,m,ns);const k=va(M.auth,_);return new sa(M.auth,"reauthViaPopup",m,k,M).executeNotNull()})).apply(this,arguments)}function pl(){return(pl=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E);Bt(M.auth,m,ns);const k=va(M.auth,_);return new sa(M.auth,"linkViaPopup",m,k,M).executeNotNull()})).apply(this,arguments)}let sa=(()=>{class E extends Yu{constructor(_,M,k,W,ye){super(_,M,W,ye),this.provider=k,this.authWindow=null,this.pollId=null,E.currentPopupAction&&E.currentPopupAction.cancel(),E.currentPopupAction=this}executeNotNull(){var _=this;return(0,w.Z)(function*(){const M=yield _.execute();return ce(M,_.auth,"internal-error"),M})()}onExecution(){var _=this;return(0,w.Z)(function*(){ve(1===_.filter.length,"Popup operations only handle one event");const M=cn();_.authWindow=yield _.resolver._openPopup(_.auth,_.provider,_.filter[0],M),_.authWindow.associatedEvent=M,_.resolver._originValidation(_.auth).catch(k=>{_.reject(k)}),_.resolver._isIframeWebStorageSupported(_.auth,k=>{k||_.reject(Ye(_.auth,"web-storage-unsupported"))}),_.pollUserCancellation()})()}get eventId(){var _;return(null===(_=this.authWindow)||void 0===_?void 0:_.associatedEvent)||null}cancel(){this.reject(Ye(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,E.currentPopupAction=null}pollUserCancellation(){const _=()=>{var M,k;this.pollId=(null===(k=null===(M=this.authWindow)||void 0===M?void 0:M.window)||void 0===k?void 0:k.closed)?window.setTimeout(()=>{this.pollId=null,this.reject(Ye(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(_,w_.get())};_()}}return E.currentPopupAction=null,E})();const ml=new Map;class Zn extends Yu{constructor(m,_,M=!1){super(m,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],_,void 0,M),this.eventId=null}execute(){var m=()=>super.execute,_=this;return(0,w.Z)(function*(){let M=ml.get(_.auth._key());if(!M){try{const W=(yield function gl(E,m){return Nc.apply(this,arguments)}(_.resolver,_.auth))?yield m().call(_):null;M=()=>Promise.resolve(W)}catch(k){M=()=>Promise.reject(k)}ml.set(_.auth._key(),M)}return _.bypassAuthState||ml.set(_.auth._key(),()=>Promise.resolve(null)),M()})()}onAuthEvent(m){var _=()=>super.onAuthEvent,M=this;return(0,w.Z)(function*(){if("signInViaRedirect"===m.type)return _().call(M,m);if("unknown"!==m.type){if(m.eventId){const k=yield M.auth._redirectUserForId(m.eventId);if(k)return M.user=k,_().call(M,m);M.resolve(null)}}else M.resolve(null)})()}onExecution(){return(0,w.Z)(function*(){})()}cleanUp(){}}function Nc(){return(Nc=(0,w.Z)(function*(E,m){const _=te(m),M=G(E);if(!(yield M._isAvailable()))return!1;const k="true"===(yield M._get(_));return yield M._remove(_),k})).apply(this,arguments)}function Ga(E,m){return ap.apply(this,arguments)}function ap(){return(ap=(0,w.Z)(function*(E,m){return G(E)._set(te(m),"true")})).apply(this,arguments)}function O(E,m){ml.set(E._key(),m)}function G(E){return Te(E._redirectPersistence)}function te(E){return Or("pendingRedirect",E.config.apiKey,E.name)}function nt(){return(nt=(0,w.Z)(function*(E,m,_){const M=xn(E);Bt(E,m,ns);const k=va(M,_);return yield Ga(k,M),k._openRedirect(M,m,"signInViaRedirect")})).apply(this,arguments)}function ui(){return(ui=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E);Bt(M.auth,m,ns);const k=va(M.auth,_);yield Ga(k,M.auth);const W=yield Is(M);return k._openRedirect(M.auth,m,"reauthViaRedirect",W)})).apply(this,arguments)}function so(){return(so=(0,w.Z)(function*(E,m,_){const M=(0,Y.m9)(E);Bt(M.auth,m,ns);const k=va(M.auth,_);yield Ri(!1,M,m.providerId),yield Ga(k,M.auth);const W=yield Is(M);return k._openRedirect(M.auth,m,"linkViaRedirect",W)})).apply(this,arguments)}function sc(){return(sc=(0,w.Z)(function*(E,m){return yield xn(E)._initializationPromise,Eo(E,m,!1)})).apply(this,arguments)}function Eo(E,m){return zo.apply(this,arguments)}function zo(){return(zo=(0,w.Z)(function*(E,m,_=!1){const M=xn(E),k=va(M,m),ye=yield new Zn(M,k,_).execute();return ye&&!_&&(delete ye.user._redirectEventId,yield M._persistUserIfCurrent(ye.user),yield M._setRedirectUser(null,m)),ye})).apply(this,arguments)}function Is(E){return wa.apply(this,arguments)}function wa(){return(wa=(0,w.Z)(function*(E){const m=cn(`${E.uid}:::`);return E._redirectEventId=m,yield E.auth._setRedirectUser(E),yield E.auth._persistUserIfCurrent(E),m})).apply(this,arguments)}class ja{constructor(m){this.auth=m,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(m){this.consumers.add(m),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,m)&&(this.sendToConsumer(this.queuedRedirectEvent,m),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(m){this.consumers.delete(m)}onEvent(m){if(this.hasEventBeenHandled(m))return!1;let _=!1;return this.consumers.forEach(M=>{this.isEventForConsumer(m,M)&&(_=!0,this.sendToConsumer(m,M),this.saveEventToCache(m))}),this.hasHandledPotentialRedirect||!function $m(E){switch(E.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return oc(E);default:return!1}}(m)||(this.hasHandledPotentialRedirect=!0,_||(this.queuedRedirectEvent=m,_=!0)),_}sendToConsumer(m,_){var M;if(m.error&&!oc(m)){const k=(null===(M=m.error.code)||void 0===M?void 0:M.split("auth/")[1])||"internal-error";_.onError(Ye(this.auth,k))}else _.onAuthEvent(m)}isEventForConsumer(m,_){const M=null===_.eventId||!!m.eventId&&m.eventId===_.eventId;return _.filter.includes(m.type)&&M}hasEventBeenHandled(m){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Wa(m))}saveEventToCache(m){this.cachedEventUids.add(Wa(m)),this.lastProcessedEventTime=Date.now()}}function Wa(E){return[E.type,E.eventId,E.sessionId,E.tenantId].filter(m=>m).join("-")}function oc({type:E,error:m}){return"unknown"===E&&"auth/no-auth-event"===(null==m?void 0:m.code)}function qm(E){return lp.apply(this,arguments)}function lp(){return(lp=(0,w.Z)(function*(E,m={}){return An(E,"GET","/v1/projects",m)})).apply(this,arguments)}const cu=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,kh=/^https?/;function Ju(){return(Ju=(0,w.Z)(function*(E){if(E.config.emulator)return;const{authorizedDomains:m}=yield qm(E);for(const _ of m)try{if(Km(_))return}catch(M){}lt(E,"unauthorized-domain")})).apply(this,arguments)}function Km(E){const m=It(),{protocol:_,hostname:M}=new URL(m);if(E.startsWith("chrome-extension://")){const ye=new URL(E);return""===ye.hostname&&""===M?"chrome-extension:"===_&&E.replace("chrome-extension://","")===m.replace("chrome-extension://",""):"chrome-extension:"===_&&ye.hostname===M}if(!kh.test(_))return!1;if(cu.test(E))return M===E;const k=E.replace(/\./g,"\\.");return new RegExp("^(.+\\."+k+"|"+k+")$","i").test(M)}const Zm=new Ci(3e4,6e4);function b_(){const E=St().___jsl;if(null==E?void 0:E.H)for(const m of Object.keys(E.H))if(E.H[m].r=E.H[m].r||[],E.H[m].L=E.H[m].L||[],E.H[m].r=[...E.H[m].L],E.CP)for(let _=0;_<E.CP.length;_++)E.CP[_]=null}let Fh=null;function cp(E){return Fh=Fh||function Ew(E){return new Promise((m,_)=>{var M,k,W;function ye(){b_(),gapi.load("gapi.iframes",{callback:()=>{m(gapi.iframes.getContext())},ontimeout:()=>{b_(),_(Ye(E,"network-request-failed"))},timeout:Zm.get()})}if(null===(k=null===(M=St().gapi)||void 0===M?void 0:M.iframes)||void 0===k?void 0:k.Iframe)m(gapi.iframes.getContext());else{if(!(null===(W=St().gapi)||void 0===W?void 0:W.load)){const je=_a("iframefcb");return St()[je]=()=>{gapi.load?ye():_(Ye(E,"network-request-failed"))},hl(`https://apis.google.com/js/api.js?onload=${je}`).catch(kt=>_(kt))}ye()}}).catch(m=>{throw Fh=null,m})}(E),Fh}const Vd=new Ci(5e3,15e3),Sw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Tw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function x_(E){const m=E.config;ce(m.authDomain,E,"auth-domain-config-required");const _=m.emulator?nr(m,"emulator/auth/iframe"):`https://${E.config.authDomain}/__/auth/iframe`,M={apiKey:m.apiKey,appName:E.name,v:Oe.SDK_VERSION},k=Tw.get(E.config.apiHost);k&&(M.eid=k);const W=E._getFrameworks();return W.length&&(M.fw=W.join(",")),`${_}?${(0,Y.xO)(M).slice(1)}`}function Bh(){return Bh=(0,w.Z)(function*(E){const m=yield cp(E),_=St().gapi;return ce(_,E,"internal-error"),m.open({where:document.body,url:x_(E),messageHandlersFilter:_.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Sw,dontclear:!0},M=>new Promise(function(){var k=(0,w.Z)(function*(W,ye){yield M.restyle({setHideOnLeave:!1});const je=Ye(E,"network-request-failed"),kt=St().setTimeout(()=>{ye(je)},Vd.get());function on(){St().clearTimeout(kt),W(M)}M.ping(on).then(on,()=>{ye(je)})});return function(W,ye){return k.apply(this,arguments)}}()))}),Bh.apply(this,arguments)}const E_={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class T_{constructor(m){this.window=m,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(m){}}}function Oc(E,m,_,M,k,W){ce(E.config.authDomain,E,"auth-domain-config-required"),ce(E.config.apiKey,E,"invalid-api-key");const ye={apiKey:E.config.apiKey,appName:E.name,authType:_,redirectUrl:M,v:Oe.SDK_VERSION,eventId:k};if(m instanceof ns){m.setDefaultLanguage(E.languageCode),ye.providerId=m.providerId||"",(0,Y.xb)(m.getCustomParameters())||(ye.customParameters=JSON.stringify(m.getCustomParameters()));for(const[kt,on]of Object.entries(W||{}))ye[kt]=on}if(m instanceof Oa){const kt=m.getScopes().filter(on=>""!==on);kt.length>0&&(ye.scopes=kt.join(","))}E.tenantId&&(ye.tid=E.tenantId);const je=ye;for(const kt of Object.keys(je))void 0===je[kt]&&delete je[kt];return`${function Ym({config:E}){return E.emulator?nr(E,"emulator/auth/handler"):`https://${E.authDomain}/__/auth/handler`}(E)}?${(0,Y.xO)(je).slice(1)}`}const hp="webStorageSupport";class Xm extends class TS{constructor(m){this.factorId=m}_process(m,_,M){switch(_.type){case"enroll":return this._finalizeEnroll(m,_.credential,M);case"signin":return this._finalizeSignIn(m,_.credential);default:return Xe("unexpected MultiFactorSessionType")}}}{constructor(m){super("phone"),this.credential=m}static _fromCredential(m){return new Xm(m)}_finalizeEnroll(m,_,M){return function H(E,m){return An(E,"POST","/v2/accounts/mfaEnrollment:finalize",vi(E,m))}(m,{idToken:_,displayName:M,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(m,_){return function ul(E,m){return An(E,"POST","/v2/accounts/mfaSignIn:finalize",vi(E,m))}(m,{mfaPendingCredential:_,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let Jm=(()=>{class E{constructor(){}static assertion(_){return Xm._fromCredential(_)}}return E.FACTOR_ID="phone",E})();var fp="@firebase/auth";class Aw{constructor(m){this.auth=m,this.internalListeners=new Map}getUid(){var m;return this.assertAuthConfigured(),(null===(m=this.auth.currentUser)||void 0===m?void 0:m.uid)||null}getToken(m){var _=this;return(0,w.Z)(function*(){return _.assertAuthConfigured(),yield _.auth._initializationPromise,_.auth.currentUser?{accessToken:yield _.auth.currentUser.getIdToken(m)}:null})()}addAuthTokenListener(m){if(this.assertAuthConfigured(),this.internalListeners.has(m))return;const _=this.auth.onIdTokenChanged(M=>{var k;m((null===(k=M)||void 0===k?void 0:k.stsTokenManager.accessToken)||null)});this.internalListeners.set(m,_),this.updateProactiveRefresh()}removeAuthTokenListener(m){this.assertAuthConfigured();const _=this.internalListeners.get(m);!_||(this.internalListeners.delete(m),_(),this.updateProactiveRefresh())}assertAuthConfigured(){ce(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function fr(){return window}function Lc(){return(Lc=(0,w.Z)(function*(E,m,_){var M;const{BuildInfo:k}=fr();ve(m.sessionId,"AuthEvent did not contain a session ID");const W=yield zh(m.sessionId),ye={};return Qr()?ye.ibi=k.packageName:Ts()?ye.apn=k.packageName:lt(E,"operation-not-supported-in-this-environment"),k.displayName&&(ye.appDisplayName=k.displayName),ye.sessionId=W,Oc(E,_,m.type,void 0,null!==(M=m.eventId)&&void 0!==M?M:void 0,ye)})).apply(this,arguments)}function pp(){return(pp=(0,w.Z)(function*(E){const{BuildInfo:m}=fr(),_={};Qr()?_.iosBundleId=m.packageName:Ts()?_.androidPackageName=m.packageName:lt(E,"operation-not-supported-in-this-environment"),yield qm(E,_)})).apply(this,arguments)}function D_(){return(D_=(0,w.Z)(function*(E,m,_){const{cordova:M}=fr();let k=()=>{};try{yield new Promise((W,ye)=>{let je=null;function kt(){var In;W();const ss=null===(In=M.plugins.browsertab)||void 0===In?void 0:In.close;"function"==typeof ss&&ss(),"function"==typeof(null==_?void 0:_.close)&&_.close()}function on(){je||(je=window.setTimeout(()=>{ye(Ye(E,"redirect-cancelled-by-user"))},2e3))}function Vn(){"visible"===(null==document?void 0:document.visibilityState)&&on()}m.addPassiveListener(kt),document.addEventListener("resume",on,!1),Ts()&&document.addEventListener("visibilitychange",Vn,!1),k=()=>{m.removePassiveListener(kt),document.removeEventListener("resume",on,!1),document.removeEventListener("visibilitychange",Vn,!1),je&&window.clearTimeout(je)}})}finally{k()}})).apply(this,arguments)}function zh(E){return Gh.apply(this,arguments)}function Gh(){return(Gh=(0,w.Z)(function*(E){const m=jh(E),_=yield crypto.subtle.digest("SHA-256",m);return Array.from(new Uint8Array(_)).map(k=>k.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function jh(E){if(ve(/[0-9a-zA-Z]+/.test(E),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(E);const m=new ArrayBuffer(E.length),_=new Uint8Array(m);for(let M=0;M<E.length;M++)_[M]=E.charCodeAt(M);return _}!function C_(E){(0,Oe._registerComponent)(new Fe.wA("auth",(m,{options:_})=>{const M=m.getProvider("app").getImmediate(),k=m.getProvider("heartbeat"),{apiKey:W,authDomain:ye}=M.options;return((je,kt)=>{ce(W&&!W.includes(":"),"invalid-api-key",{appName:je.name}),ce(!(null==ye?void 0:ye.includes(":")),"argument-error",{appName:je.name});const on={apiKey:W,authDomain:ye,clientPlatform:E,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ra(E)},Vn=new Vt(je,kt,on);return function ke(E,m){const _=(null==m?void 0:m.persistence)||[],M=(Array.isArray(_)?_:[_]).map(Te);(null==m?void 0:m.errorMap)&&E._updateErrorMap(m.errorMap),E._initializeWithPersistence(M,null==m?void 0:m.popupRedirectResolver)}(Vn,_),Vn})(M,k)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((m,_,M)=>{m.getProvider("auth-internal").initialize()})),(0,Oe._registerComponent)(new Fe.wA("auth-internal",m=>{const _=xn(m.getProvider("auth").getImmediate());return new Aw(_)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,Oe.registerVersion)(fp,"0.20.3",function eg(E){switch(E){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(E)),(0,Oe.registerVersion)(fp,"0.20.3","esm2017")}("Browser");class CS extends ja{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(m=>{this.resolveInialized=m})}addPassiveListener(m){this.passiveListeners.add(m)}removePassiveListener(m){this.passiveListeners.delete(m)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(m){return this.resolveInialized(),this.passiveListeners.forEach(_=>_(m)),super.onEvent(m)}initialized(){var m=this;return(0,w.Z)(function*(){yield m.initPromise})()}}function mp(E){return gp.apply(this,arguments)}function gp(){return(gp=(0,w.Z)(function*(E){const m=yield Qu()._get(yp(E));return m&&(yield Qu()._remove(yp(E))),m})).apply(this,arguments)}function Bd(){const E=[],m="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let _=0;_<20;_++){const M=Math.floor(Math.random()*m.length);E.push(m.charAt(M))}return E.join("")}function Qu(){return Te(Tt)}function yp(E){return Or("authEvent",E.config.apiKey,E.name)}function Fr(E){if(!(null==E?void 0:E.includes("?")))return{};const[m,..._]=E.split("?");return(0,Y.zd)(_.join("?"))}function rg(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Ye("no-auth-event")}}function kc(){var E;return(null===(E=null==self?void 0:self.location)||void 0===E?void 0:E.protocol)||null}function Go(E=(0,Y.z$)()){return!("file:"!==kc()&&"ionic:"!==kc()&&"capacitor:"!==kc()||!E.toLowerCase().match(/iphone|ipad|ipod|android/))}function $h(){try{const E=self.localStorage,m=cn();if(E)return E.setItem(m,"1"),E.removeItem(m),!function sg(E=(0,Y.z$)()){return function Ds(){return(0,Y.w1)()&&11===(null==document?void 0:document.documentMode)}()||function Gd(E=(0,Y.z$)()){return/Edge\/\d+/.test(E)}(E)}()||(0,Y.hl)()}catch(E){return Rs()&&(0,Y.hl)()}return!1}function Rs(){return"undefined"!=typeof global&&"WorkerGlobalScope"in global&&"importScripts"in global}function du(){return(function Pw(){return"http:"===kc()||"https:"===kc()}()||(0,Y.ru)()||Go())&&!function zd(){return(0,Y.b$)()||(0,Y.UG)()}()&&$h()&&!Rs()}function hu(){return Go()&&"undefined"!=typeof document}function qh(){return(qh=(0,w.Z)(function*(){return!!hu()&&new Promise(E=>{const m=setTimeout(()=>{E(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(m),E(!0)})})})).apply(this,arguments)}const So={LOCAL:"local",NONE:"none",SESSION:"session"},lc=ce,ag="persistence";function Kh(E){return jd.apply(this,arguments)}function jd(){return(jd=(0,w.Z)(function*(E){yield E._initializationPromise;const m=lg(),_=Or(ag,E.config.apiKey,E.name);m&&m.setItem(_,E._getPersistence())})).apply(this,arguments)}function lg(){var E;try{return(null===(E=function bp(){return"undefined"!=typeof window?window:null}())||void 0===E?void 0:E.sessionStorage)||null}catch(m){return null}}const L_=ce;class yl{constructor(){this.browserResolver=Te(class Cw{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=mn,this._completeRedirectFn=Eo,this._overrideRedirectResult=O}_openPopup(m,_,M,k){var W=this;return(0,w.Z)(function*(){var ye;ve(null===(ye=W.eventManagers[m._key()])||void 0===ye?void 0:ye.manager,"_initialize() not called before _openPopup()");const je=Oc(m,_,M,It(),k);return function Mw(E,m,_,M=500,k=600){const W=Math.max((window.screen.availHeight-k)/2,0).toString(),ye=Math.max((window.screen.availWidth-M)/2,0).toString();let je="";const kt=Object.assign(Object.assign({},E_),{width:M.toString(),height:k.toString(),top:W,left:ye}),on=(0,Y.z$)().toLowerCase();_&&(je=kl(on)?"_blank":_),Ll(on)&&(m=m||"http://localhost",kt.scrollbars="yes");const Vn=Object.entries(kt).reduce((ss,[ao,$a])=>`${ss}${ao}=${$a},`,"");if(function Da(E=(0,Y.z$)()){var m;return Qr(E)&&!!(null===(m=window.navigator)||void 0===m?void 0:m.standalone)}(on)&&"_self"!==je)return function up(E,m){const _=document.createElement("a");_.href=E,_.target=m;const M=document.createEvent("MouseEvent");M.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),_.dispatchEvent(M)}(m||"",je),new T_(null);const In=window.open(m||"",je,Vn);ce(In,E,"popup-blocked");try{In.focus()}catch(ss){}return new T_(In)}(m,je,cn())})()}_openRedirect(m,_,M,k){var W=this;return(0,w.Z)(function*(){return yield W._originValidation(m),function Gn(E){St().location.href=E}(Oc(m,_,M,It(),k)),new Promise(()=>{})})()}_initialize(m){const _=m._key();if(this.eventManagers[_]){const{manager:k,promise:W}=this.eventManagers[_];return k?Promise.resolve(k):(ve(W,"If manager is not set, promise should be"),W)}const M=this.initAndGetManager(m);return this.eventManagers[_]={promise:M},M.catch(()=>{delete this.eventManagers[_]}),M}initAndGetManager(m){var _=this;return(0,w.Z)(function*(){const M=yield function Uh(E){return Bh.apply(this,arguments)}(m),k=new ja(m);return M.register("authEvent",W=>(ce(null==W?void 0:W.authEvent,m,"invalid-auth-event"),{status:k.onEvent(W.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),_.eventManagers[m._key()]={manager:k},_.iframes[m._key()]=M,k})()}_isIframeWebStorageSupported(m,_){this.iframes[m._key()].send(hp,{type:hp},k=>{var W;const ye=null===(W=null==k?void 0:k[0])||void 0===W?void 0:W[hp];void 0!==ye&&_(!!ye),lt(m,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(m){const _=m._key();return this.originValidationPromises[_]||(this.originValidationPromises[_]=function xw(E){return Ju.apply(this,arguments)}(m)),this.originValidationPromises[_]}get _shouldInitProactively(){return es()||mc()||Qr()}}),this.cordovaResolver=Te(class Hd{constructor(){this._redirectPersistence=mn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Eo,this._overrideRedirectResult=O}_initialize(m){var _=this;return(0,w.Z)(function*(){const M=m._key();let k=_.eventManagers.get(M);return k||(k=new CS(m),_.eventManagers.set(M,k),_.attachCallbackListeners(m,k)),k})()}_openPopup(m){lt(m,"operation-not-supported-in-this-environment")}_openRedirect(m,_,M,k){var W=this;return(0,w.Z)(function*(){!function R_(E){var m,_,M,k,W,ye,je,kt,on,Vn;const In=fr();ce("function"==typeof(null===(m=null==In?void 0:In.universalLinks)||void 0===m?void 0:m.subscribe),E,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),ce(void 0!==(null===(_=null==In?void 0:In.BuildInfo)||void 0===_?void 0:_.packageName),E,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),ce("function"==typeof(null===(W=null===(k=null===(M=null==In?void 0:In.cordova)||void 0===M?void 0:M.plugins)||void 0===k?void 0:k.browsertab)||void 0===W?void 0:W.openUrl),E,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ce("function"==typeof(null===(kt=null===(je=null===(ye=null==In?void 0:In.cordova)||void 0===ye?void 0:ye.plugins)||void 0===je?void 0:je.browsertab)||void 0===kt?void 0:kt.isAvailable),E,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),ce("function"==typeof(null===(Vn=null===(on=null==In?void 0:In.cordova)||void 0===on?void 0:on.InAppBrowser)||void 0===Vn?void 0:Vn.open),E,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(m);const ye=yield W._initialize(m);yield ye.initialized(),ye.resetRedirect(),function P(){ml.clear()}(),yield W._originValidation(m);const je=function Wh(E,m,_=null){return{type:m,eventId:_,urlResponse:null,sessionId:Bd(),postBody:null,tenantId:E.tenantId,error:Ye(E,"no-auth-event")}}(m,M,k);yield function ng(E,m){return Qu()._set(yp(E),m)}(m,je);const kt=yield function ba(E,m,_){return Lc.apply(this,arguments)}(m,je,_),on=yield function tg(E){const{cordova:m}=fr();return new Promise(_=>{m.plugins.browsertab.isAvailable(M=>{let k=null;M?m.plugins.browsertab.openUrl(E):k=m.InAppBrowser.open(E,function eo(E=(0,Y.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(E)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(E)}()?"_blank":"_system","location=yes"),_(k)})})}(kt);return function MS(E,m,_){return D_.apply(this,arguments)}(m,ye,on)})()}_isIframeWebStorageSupported(m,_){throw new Error("Method not implemented.")}_originValidation(m){const _=m._key();return this.originValidationPromises[_]||(this.originValidationPromises[_]=function I_(E){return pp.apply(this,arguments)}(m)),this.originValidationPromises[_]}attachCallbackListeners(m,_){const{universalLinks:M,handleOpenURL:k,BuildInfo:W}=fr(),ye=setTimeout((0,w.Z)(function*(){yield mp(m),_.onEvent(rg())}),500),je=function(){var Vn=(0,w.Z)(function*(In){clearTimeout(ye);const ss=yield mp(m);let ao=null;ss&&(null==In?void 0:In.url)&&(ao=function Dw(E,m){var _,M;const k=function vp(E){const m=Fr(E),_=m.link?decodeURIComponent(m.link):void 0,M=Fr(_).link,k=m.deep_link_id?decodeURIComponent(m.deep_link_id):void 0;return Fr(k).link||k||M||_||E}(m);if(k.includes("/__/auth/callback")){const W=Fr(k),ye=W.firebaseError?function _p(E){try{return JSON.parse(E)}catch(m){return null}}(decodeURIComponent(W.firebaseError)):null,je=null===(M=null===(_=null==ye?void 0:ye.code)||void 0===_?void 0:_.split("auth/"))||void 0===M?void 0:M[1],kt=je?Ye(je):null;return kt?{type:E.type,eventId:E.eventId,tenantId:E.tenantId,error:kt,urlResponse:null,sessionId:null,postBody:null}:{type:E.type,eventId:E.eventId,tenantId:E.tenantId,sessionId:E.sessionId,urlResponse:k,postBody:null}}return null}(ss,In.url)),_.onEvent(ao||rg())});return function(ss){return Vn.apply(this,arguments)}}();void 0!==M&&"function"==typeof M.subscribe&&M.subscribe(null,je);const kt=k,on=`${W.packageName.toLowerCase()}://`;fr().handleOpenURL=function(){var Vn=(0,w.Z)(function*(In){if(In.toLowerCase().startsWith(on)&&je({url:In}),"function"==typeof kt)try{kt(In)}catch(ss){console.error(ss)}});return function(In){return Vn.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=mn,this._completeRedirectFn=Eo,this._overrideRedirectResult=O}_initialize(m){var _=this;return(0,w.Z)(function*(){return yield _.selectUnderlyingResolver(),_.assertedUnderlyingResolver._initialize(m)})()}_openPopup(m,_,M,k){var W=this;return(0,w.Z)(function*(){return yield W.selectUnderlyingResolver(),W.assertedUnderlyingResolver._openPopup(m,_,M,k)})()}_openRedirect(m,_,M,k){var W=this;return(0,w.Z)(function*(){return yield W.selectUnderlyingResolver(),W.assertedUnderlyingResolver._openRedirect(m,_,M,k)})()}_isIframeWebStorageSupported(m,_){this.assertedUnderlyingResolver._isIframeWebStorageSupported(m,_)}_originValidation(m){return this.assertedUnderlyingResolver._originValidation(m)}get _shouldInitProactively(){return hu()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return L_(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var m=this;return(0,w.Z)(function*(){if(m.underlyingResolver)return;const _=yield function og(){return qh.apply(this,arguments)}();m.underlyingResolver=_?m.cordovaResolver:m.browserResolver})()}}function k_(E){return E.unwrap()}function Xh(E){return Wd(E)}function Wd(E){const{_tokenResponse:m}=E instanceof Y.ZR?E.customData:E;if(!m)return null;if(!(E instanceof Y.ZR)&&"temporaryProof"in m&&"phoneNumber"in m)return Ha.credentialFromResult(E);const _=m.providerId;if(!_||"password"===_)return null;let M;switch(_){case"google.com":M=Dd;break;case"facebook.com":M=La;break;case"github.com":M=Rd;break;case"twitter.com":M=Pd;break;default:const{oauthIdToken:k,oauthAccessToken:W,oauthTokenSecret:ye,pendingToken:je,nonce:kt}=m;return W||ye||k||je?je?_.startsWith("saml.")?go._create(_,je):Xo._fromParams({providerId:_,signInMethod:_,pendingToken:je,idToken:k,accessToken:W}):new Vo(_).credential({idToken:k,accessToken:W,rawNonce:kt}):null}return E instanceof Y.ZR?M.credentialFromError(E):M.credentialFromResult(E)}function ms(E,m){return m.catch(_=>{throw _ instanceof Y.ZR&&function xp(E,m){var _;const M=null===(_=m.customData)||void 0===_?void 0:_._tokenResponse;if("auth/multi-factor-auth-required"===m.code)m.resolver=new Ep(E,function $r(E,m){var _;const M=(0,Y.m9)(E),k=m;return ce(m.customData.operationType,M,"argument-error"),ce(null===(_=k.customData._serverResponse)||void 0===_?void 0:_.mfaPendingCredential,M,"argument-error"),Jl._fromError(M,k)}(E,m));else if(M){const k=Wd(m),W=m;k&&(W.credential=k,W.tenantId=M.tenantId||void 0,W.email=M.email||void 0,W.phoneNumber=M.phoneNumber||void 0)}}(E,_),_}).then(_=>{const k=_.user;return{operationType:_.operationType,credential:Xh(_),additionalUserInfo:Hs(_),user:oa.getOrCreate(k)}})}function Jh(E,m){return cg.apply(this,arguments)}function cg(){return(cg=(0,w.Z)(function*(E,m){const _=yield m;return{verificationId:_.verificationId,confirm:M=>ms(E,_.confirm(M))}})).apply(this,arguments)}class Ep{constructor(m,_){this.resolver=_,this.auth=function Yh(E){return E.wrapped()}(m)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(m){return ms(k_(this.auth),this.resolver.resolveSignIn(m))}}class oa{constructor(m){this._delegate=m,this.multiFactor=function re(E){const m=(0,Y.m9)(E);return q.has(m)||q.set(m,N._fromUser(m)),q.get(m)}(m)}static getOrCreate(m){return oa.USER_MAP.has(m)||oa.USER_MAP.set(m,new oa(m)),oa.USER_MAP.get(m)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(m){return this._delegate.getIdTokenResult(m)}getIdToken(m){return this._delegate.getIdToken(m)}linkAndRetrieveDataWithCredential(m){return this.linkWithCredential(m)}linkWithCredential(m){var _=this;return(0,w.Z)(function*(){return ms(_.auth,is(_._delegate,m))})()}linkWithPhoneNumber(m,_){var M=this;return(0,w.Z)(function*(){return Jh(M.auth,function SS(E,m,_){return op.apply(this,arguments)}(M._delegate,m,_))})()}linkWithPopup(m){var _=this;return(0,w.Z)(function*(){return ms(_.auth,function fi(E,m,_){return pl.apply(this,arguments)}(_._delegate,m,yl))})()}linkWithRedirect(m){var _=this;return(0,w.Z)(function*(){return yield Kh(xn(_.auth)),function Ti(E,m,_){return function Rn(E,m,_){return so.apply(this,arguments)}(E,m,_)}(_._delegate,m,yl)})()}reauthenticateAndRetrieveDataWithCredential(m){return this.reauthenticateWithCredential(m)}reauthenticateWithCredential(m){var _=this;return(0,w.Z)(function*(){return ms(_.auth,ea(_._delegate,m))})()}reauthenticateWithPhoneNumber(m,_){return Jh(this.auth,function Dr(E,m,_){return ia.apply(this,arguments)}(this._delegate,m,_))}reauthenticateWithPopup(m){return ms(this.auth,function Xu(E,m,_){return za.apply(this,arguments)}(this._delegate,m,yl))}reauthenticateWithRedirect(m){var _=this;return(0,w.Z)(function*(){return yield Kh(xn(_.auth)),function Pt(E,m,_){return function jn(E,m,_){return ui.apply(this,arguments)}(E,m,_)}(_._delegate,m,yl)})()}sendEmailVerification(m){return function al(E,m){return Ua.apply(this,arguments)}(this._delegate,m)}unlink(m){var _=this;return(0,w.Z)(function*(){return yield function Od(E,m){return Fi.apply(this,arguments)}(_._delegate,m),_})()}updateEmail(m){return function Kl(E,m){return Zl((0,Y.m9)(E),m,null)}(this._delegate,m)}updatePassword(m){return function Gu(E,m){return Zl((0,Y.m9)(E),null,m)}(this._delegate,m)}updatePhoneNumber(m){return function Pc(E,m){return ic.apply(this,arguments)}(this._delegate,m)}updateProfile(m){return function $l(E,m){return ql.apply(this,arguments)}(this._delegate,m)}verifyBeforeUpdateEmail(m,_){return function Mc(E,m,_){return Cc.apply(this,arguments)}(this._delegate,m,_)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}oa.USER_MAP=new WeakMap;const td=ce;let fu=(()=>{class E{constructor(_,M){if(this.app=_,M.isInitialized())return this._delegate=M.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:k}=_.options;td(k,"invalid-api-key",{appName:_.name}),td(k,"invalid-api-key",{appName:_.name});const W="undefined"!=typeof window?yl:void 0;this._delegate=M.initialize({options:{persistence:Nw(k,_.name),popupRedirectResolver:W}}),this._delegate._updateErrorMap(pt),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?oa.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(_){this._delegate.languageCode=_}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(_){this._delegate.tenantId=_}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(_,M){!function us(E,m,_){const M=xn(E);ce(M._canInitEmulator,M,"emulator-config-failed"),ce(/^https?:\/\//.test(m),M,"invalid-emulator-scheme");const k=!!(null==_?void 0:_.disableWarnings),W=Lo(m),{host:ye,port:je}=function lr(E){const m=Lo(E),_=/(\/\/)?([^?#/]+)/.exec(E.substr(m.length));if(!_)return{host:"",port:null};const M=_[2].split("@").pop()||"",k=/^(\[[^\]]+\])(:|$)/.exec(M);if(k){const W=k[1];return{host:W,port:po(M.substr(W.length+1))}}{const[W,ye]=M.split(":");return{host:W,port:po(ye)}}}(m);M.config.emulator={url:`${W}//${ye}${null===je?"":`:${je}`}/`},M.settings.appVerificationDisabledForTesting=!0,M.emulatorConfig=Object.freeze({host:ye,port:je,protocol:W.replace(":",""),options:Object.freeze({disableWarnings:k})}),k||function Ai(){function E(){const m=document.createElement("p"),_=m.style;m.innerText="Running in emulator mode. Do not use with production credentials.",_.position="fixed",_.width="100%",_.backgroundColor="#ffffff",_.border=".1em solid #000000",_.color="#b50000",_.bottom="0px",_.left="0px",_.margin="0px",_.zIndex="10000",_.textAlign="center",m.classList.add("firebase-emulator-warning"),document.body.appendChild(m)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",E):E())}()}(this._delegate,_,M)}applyActionCode(_){return function ut(E,m){return ai.apply(this,arguments)}(this._delegate,_)}checkActionCode(_){return xc(this._delegate,_)}confirmPasswordReset(_,M){return function pa(E,m,_){return su.apply(this,arguments)}(this._delegate,_,M)}createUserWithEmailAndPassword(_,M){var k=this;return(0,w.Z)(function*(){return ms(k._delegate,function vo(E,m,_){return Ec.apply(this,arguments)}(k._delegate,_,M))})()}fetchProvidersForEmail(_){return this.fetchSignInMethodsForEmail(_)}fetchSignInMethodsForEmail(_){return function Va(E,m){return Bs.apply(this,arguments)}(this._delegate,_)}isSignInWithEmailLink(_){return function Gl(E,m){const _=Vl.parseLink(m);return"EMAIL_SIGNIN"===(null==_?void 0:_.operation)}(0,_)}getRedirectResult(){var _=this;return(0,w.Z)(function*(){td(du(),_._delegate,"operation-not-supported-in-this-environment");const M=yield function xo(E,m){return sc.apply(this,arguments)}(_._delegate,yl);return M?ms(_._delegate,Promise.resolve(M)):{credential:null,user:null}})()}addFrameworkForLogging(_){!function ed(E,m){xn(E)._logFramework(m)}(this._delegate,_)}onAuthStateChanged(_,M,k){const{next:W,error:ye,complete:je}=ug(_,M,k);return this._delegate.onAuthStateChanged(W,ye,je)}onIdTokenChanged(_,M,k){const{next:W,error:ye,complete:je}=ug(_,M,k);return this._delegate.onIdTokenChanged(W,ye,je)}sendSignInLinkToEmail(_,M){return function Qf(E,m,_){return Sc.apply(this,arguments)}(this._delegate,_,M)}sendPasswordResetEmail(_,M){return function ru(E,m,_){return sl.apply(this,arguments)}(this._delegate,_,M||void 0)}setPersistence(_){var M=this;return(0,w.Z)(function*(){let k;switch(function O_(E,m){lc(Object.values(So).includes(m),E,"invalid-persistence-type"),(0,Y.b$)()?lc(m!==So.SESSION,E,"unsupported-persistence-type"):(0,Y.UG)()?lc(m===So.NONE,E,"unsupported-persistence-type"):Rs()?lc(m===So.NONE||m===So.LOCAL&&(0,Y.hl)(),E,"unsupported-persistence-type"):lc(m===So.NONE||$h(),E,"unsupported-persistence-type")}(M._delegate,_),_){case So.SESSION:k=mn;break;case So.LOCAL:k=(yield Te(ro)._isAvailable())?ro:Tt;break;case So.NONE:k=Fn;break;default:return lt("argument-error",{appName:M._delegate.name})}return M._delegate.setPersistence(k)})()}signInAndRetrieveDataWithCredential(_){return this.signInWithCredential(_)}signInAnonymously(){return ms(this._delegate,function Nd(E){return Hu.apply(this,arguments)}(this._delegate))}signInWithCredential(_){return ms(this._delegate,ur(this._delegate,_))}signInWithCustomToken(_){return ms(this._delegate,function il(E,m){return Cn.apply(this,arguments)}(this._delegate,_))}signInWithEmailAndPassword(_,M){return ms(this._delegate,function zu(E,m,_){return ur((0,Y.m9)(E),tu.credential(m,_))}(this._delegate,_,M))}signInWithEmailLink(_,M){return ms(this._delegate,function ou(E,m,_){return Ir.apply(this,arguments)}(this._delegate,_,M))}signInWithPhoneNumber(_,M){return Jh(this._delegate,function Lh(E,m,_){return Rc.apply(this,arguments)}(this._delegate,_,M))}signInWithPopup(_){var M=this;return(0,w.Z)(function*(){return td(du(),M._delegate,"operation-not-supported-in-this-environment"),ms(M._delegate,function Ke(E,m,_){return bo.apply(this,arguments)}(M._delegate,_,yl))})()}signInWithRedirect(_){var M=this;return(0,w.Z)(function*(){return td(du(),M._delegate,"operation-not-supported-in-this-environment"),yield Kh(M._delegate),function ge(E,m,_){return function Ie(E,m,_){return nt.apply(this,arguments)}(E,m,_)}(M._delegate,_,yl)})()}updateCurrentUser(_){return this._delegate.updateCurrentUser(_)}verifyPasswordResetCode(_){return function ol(E,m){return Us.apply(this,arguments)}(this._delegate,_)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return E.Persistence=So,E})();function ug(E,m,_){let M=E;"function"!=typeof E&&({next:M,error:m,complete:_}=E);const k=M;return{next:ye=>k(ye&&oa.getOrCreate(ye)),error:m,complete:_}}function Nw(E,m){const _=function Zh(E,m){const _=lg();if(!_)return[];const M=Or(ag,E,m);switch(_.getItem(M)){case So.NONE:return[Fn];case So.LOCAL:return[ro,mn];case So.SESSION:return[mn];default:return[]}}(E,m);if("undefined"!=typeof self&&!_.includes(ro)&&_.push(ro),"undefined"!=typeof window)for(const M of[Tt,mn])_.includes(M)||_.push(M);return _.includes(Fn)||_.push(Fn),_}class Fc{constructor(){this.providerId="phone",this._delegate=new Ha(k_(be.Z.auth()))}static credential(m,_){return Ha.credential(m,_)}verifyPhoneNumber(m,_){return this._delegate.verifyPhoneNumber(m,_)}unwrap(){return this._delegate}}Fc.PHONE_SIGN_IN_METHOD=Ha.PHONE_SIGN_IN_METHOD,Fc.PROVIDER_ID=Ha.PROVIDER_ID;const Vc=ce;class Sp{constructor(m,_,M=be.Z.app()){var k;Vc(null===(k=M.options)||void 0===k?void 0:k.apiKey,"invalid-api-key",{appName:M.name}),this._delegate=new Zu(m,_,M.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function xa(E){E.INTERNAL.registerComponent(new Fe.wA("auth-compat",m=>{const _=m.getProvider("app-compat").getImmediate(),M=m.getProvider("auth");return new fu(_,M)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:tu,FacebookAuthProvider:La,GithubAuthProvider:Rd,GoogleAuthProvider:Dd,OAuthProvider:Vo,SAMLAuthProvider:hs,PhoneAuthProvider:Fc,PhoneMultiFactorGenerator:Jm,RecaptchaVerifier:Sp,TwitterAuthProvider:Pd,Auth:fu,AuthCredential:Ms,Error:Y.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),E.registerVersion("@firebase/auth-compat","0.2.16")}(be.Z)},8306:(hn,Ze,K)=>{"use strict";K.d(Ze,{y:()=>ue});var w=K(2961),be=K(727),Y=K(8822),Oe=K(4671);var Fe=K(2416),Ne=K(576),Be=K(2806);let ue=(()=>{class tt{constructor(Ot){Ot&&(this._subscribe=Ot)}lift(Ot){const ze=new tt;return ze.source=this,ze.operator=Ot,ze}subscribe(Ot,ze,at){const qt=function Gt(tt){return tt&&tt instanceof w.Lv||function Ce(tt){return tt&&(0,Ne.m)(tt.next)&&(0,Ne.m)(tt.error)&&(0,Ne.m)(tt.complete)}(tt)&&(0,be.Nn)(tt)}(Ot)?Ot:new w.Hp(Ot,ze,at);return(0,Be.x)(()=>{const{operator:nn,source:lt}=this;qt.add(nn?nn.call(qt,lt):lt?this._subscribe(qt):this._trySubscribe(qt))}),qt}_trySubscribe(Ot){try{return this._subscribe(Ot)}catch(ze){Ot.error(ze)}}forEach(Ot,ze){return new(ze=le(ze))((at,qt)=>{const nn=new w.Hp({next:lt=>{try{Ot(lt)}catch(Ye){qt(Ye),nn.unsubscribe()}},error:qt,complete:at});this.subscribe(nn)})}_subscribe(Ot){var ze;return null===(ze=this.source)||void 0===ze?void 0:ze.subscribe(Ot)}[Y.L](){return this}pipe(...Ot){return function Ve(tt){return 0===tt.length?Oe.y:1===tt.length?tt[0]:function(Ot){return tt.reduce((ze,at)=>at(ze),Ot)}}(Ot)(this)}toPromise(Ot){return new(Ot=le(Ot))((ze,at)=>{let qt;this.subscribe(nn=>qt=nn,nn=>at(nn),()=>ze(qt))})}}return tt.create=pt=>new tt(pt),tt})();function le(tt){var pt;return null!==(pt=null!=tt?tt:Fe.v.Promise)&&void 0!==pt?pt:Promise}},7579:(hn,Ze,K)=>{"use strict";K.d(Ze,{x:()=>Fe});var w=K(8306),be=K(727);const Oe=(0,K(3888).d)(Be=>function(){Be(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ae=K(8737),Ve=K(2806);let Fe=(()=>{class Be extends w.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(le){const Ce=new Ne(this,this);return Ce.operator=le,Ce}_throwIfClosed(){if(this.closed)throw new Oe}next(le){(0,Ve.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Ce of this.currentObservers)Ce.next(le)}})}error(le){(0,Ve.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=le;const{observers:Ce}=this;for(;Ce.length;)Ce.shift().error(le)}})}complete(){(0,Ve.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:le}=this;for(;le.length;)le.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var le;return(null===(le=this.observers)||void 0===le?void 0:le.length)>0}_trySubscribe(le){return this._throwIfClosed(),super._trySubscribe(le)}_subscribe(le){return this._throwIfClosed(),this._checkFinalizedStatuses(le),this._innerSubscribe(le)}_innerSubscribe(le){const{hasError:Ce,isStopped:Gt,observers:tt}=this;return Ce||Gt?be.Lc:(this.currentObservers=null,tt.push(le),new be.w0(()=>{this.currentObservers=null,(0,Ae.P)(tt,le)}))}_checkFinalizedStatuses(le){const{hasError:Ce,thrownError:Gt,isStopped:tt}=this;Ce?le.error(Gt):tt&&le.complete()}asObservable(){const le=new w.y;return le.source=this,le}}return Be.create=(ue,le)=>new Ne(ue,le),Be})();class Ne extends Fe{constructor(ue,le){super(),this.destination=ue,this.source=le}next(ue){var le,Ce;null===(Ce=null===(le=this.destination)||void 0===le?void 0:le.next)||void 0===Ce||Ce.call(le,ue)}error(ue){var le,Ce;null===(Ce=null===(le=this.destination)||void 0===le?void 0:le.error)||void 0===Ce||Ce.call(le,ue)}complete(){var ue,le;null===(le=null===(ue=this.destination)||void 0===ue?void 0:ue.complete)||void 0===le||le.call(ue)}_subscribe(ue){var le,Ce;return null!==(Ce=null===(le=this.source)||void 0===le?void 0:le.subscribe(ue))&&void 0!==Ce?Ce:be.Lc}}},2961:(hn,Ze,K)=>{"use strict";K.d(Ze,{Hp:()=>Ot,Lv:()=>Ce});var w=K(576),be=K(727),Y=K(2416),Oe=K(7849);function Ae(){}const Ve=Be("C",void 0,void 0);function Be(lt,Ye,st){return{kind:lt,value:Ye,error:st}}var ue=K(3410),le=K(2806);class Ce extends be.w0{constructor(Ye){super(),this.isStopped=!1,Ye?(this.destination=Ye,(0,be.Nn)(Ye)&&Ye.add(this)):this.destination=nn}static create(Ye,st,Bt){return new Ot(Ye,st,Bt)}next(Ye){this.isStopped?qt(function Ne(lt){return Be("N",lt,void 0)}(Ye),this):this._next(Ye)}error(Ye){this.isStopped?qt(function Fe(lt){return Be("E",void 0,lt)}(Ye),this):(this.isStopped=!0,this._error(Ye))}complete(){this.isStopped?qt(Ve,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ye){this.destination.next(Ye)}_error(Ye){try{this.destination.error(Ye)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Gt=Function.prototype.bind;function tt(lt,Ye){return Gt.call(lt,Ye)}class pt{constructor(Ye){this.partialObserver=Ye}next(Ye){const{partialObserver:st}=this;if(st.next)try{st.next(Ye)}catch(Bt){ze(Bt)}}error(Ye){const{partialObserver:st}=this;if(st.error)try{st.error(Ye)}catch(Bt){ze(Bt)}else ze(Ye)}complete(){const{partialObserver:Ye}=this;if(Ye.complete)try{Ye.complete()}catch(st){ze(st)}}}class Ot extends Ce{constructor(Ye,st,Bt){let Ut;if(super(),(0,w.m)(Ye)||!Ye)Ut={next:null!=Ye?Ye:void 0,error:null!=st?st:void 0,complete:null!=Bt?Bt:void 0};else{let ce;this&&Y.v.useDeprecatedNextContext?(ce=Object.create(Ye),ce.unsubscribe=()=>this.unsubscribe(),Ut={next:Ye.next&&tt(Ye.next,ce),error:Ye.error&&tt(Ye.error,ce),complete:Ye.complete&&tt(Ye.complete,ce)}):Ut=Ye}this.destination=new pt(Ut)}}function ze(lt){Y.v.useDeprecatedSynchronousErrorHandling?(0,le.O)(lt):(0,Oe.h)(lt)}function qt(lt,Ye){const{onStoppedNotification:st}=Y.v;st&&ue.z.setTimeout(()=>st(lt,Ye))}const nn={closed:!0,next:Ae,error:function at(lt){throw lt},complete:Ae}},727:(hn,Ze,K)=>{"use strict";K.d(Ze,{Lc:()=>Ve,w0:()=>Ae,Nn:()=>Fe});var w=K(576);const Y=(0,K(3888).d)(Be=>function(le){Be(this),this.message=le?`${le.length} errors occurred during unsubscription:\n${le.map((Ce,Gt)=>`${Gt+1}) ${Ce.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=le});var Oe=K(8737);class Ae{constructor(ue){this.initialTeardown=ue,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let ue;if(!this.closed){this.closed=!0;const{_parentage:le}=this;if(le)if(this._parentage=null,Array.isArray(le))for(const tt of le)tt.remove(this);else le.remove(this);const{initialTeardown:Ce}=this;if((0,w.m)(Ce))try{Ce()}catch(tt){ue=tt instanceof Y?tt.errors:[tt]}const{_finalizers:Gt}=this;if(Gt){this._finalizers=null;for(const tt of Gt)try{Ne(tt)}catch(pt){ue=null!=ue?ue:[],pt instanceof Y?ue=[...ue,...pt.errors]:ue.push(pt)}}if(ue)throw new Y(ue)}}add(ue){var le;if(ue&&ue!==this)if(this.closed)Ne(ue);else{if(ue instanceof Ae){if(ue.closed||ue._hasParent(this))return;ue._addParent(this)}(this._finalizers=null!==(le=this._finalizers)&&void 0!==le?le:[]).push(ue)}}_hasParent(ue){const{_parentage:le}=this;return le===ue||Array.isArray(le)&&le.includes(ue)}_addParent(ue){const{_parentage:le}=this;this._parentage=Array.isArray(le)?(le.push(ue),le):le?[le,ue]:ue}_removeParent(ue){const{_parentage:le}=this;le===ue?this._parentage=null:Array.isArray(le)&&(0,Oe.P)(le,ue)}remove(ue){const{_finalizers:le}=this;le&&(0,Oe.P)(le,ue),ue instanceof Ae&&ue._removeParent(this)}}Ae.EMPTY=(()=>{const Be=new Ae;return Be.closed=!0,Be})();const Ve=Ae.EMPTY;function Fe(Be){return Be instanceof Ae||Be&&"closed"in Be&&(0,w.m)(Be.remove)&&(0,w.m)(Be.add)&&(0,w.m)(Be.unsubscribe)}function Ne(Be){(0,w.m)(Be)?Be():Be.unsubscribe()}},2416:(hn,Ze,K)=>{"use strict";K.d(Ze,{v:()=>w});const w={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(hn,Ze,K)=>{"use strict";K.d(Ze,{E:()=>be});const be=new(K(8306).y)(Ae=>Ae.complete())},8996:(hn,Ze,K)=>{"use strict";K.d(Ze,{D:()=>Ye});var w=K(8421),be=K(5363),Y=K(9468),Ve=K(8306),Ne=K(2202),Be=K(576),ue=K(9672);function Ce(st,Bt){if(!st)throw new Error("Iterable cannot be null");return new Ve.y(Ut=>{(0,ue.f)(Ut,Bt,()=>{const ce=st[Symbol.asyncIterator]();(0,ue.f)(Ut,Bt,()=>{ce.next().then(Xe=>{Xe.done?Ut.complete():Ut.next(Xe.value)})},0,!0)})})}var Gt=K(3670),tt=K(8239),pt=K(1144),Ot=K(6495),ze=K(2206),at=K(4532),qt=K(3260);function Ye(st,Bt){return Bt?function lt(st,Bt){if(null!=st){if((0,Gt.c)(st))return function Oe(st,Bt){return(0,w.Xf)(st).pipe((0,Y.R)(Bt),(0,be.Q)(Bt))}(st,Bt);if((0,pt.z)(st))return function Fe(st,Bt){return new Ve.y(Ut=>{let ce=0;return Bt.schedule(function(){ce===st.length?Ut.complete():(Ut.next(st[ce++]),Ut.closed||this.schedule())})})}(st,Bt);if((0,tt.t)(st))return function Ae(st,Bt){return(0,w.Xf)(st).pipe((0,Y.R)(Bt),(0,be.Q)(Bt))}(st,Bt);if((0,ze.D)(st))return Ce(st,Bt);if((0,Ot.T)(st))return function le(st,Bt){return new Ve.y(Ut=>{let ce;return(0,ue.f)(Ut,Bt,()=>{ce=st[Ne.h](),(0,ue.f)(Ut,Bt,()=>{let Xe,ve;try{({value:Xe,done:ve}=ce.next())}catch(Re){return void Ut.error(Re)}ve?Ut.complete():Ut.next(Xe)},0,!0)}),()=>(0,Be.m)(null==ce?void 0:ce.return)&&ce.return()})}(st,Bt);if((0,qt.L)(st))return function nn(st,Bt){return Ce((0,qt.Q)(st),Bt)}(st,Bt)}throw(0,at.z)(st)}(st,Bt):(0,w.Xf)(st)}},8421:(hn,Ze,K)=>{"use strict";K.d(Ze,{Xf:()=>Gt});var w=K(655),be=K(1144),Y=K(8239),Oe=K(8306),Ae=K(3670),Ve=K(2206),Fe=K(4532),Ne=K(6495),Be=K(3260),ue=K(576),le=K(7849),Ce=K(8822);function Gt(lt){if(lt instanceof Oe.y)return lt;if(null!=lt){if((0,Ae.c)(lt))return function tt(lt){return new Oe.y(Ye=>{const st=lt[Ce.L]();if((0,ue.m)(st.subscribe))return st.subscribe(Ye);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(lt);if((0,be.z)(lt))return function pt(lt){return new Oe.y(Ye=>{for(let st=0;st<lt.length&&!Ye.closed;st++)Ye.next(lt[st]);Ye.complete()})}(lt);if((0,Y.t)(lt))return function Ot(lt){return new Oe.y(Ye=>{lt.then(st=>{Ye.closed||(Ye.next(st),Ye.complete())},st=>Ye.error(st)).then(null,le.h)})}(lt);if((0,Ve.D)(lt))return at(lt);if((0,Ne.T)(lt))return function ze(lt){return new Oe.y(Ye=>{for(const st of lt)if(Ye.next(st),Ye.closed)return;Ye.complete()})}(lt);if((0,Be.L)(lt))return function qt(lt){return at((0,Be.Q)(lt))}(lt)}throw(0,Fe.z)(lt)}function at(lt){return new Oe.y(Ye=>{(function nn(lt,Ye){var st,Bt,Ut,ce;return(0,w.mG)(this,void 0,void 0,function*(){try{for(st=(0,w.KL)(lt);!(Bt=yield st.next()).done;)if(Ye.next(Bt.value),Ye.closed)return}catch(Xe){Ut={error:Xe}}finally{try{Bt&&!Bt.done&&(ce=st.return)&&(yield ce.call(st))}finally{if(Ut)throw Ut.error}}Ye.complete()})})(lt,Ye).catch(st=>Ye.error(st))})}},6451:(hn,Ze,K)=>{"use strict";K.d(Ze,{T:()=>Ve});var w=K(8189),be=K(8421),Y=K(515),Oe=K(7669),Ae=K(8996);function Ve(...Fe){const Ne=(0,Oe.yG)(Fe),Be=(0,Oe._6)(Fe,1/0),ue=Fe;return ue.length?1===ue.length?(0,be.Xf)(ue[0]):(0,w.J)(Be)((0,Ae.D)(ue,Ne)):Y.E}},5403:(hn,Ze,K)=>{"use strict";K.d(Ze,{x:()=>be});var w=K(2961);function be(Oe,Ae,Ve,Fe,Ne){return new Y(Oe,Ae,Ve,Fe,Ne)}class Y extends w.Lv{constructor(Ae,Ve,Fe,Ne,Be,ue){super(Ae),this.onFinalize=Be,this.shouldUnsubscribe=ue,this._next=Ve?function(le){try{Ve(le)}catch(Ce){Ae.error(Ce)}}:super._next,this._error=Ne?function(le){try{Ne(le)}catch(Ce){Ae.error(Ce)}finally{this.unsubscribe()}}:super._error,this._complete=Fe?function(){try{Fe()}catch(le){Ae.error(le)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Ae;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Ve}=this;super.unsubscribe(),!Ve&&(null===(Ae=this.onFinalize)||void 0===Ae||Ae.call(this))}}}},4004:(hn,Ze,K)=>{"use strict";K.d(Ze,{U:()=>Y});var w=K(4482),be=K(5403);function Y(Oe,Ae){return(0,w.e)((Ve,Fe)=>{let Ne=0;Ve.subscribe((0,be.x)(Fe,Be=>{Fe.next(Oe.call(Ae,Be,Ne++))}))})}},8189:(hn,Ze,K)=>{"use strict";K.d(Ze,{J:()=>Y});var w=K(5577),be=K(4671);function Y(Oe=1/0){return(0,w.z)(be.y,Oe)}},5577:(hn,Ze,K)=>{"use strict";K.d(Ze,{z:()=>Ne});var w=K(4004),be=K(8421),Y=K(4482),Oe=K(9672),Ae=K(5403),Fe=K(576);function Ne(Be,ue,le=1/0){return(0,Fe.m)(ue)?Ne((Ce,Gt)=>(0,w.U)((tt,pt)=>ue(Ce,tt,Gt,pt))((0,be.Xf)(Be(Ce,Gt))),le):("number"==typeof ue&&(le=ue),(0,Y.e)((Ce,Gt)=>function Ve(Be,ue,le,Ce,Gt,tt,pt,Ot){const ze=[];let at=0,qt=0,nn=!1;const lt=()=>{nn&&!ze.length&&!at&&ue.complete()},Ye=Bt=>at<Ce?st(Bt):ze.push(Bt),st=Bt=>{tt&&ue.next(Bt),at++;let Ut=!1;(0,be.Xf)(le(Bt,qt++)).subscribe((0,Ae.x)(ue,ce=>{null==Gt||Gt(ce),tt?Ye(ce):ue.next(ce)},()=>{Ut=!0},void 0,()=>{if(Ut)try{for(at--;ze.length&&at<Ce;){const ce=ze.shift();pt?(0,Oe.f)(ue,pt,()=>st(ce)):st(ce)}lt()}catch(ce){ue.error(ce)}}))};return Be.subscribe((0,Ae.x)(ue,Ye,()=>{nn=!0,lt()})),()=>{null==Ot||Ot()}}(Ce,Gt,Be,le)))}},5363:(hn,Ze,K)=>{"use strict";K.d(Ze,{Q:()=>Oe});var w=K(9672),be=K(4482),Y=K(5403);function Oe(Ae,Ve=0){return(0,be.e)((Fe,Ne)=>{Fe.subscribe((0,Y.x)(Ne,Be=>(0,w.f)(Ne,Ae,()=>Ne.next(Be),Ve),()=>(0,w.f)(Ne,Ae,()=>Ne.complete(),Ve),Be=>(0,w.f)(Ne,Ae,()=>Ne.error(Be),Ve)))})}},3099:(hn,Ze,K)=>{"use strict";K.d(Ze,{B:()=>Ve});var w=K(8996),be=K(5698),Y=K(7579),Oe=K(2961),Ae=K(4482);function Ve(Ne={}){const{connector:Be=(()=>new Y.x),resetOnError:ue=!0,resetOnComplete:le=!0,resetOnRefCountZero:Ce=!0}=Ne;return Gt=>{let tt=null,pt=null,Ot=null,ze=0,at=!1,qt=!1;const nn=()=>{null==pt||pt.unsubscribe(),pt=null},lt=()=>{nn(),tt=Ot=null,at=qt=!1},Ye=()=>{const st=tt;lt(),null==st||st.unsubscribe()};return(0,Ae.e)((st,Bt)=>{ze++,!qt&&!at&&nn();const Ut=Ot=null!=Ot?Ot:Be();Bt.add(()=>{ze--,0===ze&&!qt&&!at&&(pt=Fe(Ye,Ce))}),Ut.subscribe(Bt),tt||(tt=new Oe.Hp({next:ce=>Ut.next(ce),error:ce=>{qt=!0,nn(),pt=Fe(lt,ue,ce),Ut.error(ce)},complete:()=>{at=!0,nn(),pt=Fe(lt,le),Ut.complete()}}),(0,w.D)(st).subscribe(tt))})(Gt)}}function Fe(Ne,Be,...ue){return!0===Be?(Ne(),null):!1===Be?null:Be(...ue).pipe((0,be.q)(1)).subscribe(()=>Ne())}},9468:(hn,Ze,K)=>{"use strict";K.d(Ze,{R:()=>be});var w=K(4482);function be(Y,Oe=0){return(0,w.e)((Ae,Ve)=>{Ve.add(Y.schedule(()=>Ae.subscribe(Ve),Oe))})}},5698:(hn,Ze,K)=>{"use strict";K.d(Ze,{q:()=>Oe});var w=K(515),be=K(4482),Y=K(5403);function Oe(Ae){return Ae<=0?()=>w.E:(0,be.e)((Ve,Fe)=>{let Ne=0;Ve.subscribe((0,Y.x)(Fe,Be=>{++Ne<=Ae&&(Fe.next(Be),Ae<=Ne&&Fe.complete())}))})}},8505:(hn,Ze,K)=>{"use strict";K.d(Ze,{b:()=>Ae});var w=K(576),be=K(4482),Y=K(5403),Oe=K(4671);function Ae(Ve,Fe,Ne){const Be=(0,w.m)(Ve)||Fe||Ne?{next:Ve,error:Fe,complete:Ne}:Ve;return Be?(0,be.e)((ue,le)=>{var Ce;null===(Ce=Be.subscribe)||void 0===Ce||Ce.call(Be);let Gt=!0;ue.subscribe((0,Y.x)(le,tt=>{var pt;null===(pt=Be.next)||void 0===pt||pt.call(Be,tt),le.next(tt)},()=>{var tt;Gt=!1,null===(tt=Be.complete)||void 0===tt||tt.call(Be),le.complete()},tt=>{var pt;Gt=!1,null===(pt=Be.error)||void 0===pt||pt.call(Be,tt),le.error(tt)},()=>{var tt,pt;Gt&&(null===(tt=Be.unsubscribe)||void 0===tt||tt.call(Be)),null===(pt=Be.finalize)||void 0===pt||pt.call(Be)}))}):Oe.y}},4408:(hn,Ze,K)=>{"use strict";K.d(Ze,{o:()=>Ae});var w=K(727);class be extends w.w0{constructor(Fe,Ne){super()}schedule(Fe,Ne=0){return this}}const Y={setInterval(Ve,Fe,...Ne){const{delegate:Be}=Y;return(null==Be?void 0:Be.setInterval)?Be.setInterval(Ve,Fe,...Ne):setInterval(Ve,Fe,...Ne)},clearInterval(Ve){const{delegate:Fe}=Y;return((null==Fe?void 0:Fe.clearInterval)||clearInterval)(Ve)},delegate:void 0};var Oe=K(8737);class Ae extends be{constructor(Fe,Ne){super(Fe,Ne),this.scheduler=Fe,this.work=Ne,this.pending=!1}schedule(Fe,Ne=0){if(this.closed)return this;this.state=Fe;const Be=this.id,ue=this.scheduler;return null!=Be&&(this.id=this.recycleAsyncId(ue,Be,Ne)),this.pending=!0,this.delay=Ne,this.id=this.id||this.requestAsyncId(ue,this.id,Ne),this}requestAsyncId(Fe,Ne,Be=0){return Y.setInterval(Fe.flush.bind(Fe,this),Be)}recycleAsyncId(Fe,Ne,Be=0){if(null!=Be&&this.delay===Be&&!1===this.pending)return Ne;Y.clearInterval(Ne)}execute(Fe,Ne){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Be=this._execute(Fe,Ne);if(Be)return Be;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(Fe,Ne){let ue,Be=!1;try{this.work(Fe)}catch(le){Be=!0,ue=le||new Error("Scheduled action threw falsy error")}if(Be)return this.unsubscribe(),ue}unsubscribe(){if(!this.closed){const{id:Fe,scheduler:Ne}=this,{actions:Be}=Ne;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Oe.P)(Be,this),null!=Fe&&(this.id=this.recycleAsyncId(Ne,Fe,null)),this.delay=null,super.unsubscribe()}}}},7565:(hn,Ze,K)=>{"use strict";K.d(Ze,{v:()=>Y});var w=K(6063);class be{constructor(Ae,Ve=be.now){this.schedulerActionCtor=Ae,this.now=Ve}schedule(Ae,Ve=0,Fe){return new this.schedulerActionCtor(this,Ae).schedule(Fe,Ve)}}be.now=w.l.now;class Y extends be{constructor(Ae,Ve=be.now){super(Ae,Ve),this.actions=[],this._active=!1,this._scheduled=void 0}flush(Ae){const{actions:Ve}=this;if(this._active)return void Ve.push(Ae);let Fe;this._active=!0;do{if(Fe=Ae.execute(Ae.state,Ae.delay))break}while(Ae=Ve.shift());if(this._active=!1,Fe){for(;Ae=Ve.shift();)Ae.unsubscribe();throw Fe}}}},4986:(hn,Ze,K)=>{"use strict";K.d(Ze,{z:()=>Y});var w=K(4408);const Y=new(K(7565).v)(w.o)},6063:(hn,Ze,K)=>{"use strict";K.d(Ze,{l:()=>w});const w={now:()=>(w.delegate||Date).now(),delegate:void 0}},3410:(hn,Ze,K)=>{"use strict";K.d(Ze,{z:()=>w});const w={setTimeout(be,Y,...Oe){const{delegate:Ae}=w;return(null==Ae?void 0:Ae.setTimeout)?Ae.setTimeout(be,Y,...Oe):setTimeout(be,Y,...Oe)},clearTimeout(be){const{delegate:Y}=w;return((null==Y?void 0:Y.clearTimeout)||clearTimeout)(be)},delegate:void 0}},2202:(hn,Ze,K)=>{"use strict";K.d(Ze,{h:()=>be});const be=function w(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(hn,Ze,K)=>{"use strict";K.d(Ze,{L:()=>w});const w="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(hn,Ze,K)=>{"use strict";K.d(Ze,{_6:()=>Ve,jO:()=>Oe,yG:()=>Ae});var w=K(576);function Y(Fe){return Fe[Fe.length-1]}function Oe(Fe){return(0,w.m)(Y(Fe))?Fe.pop():void 0}function Ae(Fe){return function be(Fe){return Fe&&(0,w.m)(Fe.schedule)}(Y(Fe))?Fe.pop():void 0}function Ve(Fe,Ne){return"number"==typeof Y(Fe)?Fe.pop():Ne}},8737:(hn,Ze,K)=>{"use strict";function w(be,Y){if(be){const Oe=be.indexOf(Y);0<=Oe&&be.splice(Oe,1)}}K.d(Ze,{P:()=>w})},3888:(hn,Ze,K)=>{"use strict";function w(be){const Oe=be(Ae=>{Error.call(Ae),Ae.stack=(new Error).stack});return Oe.prototype=Object.create(Error.prototype),Oe.prototype.constructor=Oe,Oe}K.d(Ze,{d:()=>w})},2806:(hn,Ze,K)=>{"use strict";K.d(Ze,{x:()=>Y,O:()=>Oe});var w=K(2416);let be=null;function Y(Ae){if(w.v.useDeprecatedSynchronousErrorHandling){const Ve=!be;if(Ve&&(be={errorThrown:!1,error:null}),Ae(),Ve){const{errorThrown:Fe,error:Ne}=be;if(be=null,Fe)throw Ne}}else Ae()}function Oe(Ae){w.v.useDeprecatedSynchronousErrorHandling&&be&&(be.errorThrown=!0,be.error=Ae)}},9672:(hn,Ze,K)=>{"use strict";function w(be,Y,Oe,Ae=0,Ve=!1){const Fe=Y.schedule(function(){Oe(),Ve?be.add(this.schedule(null,Ae)):this.unsubscribe()},Ae);if(be.add(Fe),!Ve)return Fe}K.d(Ze,{f:()=>w})},4671:(hn,Ze,K)=>{"use strict";function w(be){return be}K.d(Ze,{y:()=>w})},1144:(hn,Ze,K)=>{"use strict";K.d(Ze,{z:()=>w});const w=be=>be&&"number"==typeof be.length&&"function"!=typeof be},2206:(hn,Ze,K)=>{"use strict";K.d(Ze,{D:()=>be});var w=K(576);function be(Y){return Symbol.asyncIterator&&(0,w.m)(null==Y?void 0:Y[Symbol.asyncIterator])}},576:(hn,Ze,K)=>{"use strict";function w(be){return"function"==typeof be}K.d(Ze,{m:()=>w})},3670:(hn,Ze,K)=>{"use strict";K.d(Ze,{c:()=>Y});var w=K(8822),be=K(576);function Y(Oe){return(0,be.m)(Oe[w.L])}},6495:(hn,Ze,K)=>{"use strict";K.d(Ze,{T:()=>Y});var w=K(2202),be=K(576);function Y(Oe){return(0,be.m)(null==Oe?void 0:Oe[w.h])}},8239:(hn,Ze,K)=>{"use strict";K.d(Ze,{t:()=>be});var w=K(576);function be(Y){return(0,w.m)(null==Y?void 0:Y.then)}},3260:(hn,Ze,K)=>{"use strict";K.d(Ze,{Q:()=>Y,L:()=>Oe});var w=K(655),be=K(576);function Y(Ae){return(0,w.FC)(this,arguments,function*(){const Fe=Ae.getReader();try{for(;;){const{value:Ne,done:Be}=yield(0,w.qq)(Fe.read());if(Be)return yield(0,w.qq)(void 0);yield yield(0,w.qq)(Ne)}}finally{Fe.releaseLock()}})}function Oe(Ae){return(0,be.m)(null==Ae?void 0:Ae.getReader)}},4482:(hn,Ze,K)=>{"use strict";K.d(Ze,{A:()=>be,e:()=>Y});var w=K(576);function be(Oe){return(0,w.m)(null==Oe?void 0:Oe.lift)}function Y(Oe){return Ae=>{if(be(Ae))return Ae.lift(function(Ve){try{return Oe(Ve,this)}catch(Fe){this.error(Fe)}});throw new TypeError("Unable to lift unknown Observable type")}}},7849:(hn,Ze,K)=>{"use strict";K.d(Ze,{h:()=>Y});var w=K(2416),be=K(3410);function Y(Oe){be.z.setTimeout(()=>{const{onUnhandledError:Ae}=w.v;if(!Ae)throw Oe;Ae(Oe)})}},4532:(hn,Ze,K)=>{"use strict";function w(be){return new TypeError(`You provided ${null!==be&&"object"==typeof be?"an invalid object":`'${be}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}K.d(Ze,{z:()=>w})},655:(hn,Ze,K)=>{"use strict";function Oe(ve,Re){var Te={};for(var We in ve)Object.prototype.hasOwnProperty.call(ve,We)&&Re.indexOf(We)<0&&(Te[We]=ve[We]);if(null!=ve&&"function"==typeof Object.getOwnPropertySymbols){var ke=0;for(We=Object.getOwnPropertySymbols(ve);ke<We.length;ke++)Re.indexOf(We[ke])<0&&Object.prototype.propertyIsEnumerable.call(ve,We[ke])&&(Te[We[ke]]=ve[We[ke]])}return Te}function Ne(ve,Re,Te,We){return new(Te||(Te=Promise))(function(It,Pe){function ni(Ci){try{Ht(We.next(Ci))}catch(nr){Pe(nr)}}function ii(Ci){try{Ht(We.throw(Ci))}catch(nr){Pe(nr)}}function Ht(Ci){Ci.done?It(Ci.value):function ke(It){return It instanceof Te?It:new Te(function(Pe){Pe(It)})}(Ci.value).then(ni,ii)}Ht((We=We.apply(ve,Re||[])).next())})}function ze(ve){return this instanceof ze?(this.v=ve,this):new ze(ve)}function at(ve,Re,Te){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ke,We=Te.apply(ve,Re||[]),It=[];return ke={},Pe("next"),Pe("throw"),Pe("return"),ke[Symbol.asyncIterator]=function(){return this},ke;function Pe($i){We[$i]&&(ke[$i]=function(_i){return new Promise(function(xs,vi){It.push([$i,_i,xs,vi])>1||ni($i,_i)})})}function ni($i,_i){try{!function ii($i){$i.value instanceof ze?Promise.resolve($i.value.v).then(Ht,Ci):nr(It[0][2],$i)}(We[$i](_i))}catch(xs){nr(It[0][3],xs)}}function Ht($i){ni("next",$i)}function Ci($i){ni("throw",$i)}function nr($i,_i){$i(_i),It.shift(),It.length&&ni(It[0][0],It[0][1])}}function nn(ve){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Te,Re=ve[Symbol.asyncIterator];return Re?Re.call(ve):(ve=function Ce(ve){var Re="function"==typeof Symbol&&Symbol.iterator,Te=Re&&ve[Re],We=0;if(Te)return Te.call(ve);if(ve&&"number"==typeof ve.length)return{next:function(){return ve&&We>=ve.length&&(ve=void 0),{value:ve&&ve[We++],done:!ve}}};throw new TypeError(Re?"Object is not iterable.":"Symbol.iterator is not defined.")}(ve),Te={},We("next"),We("throw"),We("return"),Te[Symbol.asyncIterator]=function(){return this},Te);function We(It){Te[It]=ve[It]&&function(Pe){return new Promise(function(ni,ii){!function ke(It,Pe,ni,ii){Promise.resolve(ii).then(function(Ht){It({value:Ht,done:ni})},Pe)}(ni,ii,(Pe=ve[It](Pe)).done,Pe.value)})}}}K.d(Ze,{_T:()=>Oe,mG:()=>Ne,qq:()=>ze,FC:()=>at,KL:()=>nn})},5e3:(hn,Ze,K)=>{"use strict";K.d(Ze,{deG:()=>__,tb:()=>Ey,AFp:()=>eE,ip1:()=>jM,CZH:()=>Qx,hGG:()=>vE,z2F:()=>qo,sBO:()=>Of,Sil:()=>e1,_Vd:()=>sm,EJc:()=>Pf,SBq:()=>om,qLn:()=>Xh,vpe:()=>Au,tBr:()=>Eo,XFs:()=>Pn,OlP:()=>hr,zs3:()=>_s,ZZ4:()=>aC,aQg:()=>lC,soG:()=>iE,YKP:()=>n0,h0i:()=>am,PXZ:()=>lE,R0b:()=>$c,FiY:()=>zo,Lbi:()=>_0,g9A:()=>WM,Qsj:()=>ud,FYo:()=>Qv,JOm:()=>k,tp0:()=>wa,Rgc:()=>Af,dDg:()=>YM,q4F:()=>hM,GfV:()=>dM,s_b:()=>Mi,ifc:()=>gi,eFA:()=>QM,G48:()=>hE,Gpc:()=>le,X6Q:()=>c1,_c5:()=>E0,VLi:()=>XM,c2e:()=>nE,zSh:()=>rb,wAp:()=>Un,vHH:()=>pt,cg1:()=>ry,kL8:()=>Vv,dqk:()=>kn,sIi:()=>Zr,CqO:()=>bv,QGY:()=>Kg,F4k:()=>co,RDi:()=>Cs,AaK:()=>Ne,qOj:()=>pb,TTD:()=>Vo,_Bn:()=>Yv,xp6:()=>jw,uIk:()=>hc,ekj:()=>Dv,Suo:()=>PM,Xpm:()=>wn,lG2:()=>mc,Yz7:()=>_i,cJS:()=>vi,oAB:()=>Ss,Yjl:()=>kl,Y36:()=>qg,_UZ:()=>Db,qZA:()=>vv,TgZ:()=>_v,EpF:()=>ST,n5z:()=>dl,LFG:()=>Pt,$8M:()=>tc,$Z:()=>xT,NdJ:()=>Zg,CRH:()=>Wx,oxw:()=>Yg,Q6J:()=>Ab,iGM:()=>jx,CHM:()=>xc,LSH:()=>ig,YNc:()=>jp,_uU:()=>LT,Oqu:()=>Pv,Gf:()=>RM});var w=K(7579),be=K(727),Y=K(8306),Oe=K(6451),Ae=K(3099);function Ve(o){for(let l in o)if(o[l]===Ve)return l;throw Error("Could not find renamed property on target object.")}function Fe(o,l){for(const u in l)l.hasOwnProperty(u)&&!o.hasOwnProperty(u)&&(o[u]=l[u])}function Ne(o){if("string"==typeof o)return o;if(Array.isArray(o))return"["+o.map(Ne).join(", ")+"]";if(null==o)return""+o;if(o.overriddenName)return`${o.overriddenName}`;if(o.name)return`${o.name}`;const l=o.toString();if(null==l)return""+l;const u=l.indexOf("\n");return-1===u?l:l.substring(0,u)}function Be(o,l){return null==o||""===o?null===l?"":l:null==l||""===l?o:o+" "+l}const ue=Ve({__forward_ref__:Ve});function le(o){return o.__forward_ref__=le,o.toString=function(){return Ne(this())},o}function Ce(o){return Gt(o)?o():o}function Gt(o){return"function"==typeof o&&o.hasOwnProperty(ue)&&o.__forward_ref__===le}class pt extends Error{constructor(l,u){super(function Ot(o,l){return`NG0${Math.abs(o)}${l?": "+l:""}`}(l,u)),this.code=l}}function ze(o){return"string"==typeof o?o:null==o?"":String(o)}function at(o){return"function"==typeof o?o.name||o.toString():"object"==typeof o&&null!=o&&"function"==typeof o.type?o.type.name||o.type.toString():ze(o)}function Ye(o,l){const u=l?` in ${l}`:"";throw new pt(-201,`No provider for ${at(o)} found${u}`)}function ii(o,l){null==o&&function Ht(o,l,u,h){throw new Error(`ASSERTION ERROR: ${o}`+(null==h?"":` [Expected=> ${u} ${h} ${l} <=Actual]`))}(l,o,null,"!=")}function _i(o){return{token:o.token,providedIn:o.providedIn||null,factory:o.factory,value:void 0}}function vi(o){return{providers:o.providers||[],imports:o.imports||[]}}function An(o){return Tn(o,ls)||Tn(o,Br)}function Tn(o,l){return o.hasOwnProperty(l)?o[l]:null}function Ls(o){return o&&(o.hasOwnProperty(ks)||o.hasOwnProperty(Es))?o[ks]:null}const ls=Ve({\u0275prov:Ve}),ks=Ve({\u0275inj:Ve}),Br=Ve({ngInjectableDef:Ve}),Es=Ve({ngInjectorDef:Ve});var Pn=(()=>((Pn=Pn||{})[Pn.Default=0]="Default",Pn[Pn.Host=1]="Host",Pn[Pn.Self=2]="Self",Pn[Pn.SkipSelf=4]="SkipSelf",Pn[Pn.Optional=8]="Optional",Pn))();let Xs;function ar(o){const l=Xs;return Xs=o,l}function cs(o,l,u){const h=An(o);return h&&"root"==h.providedIn?void 0===h.value?h.value=h.factory():h.value:u&Pn.Optional?null:void 0!==l?l:void Ye(Ne(o),"Injector")}function Hr(o){return{toString:o}.toString()}var Pr=(()=>((Pr=Pr||{})[Pr.OnPush=0]="OnPush",Pr[Pr.Default=1]="Default",Pr))(),gi=(()=>{return(o=gi||(gi={}))[o.Emulated=0]="Emulated",o[o.None=2]="None",o[o.ShadowDom=3]="ShadowDom",gi;var o})();const _n="undefined"!=typeof globalThis&&globalThis,On="undefined"!=typeof window&&window,Jr="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,kn=_n||"undefined"!=typeof global&&global||On||Jr,Hi={},oe=[],fe=Ve({\u0275cmp:Ve}),pe=Ve({\u0275dir:Ve}),et=Ve({\u0275pipe:Ve}),he=Ve({\u0275mod:Ve}),Ee=Ve({\u0275fac:Ve}),ct=Ve({__NG_ELEMENT_ID__:Ve});let sn=0;function wn(o){return Hr(()=>{const u={},h={type:o.type,providersResolver:null,decls:o.decls,vars:o.vars,factory:null,template:o.template||null,consts:o.consts||null,ngContentSelectors:o.ngContentSelectors,hostBindings:o.hostBindings||null,hostVars:o.hostVars||0,hostAttrs:o.hostAttrs||null,contentQueries:o.contentQueries||null,declaredInputs:u,inputs:null,outputs:null,exportAs:o.exportAs||null,onPush:o.changeDetection===Pr.OnPush,directiveDefs:null,pipeDefs:null,selectors:o.selectors||oe,viewQuery:o.viewQuery||null,features:o.features||null,data:o.data||{},encapsulation:o.encapsulation||gi.Emulated,id:"c",styles:o.styles||oe,_:null,setInput:null,schemas:o.schemas||null,tView:null},p=o.directives,y=o.features,S=o.pipes;return h.id+=sn++,h.inputs=Ll(o.inputs,u),h.outputs=Ll(o.outputs),y&&y.forEach(A=>A(h)),h.directiveDefs=p?()=>("function"==typeof p?p():p).map(Ji):null,h.pipeDefs=S?()=>("function"==typeof S?S():S).map(Fn):null,h})}function Ji(o){return Lr(o)||function Ts(o){return o[pe]||null}(o)}function Fn(o){return function Gr(o){return o[et]||null}(o)}const Or={};function Ss(o){return Hr(()=>{const l={type:o.type,bootstrap:o.bootstrap||oe,declarations:o.declarations||oe,imports:o.imports||oe,exports:o.exports||oe,transitiveCompileScopes:null,schemas:o.schemas||null,id:o.id||null};return null!=o.id&&(Or[o.id]=o.type),l})}function Ll(o,l){if(null==o)return Hi;const u={};for(const h in o)if(o.hasOwnProperty(h)){let p=o[h],y=p;Array.isArray(p)&&(y=p[1],p=p[0]),u[p]=h,l&&(l[p]=y)}return u}const mc=wn;function kl(o){return{type:o.type,name:o.name,factory:null,pure:!1!==o.pure,onDestroy:o.type.prototype.ngOnDestroy||null}}function Lr(o){return o[fe]||null}function zi(o,l){const u=o[he]||null;if(!u&&!0===l)throw new Error(`Type ${Ne(o)} does not have '\u0275mod' property.`);return u}function no(o){return Array.isArray(o)&&"object"==typeof o[1]}function ko(o){return Array.isArray(o)&&!0===o[1]}function Fl(o){return 0!=(8&o.flags)}function Qc(o){return 2==(2&o.flags)}function mo(o){return 1==(1&o.flags)}function Fo(o){return null!==o.template}function tl(o){return 0!=(512&o[2])}function ns(o,l){return o.hasOwnProperty(Ee)?o[Ee]:null}class Oa{constructor(l,u,h){this.previousValue=l,this.currentValue=u,this.firstChange=h}isFirstChange(){return this.firstChange}}function Vo(){return La}function La(o){return o.type.prototype.ngOnChanges&&(o.setInput=Rd),Dd}function Dd(){const o=go(this),l=null==o?void 0:o.current;if(l){const u=o.previous;if(u===Hi)o.previous=l;else for(let h in l)u[h]=l[h];o.current=null,this.ngOnChanges(l)}}function Rd(o,l,u,h){const p=go(o)||function Qo(o,l){return o[nu]=l}(o,{previous:Hi,current:null}),y=p.current||(p.current={}),S=p.previous,A=this.declaredInputs[u],R=S[A];y[A]=new Oa(R&&R.currentValue,l,S===Hi),o[h]=l}Vo.ngInherit=!0;const nu="__ngSimpleChanges__";function go(o){return o[nu]||null}let Bl;function Cs(o){Bl=o}function Fi(o){return!!o.listen}const _c={createRenderer:(o,l)=>function Uo(){return void 0!==Bl?Bl:"undefined"!=typeof document?document:void 0}()};function Ri(o){for(;Array.isArray(o);)o=o[0];return o}function ka(o,l){return Ri(l[o])}function fs(o,l){return Ri(l[o.index])}function ur(o,l){return o.data[l]}function is(o,l){const u=l[o];return no(u)?u:u[0]}function Fa(o){return 4==(4&o[2])}function ea(o){return 128==(128&o[2])}function _o(o,l){return null==l?null:o[l]}function Ho(o){o[18]=0}function il(o,l){o[5]+=l;let u=o,h=o[3];for(;null!==h&&(1===l&&1===u[5]||-1===l&&0===u[5]);)h[5]+=l,u=h,h=h[3]}const Cn={lFrame:Ic(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function sl(){return Cn.bindingsEnabled}function ut(){return Cn.lFrame.lView}function ai(){return Cn.lFrame.tView}function xc(o){return Cn.lFrame.contextLView=o,o[8]}function ir(){let o=ol();for(;null!==o&&64===o.type;)o=o.parent;return o}function ol(){return Cn.lFrame.currentTNode}function vo(o,l){const u=Cn.lFrame;u.currentTNode=o,u.isParent=l}function Ec(){return Cn.lFrame.isParent}function Gl(){return Cn.isInCheckNoChangesMode}function ou(o){Cn.isInCheckNoChangesMode=o}function Va(){return Cn.lFrame.bindingIndex++}function Mc(o,l){const u=Cn.lFrame;u.bindingIndex=u.bindingRootIndex=o,jl(l)}function jl(o){Cn.lFrame.currentDirectiveIndex=o}function $l(){return Cn.lFrame.currentQueryIndex}function ql(o){Cn.lFrame.currentQueryIndex=o}function Kl(o){const l=o[1];return 2===l.type?l.declTNode:1===l.type?o[6]:null}function Gu(o,l,u){if(u&Pn.SkipSelf){let p=l,y=o;for(;!(p=p.parent,null!==p||u&Pn.Host||(p=Kl(y),null===p||(y=y[15],10&p.type))););if(null===p)return!1;l=p,o=y}const h=Cn.lFrame=Ac();return h.currentTNode=l,h.lView=o,!0}function Zl(o){const l=Ac(),u=o[1];Cn.lFrame=l,l.currentTNode=u.firstChild,l.lView=o,l.tView=u,l.contextLView=o,l.bindingIndex=u.bindingStartIndex,l.inI18n=!1}function Ac(){const o=Cn.lFrame,l=null===o?null:o.child;return null===l?Ic(o):l}function Ic(o){const l={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:o,child:null,inI18n:!1};return null!==o&&(o.child=l),l}function ll(){const o=Cn.lFrame;return Cn.lFrame=o.parent,o.currentTNode=null,o.lView=null,o}const ju=ll;function Yl(){const o=ll();o.isParent=!0,o.tView=null,o.selectedIndex=-1,o.contextLView=null,o.elementDepthCount=0,o.currentDirectiveIndex=-1,o.currentNamespace=null,o.bindingRootIndex=-1,o.bindingIndex=-1,o.currentQueryIndex=0}function Wr(){return Cn.lFrame.selectedIndex}function Hs(o){Cn.lFrame.selectedIndex=o}function Qi(){const o=Cn.lFrame;return ur(o.tView,o.selectedIndex)}function $u(o,l){for(let u=l.directiveStart,h=l.directiveEnd;u<h;u++){const y=o.data[u].type.prototype,{ngAfterContentInit:S,ngAfterContentChecked:A,ngAfterViewInit:R,ngAfterViewChecked:F,ngOnDestroy:B}=y;S&&(o.contentHooks||(o.contentHooks=[])).push(-u,S),A&&((o.contentHooks||(o.contentHooks=[])).push(u,A),(o.contentCheckHooks||(o.contentCheckHooks=[])).push(u,A)),R&&(o.viewHooks||(o.viewHooks=[])).push(-u,R),F&&((o.viewHooks||(o.viewHooks=[])).push(u,F),(o.viewCheckHooks||(o.viewCheckHooks=[])).push(u,F)),null!=B&&(o.destroyHooks||(o.destroyHooks=[])).push(u,B)}}function ga(o,l,u){$r(o,l,3,u)}function wo(o,l,u,h){(3&o[2])===u&&$r(o,l,u,h)}function Jl(o,l){let u=o[2];(3&u)===l&&(u&=2047,u+=1,o[2]=u)}function $r(o,l,u,h){const y=null!=h?h:-1,S=l.length-1;let A=0;for(let R=void 0!==h?65535&o[18]:0;R<S;R++)if("number"==typeof l[R+1]){if(A=l[R],null!=h&&A>=h)break}else l[R]<0&&(o[18]+=65536),(A<y||-1==y)&&(Dc(o,u,l,R),o[18]=(4294901760&o[18])+R+2),R++}function Dc(o,l,u,h){const p=u[h]<0,y=u[h+1],A=o[p?-u[h]:u[h]];if(p){if(o[2]>>11<o[18]>>16&&(3&o[2])===l){o[2]+=2048;try{y.call(A)}finally{}}}else try{y.call(A)}finally{}}const H=-1;class T{constructor(l,u,h){this.factory=l,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=h}}function qe(o,l,u){const h=Fi(o);let p=0;for(;p<u.length;){const y=u[p];if("number"==typeof y){if(0!==y)break;p++;const S=u[p++],A=u[p++],R=u[p++];h?o.setAttribute(l,A,R,S):l.setAttributeNS(S,A,R)}else{const S=y,A=u[++p];En(S)?h&&o.setProperty(l,S,A):h?o.setAttribute(l,S,A):l.setAttribute(S,A),p++}}return p}function Tt(o){return 3===o||4===o||6===o}function En(o){return 64===o.charCodeAt(0)}function mn(o,l){if(null!==l&&0!==l.length)if(null===o||0===o.length)o=l.slice();else{let u=-1;for(let h=0;h<l.length;h++){const p=l[h];"number"==typeof p?u=p:0===u||bn(o,u,p,null,-1===u||2===u?l[++h]:null)}}return o}function bn(o,l,u,h,p){let y=0,S=o.length;if(-1===l)S=-1;else for(;y<o.length;){const A=o[y++];if("number"==typeof A){if(A===l){S=-1;break}if(A>l){S=y-1;break}}}for(;y<o.length;){const A=o[y];if("number"==typeof A)break;if(A===u){if(null===h)return void(null!==p&&(o[y+1]=p));if(h===o[y+1])return void(o[y+2]=p)}y++,null!==h&&y++,null!==p&&y++}-1!==S&&(o.splice(S,0,l),y=S+1),o.splice(y++,0,u),null!==h&&o.splice(y++,0,h),null!==p&&o.splice(y++,0,p)}function vn(o){return o!==H}function cn(o){return 32767&o}function St(o,l){let u=function ri(o){return o>>16}(o),h=l;for(;u>0;)h=h[15],u--;return h}let Gn=!0;function Qn(o){const l=Gn;return Gn=o,l}let Pi=0;function dr(o,l){const u=rr(o,l);if(-1!==u)return u;const h=l[1];h.firstCreatePass&&(o.injectorIndex=l.length,br(h.data,o),br(l,null),br(h.blueprint,null));const p=Zi(o,l),y=o.injectorIndex;if(vn(p)){const S=cn(p),A=St(p,l),R=A[1].data;for(let F=0;F<8;F++)l[y+F]=A[S+F]|R[S+F]}return l[y+8]=p,y}function br(o,l){o.push(0,0,0,0,0,0,0,0,l)}function rr(o,l){return-1===o.injectorIndex||o.parent&&o.parent.injectorIndex===o.injectorIndex||null===l[o.injectorIndex+8]?-1:o.injectorIndex}function Zi(o,l){if(o.parent&&-1!==o.parent.injectorIndex)return o.parent.injectorIndex;let u=0,h=null,p=l;for(;null!==p;){const y=p[1],S=y.type;if(h=2===S?y.declTNode:1===S?p[6]:null,null===h)return H;if(u++,p=p[15],-1!==h.injectorIndex)return h.injectorIndex|u<<16}return H}function xr(o,l,u){!function Xi(o,l,u){let h;"string"==typeof u?h=u.charCodeAt(0)||0:u.hasOwnProperty(ct)&&(h=u[ct]),null==h&&(h=u[ct]=Pi++);const p=255&h;l.data[o+(p>>5)]|=1<<p}(o,l,u)}function zs(o,l,u){if(u&Pn.Optional)return o;Ye(l,"NodeInjector")}function mr(o,l,u,h){if(u&Pn.Optional&&void 0===h&&(h=null),0==(u&(Pn.Self|Pn.Host))){const p=o[9],y=ar(void 0);try{return p?p.get(l,h,u&Pn.Optional):cs(l,h,u&Pn.Optional)}finally{ar(y)}}return zs(h,l,u)}function Yi(o,l,u,h=Pn.Default,p){if(null!==o){const y=function cl(o){if("string"==typeof o)return o.charCodeAt(0)||0;const l=o.hasOwnProperty(ct)?o[ct]:void 0;return"number"==typeof l?l>=0?255&l:sr:l}(u);if("function"==typeof y){if(!Gu(l,o,h))return h&Pn.Host?zs(p,u,h):mr(l,u,h,p);try{const S=y(h);if(null!=S||h&Pn.Optional)return S;Ye(u)}finally{ju()}}else if("number"==typeof y){let S=null,A=rr(o,l),R=H,F=h&Pn.Host?l[16][6]:null;for((-1===A||h&Pn.SkipSelf)&&(R=-1===A?Zi(o,l):l[A+8],R!==H&&Ql(h,!1)?(S=l[1],A=cn(R),l=St(R,l)):A=-1);-1!==A;){const B=l[1];if(ro(y,A,B.data)){const X=ci(A,l,u,S,h,F);if(X!==ya)return X}R=l[A+8],R!==H&&Ql(h,l[1].data[A+8]===F)&&ro(y,A,l)?(S=B,A=cn(R),l=St(R,l)):A=-1}}}return mr(l,u,h,p)}const ya={};function sr(){return new ul(ir(),ut())}function ci(o,l,u,h,p,y){const S=l[1],A=S.data[o+8],B=ps(A,S,u,null==h?Qc(A)&&Gn:h!=S&&0!=(3&A.type),p&Pn.Host&&y===A);return null!==B?na(l,S,B,A):ya}function ps(o,l,u,h,p){const y=o.providerIndexes,S=l.data,A=1048575&y,R=o.directiveStart,B=y>>20,de=p?A+B:o.directiveEnd;for(let xe=h?A:A+B;xe<de;xe++){const Je=S[xe];if(xe<R&&u===Je||xe>=R&&Je.type===u)return xe}if(p){const xe=S[R];if(xe&&Fo(xe)&&xe.type===u)return R}return null}function na(o,l,u,h){let p=o[u];const y=l.data;if(function N(o){return o instanceof T}(p)){const S=p;S.resolving&&function qt(o,l){const u=l?`. Dependency path: ${l.join(" > ")} > ${o}`:"";throw new pt(-200,`Circular dependency in DI detected for ${o}${u}`)}(at(y[u]));const A=Qn(S.canSeeViewProviders);S.resolving=!0;const R=S.injectImpl?ar(S.injectImpl):null;Gu(o,h,Pn.Default);try{p=o[u]=S.factory(void 0,y,o,h),l.firstCreatePass&&u>=h.directiveStart&&function Oh(o,l,u){const{ngOnChanges:h,ngOnInit:p,ngDoCheck:y}=l.type.prototype;if(h){const S=La(l);(u.preOrderHooks||(u.preOrderHooks=[])).push(o,S),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(o,S)}p&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-o,p),y&&((u.preOrderHooks||(u.preOrderHooks=[])).push(o,y),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(o,y))}(u,y[u],l)}finally{null!==R&&ar(R),Qn(A),S.resolving=!1,ju()}}return p}function ro(o,l,u){return!!(u[l+(o>>5)]&1<<o)}function Ql(o,l){return!(o&Pn.Self||o&Pn.Host&&l)}class ul{constructor(l,u){this._tNode=l,this._lView=u}get(l,u,h){return Yi(this._tNode,this._lView,l,h,u)}}function dl(o){return Hr(()=>{const l=o.prototype.constructor,u=l[Ee]||ec(l),h=Object.prototype;let p=Object.getPrototypeOf(o.prototype).constructor;for(;p&&p!==h;){const y=p[Ee]||ec(p);if(y&&y!==u)return y;p=Object.getPrototypeOf(p)}return y=>new y})}function ec(o){return Gt(o)?()=>{const l=ec(Ce(o));return l&&l()}:ns(o)}function tc(o){return function ta(o,l){if("class"===l)return o.classes;if("style"===l)return o.styles;const u=o.attrs;if(u){const h=u.length;let p=0;for(;p<h;){const y=u[p];if(Tt(y))break;if(0===y)p+=2;else if("number"==typeof y)for(p++;p<h&&"string"==typeof u[p];)p++;else{if(y===l)return u[p+1];p+=2}}}return null}(ir(),o)}const _a="__parameters__";function Ba(o,l,u){return Hr(()=>{const h=function au(o){return function(...u){if(o){const h=o(...u);for(const p in h)this[p]=h[p]}}}(l);function p(...y){if(this instanceof p)return h.apply(this,y),this;const S=new p(...y);return A.annotation=S,A;function A(R,F,B){const X=R.hasOwnProperty(_a)?R[_a]:Object.defineProperty(R,_a,{value:[]})[_a];for(;X.length<=B;)X.push(null);return(X[B]=X[B]||[]).push(S),R}}return u&&(p.prototype=Object.create(u.prototype)),p.prototype.ngMetadataName=o,p.annotationCls=p,p})}class hr{constructor(l,u){this._desc=l,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=_i({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}toString(){return`InjectionToken ${this._desc}`}}const __=new hr("AnalyzeForEntryComponents");function Dr(o,l){void 0===l&&(l=o);for(let u=0;u<o.length;u++){let h=o[u];Array.isArray(h)?(l===o&&(l=o.slice(0,u)),Dr(h,l)):l!==o&&l.push(h)}return l}function ia(o,l){o.forEach(u=>Array.isArray(u)?ia(u,l):l(u))}function kr(o,l,u){l>=o.length?o.push(u):o.splice(l,0,u)}function fl(o,l){return l>=o.length-1?o.pop():o.splice(l,1)[0]}function ra(o,l,u){let h=Yu(o,l);return h>=0?o[1|h]=u:(h=~h,function va(o,l,u,h){let p=o.length;if(p==l)o.push(u,h);else if(1===p)o.push(h,o[0]),o[0]=u;else{for(p--,o.push(o[p-1],o[p]);p>l;)o[p]=o[p-2],p--;o[l]=u,o[l+1]=h}}(o,h,l,u)),h}function Fd(o,l){const u=Yu(o,l);if(u>=0)return o[1|u]}function Yu(o,l){return function Ke(o,l,u){let h=0,p=o.length>>u;for(;p!==h;){const y=h+(p-h>>1),S=o[y<<u];if(l===S)return y<<u;S>l?p=y:h=y+1}return~(p<<u)}(o,l,1)}const gl={},Nc="__NG_DI_FLAG__",Ga="ngTempTokenPath",P=/\n/gm,G="__source",te=Ve({provide:String,useValue:Ve});let ge;function Ie(o){const l=ge;return ge=o,l}function nt(o,l=Pn.Default){if(void 0===ge)throw new pt(203,"");return null===ge?cs(o,void 0,l):ge.get(o,l&Pn.Optional?null:void 0,l)}function Pt(o,l=Pn.Default){return(function qi(){return Xs}()||nt)(Ce(o),l)}const ui=Pt;function Ti(o){const l=[];for(let u=0;u<o.length;u++){const h=Ce(o[u]);if(Array.isArray(h)){if(0===h.length)throw new pt(900,"");let p,y=Pn.Default;for(let S=0;S<h.length;S++){const A=h[S],R=so(A);"number"==typeof R?-1===R?p=A.token:y|=R:p=A}l.push(Pt(p,y))}else l.push(Pt(h))}return l}function Rn(o,l){return o[Nc]=l,o.prototype[Nc]=l,o}function so(o){return o[Nc]}const Eo=Rn(Ba("Inject",o=>({token:o})),-1),zo=Rn(Ba("Optional"),8),wa=Rn(Ba("SkipSelf"),4);class S_{constructor(l){this.changingThisBreaksApplicationSecurity=l}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function ac(o){return o instanceof S_?o.changingThisBreaksApplicationSecurity:o}const eg=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,A_=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var Fr=(()=>((Fr=Fr||{})[Fr.NONE=0]="NONE",Fr[Fr.HTML=1]="HTML",Fr[Fr.STYLE=2]="STYLE",Fr[Fr.SCRIPT=3]="SCRIPT",Fr[Fr.URL=4]="URL",Fr[Fr.RESOURCE_URL=5]="RESOURCE_URL",Fr))();function ig(o){const l=function zd(){const o=ut();return o&&o[12]}();return l?l.sanitize(Fr.URL,o)||"":function Oc(o,l){const u=function Ym(o){return o instanceof S_&&o.getTypeName()||null}(o);if(null!=u&&u!==l){if("ResourceURL"===u&&"URL"===l)return!0;throw new Error(`Required a safe ${l}, got a ${u} (see https://g.co/ng/security#xss)`)}return u===l}(o,"URL")?ac(o):function fr(o){return(o=String(o)).match(eg)||o.match(A_)?o:"unsafe:"+o}(ze(o))}const $h="__ngContext__";function Rs(o,l){o[$h]=l}function hu(o){const l=function du(o){return o[$h]||null}(o);return l?Array.isArray(l)?l:l.lView:null}function yl(o){return o.ngOriginalError}function Yh(o,...l){o.error(...l)}class Xh{constructor(){this._console=console}handleError(l){const u=this._findOriginalError(l),h=function k_(o){return o&&o.ngErrorLogger||Yh}(l);h(this._console,"ERROR",l),u&&h(this._console,"ORIGINAL ERROR",u)}_findOriginalError(l){let u=l&&yl(l);for(;u&&yl(u);)u=yl(u);return u||null}}const Nw=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(kn))();function xa(o){return o instanceof Function?o():o}var k=(()=>((k=k||{})[k.Important=1]="Important",k[k.DashCase=2]="DashCase",k))();function ye(o,l){return undefined(o,l)}function on(o){const l=o[3];return ko(l)?l[3]:l}function ss(o){return $a(o[13])}function ao(o){return $a(o[4])}function $a(o){for(;null!==o&&!ko(o);)o=o[4];return o}function Bc(o,l,u,h,p){if(null!=h){let y,S=!1;ko(h)?y=h:no(h)&&(S=!0,h=h[0]);const A=Ri(h);0===o&&null!==u?null==p?H_(l,u,A):mu(l,u,A,p||null,!0):1===o&&null!==u?mu(l,u,A,p||null,!0):2===o?function vg(o,l,u){const h=$d(o,l);h&&function yg(o,l,u,h){Fi(o)?o.removeChild(l,u,h):l.removeChild(u)}(o,h,l,u)}(l,A,S):3===o&&l.destroyNode(A),null!=y&&function Bw(o,l,u,h,p){const y=u[7];y!==Ri(u)&&Bc(l,o,h,y,p);for(let A=10;A<u.length;A++){const R=u[A];_l(R[1],R,o,l,h,y)}}(l,o,y,u,p)}}function Tp(o,l,u){if(Fi(o))return o.createElement(l,u);{const h=null!==u?function Hu(o){const l=o.toLowerCase();return"svg"===l?"http://www.w3.org/2000/svg":"math"===l?"http://www.w3.org/1998/MathML/":null}(u):null;return null===h?o.createElement(l):o.createElementNS(h,l)}}function Ow(o,l){const u=o[9],h=u.indexOf(l),p=l[3];1024&l[2]&&(l[2]&=-1025,il(p,-1)),u.splice(h,1)}function U_(o,l){if(o.length<=10)return;const u=10+l,h=o[u];if(h){const p=h[17];null!==p&&p!==o&&Ow(p,h),l>0&&(o[u-1][4]=h[4]);const y=fl(o,10+l);!function hg(o,l){_l(o,l,l[11],2,null,null),l[0]=null,l[6]=null}(h[1],h);const S=y[19];null!==S&&S.detachView(y[1]),h[3]=null,h[4]=null,h[2]&=-129}return h}function B_(o,l){if(!(256&l[2])){const u=l[11];Fi(u)&&u.destroyNode&&_l(o,l,u,3,null,null),function V_(o){let l=o[13];if(!l)return Lw(o[1],o);for(;l;){let u=null;if(no(l))u=l[13];else{const h=l[10];h&&(u=h)}if(!u){for(;l&&!l[4]&&l!==o;)no(l)&&Lw(l[1],l),l=l[3];null===l&&(l=o),no(l)&&Lw(l[1],l),u=l&&l[4]}l=u}}(l)}}function Lw(o,l){if(!(256&l[2])){l[2]&=-129,l[2]|=256,function rI(o,l){let u;if(null!=o&&null!=(u=o.destroyHooks))for(let h=0;h<u.length;h+=2){const p=l[u[h]];if(!(p instanceof T)){const y=u[h+1];if(Array.isArray(y))for(let S=0;S<y.length;S+=2){const A=p[y[S]],R=y[S+1];try{R.call(A)}finally{}}else try{y.call(p)}finally{}}}}(o,l),function iI(o,l){const u=o.cleanup,h=l[7];let p=-1;if(null!==u)for(let y=0;y<u.length-1;y+=2)if("string"==typeof u[y]){const S=u[y+1],A="function"==typeof S?S(l):Ri(l[S]),R=h[p=u[y+2]],F=u[y+3];"boolean"==typeof F?A.removeEventListener(u[y],R,F):F>=0?h[p=F]():h[p=-F].unsubscribe(),y+=2}else{const S=h[p=u[y+1]];u[y].call(S)}if(null!==h){for(let y=p+1;y<h.length;y++)h[y]();l[7]=null}}(o,l),1===l[1].type&&Fi(l[11])&&l[11].destroy();const u=l[17];if(null!==u&&ko(l[3])){u!==l[3]&&Ow(u,l);const h=l[19];null!==h&&h.detachView(o)}}}function gg(o,l,u){return function Mp(o,l,u){let h=l;for(;null!==h&&40&h.type;)h=(l=h).parent;if(null===h)return u[0];if(2&h.flags){const p=o.data[h.directiveStart].encapsulation;if(p===gi.None||p===gi.Emulated)return null}return fs(h,u)}(o,l.parent,u)}function mu(o,l,u,h,p){Fi(o)?o.insertBefore(l,u,h,p):l.insertBefore(u,h,p)}function H_(o,l,u){Fi(o)?o.appendChild(l,u):l.appendChild(u)}function kw(o,l,u,h,p){null!==h?mu(o,l,u,h,p):H_(o,l,u)}function $d(o,l){return Fi(o)?o.parentNode(l):l.parentNode}let AS=function Fw(o,l,u){return 40&o.type?fs(o,u):null};function z_(o,l,u,h){const p=gg(o,h,l),y=l[11],A=function Ps(o,l,u){return AS(o,l,u)}(h.parent||l[6],h,l);if(null!=p)if(Array.isArray(u))for(let R=0;R<u.length;R++)kw(y,p,u[R],A,!1);else kw(y,p,u,A,!1)}function _g(o,l){if(null!==l){const u=l.type;if(3&u)return fs(l,o);if(4&u)return G_(-1,o[l.index]);if(8&u){const h=l.child;if(null!==h)return _g(o,h);{const p=o[l.index];return ko(p)?G_(-1,p):Ri(p)}}if(32&u)return ye(l,o)()||Ri(o[l.index]);{const h=Uw(o,l);return null!==h?Array.isArray(h)?h[0]:_g(on(o[16]),h):_g(o,l.next)}}return null}function Uw(o,l){return null!==l?o[16][6].projection[l.projection]:null}function G_(o,l){const u=10+o+1;if(u<l.length){const h=l[u],p=h[1].firstChild;if(null!==p)return _g(h,p)}return l[7]}function j_(o,l,u,h,p,y,S){for(;null!=u;){const A=h[u.index],R=u.type;if(S&&0===l&&(A&&Rs(Ri(A),h),u.flags|=4),64!=(64&u.flags))if(8&R)j_(o,l,u.child,h,p,y,!1),Bc(l,o,p,A,y);else if(32&R){const F=ye(u,h);let B;for(;B=F();)Bc(l,o,p,B,y);Bc(l,o,p,A,y)}else 16&R?RS(o,l,h,u,p,y):Bc(l,o,p,A,y);u=S?u.projectionNext:u.next}}function _l(o,l,u,h,p,y){j_(u,h,o.firstChild,l,p,y,!1)}function RS(o,l,u,h,p,y){const S=u[16],R=S[6].projection[h.projection];if(Array.isArray(R))for(let F=0;F<R.length;F++)Bc(l,o,p,R[F],y);else j_(o,l,R,S[3],p,y,!0)}function Hw(o,l,u){Fi(o)?o.setAttribute(l,"style",u):l.style.cssText=u}function bg(o,l,u){Fi(o)?""===u?o.removeAttribute(l,"class"):o.setAttribute(l,"class",u):l.className=u}function xg(o,l,u){let h=o.length;for(;;){const p=o.indexOf(l,u);if(-1===p)return p;if(0===p||o.charCodeAt(p-1)<=32){const y=l.length;if(p+y===h||o.charCodeAt(p+y)<=32)return p}u=p+1}}const W_="ng-template";function $_(o,l,u){let h=0;for(;h<o.length;){let p=o[h++];if(u&&"class"===p){if(p=o[h],-1!==xg(p.toLowerCase(),l,0))return!0}else if(1===p){for(;h<o.length&&"string"==typeof(p=o[h++]);)if(p.toLowerCase()===l)return!0;return!1}}return!1}function PS(o){return 4===o.type&&o.value!==W_}function NS(o,l,u){return l===(4!==o.type||u?o.value:W_)}function Eg(o,l,u){let h=4;const p=o.attrs||[],y=function LS(o){for(let l=0;l<o.length;l++)if(Tt(o[l]))return l;return o.length}(p);let S=!1;for(let A=0;A<l.length;A++){const R=l[A];if("number"!=typeof R){if(!S)if(4&h){if(h=2|1&h,""!==R&&!NS(o,R,u)||""===R&&1===l.length){if(cc(h))return!1;S=!0}}else{const F=8&h?R:l[++A];if(8&h&&null!==o.attrs){if(!$_(o.attrs,F,u)){if(cc(h))return!1;S=!0}continue}const X=OS(8&h?"class":R,p,PS(o),u);if(-1===X){if(cc(h))return!1;S=!0;continue}if(""!==F){let de;de=X>y?"":p[X+1].toLowerCase();const xe=8&h?de:null;if(xe&&-1!==xg(xe,F,0)||2&h&&F!==de){if(cc(h))return!1;S=!0}}}}else{if(!S&&!cc(h)&&!cc(R))return!1;if(S&&cc(R))continue;S=!1,h=R|1&h}}return cc(h)||S}function cc(o){return 0==(1&o)}function OS(o,l,u,h){if(null===l)return-1;let p=0;if(h||!u){let y=!1;for(;p<l.length;){const S=l[p];if(S===o)return p;if(3===S||6===S)y=!0;else{if(1===S||2===S){let A=l[++p];for(;"string"==typeof A;)A=l[++p];continue}if(4===S)break;if(0===S){p+=4;continue}}p+=y?1:2}return-1}return function K_(o,l){let u=o.indexOf(4);if(u>-1)for(u++;u<o.length;){const h=o[u];if("number"==typeof h)return-1;if(h===l)return u;u++}return-1}(l,o)}function q_(o,l,u=!1){for(let h=0;h<l.length;h++)if(Eg(o,l[h],u))return!0;return!1}function Gw(o,l){return o?":not("+l.trim()+")":l}function tf(o){let l=o[0],u=1,h=2,p="",y=!1;for(;u<o.length;){let S=o[u];if("string"==typeof S)if(2&h){const A=o[++u];p+="["+S+(A.length>0?'="'+A+'"':"")+"]"}else 8&h?p+="."+S:4&h&&(p+=" "+S);else""!==p&&!cc(S)&&(l+=Gw(y,p),p=""),h=S,y=y||!cc(h);u++}return""!==p&&(l+=Gw(y,p)),l}const si={};function jw(o){Sg(ai(),ut(),Wr()+o,Gl())}function Sg(o,l,u,h){if(!h)if(3==(3&l[2])){const y=o.preOrderCheckHooks;null!==y&&ga(l,y,u)}else{const y=o.preOrderHooks;null!==y&&wo(l,y,0,u)}Hs(u)}function Tg(o,l){return o<<17|l<<2}function uc(o){return o>>17&32767}function Ww(o){return 2|o}function Hc(o){return(131068&o)>>2}function $w(o,l){return-131069&o|l<<2}function Z_(o){return 1|o}function Rg(o,l){const u=o.contentQueries;if(null!==u)for(let h=0;h<u.length;h+=2){const p=u[h],y=u[h+1];if(-1!==y){const S=o.data[y];ql(p),S.contentQueries(2,l[y],y)}}}function Ap(o,l,u,h,p,y,S,A,R,F){const B=l.blueprint.slice();return B[0]=p,B[2]=140|h,Ho(B),B[3]=B[15]=o,B[8]=u,B[10]=S||o&&o[10],B[11]=A||o&&o[11],B[12]=R||o&&o[12]||null,B[9]=F||o&&o[9]||null,B[6]=y,B[16]=2==l.type?o[16]:B,B}function Mo(o,l,u,h,p){let y=o.data[l];if(null===y)y=function Ng(o,l,u,h,p){const y=ol(),S=Ec(),R=o.data[l]=function pI(o,l,u,h,p,y){return{type:u,index:h,insertBeforeIndex:null,injectorIndex:l?l.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:p,attrs:y,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:l,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,S?y:y&&y.parent,u,l,h,p);return null===o.firstChild&&(o.firstChild=R),null!==y&&(S?null==y.child&&null!==R.parent&&(y.child=R):null===y.next&&(y.next=R)),R}(o,l,u,h,p),function al(){return Cn.lFrame.inI18n}()&&(y.flags|=64);else if(64&y.type){y.type=u,y.value=h,y.attrs=p;const S=function Us(){const o=Cn.lFrame,l=o.currentTNode;return o.isParent?l:l.parent}();y.injectorIndex=null===S?-1:S.injectorIndex}return vo(y,!0),y}function sf(o,l,u,h){if(0===u)return-1;const p=l.length;for(let y=0;y<u;y++)l.push(h),o.blueprint.push(h),o.data.push(null);return p}function Ip(o,l,u){Zl(l);try{const h=o.viewQuery;null!==h&&nv(1,h,u);const p=o.template;null!==p&&Le(o,l,p,1,u),o.firstCreatePass&&(o.firstCreatePass=!1),o.staticContentQueries&&Rg(o,l),o.staticViewQueries&&nv(2,o.viewQuery,u);const y=o.components;null!==y&&function HS(o,l){for(let u=0;u<l.length;u++)lf(o,l[u])}(l,y)}catch(h){throw o.firstCreatePass&&(o.incompleteFirstPass=!0,o.firstCreatePass=!1),h}finally{l[2]&=-5,Yl()}}function vl(o,l,u,h){const p=l[2];if(256==(256&p))return;Zl(l);const y=Gl();try{Ho(l),function Tc(o){return Cn.lFrame.bindingIndex=o}(o.bindingStartIndex),null!==u&&Le(o,l,u,2,h);const S=3==(3&p);if(!y)if(S){const F=o.preOrderCheckHooks;null!==F&&ga(l,F,null)}else{const F=o.preOrderHooks;null!==F&&wo(l,F,0,null),Jl(l,0)}if(function jS(o){for(let l=ss(o);null!==l;l=ao(l)){if(!l[2])continue;const u=l[9];for(let h=0;h<u.length;h++){const p=u[h],y=p[3];0==(1024&p[2])&&il(y,1),p[2]|=1024}}}(l),function Jd(o){for(let l=ss(o);null!==l;l=ao(l))for(let u=10;u<l.length;u++){const h=l[u],p=h[1];ea(h)&&vl(p,h,p.template,h[8])}}(l),null!==o.contentQueries&&Rg(o,l),!y)if(S){const F=o.contentCheckHooks;null!==F&&ga(l,F)}else{const F=o.contentHooks;null!==F&&wo(l,F,1),Jl(l,1)}!function rf(o,l){const u=o.hostBindingOpCodes;if(null!==u)try{for(let h=0;h<u.length;h++){const p=u[h];if(p<0)Hs(~p);else{const y=p,S=u[++h],A=u[++h];Mc(S,y),A(2,l[y])}}}finally{Hs(-1)}}(o,l);const A=o.components;null!==A&&function Pg(o,l){for(let u=0;u<l.length;u++)Np(o,l[u])}(l,A);const R=o.viewQuery;if(null!==R&&nv(2,R,h),!y)if(S){const F=o.viewCheckHooks;null!==F&&ga(l,F)}else{const F=o.viewHooks;null!==F&&wo(l,F,2),Jl(l,2)}!0===o.firstUpdatePass&&(o.firstUpdatePass=!1),y||(l[2]&=-73),1024&l[2]&&(l[2]&=-1025,il(l[3],-1))}finally{Yl()}}function Kw(o,l,u,h){const p=l[10],y=!Gl(),S=Fa(l);try{y&&!S&&p.begin&&p.begin(),S&&Ip(o,l,h),vl(o,l,u,h)}finally{y&&!S&&p.end&&p.end()}}function Le(o,l,u,h,p){const y=Wr(),S=2&h;try{Hs(-1),S&&l.length>20&&Sg(o,l,20,Gl()),u(h,p)}finally{Hs(y)}}function wl(o,l,u){!sl()||(function Yd(o,l,u,h){const p=u.directiveStart,y=u.directiveEnd;o.firstCreatePass||dr(u,l),Rs(h,l);const S=u.initialInputs;for(let A=p;A<y;A++){const R=o.data[A],F=Fo(R);F&&Fg(l,u,R);const B=na(l,o,A,u);Rs(B,l),null!==S&&ev(0,A-p,B,R,0,S),F&&(is(u.index,l)[8]=B)}}(o,l,u,fs(u,l)),128==(128&u.flags)&&function ys(o,l,u){const h=u.directiveStart,p=u.directiveEnd,S=u.index,A=function Cc(){return Cn.lFrame.currentDirectiveIndex}();try{Hs(S);for(let R=h;R<p;R++){const F=o.data[R],B=l[R];jl(R),(null!==F.hostBindings||0!==F.hostVars||null!==F.hostAttrs)&&Xd(F,B)}}finally{Hs(-1),jl(A)}}(o,l,u))}function Zw(o,l,u=fs){const h=l.localNames;if(null!==h){let p=l.index+1;for(let y=0;y<h.length;y+=2){const S=h[y+1],A=-1===S?u(l,o):o[S];o[p++]=A}}}function Dp(o){const l=o.tView;return null===l||l.incompleteFirstPass?o.tView=zc(1,null,o.template,o.decls,o.vars,o.directiveDefs,o.pipeDefs,o.viewQuery,o.schemas,o.consts):l}function zc(o,l,u,h,p,y,S,A,R,F){const B=20+h,X=B+p,de=function hI(o,l){const u=[];for(let h=0;h<l;h++)u.push(h<o?null:si);return u}(B,X),xe="function"==typeof F?F():F;return de[1]={type:o,blueprint:de,template:u,queries:null,viewQuery:A,declTNode:l,data:de.slice().fill(null,B),bindingStartIndex:B,expandoStartIndex:X,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof y?y():y,pipeRegistry:"function"==typeof S?S():S,firstChild:null,schemas:R,consts:xe,incompleteFirstPass:!1}}function zS(o,l,u,h){const p=nb(l);null===u?p.push(h):(p.push(u),o.firstCreatePass&&Sr(o).push(h,p.length-1))}function Ea(o,l,u){for(let h in o)if(o.hasOwnProperty(h)){const p=o[h];(u=null===u?{}:u).hasOwnProperty(h)?u[h].push(l,p):u[h]=[l,p]}return u}function Xw(o,l,u,h){let p=!1;if(sl()){const y=function Jw(o,l,u){const h=o.directiveRegistry;let p=null;if(h)for(let y=0;y<h.length;y++){const S=h[y];q_(u,S.selectors,!1)&&(p||(p=[]),xr(dr(u,l),o,S.type),Fo(S)?(Qw(o,u),p.unshift(S)):p.push(S))}return p}(o,l,u),S=null===h?null:{"":-1};if(null!==y){p=!0,yu(u,o.data.length,y.length);for(let B=0;B<y.length;B++){const X=y[B];X.providersResolver&&X.providersResolver(X)}let A=!1,R=!1,F=sf(o,l,y.length,null);for(let B=0;B<y.length;B++){const X=y[B];u.mergedAttrs=mn(u.mergedAttrs,X.hostAttrs),Rp(o,u,l,F,X),gI(F,X,S),null!==X.contentQueries&&(u.flags|=8),(null!==X.hostBindings||null!==X.hostAttrs||0!==X.hostVars)&&(u.flags|=128);const de=X.type.prototype;!A&&(de.ngOnChanges||de.ngOnInit||de.ngDoCheck)&&((o.preOrderHooks||(o.preOrderHooks=[])).push(u.index),A=!0),!R&&(de.ngOnChanges||de.ngDoCheck)&&((o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(u.index),R=!0),F++}!function GS(o,l){const h=l.directiveEnd,p=o.data,y=l.attrs,S=[];let A=null,R=null;for(let F=l.directiveStart;F<h;F++){const B=p[F],X=B.inputs,de=null===y||PS(l)?null:af(X,y);S.push(de),A=Ea(X,F,A),R=Ea(B.outputs,F,R)}null!==A&&(A.hasOwnProperty("class")&&(l.flags|=16),A.hasOwnProperty("style")&&(l.flags|=32)),l.initialInputs=S,l.inputs=A,l.outputs=R}(o,u)}S&&function kg(o,l,u){if(l){const h=o.localNames=[];for(let p=0;p<l.length;p+=2){const y=u[l[p+1]];if(null==y)throw new pt(-301,!1);h.push(l[p],y)}}}(u,h,S)}return u.mergedAttrs=mn(u.mergedAttrs,u.attrs),p}function Ws(o,l,u,h,p,y){const S=y.hostBindings;if(S){let A=o.hostBindingOpCodes;null===A&&(A=o.hostBindingOpCodes=[]);const R=~l.index;(function mI(o){let l=o.length;for(;l>0;){const u=o[--l];if("number"==typeof u&&u<0)return u}return 0})(A)!=R&&A.push(R),A.push(h,p,S)}}function Xd(o,l){null!==o.hostBindings&&o.hostBindings(1,l)}function Qw(o,l){l.flags|=2,(o.components||(o.components=[])).push(l.index)}function gI(o,l,u){if(u){if(l.exportAs)for(let h=0;h<l.exportAs.length;h++)u[l.exportAs[h]]=o;Fo(l)&&(u[""]=o)}}function yu(o,l,u){o.flags|=1,o.directiveStart=l,o.directiveEnd=l+u,o.providerIndexes=l}function Rp(o,l,u,h,p){o.data[h]=p;const y=p.factory||(p.factory=ns(p.type)),S=new T(y,Fo(p),null);o.blueprint[h]=S,u[h]=S,Ws(o,l,0,h,sf(o,u,p.hostVars,si),p)}function Fg(o,l,u){const h=fs(l,o),p=Dp(u),y=o[10],S=Qd(o,Ap(o,p,null,u.onPush?64:16,h,l,y,y.createRenderer(h,u),null,null));o[l.index]=S}function Gc(o,l,u,h,p,y){const S=fs(o,l);!function _u(o,l,u,h,p,y,S){if(null==y)Fi(o)?o.removeAttribute(l,p,u):l.removeAttribute(p);else{const A=null==S?ze(y):S(y,h||"",p);Fi(o)?o.setAttribute(l,p,A,u):u?l.setAttributeNS(u,p,A):l.setAttribute(p,A)}}(l[11],S,y,o.value,u,h,p)}function ev(o,l,u,h,p,y){const S=y[l];if(null!==S){const A=h.setInput;for(let R=0;R<S.length;){const F=S[R++],B=S[R++],X=S[R++];null!==A?h.setInput(u,X,F,B):u[B]=X}}}function af(o,l){let u=null,h=0;for(;h<l.length;){const p=l[h];if(0!==p)if(5!==p){if("number"==typeof p)break;o.hasOwnProperty(p)&&(null===u&&(u=[]),u.push(p,o[p],l[h+1])),h+=2}else h+=2;else h+=4}return u}function Pp(o,l,u,h){return new Array(o,!0,!1,l,null,0,h,u,null,null)}function Np(o,l){const u=is(l,o);if(ea(u)){const h=u[1];80&u[2]?vl(h,u,h.template,u[8]):u[5]>0&&Vg(u)}}function Vg(o){for(let h=ss(o);null!==h;h=ao(h))for(let p=10;p<h.length;p++){const y=h[p];if(1024&y[2]){const S=y[1];vl(S,y,S.template,y[8])}else y[5]>0&&Vg(y)}const u=o[1].components;if(null!==u)for(let h=0;h<u.length;h++){const p=is(u[h],o);ea(p)&&p[5]>0&&Vg(p)}}function lf(o,l){const u=is(l,o),h=u[1];(function eb(o,l){for(let u=l.length;u<o.blueprint.length;u++)l.push(o.blueprint[u])})(h,u),Ip(h,u,u[8])}function Qd(o,l){return o[13]?o[14][4]=l:o[13]=l,o[14]=l,l}function tv(o){for(;o;){o[2]|=64;const l=on(o);if(tl(o)&&!l)return o;o=l}return null}function cf(o,l,u){const h=l[10];h.begin&&h.begin();try{vl(o,l,o.template,u)}catch(p){throw ib(l,p),p}finally{h.end&&h.end()}}function tb(o){!function Op(o){for(let l=0;l<o.components.length;l++){const u=o.components[l],h=hu(u),p=h[1];Kw(p,h,p.template,u)}}(o[8])}function nv(o,l,u){ql(0),l(o,u)}const jo=(()=>Promise.resolve(null))();function nb(o){return o[7]||(o[7]=[])}function Sr(o){return o.cleanup||(o.cleanup=[])}function ib(o,l){const u=o[9],h=u?u.get(Xh,null):null;h&&h.handleError(l)}function eh(o,l,u,h,p){for(let y=0;y<u.length;){const S=u[y++],A=u[y++],R=l[S],F=o.data[S];null!==F.setInput?F.setInput(R,p,h,A):R[A]=p}}function id(o,l,u){const h=ka(l,o);!function pu(o,l,u){Fi(o)?o.setValue(l,u):l.textContent=u}(o[11],h,u)}function th(o,l,u){let h=u?o.styles:null,p=u?o.classes:null,y=0;if(null!==l)for(let S=0;S<l.length;S++){const A=l[S];"number"==typeof A?y=A:1==y?p=Be(p,A):2==y&&(h=Be(h,A+": "+l[++S]+";"))}u?o.styles=h:o.stylesWithoutHost=h,u?o.classes=p:o.classesWithoutHost=p}const sv=new hr("INJECTOR",-1);class Co{get(l,u=gl){if(u===gl){const h=new Error(`NullInjectorError: No provider for ${Ne(l)}!`);throw h.name="NullInjectorError",h}return u}}const rb=new hr("Set Injector scope."),Ug={},bI={};let ov;function qS(){return void 0===ov&&(ov=new Co),ov}function KS(o,l=null,u=null,h){const p=ZS(o,l,u,h);return p._resolveInjectorDefTypes(),p}function ZS(o,l=null,u=null,h){return new xI(o,u,l||qS(),h)}class xI{constructor(l,u,h,p=null){this.parent=h,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const y=[];u&&ia(u,A=>this.processProvider(A,l,u)),ia([l],A=>this.processInjectorType(A,[],y)),this.records.set(sv,uf(void 0,this));const S=this.records.get(rb);this.scope=null!=S?S.value:null,this.source=p||("object"==typeof l?null:Ne(l))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(l=>l.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(l,u=gl,h=Pn.Default){this.assertNotDestroyed();const p=Ie(this),y=ar(void 0);try{if(!(h&Pn.SkipSelf)){let A=this.records.get(l);if(void 0===A){const R=function Vp(o){return"function"==typeof o||"object"==typeof o&&o instanceof hr}(l)&&An(l);A=R&&this.injectableDefInScope(R)?uf(vu(l),Ug):null,this.records.set(l,A)}if(null!=A)return this.hydrate(l,A)}return(h&Pn.Self?qS():this.parent).get(l,u=h&Pn.Optional&&u===gl?null:u)}catch(S){if("NullInjectorError"===S.name){if((S[Ga]=S[Ga]||[]).unshift(Ne(l)),p)throw S;return function xo(o,l,u,h){const p=o[Ga];throw l[G]&&p.unshift(l[G]),o.message=function sc(o,l,u,h=null){o=o&&"\n"===o.charAt(0)&&"\u0275"==o.charAt(1)?o.substr(2):o;let p=Ne(l);if(Array.isArray(l))p=l.map(Ne).join(" -> ");else if("object"==typeof l){let y=[];for(let S in l)if(l.hasOwnProperty(S)){let A=l[S];y.push(S+":"+("string"==typeof A?JSON.stringify(A):Ne(A)))}p=`{${y.join(", ")}}`}return`${u}${h?"("+h+")":""}[${p}]: ${o.replace(P,"\n  ")}`}("\n"+o.message,p,u,h),o.ngTokenPath=p,o[Ga]=null,o}(S,l,"R3InjectorError",this.source)}throw S}finally{ar(y),Ie(p)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(l=>this.get(l))}toString(){const l=[];return this.records.forEach((h,p)=>l.push(Ne(p))),`R3Injector[${l.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new pt(205,!1)}processInjectorType(l,u,h){if(!(l=Ce(l)))return!1;let p=Ls(l);const y=null==p&&l.ngModule||void 0,S=void 0===y?l:y,A=-1!==h.indexOf(S);if(void 0!==y&&(p=Ls(y)),null==p)return!1;if(null!=p.imports&&!A){let B;h.push(S);try{ia(p.imports,X=>{this.processInjectorType(X,u,h)&&(void 0===B&&(B=[]),B.push(X))})}finally{}if(void 0!==B)for(let X=0;X<B.length;X++){const{ngModule:de,providers:xe}=B[X];ia(xe,Je=>this.processProvider(Je,de,xe||oe))}}this.injectorDefTypes.add(S);const R=ns(S)||(()=>new S);this.records.set(S,uf(R,Ug));const F=p.providers;if(null!=F&&!A){const B=l;ia(F,X=>this.processProvider(X,B,F))}return void 0!==y&&void 0!==l.providers}processProvider(l,u,h){let p=Fp(l=Ce(l))?l:Ce(l&&l.provide);const y=function EI(o,l,u){return wu(o)?uf(void 0,o.useValue):uf(sb(o),Ug)}(l);if(Fp(l)||!0!==l.multi)this.records.get(p);else{let S=this.records.get(p);S||(S=uf(void 0,Ug,!0),S.factory=()=>Ti(S.multi),this.records.set(p,S)),p=l,S.multi.push(l)}this.records.set(p,y)}hydrate(l,u){return u.value===Ug&&(u.value=bI,u.value=u.factory()),"object"==typeof u.value&&u.value&&function lb(o){return null!==o&&"object"==typeof o&&"function"==typeof o.ngOnDestroy}(u.value)&&this.onDestroy.add(u.value),u.value}injectableDefInScope(l){if(!l.providedIn)return!1;const u=Ce(l.providedIn);return"string"==typeof u?"any"===u||u===this.scope:this.injectorDefTypes.has(u)}}function vu(o){const l=An(o),u=null!==l?l.factory:ns(o);if(null!==u)return u;if(o instanceof hr)throw new pt(204,!1);if(o instanceof Function)return function Lp(o){const l=o.length;if(l>0)throw function Pc(o,l){const u=[];for(let h=0;h<o;h++)u.push(l);return u}(l,"?"),new pt(204,!1);const u=function Ys(o){const l=o&&(o[ls]||o[Br]);if(l){const u=function as(o){if(o.hasOwnProperty("name"))return o.name;const l=(""+o).match(/^function\s*([^\s(]+)/);return null===l?"":l[1]}(o);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),l}return null}(o);return null!==u?()=>u.factory(o):()=>new o}(o);throw new pt(204,!1)}function sb(o,l,u){let h;if(Fp(o)){const p=Ce(o);return ns(p)||vu(p)}if(wu(o))h=()=>Ce(o.useValue);else if(function kp(o){return!(!o||!o.useFactory)}(o))h=()=>o.useFactory(...Ti(o.deps||[]));else if(function YS(o){return!(!o||!o.useExisting)}(o))h=()=>Pt(Ce(o.useExisting));else{const p=Ce(o&&(o.useClass||o.provide));if(!function ab(o){return!!o.deps}(o))return ns(p)||vu(p);h=()=>new p(...Ti(o.deps))}return h}function uf(o,l,u=!1){return{factory:o,value:l,multi:u?[]:void 0}}function wu(o){return null!==o&&"object"==typeof o&&te in o}function Fp(o){return"function"==typeof o}let _s=(()=>{class o{static create(u,h){var p;if(Array.isArray(u))return KS({name:""},h,u,"");{const y=null!==(p=u.name)&&void 0!==p?p:"";return KS({name:y},u.parent,u.providers,y)}}}return o.THROW_IF_NOT_FOUND=gl,o.NULL=new Co,o.\u0275prov=_i({token:o,providedIn:"any",factory:()=>Pt(sv)}),o.__NG_ELEMENT_ID__=-1,o})();function dv(o,l){$u(hu(o)[1],ir())}function pb(o){let l=function fb(o){return Object.getPrototypeOf(o.prototype).constructor}(o.type),u=!0;const h=[o];for(;l;){let p;if(Fo(o))p=l.\u0275cmp||l.\u0275dir;else{if(l.\u0275cmp)throw new pt(903,"");p=l.\u0275dir}if(p){if(u){h.push(p);const S=o;S.inputs=mb(o.inputs),S.declaredInputs=mb(o.declaredInputs),S.outputs=mb(o.outputs);const A=p.hostBindings;A&&sd(o,A);const R=p.viewQuery,F=p.contentQueries;if(R&&iT(o,R),F&&Bp(o,F),Fe(o.inputs,p.inputs),Fe(o.declaredInputs,p.declaredInputs),Fe(o.outputs,p.outputs),Fo(p)&&p.data.animation){const B=o.data;B.animation=(B.animation||[]).concat(p.data.animation)}}const y=p.features;if(y)for(let S=0;S<y.length;S++){const A=y[S];A&&A.ngInherit&&A(o),A===pb&&(u=!1)}}l=Object.getPrototypeOf(l)}!function Gg(o){let l=0,u=null;for(let h=o.length-1;h>=0;h--){const p=o[h];p.hostVars=l+=p.hostVars,p.hostAttrs=mn(p.hostAttrs,u=mn(u,p.hostAttrs))}}(h)}function mb(o){return o===Hi?{}:o===oe?[]:o}function iT(o,l){const u=o.viewQuery;o.viewQuery=u?(h,p)=>{l(h,p),u(h,p)}:l}function Bp(o,l){const u=o.contentQueries;o.contentQueries=u?(h,p,y)=>{l(h,p,y),u(h,p,y)}:l}function sd(o,l){const u=o.hostBindings;o.hostBindings=u?(h,p)=>{l(h,p),u(h,p)}:l}let od=null;function ih(){if(!od){const o=kn.Symbol;if(o&&o.iterator)od=o.iterator;else{const l=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<l.length;++u){const h=l[u];"entries"!==h&&"size"!==h&&Map.prototype[h]===Map.prototype.entries&&(od=h)}}}return od}function Zr(o){return!!hv(o)&&(Array.isArray(o)||!(o instanceof Map)&&ih()in o)}function hv(o){return null!==o&&("function"==typeof o||"object"==typeof o)}function pr(o,l,u){return!Object.is(o[l],u)&&(o[l]=u,!0)}function hc(o,l,u,h){const p=ut();return pr(p,Va(),l)&&(ai(),Gc(Qi(),p,o,l,u,h)),hc}function jp(o,l,u,h,p,y,S,A){const R=ut(),F=ai(),B=o+20,X=F.firstCreatePass?function RI(o,l,u,h,p,y,S,A,R){const F=l.consts,B=Mo(l,o,4,S||null,_o(F,A));Xw(l,u,B,_o(F,R)),$u(l,B);const X=B.tViews=zc(2,B,h,p,y,l.directiveRegistry,l.pipeRegistry,null,l.schemas,F);return null!==l.queries&&(l.queries.template(l,B),X.queries=l.queries.embeddedTView(B)),B}(B,F,R,l,u,h,p,y,S):F.data[B];vo(X,!1);const de=R[11].createComment("");z_(F,R,de,X),Rs(de,R),Qd(R,R[B]=Pp(de,R,de,X)),mo(X)&&wl(F,R,X),null!=S&&Zw(R,X,A)}function qg(o,l=Pn.Default){const u=ut();return null===u?Pt(o,l):Yi(ir(),u,Ce(o),l)}function xT(){throw new Error("invalid")}function Ab(o,l,u){const h=ut();return pr(h,Va(),l)&&function Ka(o,l,u,h,p,y,S,A){const R=fs(l,u);let B,F=l.inputs;!A&&null!=F&&(B=F[h])?(eh(o,u,B,h,p),Qc(l)&&function gs(o,l){const u=is(l,o);16&u[2]||(u[2]|=64)}(u,l.index)):3&l.type&&(h=function of(o){return"class"===o?"className":"for"===o?"htmlFor":"formaction"===o?"formAction":"innerHtml"===o?"innerHTML":"readonly"===o?"readOnly":"tabindex"===o?"tabIndex":o}(h),p=null!=S?S(p,l.value||"",h):p,Fi(y)?y.setProperty(R,h,p):En(h)||(R.setProperty?R.setProperty(h,p):R[h]=p))}(ai(),Qi(),h,o,l,h[11],u,!1),Ab}function Ib(o,l,u,h,p){const S=p?"class":"style";eh(o,u,l.inputs[S],S,h)}function _v(o,l,u,h){const p=ut(),y=ai(),S=20+o,A=p[11],R=p[S]=Tp(A,l,function Xl(){return Cn.lFrame.currentNamespace}()),F=y.firstCreatePass?function HI(o,l,u,h,p,y,S){const A=l.consts,F=Mo(l,o,2,p,_o(A,y));return Xw(l,u,F,_o(A,S)),null!==F.attrs&&th(F,F.attrs,!1),null!==F.mergedAttrs&&th(F,F.mergedAttrs,!0),null!==l.queries&&l.queries.elementStart(l,F),F}(S,y,p,0,l,u,h):y.data[S];vo(F,!0);const B=F.mergedAttrs;null!==B&&qe(A,R,B);const X=F.classes;null!==X&&bg(A,R,X);const de=F.styles;return null!==de&&Hw(A,R,de),64!=(64&F.flags)&&z_(y,p,R,F),0===function bc(){return Cn.lFrame.elementDepthCount}()&&Rs(R,p),function zl(){Cn.lFrame.elementDepthCount++}(),mo(F)&&(wl(y,p,F),function Og(o,l,u){if(Fl(l)){const p=l.directiveEnd;for(let y=l.directiveStart;y<p;y++){const S=o.data[y];S.contentQueries&&S.contentQueries(1,u[y],y)}}}(y,F,p)),null!==h&&Zw(p,F),_v}function vv(){let o=ir();Ec()?function zu(){Cn.lFrame.isParent=!1}():(o=o.parent,vo(o,!1));const l=o;!function ru(){Cn.lFrame.elementDepthCount--}();const u=ai();return u.firstCreatePass&&($u(u,o),Fl(o)&&u.queries.elementEnd(o)),null!=l.classesWithoutHost&&function De(o){return 0!=(16&o.flags)}(l)&&Ib(u,l,ut(),l.classesWithoutHost,!0),null!=l.stylesWithoutHost&&function yt(o){return 0!=(32&o.flags)}(l)&&Ib(u,l,ut(),l.stylesWithoutHost,!1),vv}function Db(o,l,u,h){return _v(o,l,u,h),vv(),Db}function ST(){return ut()}function Kg(o){return!!o&&"function"==typeof o.then}function co(o){return!!o&&"function"==typeof o.subscribe}const bv=co;function Zg(o,l,u,h){const p=ut(),y=ai(),S=ir();return function Nb(o,l,u,h,p,y,S,A){const R=mo(h),B=o.firstCreatePass&&Sr(o),X=l[8],de=nb(l);let xe=!0;if(3&h.type||A){const Zt=fs(h,l),yn=A?A(Zt):Zt,mt=de.length,Nn=A?wi=>A(Ri(wi[h.index])):h.index;if(Fi(u)){let wi=null;if(!A&&R&&(wi=function oh(o,l,u,h){const p=o.cleanup;if(null!=p)for(let y=0;y<p.length-1;y+=2){const S=p[y];if(S===u&&p[y+1]===h){const A=l[7],R=p[y+2];return A.length>R?A[R]:null}"string"==typeof S&&(y+=2)}return null}(o,l,p,h.index)),null!==wi)(wi.__ngLastListenerFn__||wi).__ngNextListenerFn__=y,wi.__ngLastListenerFn__=y,xe=!1;else{y=Ev(h,l,X,y,!1);const er=u.listen(yn,p,y);de.push(y,er),B&&B.push(p,Nn,mt,mt+1)}}else y=Ev(h,l,X,y,!0),yn.addEventListener(p,y,S),de.push(y),B&&B.push(p,Nn,mt,S)}else y=Ev(h,l,X,y,!1);const Je=h.outputs;let Lt;if(xe&&null!==Je&&(Lt=Je[p])){const Zt=Lt.length;if(Zt)for(let yn=0;yn<Zt;yn+=2){const Ca=l[Lt[yn]][Lt[yn+1]].subscribe(y),yh=de.length;de.push(y,Ca),B&&B.push(p,h.index,yh,-(yh+1))}}}(y,p,p[11],S,o,l,!!u,h),Zg}function TT(o,l,u,h){try{return!1!==u(h)}catch(p){return ib(o,p),!1}}function Ev(o,l,u,h,p){return function y(S){if(S===Function)return h;const A=2&o.flags?is(o.index,l):l;0==(32&l[2])&&tv(A);let R=TT(l,0,h,S),F=y.__ngNextListenerFn__;for(;F;)R=TT(l,0,F,S)&&R,F=F.__ngNextListenerFn__;return p&&!1===R&&(S.preventDefault(),S.returnValue=!1),R}}function Yg(o=1){return function As(o){return(Cn.lFrame.contextLView=function Wu(o,l){for(;o>0;)l=l[15],o--;return l}(o,Cn.lFrame.contextLView))[8]}(o)}function Vb(o,l,u,h,p){const y=o[u+1],S=null===l;let A=h?uc(y):Hc(y),R=!1;for(;0!==A&&(!1===R||S);){const B=o[A+1];GI(o[A],l)&&(R=!0,o[A+1]=h?Z_(B):Ww(B)),A=h?uc(B):Hc(B)}R&&(o[u+1]=h?Ww(y):Z_(y))}function GI(o,l){return null===o||null==l||(Array.isArray(o)?o[1]:o)===l||!(!Array.isArray(o)||"string"!=typeof l)&&Yu(o,l)>=0}function Dv(o,l){return function fc(o,l,u,h){const p=ut(),y=ai(),S=function Bs(o){const l=Cn.lFrame,u=l.bindingIndex;return l.bindingIndex=l.bindingIndex+o,u}(2);y.firstUpdatePass&&function Hb(o,l,u,h){const p=o.data;if(null===p[u+1]){const y=p[Wr()],S=function vf(o,l){return l>=o.expandoStartIndex}(o,u);(function zb(o,l){return 0!=(o.flags&(l?16:32))})(y,h)&&null===l&&!S&&(l=!1),l=function wf(o,l,u,h){const p=function Wl(o){const l=Cn.lFrame.currentDirectiveIndex;return-1===l?null:o[l]}(o);let y=h?l.residualClasses:l.residualStyles;if(null===p)0===(h?l.classBindings:l.styleBindings)&&(u=Zp(u=Mu(null,o,l,u,h),l.attrs,h),y=null);else{const S=l.directiveStylingLast;if(-1===S||o[S]!==p)if(u=Mu(p,o,l,u,h),null===y){let R=function WI(o,l,u){const h=u?l.classBindings:l.styleBindings;if(0!==Hc(h))return o[uc(h)]}(o,l,h);void 0!==R&&Array.isArray(R)&&(R=Mu(null,o,l,R[1],h),R=Zp(R,l.attrs,h),function Kp(o,l,u,h){o[uc(u?l.classBindings:l.styleBindings)]=h}(o,l,h,R))}else y=function PT(o,l,u){let h;const p=l.directiveEnd;for(let y=1+l.directiveStylingLast;y<p;y++)h=Zp(h,o[y].hostAttrs,u);return Zp(h,l.attrs,u)}(o,l,h)}return void 0!==y&&(h?l.residualClasses=y:l.residualStyles=y),u}(p,y,l,h),function yf(o,l,u,h,p,y){let S=y?l.classBindings:l.styleBindings,A=uc(S),R=Hc(S);o[h]=u;let B,F=!1;if(Array.isArray(u)){const X=u;B=X[1],(null===B||Yu(X,B)>0)&&(F=!0)}else B=u;if(p)if(0!==R){const de=uc(o[A+1]);o[h+1]=Tg(de,A),0!==de&&(o[de+1]=$w(o[de+1],h)),o[A+1]=function aI(o,l){return 131071&o|l<<17}(o[A+1],h)}else o[h+1]=Tg(A,0),0!==A&&(o[A+1]=$w(o[A+1],h)),A=h;else o[h+1]=Tg(R,0),0===A?A=h:o[R+1]=$w(o[R+1],h),R=h;F&&(o[h+1]=Ww(o[h+1])),Vb(o,B,h,!0),Vb(o,B,h,!1),function zI(o,l,u,h,p){const y=p?o.residualClasses:o.residualStyles;null!=y&&"string"==typeof l&&Yu(y,l)>=0&&(u[h+1]=Z_(u[h+1]))}(l,B,o,h,y),S=Tg(A,R),y?l.classBindings=S:l.styleBindings=S}(p,y,l,u,S,h)}}(y,o,S,h),l!==si&&pr(p,S,l)&&function OT(o,l,u,h,p,y,S,A){if(!(3&l.type))return;const R=o.data,F=R[A+1];ny(function US(o){return 1==(1&o)}(F)?ty(R,l,u,p,Hc(F),S):void 0)||(ny(y)||function nf(o){return 2==(2&o)}(F)&&(y=ty(R,null,u,p,A,S)),function wg(o,l,u,h,p){const y=Fi(o);if(l)p?y?o.addClass(u,h):u.classList.add(h):y?o.removeClass(u,h):u.classList.remove(h);else{let S=-1===h.indexOf("-")?void 0:k.DashCase;if(null==p)y?o.removeStyle(u,h,S):u.style.removeProperty(h);else{const A="string"==typeof p&&p.endsWith("!important");A&&(p=p.slice(0,-10),S|=k.Important),y?o.setStyle(u,h,p,S):u.style.setProperty(h,p,A?"important":"")}}}(h,S,ka(Wr(),u),p,y))}(y,y.data[Wr()],p,p[11],o,p[S+1]=function KI(o,l){return null==o||("string"==typeof l?o+=l:"object"==typeof o&&(o=Ne(ac(o)))),o}(l,u),h,S)}(o,l,null,!0),Dv}function Mu(o,l,u,h,p){let y=null;const S=u.directiveEnd;let A=u.directiveStylingLast;for(-1===A?A=u.directiveStart:A++;A<S&&(y=l[A],h=Zp(h,y.hostAttrs,p),y!==o);)A++;return null!==o&&(u.directiveStylingLast=A),h}function Zp(o,l,u){const h=u?1:2;let p=-1;if(null!==l)for(let y=0;y<l.length;y++){const S=l[y];"number"==typeof S?p=S:p===h&&(Array.isArray(o)||(o=void 0===o?[]:["",o]),ra(o,S,!!u||l[++y]))}return void 0===o?null:o}function ty(o,l,u,h,p,y){const S=null===l;let A;for(;p>0;){const R=o[p],F=Array.isArray(R),B=F?R[1]:R,X=null===B;let de=u[p+1];de===si&&(de=X?oe:void 0);let xe=X?Fd(de,h):B===h?de:void 0;if(F&&!ny(xe)&&(xe=Fd(R,h)),ny(xe)&&(A=xe,S))return A;const Je=o[p+1];p=S?uc(Je):Hc(Je)}if(null!==l){let R=y?l.residualClasses:l.residualStyles;null!=R&&(A=Fd(R,h))}return A}function ny(o){return void 0!==o}function LT(o,l=""){const u=ut(),h=ai(),p=o+20,y=h.firstCreatePass?Mo(h,p,1,l,null):h.data[p],S=u[p]=function Qh(o,l){return Fi(o)?o.createText(l):o.createTextNode(l)}(u[11],l);z_(h,u,S,y),vo(y,!1)}function Pv(o){return ld("",o,""),Pv}function ld(o,l,u){const h=ut(),p=function bu(o,l,u,h){return pr(o,Va(),u)?l+ze(u)+h:si}(h,o,l,u);return p!==si&&id(h,Wr(),p),ld}const Cu=void 0;var $T=["en",[["a","p"],["AM","PM"],Cu],[["AM","PM"],Cu,Cu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Cu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Cu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Cu,"{1} 'at' {0}",Cu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function WT(o){const u=Math.floor(Math.abs(o)),h=o.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===h?1:5}];let Ef={};function ry(o){const l=function Uv(o){return o.toLowerCase().replace(/_/g,"-")}(o);let u=ex(l);if(u)return u;const h=l.split("-")[0];if(u=ex(h),u)return u;if("en"===h)return $T;throw new Error(`Missing locale data for the locale "${o}".`)}function Vv(o){return ry(o)[Un.PluralCase]}function ex(o){return o in Ef||(Ef[o]=kn.ng&&kn.ng.common&&kn.ng.common.locales&&kn.ng.common.locales[o]),Ef[o]}var Un=(()=>((Un=Un||{})[Un.LocaleId=0]="LocaleId",Un[Un.DayPeriodsFormat=1]="DayPeriodsFormat",Un[Un.DayPeriodsStandalone=2]="DayPeriodsStandalone",Un[Un.DaysFormat=3]="DaysFormat",Un[Un.DaysStandalone=4]="DaysStandalone",Un[Un.MonthsFormat=5]="MonthsFormat",Un[Un.MonthsStandalone=6]="MonthsStandalone",Un[Un.Eras=7]="Eras",Un[Un.FirstDayOfWeek=8]="FirstDayOfWeek",Un[Un.WeekendRange=9]="WeekendRange",Un[Un.DateFormat=10]="DateFormat",Un[Un.TimeFormat=11]="TimeFormat",Un[Un.DateTimeFormat=12]="DateTimeFormat",Un[Un.NumberSymbols=13]="NumberSymbols",Un[Un.NumberFormats=14]="NumberFormats",Un[Un.CurrencyCode=15]="CurrencyCode",Un[Un.CurrencySymbol=16]="CurrencySymbol",Un[Un.CurrencyName=17]="CurrencyName",Un[Un.Currencies=18]="Currencies",Un[Un.Directionality=19]="Directionality",Un[Un.PluralCase=20]="PluralCase",Un[Un.ExtraData=21]="ExtraData",Un))();const Xp="en-US";let qT=Xp;function Sx(o,l,u,h,p){if(o=Ce(o),Array.isArray(o))for(let y=0;y<o.length;y++)Sx(o[y],l,u,h,p);else{const y=ai(),S=ut();let A=Fp(o)?o:Ce(o.provide),R=sb(o);const F=ir(),B=1048575&F.providerIndexes,X=F.directiveStart,de=F.providerIndexes>>20;if(Fp(o)||!o.multi){const xe=new T(R,p,qg),Je=gy(A,l,p?B:B+de,X);-1===Je?(xr(dr(F,S),y,A),my(y,o,l.length),l.push(A),F.directiveStart++,F.directiveEnd++,p&&(F.providerIndexes+=1048576),u.push(xe),S.push(xe)):(u[Je]=xe,S[Je]=xe)}else{const xe=gy(A,l,B+de,X),Je=gy(A,l,B,B+de),Lt=xe>=0&&u[xe],Zt=Je>=0&&u[Je];if(p&&!Zt||!p&&!Lt){xr(dr(F,S),y,A);const yn=function bD(o,l,u,h,p){const y=new T(o,u,qg);return y.multi=[],y.index=l,y.componentProviders=0,cM(y,p,h&&!u),y}(p?Tx:uM,u.length,p,h,R);!p&&Zt&&(u[Je].providerFactory=yn),my(y,o,l.length,0),l.push(A),F.directiveStart++,F.directiveEnd++,p&&(F.providerIndexes+=1048576),u.push(yn),S.push(yn)}else my(y,o,xe>-1?xe:Je,cM(u[p?Je:xe],R,!p&&h));!p&&h&&Zt&&u[Je].componentProviders++}}}function my(o,l,u,h){const p=Fp(l),y=function ob(o){return!!o.useClass}(l);if(p||y){const R=(y?Ce(l.useClass):l).prototype.ngOnDestroy;if(R){const F=o.destroyHooks||(o.destroyHooks=[]);if(!p&&l.multi){const B=F.indexOf(u);-1===B?F.push(u,[h,R]):F[B+1].push(h,R)}else F.push(u,R)}}}function cM(o,l,u){return u&&o.componentProviders++,o.multi.push(l)-1}function gy(o,l,u,h){for(let p=u;p<h;p++)if(l[p]===o)return p;return-1}function uM(o,l,u,h){return Zv(this.multi,[])}function Tx(o,l,u,h){const p=this.multi;let y;if(this.providerFactory){const S=this.providerFactory.componentProviders,A=na(u,u[1],this.providerFactory.index,h);y=A.slice(0,S),Zv(p,y);for(let R=S;R<A.length;R++)y.push(A[R])}else y=[],Zv(p,y);return y}function Zv(o,l){for(let u=0;u<o.length;u++)l.push((0,o[u])());return l}function Yv(o,l=[]){return u=>{u.providersResolver=(h,p)=>function Ex(o,l,u){const h=ai();if(h.firstCreatePass){const p=Fo(o);Sx(u,h.data,h.blueprint,p,!0),Sx(l,h.data,h.blueprint,p,!1)}}(h,p?p(o):o,l)}}class Xv{}class Mx{resolveComponentFactory(l){throw function ED(o){const l=Error(`No component factory found for ${Ne(o)}. Did you add it to @NgModule.entryComponents?`);return l.ngComponent=o,l}(l)}}let sm=(()=>{class o{}return o.NULL=new Mx,o})();function Cx(){return jc(ir(),ut())}function jc(o,l){return new om(fs(o,l))}let om=(()=>{class o{constructor(u){this.nativeElement=u}}return o.__NG_ELEMENT_ID__=Cx,o})();function Ax(o){return o instanceof om?o.nativeElement:o}class Qv{}let ud=(()=>{class o{}return o.__NG_ELEMENT_ID__=()=>function SD(){const o=ut(),u=is(ir().index,o);return function Ix(o){return o[11]}(no(u)?u:o)}(),o})(),Dx=(()=>{class o{}return o.\u0275prov=_i({token:o,providedIn:"root",factory:()=>null}),o})();class dM{constructor(l){this.full=l,this.major=l.split(".")[0],this.minor=l.split(".")[1],this.patch=l.split(".").slice(2).join(".")}}const hM=new dM("13.2.7"),yy={};function e0(o,l,u,h,p=!1){for(;null!==u;){const y=l[u.index];if(null!==y&&h.push(Ri(y)),ko(y))for(let A=10;A<y.length;A++){const R=y[A],F=R[1].firstChild;null!==F&&e0(R[1],R,F,h)}const S=u.type;if(8&S)e0(o,l,u.child,h);else if(32&S){const A=ye(u,l);let R;for(;R=A();)h.push(R)}else if(16&S){const A=Uw(l,u);if(Array.isArray(A))h.push(...A);else{const R=on(l[16]);e0(R[1],R,A,h,!0)}}u=p?u.projectionNext:u.next}return h}class Cf{constructor(l,u){this._lView=l,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const l=this._lView,u=l[1];return e0(u,l,u.firstChild,[])}get context(){return this._lView[8]}set context(l){this._lView[8]=l}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const l=this._lView[3];if(ko(l)){const u=l[8],h=u?u.indexOf(this):-1;h>-1&&(U_(l,h),fl(u,h))}this._attachedToViewContainer=!1}B_(this._lView[1],this._lView)}onDestroy(l){zS(this._lView[1],this._lView,null,l)}markForCheck(){tv(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){cf(this._lView[1],this._lView,this.context)}checkNoChanges(){!function yI(o,l,u){ou(!0);try{cf(o,l,u)}finally{ou(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new pt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function pg(o,l){_l(o,l,l[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(l){if(this._attachedToViewContainer)throw new pt(902,"");this._appRef=l}}class TD extends Cf{constructor(l){super(l),this._view=l}detectChanges(){tb(this._view)}checkNoChanges(){!function _I(o){ou(!0);try{tb(o)}finally{ou(!1)}}(this._view)}get context(){return null}}class t0 extends sm{constructor(l){super(),this.ngModule=l}resolveComponentFactory(l){const u=Lr(l);return new _y(u,this.ngModule)}}function fM(o){const l=[];for(let u in o)o.hasOwnProperty(u)&&l.push({propName:o[u],templateName:u});return l}class _y extends Xv{constructor(l,u){super(),this.componentDef=l,this.ngModule=u,this.componentType=l.type,this.selector=function FS(o){return o.map(tf).join(",")}(l.selectors),this.ngContentSelectors=l.ngContentSelectors?l.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return fM(this.componentDef.inputs)}get outputs(){return fM(this.componentDef.outputs)}create(l,u,h,p){const y=(p=p||this.ngModule)?function pM(o,l){return{get:(u,h,p)=>{const y=o.get(u,yy,p);return y!==yy||h===yy?y:l.get(u,h,p)}}}(l,p.injector):l,S=y.get(Qv,_c),A=y.get(Dx,null),R=S.createRenderer(null,this.componentDef),F=this.componentDef.selectors[0][0]||"div",B=h?function J_(o,l,u){if(Fi(o))return o.selectRootElement(l,u===gi.ShadowDom);let h="string"==typeof l?o.querySelector(l):l;return h.textContent="",h}(R,h,this.componentDef.encapsulation):Tp(S.createRenderer(null,this.componentDef),F,function Rx(o){const l=o.toLowerCase();return"svg"===l?"svg":"math"===l?"math":null}(F)),X=this.componentDef.onPush?576:528,de=function Kr(o,l){return{components:[],scheduler:o||Nw,clean:jo,playerHandler:l||null,flags:0}}(),xe=zc(0,null,null,1,0,null,null,null,null,null),Je=Ap(null,xe,de,X,null,null,S,R,A,y);let Lt,Zt;Zl(Je);try{const yn=function tT(o,l,u,h,p,y){const S=u[1];u[20]=o;const R=Mo(S,20,2,"#host",null),F=R.mergedAttrs=l.hostAttrs;null!==F&&(th(R,F,!0),null!==o&&(qe(p,o,F),null!==R.classes&&bg(p,o,R.classes),null!==R.styles&&Hw(p,o,R.styles)));const B=h.createRenderer(o,l),X=Ap(u,Dp(l),null,l.onPush?64:16,u[20],R,h,B,y||null,null);return S.firstCreatePass&&(xr(dr(R,u),S,l.type),Qw(S,R),yu(R,u.length,1)),Qd(u,X),u[20]=X}(B,this.componentDef,Je,S,R);if(B)if(h)qe(R,B,["ng-version",hM.full]);else{const{attrs:mt,classes:Nn}=function VS(o){const l=[],u=[];let h=1,p=2;for(;h<o.length;){let y=o[h];if("string"==typeof y)2===p?""!==y&&l.push(y,o[++h]):8===p&&u.push(y);else{if(!cc(p))break;p=y}h++}return{attrs:l,classes:u}}(this.componentDef.selectors[0]);mt&&qe(R,B,mt),Nn&&Nn.length>0&&bg(R,B,Nn.join(" "))}if(Zt=ur(xe,20),void 0!==u){const mt=Zt.projection=[];for(let Nn=0;Nn<this.ngContentSelectors.length;Nn++){const wi=u[Nn];mt.push(null!=wi?Array.from(wi):null)}}Lt=function nT(o,l,u,h,p){const y=u[1],S=function bl(o,l,u){const h=ir();o.firstCreatePass&&(u.providersResolver&&u.providersResolver(u),Rp(o,h,l,sf(o,l,1,null),u));const p=na(l,o,h.directiveStart,h);Rs(p,l);const y=fs(h,l);return y&&Rs(y,l),p}(y,u,l);if(h.components.push(S),o[8]=S,p&&p.forEach(R=>R(S,l)),l.contentQueries){const R=ir();l.contentQueries(1,S,R.directiveStart)}const A=ir();return!y.firstCreatePass||null===l.hostBindings&&null===l.hostAttrs||(Hs(A.index),Ws(u[1],A,0,A.directiveStart,A.directiveEnd,l),Xd(l,S)),S}(yn,this.componentDef,Je,de,[dv]),Ip(xe,Je,null)}finally{Yl()}return new MD(this.componentType,Lt,jc(Zt,Je),Je,Zt)}}class MD extends class xD{}{constructor(l,u,h,p,y){super(),this.location=h,this._rootLView=p,this._tNode=y,this.instance=u,this.hostView=this.changeDetectorRef=new TD(p),this.componentType=l}get injector(){return new ul(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(l){this.hostView.onDestroy(l)}}class am{}class n0{}const dh=new Map;class Nx extends am{constructor(l,u){super(),this._parent=u,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new t0(this);const h=zi(l);this._bootstrapComponents=xa(h.bootstrap),this._r3Injector=ZS(l,u,[{provide:am,useValue:this},{provide:sm,useValue:this.componentFactoryResolver}],Ne(l)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(l)}get(l,u=_s.THROW_IF_NOT_FOUND,h=Pn.Default){return l===_s||l===am||l===sv?this:this._r3Injector.get(l,u,h)}destroy(){const l=this._r3Injector;!l.destroyed&&l.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(l){this.destroyCbs.push(l)}}class lm extends n0{constructor(l){super(),this.moduleType=l,null!==zi(l)&&function _M(o){const l=new Set;!function u(h){const p=zi(h,!0),y=p.id;null!==y&&(function yM(o,l,u){if(l&&l!==u)throw new Error(`Duplicate module registered for ${o} - ${Ne(l)} vs ${Ne(l.name)}`)}(y,dh.get(y),h),dh.set(y,h));const S=xa(p.imports);for(const A of S)l.has(A)||(l.add(A),u(A))}(o)}(l)}create(l){return new Nx(this.moduleType,l)}}function Hx(o){return l=>{setTimeout(o,void 0,l)}}const Au=class kD extends w.x{constructor(l=!1){super(),this.__isAsync=l}emit(l){super.next(l)}subscribe(l,u,h){var p,y,S;let A=l,R=u||(()=>null),F=h;if(l&&"object"==typeof l){const X=l;A=null===(p=X.next)||void 0===p?void 0:p.bind(X),R=null===(y=X.error)||void 0===y?void 0:y.bind(X),F=null===(S=X.complete)||void 0===S?void 0:S.bind(X)}this.__isAsync&&(R=Hx(R),A&&(A=Hx(A)),F&&(F=Hx(F)));const B=super.subscribe({next:A,error:R,complete:F});return l instanceof be.w0&&l.add(B),B}};function FD(){return this._results[ih()]()}class a0{constructor(l=!1){this._emitDistinctChangesOnly=l,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=ih(),h=a0.prototype;h[u]||(h[u]=FD)}get changes(){return this._changes||(this._changes=new Au)}get(l){return this._results[l]}map(l){return this._results.map(l)}filter(l){return this._results.filter(l)}find(l){return this._results.find(l)}reduce(l,u){return this._results.reduce(l,u)}forEach(l){this._results.forEach(l)}some(l){return this._results.some(l)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(l,u){const h=this;h.dirty=!1;const p=Dr(l);(this._changesDetected=!function op(o,l,u){if(o.length!==l.length)return!1;for(let h=0;h<o.length;h++){let p=o[h],y=l[h];if(u&&(p=u(p),y=u(y)),y!==p)return!1}return!0}(h._results,p,u))&&(h._results=p,h.length=p.length,h.last=p[this.length-1],h.first=p[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Af=(()=>{class o{}return o.__NG_ELEMENT_ID__=MM,o})();const SM=Af,TM=class extends SM{constructor(l,u,h){super(),this._declarationLView=l,this._declarationTContainer=u,this.elementRef=h}createEmbeddedView(l){const u=this._declarationTContainer.tViews,h=Ap(this._declarationLView,u,l,16,null,u.declTNode,null,null,null,null);h[17]=this._declarationLView[this._declarationTContainer.index];const y=this._declarationLView[19];return null!==y&&(h[19]=y.createEmbeddedView(u)),Ip(u,h,l),new Cf(h)}};function MM(){return If(ir(),ut())}function If(o,l){return 4&o.type?new TM(l,o,jc(o,l)):null}let Mi=(()=>{class o{}return o.__NG_ELEMENT_ID__=CM,o})();function CM(){return $o(ir(),ut())}const AM=Mi,dm=class extends AM{constructor(l,u,h){super(),this._lContainer=l,this._hostTNode=u,this._hostLView=h}get element(){return jc(this._hostTNode,this._hostLView)}get injector(){return new ul(this._hostTNode,this._hostLView)}get parentInjector(){const l=Zi(this._hostTNode,this._hostLView);if(vn(l)){const u=St(l,this._hostLView),h=cn(l);return new ul(u[1].data[h+8],u)}return new ul(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(l){const u=IM(this._lContainer);return null!==u&&u[l]||null}get length(){return this._lContainer.length-10}createEmbeddedView(l,u,h){const p=l.createEmbeddedView(u||{});return this.insert(p,h),p}createComponent(l,u,h,p,y){const S=l&&!function Rc(o){return"function"==typeof o}(l);let A;if(S)A=u;else{const X=u||{};A=X.index,h=X.injector,p=X.projectableNodes,y=X.ngModuleRef}const R=S?l:new _y(Lr(l)),F=h||this.parentInjector;if(!y&&null==R.ngModule){const de=(S?F:this.parentInjector).get(am,null);de&&(y=de)}const B=R.create(F,p,void 0,y);return this.insert(B.hostView,A),B}insert(l,u){const h=l._lView,p=h[1];if(function wc(o){return ko(o[3])}(h)){const B=this.indexOf(l);if(-1!==B)this.detach(B);else{const X=h[3],de=new dm(X,X[6],X[3]);de.detach(de.indexOf(l))}}const y=this._adjustIndex(u),S=this._lContainer;!function ef(o,l,u,h){const p=10+h,y=u.length;h>0&&(u[p-1][4]=l),h<y-10?(l[4]=u[p],kr(u,10+h,l)):(u.push(l),l[4]=null),l[3]=u;const S=l[17];null!==S&&u!==S&&function mg(o,l){const u=o[9];l[16]!==l[3][3][16]&&(o[2]=!0),null===u?o[9]=[l]:u.push(l)}(S,l);const A=l[19];null!==A&&A.insertView(o),l[2]|=128}(p,h,S,y);const A=G_(y,S),R=h[11],F=$d(R,S[7]);return null!==F&&function fg(o,l,u,h,p,y){h[0]=p,h[6]=l,_l(o,h,u,1,p,y)}(p,S[6],R,h,F,A),l.attachToViewContainerRef(),kr(Tr(S),y,l),l}move(l,u){return this.insert(l,u)}indexOf(l){const u=IM(this._lContainer);return null!==u?u.indexOf(l):-1}remove(l){const u=this._adjustIndex(l,-1),h=U_(this._lContainer,u);h&&(fl(Tr(this._lContainer),u),B_(h[1],h))}detach(l){const u=this._adjustIndex(l,-1),h=U_(this._lContainer,u);return h&&null!=fl(Tr(this._lContainer),u)?new Cf(h):null}_adjustIndex(l,u=0){return null==l?this.length+u:l}};function IM(o){return o[8]}function Tr(o){return o[8]||(o[8]=[])}function $o(o,l){let u;const h=l[o.index];if(ko(h))u=h;else{let p;if(8&o.type)p=Ri(h);else{const y=l[11];p=y.createComment("");const S=fs(o,l);mu(y,$d(y,S),p,function sI(o,l){return Fi(o)?o.nextSibling(l):l.nextSibling}(y,S),!1)}l[o.index]=u=Pp(h,l,p,o),Qd(l,u)}return new dm(u,o,l)}class hm{constructor(l){this.queryList=l,this.matches=null}clone(){return new hm(this.queryList)}setDirty(){this.queryList.setDirty()}}class l0{constructor(l=[]){this.queries=l}createEmbeddedView(l){const u=l.queries;if(null!==u){const h=null!==l.contentQueries?l.contentQueries[0]:u.length,p=[];for(let y=0;y<h;y++){const S=u.getByIndex(y);p.push(this.queries[S.indexInDeclarationView].clone())}return new l0(p)}return null}insertView(l){this.dirtyQueriesWithMatches(l)}detachView(l){this.dirtyQueriesWithMatches(l)}dirtyQueriesWithMatches(l){for(let u=0;u<this.queries.length;u++)null!==GD(l,u).matches&&this.queries[u].setDirty()}}class zx{constructor(l,u,h=null){this.predicate=l,this.flags=u,this.read=h}}class Gx{constructor(l=[]){this.queries=l}elementStart(l,u){for(let h=0;h<this.queries.length;h++)this.queries[h].elementStart(l,u)}elementEnd(l){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(l)}embeddedTView(l){let u=null;for(let h=0;h<this.length;h++){const p=null!==u?u.length:0,y=this.getByIndex(h).embeddedTView(l,p);y&&(y.indexInDeclarationView=h,null!==u?u.push(y):u=[y])}return null!==u?new Gx(u):null}template(l,u){for(let h=0;h<this.queries.length;h++)this.queries[h].template(l,u)}getByIndex(l){return this.queries[l]}get length(){return this.queries.length}track(l){this.queries.push(l)}}class vy{constructor(l,u=-1){this.metadata=l,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(l,u){this.isApplyingToNode(u)&&this.matchTNode(l,u)}elementEnd(l){this._declarationNodeIndex===l.index&&(this._appliesToNextNode=!1)}template(l,u){this.elementStart(l,u)}embeddedTView(l,u){return this.isApplyingToNode(l)?(this.crossesNgTemplate=!0,this.addMatch(-l.index,u),new vy(this.metadata)):null}isApplyingToNode(l){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let h=l.parent;for(;null!==h&&8&h.type&&h.index!==u;)h=h.parent;return u===(null!==h?h.index:-1)}return this._appliesToNextNode}matchTNode(l,u){const h=this.metadata.predicate;if(Array.isArray(h))for(let p=0;p<h.length;p++){const y=h[p];this.matchTNodeWithReadOption(l,u,VD(u,y)),this.matchTNodeWithReadOption(l,u,ps(u,l,y,!1,!1))}else h===Af?4&u.type&&this.matchTNodeWithReadOption(l,u,-1):this.matchTNodeWithReadOption(l,u,ps(u,l,h,!1,!1))}matchTNodeWithReadOption(l,u,h){if(null!==h){const p=this.metadata.read;if(null!==p)if(p===om||p===Mi||p===Af&&4&u.type)this.addMatch(u.index,-2);else{const y=ps(u,l,p,!1,!1);null!==y&&this.addMatch(u.index,y)}else this.addMatch(u.index,h)}}addMatch(l,u){null===this.matches?this.matches=[l,u]:this.matches.push(l,u)}}function VD(o,l){const u=o.localNames;if(null!==u)for(let h=0;h<u.length;h+=2)if(u[h]===l)return u[h+1];return null}function Yr(o,l,u,h){return-1===u?function UD(o,l){return 11&o.type?jc(o,l):4&o.type?If(o,l):null}(l,o):-2===u?function wN(o,l,u){return u===om?jc(l,o):u===Af?If(l,o):u===Mi?$o(l,o):void 0}(o,l,h):na(o,o[1],u,l)}function BD(o,l,u,h){const p=l[19].queries[h];if(null===p.matches){const y=o.data,S=u.matches,A=[];for(let R=0;R<S.length;R+=2){const F=S[R];A.push(F<0?null:Yr(l,y[F],S[R+1],u.metadata.read))}p.matches=A}return p.matches}function ws(o,l,u,h){const p=o.queries.getByIndex(u),y=p.matches;if(null!==y){const S=BD(o,l,p,u);for(let A=0;A<y.length;A+=2){const R=y[A];if(R>0)h.push(S[A/2]);else{const F=y[A+1],B=l[-R];for(let X=10;X<B.length;X++){const de=B[X];de[17]===de[3]&&ws(de[1],de,F,h)}if(null!==B[9]){const X=B[9];for(let de=0;de<X.length;de++){const xe=X[de];ws(xe[1],xe,F,h)}}}}}return h}function jx(o){const l=ut(),u=ai(),h=$l();ql(h+1);const p=GD(u,h);if(o.dirty&&Fa(l)===(2==(2&p.metadata.flags))){if(null===p.matches)o.reset([]);else{const y=p.crossesNgTemplate?ws(u,l,h,[]):BD(u,l,p,h);o.reset(y,Ax),o.notifyOnChanges()}return!0}return!1}function RM(o,l,u){const h=ai();h.firstCreatePass&&(OM(h,new zx(o,l,u),-1),2==(2&l)&&(h.staticViewQueries=!0)),NM(h,ut(),l)}function PM(o,l,u,h){const p=ai();if(p.firstCreatePass){const y=ir();OM(p,new zx(l,u,h),y.index),function zD(o,l){const u=o.contentQueries||(o.contentQueries=[]);l!==(u.length?u[u.length-1]:-1)&&u.push(o.queries.length-1,l)}(p,o),2==(2&u)&&(p.staticContentQueries=!0)}NM(p,ut(),u)}function Wx(){return function HD(o,l){return o[19].queries[l].queryList}(ut(),$l())}function NM(o,l,u){const h=new a0(4==(4&u));zS(o,l,h,h.destroy),null===l[19]&&(l[19]=new l0),l[19].queries.push(new hm(h))}function OM(o,l,u){null===o.queries&&(o.queries=new Gx),o.queries.track(new vy(l,u))}function GD(o,l){return o.queries.getByIndex(l)}function g0(...o){}const jM=new hr("Application Initializer");let Qx=(()=>{class o{constructor(u){this.appInits=u,this.resolve=g0,this.reject=g0,this.initialized=!1,this.done=!1,this.donePromise=new Promise((h,p)=>{this.resolve=h,this.reject=p})}runInitializers(){if(this.initialized)return;const u=[],h=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let p=0;p<this.appInits.length;p++){const y=this.appInits[p]();if(Kg(y))u.push(y);else if(bv(y)){const S=new Promise((A,R)=>{y.subscribe({complete:A,error:R})});u.push(S)}}Promise.all(u).then(()=>{h()}).catch(p=>{this.reject(p)}),0===u.length&&h(),this.initialized=!0}}return o.\u0275fac=function(u){return new(u||o)(Pt(jM,8))},o.\u0275prov=_i({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const eE=new hr("AppId",{providedIn:"root",factory:function tE(){return`${y0()}${y0()}${y0()}`}});function y0(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const WM=new hr("Platform Initializer"),_0=new hr("Platform ID"),Ey=new hr("appBootstrapListener");let nE=(()=>{class o{log(u){console.log(u)}warn(u){console.warn(u)}}return o.\u0275fac=function(u){return new(u||o)},o.\u0275prov=_i({token:o,factory:o.\u0275fac}),o})();const iE=new hr("LocaleId",{providedIn:"root",factory:()=>ui(iE,Pn.Optional|Pn.SkipSelf)||function gh(){return"undefined"!=typeof $localize&&$localize.locale||Xp}()}),Pf=new hr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class QD{constructor(l,u){this.ngModuleFactory=l,this.componentFactories=u}}let e1=(()=>{class o{compileModuleSync(u){return new lm(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const h=this.compileModuleSync(u),y=xa(zi(u).declarations).reduce((S,A)=>{const R=Lr(A);return R&&S.push(new _y(R)),S},[]);return new QD(h,y)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return o.\u0275fac=function(u){return new(u||o)},o.\u0275prov=_i({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const n1=(()=>Promise.resolve(0))();function rE(o){"undefined"==typeof Zone?n1.then(()=>{o&&o.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",o)}class $c{constructor({enableLongStackTrace:l=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:h=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Au(!1),this.onMicrotaskEmpty=new Au(!1),this.onStable=new Au(!1),this.onError=new Au(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const p=this;p._nesting=0,p._outer=p._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(p._inner=p._inner.fork(new Zone.TaskTrackingZoneSpec)),l&&Zone.longStackTraceZoneSpec&&(p._inner=p._inner.fork(Zone.longStackTraceZoneSpec)),p.shouldCoalesceEventChangeDetection=!h&&u,p.shouldCoalesceRunChangeDetection=h,p.lastRequestAnimationFrameId=-1,p.nativeRequestAnimationFrame=function qM(){let o=kn.requestAnimationFrame,l=kn.cancelAnimationFrame;if("undefined"!=typeof Zone&&o&&l){const u=o[Zone.__symbol__("OriginalDelegate")];u&&(o=u);const h=l[Zone.__symbol__("OriginalDelegate")];h&&(l=h)}return{nativeRequestAnimationFrame:o,nativeCancelAnimationFrame:l}}().nativeRequestAnimationFrame,function r1(o){const l=()=>{!function i1(o){o.isCheckStableRunning||-1!==o.lastRequestAnimationFrameId||(o.lastRequestAnimationFrameId=o.nativeRequestAnimationFrame.call(kn,()=>{o.fakeTopEventTask||(o.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{o.lastRequestAnimationFrameId=-1,sE(o),o.isCheckStableRunning=!0,Sy(o),o.isCheckStableRunning=!1},void 0,()=>{},()=>{})),o.fakeTopEventTask.invoke()}),sE(o))}(o)};o._inner=o._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,h,p,y,S,A)=>{try{return KM(o),u.invokeTask(p,y,S,A)}finally{(o.shouldCoalesceEventChangeDetection&&"eventTask"===y.type||o.shouldCoalesceRunChangeDetection)&&l(),ZM(o)}},onInvoke:(u,h,p,y,S,A,R)=>{try{return KM(o),u.invoke(p,y,S,A,R)}finally{o.shouldCoalesceRunChangeDetection&&l(),ZM(o)}},onHasTask:(u,h,p,y)=>{u.hasTask(p,y),h===p&&("microTask"==y.change?(o._hasPendingMicrotasks=y.microTask,sE(o),Sy(o)):"macroTask"==y.change&&(o.hasPendingMacrotasks=y.macroTask))},onHandleError:(u,h,p,y)=>(u.handleError(p,y),o.runOutsideAngular(()=>o.onError.emit(y)),!1)})}(p)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!$c.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if($c.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(l,u,h){return this._inner.run(l,u,h)}runTask(l,u,h,p){const y=this._inner,S=y.scheduleEventTask("NgZoneEvent: "+p,l,gm,g0,g0);try{return y.runTask(S,u,h)}finally{y.cancelTask(S)}}runGuarded(l,u,h){return this._inner.runGuarded(l,u,h)}runOutsideAngular(l){return this._outer.run(l)}}const gm={};function Sy(o){if(0==o._nesting&&!o.hasPendingMicrotasks&&!o.isStable)try{o._nesting++,o.onMicrotaskEmpty.emit(null)}finally{if(o._nesting--,!o.hasPendingMicrotasks)try{o.runOutsideAngular(()=>o.onStable.emit(null))}finally{o.isStable=!0}}}function sE(o){o.hasPendingMicrotasks=!!(o._hasPendingMicrotasks||(o.shouldCoalesceEventChangeDetection||o.shouldCoalesceRunChangeDetection)&&-1!==o.lastRequestAnimationFrameId)}function KM(o){o._nesting++,o.isStable&&(o.isStable=!1,o.onUnstable.emit(null))}function ZM(o){o._nesting--,Sy(o)}class s1{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Au,this.onMicrotaskEmpty=new Au,this.onStable=new Au,this.onError=new Au}run(l,u,h){return l.apply(u,h)}runGuarded(l,u,h){return l.apply(u,h)}runOutsideAngular(l){return l()}runTask(l,u,h,p){return l.apply(u,h)}}let YM=(()=>{class o{constructor(u){this._ngZone=u,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{$c.assertNotInAngularZone(),rE(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())rE(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(h=>!h.updateCb||!h.updateCb(u)||(clearTimeout(h.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,h,p){let y=-1;h&&h>0&&(y=setTimeout(()=>{this._callbacks=this._callbacks.filter(S=>S.timeoutId!==y),u(this._didWork,this.getPendingTasks())},h)),this._callbacks.push({doneCb:u,timeoutId:y,updateCb:p})}whenStable(u,h,p){if(p&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,h,p),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(u,h,p){return[]}}return o.\u0275fac=function(u){return new(u||o)(Pt($c))},o.\u0275prov=_i({token:o,factory:o.\u0275fac}),o})(),o1=(()=>{class o{constructor(){this._applications=new Map,oE.addToWindow(this)}registerApplication(u,h){this._applications.set(u,h)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,h=!0){return oE.findTestabilityInTree(this,u,h)}}return o.\u0275fac=function(u){return new(u||o)},o.\u0275prov=_i({token:o,factory:o.\u0275fac}),o})();class PN{addToWindow(l){}findTestabilityInTree(l,u,h){return null}}function XM(o){oE=o}let qc,oE=new PN;const ym=new hr("AllowMultipleToken");class lE{constructor(l,u){this.name=l,this.token=u}}function QM(o,l,u=[]){const h=`Platform: ${l}`,p=new hr(h);return(y=[])=>{let S=tC();if(!S||S.injector.get(ym,!1))if(o)o(u.concat(y).concat({provide:p,useValue:!0}));else{const A=u.concat(y).concat({provide:p,useValue:!0},{provide:rb,useValue:"platform"});!function l1(o){if(qc&&!qc.destroyed&&!qc.injector.get(ym,!1))throw new pt(400,"");qc=o.get(uE);const l=o.get(WM,null);l&&l.forEach(u=>u())}(_s.create({providers:A,name:h}))}return function eC(o){const l=tC();if(!l)throw new pt(401,"");return l}()}}function tC(){return qc&&!qc.destroyed?qc:null}let uE=(()=>{class o{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,h){const A=function nC(o,l){let u;return u="noop"===o?new s1:("zone.js"===o?void 0:o)||new $c({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==l?void 0:l.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==l?void 0:l.ngZoneRunCoalescing)}),u}(h?h.ngZone:void 0,{ngZoneEventCoalescing:h&&h.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:h&&h.ngZoneRunCoalescing||!1}),R=[{provide:$c,useValue:A}];return A.run(()=>{const F=_s.create({providers:R,parent:this.injector,name:u.moduleType.name}),B=u.create(F),X=B.injector.get(Xh,null);if(!X)throw new pt(402,"");return A.runOutsideAngular(()=>{const de=A.onError.subscribe({next:xe=>{X.handleError(xe)}});B.onDestroy(()=>{v0(this._modules,B),de.unsubscribe()})}),function Nf(o,l,u){try{const h=u();return Kg(h)?h.catch(p=>{throw l.runOutsideAngular(()=>o.handleError(p)),p}):h}catch(h){throw l.runOutsideAngular(()=>o.handleError(h)),h}}(X,A,()=>{const de=B.injector.get(Qx);return de.runInitializers(),de.donePromise.then(()=>(function rD(o){ii(o,"Expected localeId to be defined"),"string"==typeof o&&(qT=o.toLowerCase().replace(/_/g,"-"))}(B.injector.get(iE,Xp)||Xp),this._moduleDoBootstrap(B),B))})})}bootstrapModule(u,h=[]){const p=Sl({},h);return function aE(o,l,u){const h=new lm(u);return Promise.resolve(h)}(0,0,u).then(y=>this.bootstrapModuleFactory(y,p))}_moduleDoBootstrap(u){const h=u.injector.get(qo);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(p=>h.bootstrap(p));else{if(!u.instance.ngDoBootstrap)throw new pt(403,"");u.instance.ngDoBootstrap(h)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new pt(404,"");this._modules.slice().forEach(u=>u.destroy()),this._destroyListeners.forEach(u=>u()),this._destroyed=!0}get destroyed(){return this._destroyed}}return o.\u0275fac=function(u){return new(u||o)(Pt(_s))},o.\u0275prov=_i({token:o,factory:o.\u0275fac}),o})();function Sl(o,l){return Array.isArray(l)?l.reduce(Sl,o):Object.assign(Object.assign({},o),l)}let qo=(()=>{class o{constructor(u,h,p,y,S){this._zone=u,this._injector=h,this._exceptionHandler=p,this._componentFactoryResolver=y,this._initStatus=S,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const A=new Y.y(F=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{F.next(this._stable),F.complete()})}),R=new Y.y(F=>{let B;this._zone.runOutsideAngular(()=>{B=this._zone.onStable.subscribe(()=>{$c.assertNotInAngularZone(),rE(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,F.next(!0))})})});const X=this._zone.onUnstable.subscribe(()=>{$c.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{F.next(!1)}))});return()=>{B.unsubscribe(),X.unsubscribe()}});this.isStable=(0,Oe.T)(A,R.pipe((0,Ae.B)()))}bootstrap(u,h){if(!this._initStatus.done)throw new pt(405,"");let p;p=u instanceof Xv?u:this._componentFactoryResolver.resolveComponentFactory(u),this.componentTypes.push(p.componentType);const y=function JM(o){return o.isBoundToModule}(p)?void 0:this._injector.get(am),A=p.create(_s.NULL,[],h||p.selector,y),R=A.location.nativeElement,F=A.injector.get(YM,null),B=F&&A.injector.get(o1);return F&&B&&B.registerApplication(R,F),A.onDestroy(()=>{this.detachView(A.hostView),v0(this.components,A),B&&B.unregisterApplication(R)}),this._loadComponent(A),A}tick(){if(this._runningTick)throw new pt(101,"");try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const h=u;this._views.push(h),h.attachToAppRef(this)}detachView(u){const h=u;v0(this._views,h),h.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u),this._injector.get(Ey,[]).concat(this._bootstrapListeners).forEach(p=>p(u))}ngOnDestroy(){this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return o.\u0275fac=function(u){return new(u||o)(Pt($c),Pt(_s),Pt(Xh),Pt(sm),Pt(Qx))},o.\u0275prov=_i({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function v0(o,l){const u=o.indexOf(l);u>-1&&o.splice(u,1)}let _m=!0,la=!1;function c1(){return la=!0,_m}function hE(){if(la)throw new Error("Cannot enable prod mode after platform setup.");_m=!1}let Of=(()=>{class o{}return o.__NG_ELEMENT_ID__=u1,o})();function u1(o){return function d1(o,l,u){if(Qc(o)&&!u){const h=is(o.index,l);return new Cf(h,h)}return 47&o.type?new Cf(l[16],l):null}(ir(),ut(),16==(16&o))}class m1{constructor(){}supports(l){return Zr(l)}create(l){return new _E(l)}}const g1=(o,l)=>l;class _E{constructor(l){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=l||g1}forEachItem(l){let u;for(u=this._itHead;null!==u;u=u._next)l(u)}forEachOperation(l){let u=this._itHead,h=this._removalsHead,p=0,y=null;for(;u||h;){const S=!h||u&&u.currentIndex<oC(h,p,y)?u:h,A=oC(S,p,y),R=S.currentIndex;if(S===h)p--,h=h._nextRemoved;else if(u=u._next,null==S.previousIndex)p++;else{y||(y=[]);const F=A-p,B=R-p;if(F!=B){for(let de=0;de<F;de++){const xe=de<y.length?y[de]:y[de]=0,Je=xe+de;B<=Je&&Je<F&&(y[de]=xe+1)}y[S.previousIndex]=B-F}}A!==R&&l(S,A,R)}}forEachPreviousItem(l){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)l(u)}forEachAddedItem(l){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)l(u)}forEachMovedItem(l){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)l(u)}forEachRemovedItem(l){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)l(u)}forEachIdentityChange(l){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)l(u)}diff(l){if(null==l&&(l=[]),!Zr(l))throw new pt(900,"");return this.check(l)?this:null}onDestroy(){}check(l){this._reset();let p,y,S,u=this._itHead,h=!1;if(Array.isArray(l)){this.length=l.length;for(let A=0;A<this.length;A++)y=l[A],S=this._trackByFn(A,y),null!==u&&Object.is(u.trackById,S)?(h&&(u=this._verifyReinsertion(u,y,S,A)),Object.is(u.item,y)||this._addIdentityChange(u,y)):(u=this._mismatch(u,y,S,A),h=!0),u=u._next}else p=0,function aT(o,l){if(Array.isArray(o))for(let u=0;u<o.length;u++)l(o[u]);else{const u=o[ih()]();let h;for(;!(h=u.next()).done;)l(h.value)}}(l,A=>{S=this._trackByFn(p,A),null!==u&&Object.is(u.trackById,S)?(h&&(u=this._verifyReinsertion(u,A,S,p)),Object.is(u.item,A)||this._addIdentityChange(u,A)):(u=this._mismatch(u,A,S,p),h=!0),u=u._next,p++}),this.length=p;return this._truncate(u),this.collection=l,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let l;for(l=this._previousItHead=this._itHead;null!==l;l=l._next)l._nextPrevious=l._next;for(l=this._additionsHead;null!==l;l=l._nextAdded)l.previousIndex=l.currentIndex;for(this._additionsHead=this._additionsTail=null,l=this._movesHead;null!==l;l=l._nextMoved)l.previousIndex=l.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(l,u,h,p){let y;return null===l?y=this._itTail:(y=l._prev,this._remove(l)),null!==(l=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null))?(Object.is(l.item,u)||this._addIdentityChange(l,u),this._reinsertAfter(l,y,p)):null!==(l=null===this._linkedRecords?null:this._linkedRecords.get(h,p))?(Object.is(l.item,u)||this._addIdentityChange(l,u),this._moveAfter(l,y,p)):l=this._addAfter(new kN(u,h),y,p),l}_verifyReinsertion(l,u,h,p){let y=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null);return null!==y?l=this._reinsertAfter(y,l._prev,p):l.currentIndex!=p&&(l.currentIndex=p,this._addToMoves(l,p)),l}_truncate(l){for(;null!==l;){const u=l._next;this._addToRemovals(this._unlink(l)),l=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(l,u,h){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(l);const p=l._prevRemoved,y=l._nextRemoved;return null===p?this._removalsHead=y:p._nextRemoved=y,null===y?this._removalsTail=p:y._prevRemoved=p,this._insertAfter(l,u,h),this._addToMoves(l,h),l}_moveAfter(l,u,h){return this._unlink(l),this._insertAfter(l,u,h),this._addToMoves(l,h),l}_addAfter(l,u,h){return this._insertAfter(l,u,h),this._additionsTail=null===this._additionsTail?this._additionsHead=l:this._additionsTail._nextAdded=l,l}_insertAfter(l,u,h){const p=null===u?this._itHead:u._next;return l._next=p,l._prev=u,null===p?this._itTail=l:p._prev=l,null===u?this._itHead=l:u._next=l,null===this._linkedRecords&&(this._linkedRecords=new sC),this._linkedRecords.put(l),l.currentIndex=h,l}_remove(l){return this._addToRemovals(this._unlink(l))}_unlink(l){null!==this._linkedRecords&&this._linkedRecords.remove(l);const u=l._prev,h=l._next;return null===u?this._itHead=h:u._next=h,null===h?this._itTail=u:h._prev=u,l}_addToMoves(l,u){return l.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=l:this._movesTail._nextMoved=l),l}_addToRemovals(l){return null===this._unlinkedRecords&&(this._unlinkedRecords=new sC),this._unlinkedRecords.put(l),l.currentIndex=null,l._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=l,l._prevRemoved=null):(l._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=l),l}_addIdentityChange(l,u){return l.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=l:this._identityChangesTail._nextIdentityChange=l,l}}class kN{constructor(l,u){this.item=l,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class FN{constructor(){this._head=null,this._tail=null}add(l){null===this._head?(this._head=this._tail=l,l._nextDup=null,l._prevDup=null):(this._tail._nextDup=l,l._prevDup=this._tail,l._nextDup=null,this._tail=l)}get(l,u){let h;for(h=this._head;null!==h;h=h._nextDup)if((null===u||u<=h.currentIndex)&&Object.is(h.trackById,l))return h;return null}remove(l){const u=l._prevDup,h=l._nextDup;return null===u?this._head=h:u._nextDup=h,null===h?this._tail=u:h._prevDup=u,null===this._head}}class sC{constructor(){this.map=new Map}put(l){const u=l.trackById;let h=this.map.get(u);h||(h=new FN,this.map.set(u,h)),h.add(l)}get(l,u){const p=this.map.get(l);return p?p.get(l,u):null}remove(l){const u=l.trackById;return this.map.get(u).remove(l)&&this.map.delete(u),l}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function oC(o,l,u){const h=o.previousIndex;if(null===h)return h;let p=0;return u&&h<u.length&&(p=u[h]),h+l+p}class y1{constructor(){}supports(l){return l instanceof Map||hv(l)}create(){return new VN}}class VN{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(l){let u;for(u=this._mapHead;null!==u;u=u._next)l(u)}forEachPreviousItem(l){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)l(u)}forEachChangedItem(l){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)l(u)}forEachAddedItem(l){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)l(u)}forEachRemovedItem(l){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)l(u)}diff(l){if(l){if(!(l instanceof Map||hv(l)))throw new pt(900,"")}else l=new Map;return this.check(l)?this:null}onDestroy(){}check(l){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(l,(h,p)=>{if(u&&u.key===p)this._maybeAddToChanges(u,h),this._appendAfter=u,u=u._next;else{const y=this._getOrCreateRecordForKey(p,h);u=this._insertBeforeOrAppend(u,y)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let h=u;null!==h;h=h._nextRemoved)h===this._mapHead&&(this._mapHead=null),this._records.delete(h.key),h._nextRemoved=h._next,h.previousValue=h.currentValue,h.currentValue=null,h._prev=null,h._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(l,u){if(l){const h=l._prev;return u._next=l,u._prev=h,l._prev=u,h&&(h._next=u),l===this._mapHead&&(this._mapHead=u),this._appendAfter=l,l}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(l,u){if(this._records.has(l)){const p=this._records.get(l);this._maybeAddToChanges(p,u);const y=p._prev,S=p._next;return y&&(y._next=S),S&&(S._prev=y),p._next=null,p._prev=null,p}const h=new UN(l);return this._records.set(l,h),h.currentValue=u,this._addToAdditions(h),h}_reset(){if(this.isDirty){let l;for(this._previousMapHead=this._mapHead,l=this._previousMapHead;null!==l;l=l._next)l._nextPrevious=l._next;for(l=this._changesHead;null!==l;l=l._nextChanged)l.previousValue=l.currentValue;for(l=this._additionsHead;null!=l;l=l._nextAdded)l.previousValue=l.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(l,u){Object.is(u,l.currentValue)||(l.previousValue=l.currentValue,l.currentValue=u,this._addToChanges(l))}_addToAdditions(l){null===this._additionsHead?this._additionsHead=this._additionsTail=l:(this._additionsTail._nextAdded=l,this._additionsTail=l)}_addToChanges(l){null===this._changesHead?this._changesHead=this._changesTail=l:(this._changesTail._nextChanged=l,this._changesTail=l)}_forEach(l,u){l instanceof Map?l.forEach(u):Object.keys(l).forEach(h=>u(l[h],h))}}class UN{constructor(l){this.key=l,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function _1(){return new aC([new m1])}let aC=(()=>{class o{constructor(u){this.factories=u}static create(u,h){if(null!=h){const p=h.factories.slice();u=u.concat(p)}return new o(u)}static extend(u){return{provide:o,useFactory:h=>o.create(u,h||_1()),deps:[[o,new wa,new zo]]}}find(u){const h=this.factories.find(p=>p.supports(u));if(null!=h)return h;throw new pt(901,"")}}return o.\u0275prov=_i({token:o,providedIn:"root",factory:_1}),o})();function v1(){return new lC([new y1])}let lC=(()=>{class o{constructor(u){this.factories=u}static create(u,h){if(h){const p=h.factories.slice();u=u.concat(p)}return new o(u)}static extend(u){return{provide:o,useFactory:h=>o.create(u,h||v1()),deps:[[o,new wa,new zo]]}}find(u){const h=this.factories.find(y=>y.supports(u));if(h)return h;throw new pt(901,"")}}return o.\u0275prov=_i({token:o,providedIn:"root",factory:v1}),o})();const E0=QM(null,"core",[{provide:_0,useValue:"unknown"},{provide:uE,deps:[_s]},{provide:o1,deps:[]},{provide:nE,deps:[]}]);let vE=(()=>{class o{constructor(u){}}return o.\u0275fac=function(u){return new(u||o)(Pt(qo))},o.\u0275mod=Ss({type:o}),o.\u0275inj=vi({}),o})()},3942:(hn,Ze,K)=>{"use strict";K.d(Ze,{Z:()=>pt});var w=K(2090),be=K(4859),Y=K(9681),Oe=K(1877);class Ae{constructor(ze,at){this._delegate=ze,this.firebase=at,(0,Y._addComponent)(ze,new be.wA("app-compat",()=>this,"PUBLIC")),this.container=ze.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ze){this._delegate.automaticDataCollectionEnabled=ze}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ze=>{this._delegate.checkDestroyed(),ze()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,Y.deleteApp)(this._delegate)))}_getService(ze,at=Y._DEFAULT_ENTRY_NAME){var qt;this._delegate.checkDestroyed();const nn=this._delegate.container.getProvider(ze);return!nn.isInitialized()&&"EXPLICIT"===(null===(qt=nn.getComponent())||void 0===qt?void 0:qt.instantiationMode)&&nn.initialize(),nn.getImmediate({identifier:at})}_removeServiceInstance(ze,at=Y._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ze).clearInstance(at)}_addComponent(ze){(0,Y._addComponent)(this._delegate,ze)}_addOrOverwriteComponent(ze){(0,Y._addOrOverwriteComponent)(this._delegate,ze)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Fe=new w.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),ue=function Be(){const Ot=function Ne(Ot){const ze={},at={__esModule:!0,initializeApp:function lt(Ut,ce={}){const Xe=Y.initializeApp(Ut,ce);if((0,w.r3)(ze,Xe.name))return ze[Xe.name];const ve=new Ot(Xe,at);return ze[Xe.name]=ve,ve},app:nn,registerVersion:Y.registerVersion,setLogLevel:Y.setLogLevel,onLog:Y.onLog,apps:null,SDK_VERSION:Y.SDK_VERSION,INTERNAL:{registerComponent:function st(Ut){const ce=Ut.name,Xe=ce.replace("-compat","");if(Y._registerComponent(Ut)&&"PUBLIC"===Ut.type){const ve=(Re=nn())=>{if("function"!=typeof Re[Xe])throw Fe.create("invalid-app-argument",{appName:ce});return Re[Xe]()};void 0!==Ut.serviceProps&&(0,w.ZB)(ve,Ut.serviceProps),at[Xe]=ve,Ot.prototype[Xe]=function(...Re){return this._getService.bind(this,ce).apply(this,Ut.multipleInstances?Re:[])}}return"PUBLIC"===Ut.type?at[Xe]:null},removeApp:function qt(Ut){delete ze[Ut]},useAsService:function Bt(Ut,ce){return"serverAuth"===ce?null:ce},modularAPIs:Y}};function nn(Ut){if(!(0,w.r3)(ze,Ut=Ut||Y._DEFAULT_ENTRY_NAME))throw Fe.create("no-app",{appName:Ut});return ze[Ut]}return at.default=at,Object.defineProperty(at,"apps",{get:function Ye(){return Object.keys(ze).map(Ut=>ze[Ut])}}),nn.App=Ot,at}(Ae);return Ot.INTERNAL=Object.assign(Object.assign({},Ot.INTERNAL),{createFirebaseNamespace:Be,extendNamespace:function ze(at){(0,w.ZB)(Ot,at)},createSubscribe:w.ne,ErrorFactory:w.LL,deepExtend:w.ZB}),Ot}(),le=new Oe.Yd("@firebase/app-compat");if((0,w.jU)()&&void 0!==self.firebase){le.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const Ot=self.firebase.SDK_VERSION;Ot&&Ot.indexOf("LITE")>=0&&le.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const pt=ue;!function tt(Ot){(0,Y.registerVersion)("@firebase/app-compat","0.1.27",Ot)}()},9681:(hn,Ze,K)=>{"use strict";K.r(Ze),K.d(Ze,{FirebaseError:()=>Oe.ZR,SDK_VERSION:()=>ls,_DEFAULT_ENTRY_NAME:()=>ii,_addComponent:()=>$i,_addOrOverwriteComponent:()=>_i,_apps:()=>Ci,_clearComponents:()=>Tn,_components:()=>nr,_getProvider:()=>vi,_registerComponent:()=>xs,_removeServiceInstance:()=>An,deleteApp:()=>Pn,getApp:()=>Br,getApps:()=>Es,initializeApp:()=>ks,onLog:()=>ar,registerVersion:()=>qi,setLogLevel:()=>cs});var w=K(5861),be=K(4859),Y=K(1877),Oe=K(2090),Ae=K(8766);class Ve{constructor(Ee){this.container=Ee}getPlatformInfoString(){return this.container.getProviders().map(ct=>{if(function Fe(he){const Ee=he.getComponent();return"VERSION"===(null==Ee?void 0:Ee.type)}(ct)){const sn=ct.getImmediate();return`${sn.library}/${sn.version}`}return null}).filter(ct=>ct).join(" ")}}const Ne="@firebase/app",ue=new Y.Yd("@firebase/app"),ii="[DEFAULT]",Ht={[Ne]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},Ci=new Map,nr=new Map;function $i(he,Ee){try{he.container.addComponent(Ee)}catch(ct){ue.debug(`Component ${Ee.name} failed to register with FirebaseApp ${he.name}`,ct)}}function _i(he,Ee){he.container.addOrOverwriteComponent(Ee)}function xs(he){const Ee=he.name;if(nr.has(Ee))return ue.debug(`There were multiple attempts to register component ${Ee}.`),!1;nr.set(Ee,he);for(const ct of Ci.values())$i(ct,he);return!0}function vi(he,Ee){const ct=he.container.getProvider("heartbeat").getImmediate({optional:!0});return ct&&ct.triggerHeartbeat(),he.container.getProvider(Ee)}function An(he,Ee,ct=ii){vi(he,Ee).clearInstance(ct)}function Tn(){nr.clear()}const as=new Oe.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."});class Ls{constructor(Ee,ct,sn){this._isDeleted=!1,this._options=Object.assign({},Ee),this._config=Object.assign({},ct),this._name=ct.name,this._automaticDataCollectionEnabled=ct.automaticDataCollectionEnabled,this._container=sn,this.container.addComponent(new be.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Ee){this.checkDestroyed(),this._automaticDataCollectionEnabled=Ee}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Ee){this._isDeleted=Ee}checkDestroyed(){if(this.isDeleted)throw as.create("app-deleted",{appName:this._name})}}const ls="9.8.3";function ks(he,Ee={}){"object"!=typeof Ee&&(Ee={name:Ee});const ct=Object.assign({name:ii,automaticDataCollectionEnabled:!1},Ee),sn=ct.name;if("string"!=typeof sn||!sn)throw as.create("bad-app-name",{appName:String(sn)});const wn=Ci.get(sn);if(wn){if((0,Oe.vZ)(he,wn.options)&&(0,Oe.vZ)(ct,wn.config))return wn;throw as.create("duplicate-app",{appName:sn})}const Ln=new be.H0(sn);for(const Fn of nr.values())Ln.addComponent(Fn);const Ji=new Ls(he,ct,Ln);return Ci.set(sn,Ji),Ji}function Br(he=ii){const Ee=Ci.get(he);if(!Ee)throw as.create("no-app",{appName:he});return Ee}function Es(){return Array.from(Ci.values())}function Pn(he){return Xs.apply(this,arguments)}function Xs(){return(Xs=(0,w.Z)(function*(he){const Ee=he.name;Ci.has(Ee)&&(Ci.delete(Ee),yield Promise.all(he.container.getProviders().map(ct=>ct.delete())),he.isDeleted=!0)})).apply(this,arguments)}function qi(he,Ee,ct){var sn;let wn=null!==(sn=Ht[he])&&void 0!==sn?sn:he;ct&&(wn+=`-${ct}`);const Ln=wn.match(/\s|\//),Ji=Ee.match(/\s|\//);if(Ln||Ji){const Fn=[`Unable to register library "${wn}" with version "${Ee}":`];return Ln&&Fn.push(`library name "${wn}" contains illegal characters (whitespace or "/")`),Ln&&Ji&&Fn.push("and"),Ji&&Fn.push(`version name "${Ee}" contains illegal characters (whitespace or "/")`),void ue.warn(Fn.join(" "))}xs(new be.wA(`${wn}-version`,()=>({library:wn,version:Ee}),"VERSION"))}function ar(he,Ee){if(null!==he&&"function"!=typeof he)throw as.create("invalid-log-argument");(0,Y.Am)(he,Ee)}function cs(he){(0,Y.Ub)(he)}const Pr="firebase-heartbeat-store";let Qs=null;function da(){return Qs||(Qs=(0,Ae.X3)("firebase-heartbeat-database",1,{upgrade:(he,Ee)=>{0===Ee&&he.createObjectStore(Pr)}}).catch(he=>{throw as.create("storage-open",{originalErrorMessage:he.message})})),Qs}function _n(){return(_n=(0,w.Z)(function*(he){var Ee;try{return(yield da()).transaction(Pr).objectStore(Pr).get(zr(he))}catch(ct){throw as.create("storage-get",{originalErrorMessage:null===(Ee=ct)||void 0===Ee?void 0:Ee.message})}})).apply(this,arguments)}function On(he,Ee){return Jr.apply(this,arguments)}function Jr(){return(Jr=(0,w.Z)(function*(he,Ee){var ct;try{const wn=(yield da()).transaction(Pr,"readwrite");return yield wn.objectStore(Pr).put(Ee,zr(he)),wn.done}catch(sn){throw as.create("storage-set",{originalErrorMessage:null===(ct=sn)||void 0===ct?void 0:ct.message})}})).apply(this,arguments)}function zr(he){return`${he.name}!${he.options.appId}`}class Ki{constructor(Ee){this.container=Ee,this._heartbeatsCache=null;const ct=this.container.getProvider("app").getImmediate();this._storage=new fe(ct),this._heartbeatsCachePromise=this._storage.read().then(sn=>(this._heartbeatsCache=sn,sn))}triggerHeartbeat(){var Ee=this;return(0,w.Z)(function*(){const sn=Ee.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),wn=Hi();if(null===Ee._heartbeatsCache&&(Ee._heartbeatsCache=yield Ee._heartbeatsCachePromise),Ee._heartbeatsCache.lastSentHeartbeatDate!==wn&&!Ee._heartbeatsCache.heartbeats.some(Ln=>Ln.date===wn))return Ee._heartbeatsCache.heartbeats.push({date:wn,agent:sn}),Ee._heartbeatsCache.heartbeats=Ee._heartbeatsCache.heartbeats.filter(Ln=>{const Ji=new Date(Ln.date).valueOf();return Date.now()-Ji<=2592e6}),Ee._storage.overwrite(Ee._heartbeatsCache)})()}getHeartbeatsHeader(){var Ee=this;return(0,w.Z)(function*(){if(null===Ee._heartbeatsCache&&(yield Ee._heartbeatsCachePromise),null===Ee._heartbeatsCache||0===Ee._heartbeatsCache.heartbeats.length)return"";const ct=Hi(),{heartbeatsToSend:sn,unsentEntries:wn}=function oe(he,Ee=1024){const ct=[];let sn=he.slice();for(const wn of he){const Ln=ct.find(Ji=>Ji.agent===wn.agent);if(Ln){if(Ln.dates.push(wn.date),pe(ct)>Ee){Ln.dates.pop();break}}else if(ct.push({agent:wn.agent,dates:[wn.date]}),pe(ct)>Ee){ct.pop();break}sn=sn.slice(1)}return{heartbeatsToSend:ct,unsentEntries:sn}}(Ee._heartbeatsCache.heartbeats),Ln=(0,Oe.L)(JSON.stringify({version:2,heartbeats:sn}));return Ee._heartbeatsCache.lastSentHeartbeatDate=ct,wn.length>0?(Ee._heartbeatsCache.heartbeats=wn,yield Ee._storage.overwrite(Ee._heartbeatsCache)):(Ee._heartbeatsCache.heartbeats=[],Ee._storage.overwrite(Ee._heartbeatsCache)),Ln})()}}function Hi(){return(new Date).toISOString().substring(0,10)}class fe{constructor(Ee){this.app=Ee,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,w.Z)(function*(){return!!(0,Oe.hl)()&&(0,Oe.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Ee=this;return(0,w.Z)(function*(){return(yield Ee._canUseIndexedDBPromise)&&(yield function gi(he){return _n.apply(this,arguments)}(Ee.app))||{heartbeats:[]}})()}overwrite(Ee){var ct=this;return(0,w.Z)(function*(){var sn;if(yield ct._canUseIndexedDBPromise){const Ln=yield ct.read();return On(ct.app,{lastSentHeartbeatDate:null!==(sn=Ee.lastSentHeartbeatDate)&&void 0!==sn?sn:Ln.lastSentHeartbeatDate,heartbeats:Ee.heartbeats})}})()}add(Ee){var ct=this;return(0,w.Z)(function*(){var sn;if(yield ct._canUseIndexedDBPromise){const Ln=yield ct.read();return On(ct.app,{lastSentHeartbeatDate:null!==(sn=Ee.lastSentHeartbeatDate)&&void 0!==sn?sn:Ln.lastSentHeartbeatDate,heartbeats:[...Ln.heartbeats,...Ee.heartbeats]})}})()}}function pe(he){return(0,Oe.L)(JSON.stringify({version:2,heartbeats:he})).length}!function et(he){xs(new be.wA("platform-logger",Ee=>new Ve(Ee),"PRIVATE")),xs(new be.wA("heartbeat",Ee=>new Ki(Ee),"PRIVATE")),qi(Ne,"0.7.26",he),qi(Ne,"0.7.26","esm2017"),qi("fire-js","")}("")},4859:(hn,Ze,K)=>{"use strict";K.d(Ze,{wA:()=>Y,H0:()=>Ne});var w=K(5861),be=K(2090);class Y{constructor(ue,le,Ce){this.name=ue,this.instanceFactory=le,this.type=Ce,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(ue){return this.instantiationMode=ue,this}setMultipleInstances(ue){return this.multipleInstances=ue,this}setServiceProps(ue){return this.serviceProps=ue,this}setInstanceCreatedCallback(ue){return this.onInstanceCreated=ue,this}}const Oe="[DEFAULT]";class Ae{constructor(ue,le){this.name=ue,this.container=le,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(ue){const le=this.normalizeInstanceIdentifier(ue);if(!this.instancesDeferred.has(le)){const Ce=new be.BH;if(this.instancesDeferred.set(le,Ce),this.isInitialized(le)||this.shouldAutoInitialize())try{const Gt=this.getOrInitializeService({instanceIdentifier:le});Gt&&Ce.resolve(Gt)}catch(Gt){}}return this.instancesDeferred.get(le).promise}getImmediate(ue){var le;const Ce=this.normalizeInstanceIdentifier(null==ue?void 0:ue.identifier),Gt=null!==(le=null==ue?void 0:ue.optional)&&void 0!==le&&le;if(!this.isInitialized(Ce)&&!this.shouldAutoInitialize()){if(Gt)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Ce})}catch(tt){if(Gt)return null;throw tt}}getComponent(){return this.component}setComponent(ue){if(ue.name!==this.name)throw Error(`Mismatching Component ${ue.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=ue,this.shouldAutoInitialize()){if(function Fe(Be){return"EAGER"===Be.instantiationMode}(ue))try{this.getOrInitializeService({instanceIdentifier:Oe})}catch(le){}for(const[le,Ce]of this.instancesDeferred.entries()){const Gt=this.normalizeInstanceIdentifier(le);try{const tt=this.getOrInitializeService({instanceIdentifier:Gt});Ce.resolve(tt)}catch(tt){}}}}clearInstance(ue=Oe){this.instancesDeferred.delete(ue),this.instancesOptions.delete(ue),this.instances.delete(ue)}delete(){var ue=this;return(0,w.Z)(function*(){const le=Array.from(ue.instances.values());yield Promise.all([...le.filter(Ce=>"INTERNAL"in Ce).map(Ce=>Ce.INTERNAL.delete()),...le.filter(Ce=>"_delete"in Ce).map(Ce=>Ce._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(ue=Oe){return this.instances.has(ue)}getOptions(ue=Oe){return this.instancesOptions.get(ue)||{}}initialize(ue={}){const{options:le={}}=ue,Ce=this.normalizeInstanceIdentifier(ue.instanceIdentifier);if(this.isInitialized(Ce))throw Error(`${this.name}(${Ce}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Gt=this.getOrInitializeService({instanceIdentifier:Ce,options:le});for(const[tt,pt]of this.instancesDeferred.entries())Ce===this.normalizeInstanceIdentifier(tt)&&pt.resolve(Gt);return Gt}onInit(ue,le){var Ce;const Gt=this.normalizeInstanceIdentifier(le),tt=null!==(Ce=this.onInitCallbacks.get(Gt))&&void 0!==Ce?Ce:new Set;tt.add(ue),this.onInitCallbacks.set(Gt,tt);const pt=this.instances.get(Gt);return pt&&ue(pt,Gt),()=>{tt.delete(ue)}}invokeOnInitCallbacks(ue,le){const Ce=this.onInitCallbacks.get(le);if(Ce)for(const Gt of Ce)try{Gt(ue,le)}catch(tt){}}getOrInitializeService({instanceIdentifier:ue,options:le={}}){let Ce=this.instances.get(ue);if(!Ce&&this.component&&(Ce=this.component.instanceFactory(this.container,{instanceIdentifier:(Be=ue,Be===Oe?void 0:Be),options:le}),this.instances.set(ue,Ce),this.instancesOptions.set(ue,le),this.invokeOnInitCallbacks(Ce,ue),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,ue,Ce)}catch(Gt){}var Be;return Ce||null}normalizeInstanceIdentifier(ue=Oe){return this.component?this.component.multipleInstances?ue:Oe:ue}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ne{constructor(ue){this.name=ue,this.providers=new Map}addComponent(ue){const le=this.getProvider(ue.name);if(le.isComponentSet())throw new Error(`Component ${ue.name} has already been registered with ${this.name}`);le.setComponent(ue)}addOrOverwriteComponent(ue){this.getProvider(ue.name).isComponentSet()&&this.providers.delete(ue.name),this.addComponent(ue)}getProvider(ue){if(this.providers.has(ue))return this.providers.get(ue);const le=new Ae(ue,this);return this.providers.set(ue,le),le}getProviders(){return Array.from(this.providers.values())}}},1877:(hn,Ze,K)=>{"use strict";K.d(Ze,{in:()=>be,Yd:()=>Fe,Ub:()=>Ne,Am:()=>Be});const w=[];var be=(()=>{return(ue=be||(be={}))[ue.DEBUG=0]="DEBUG",ue[ue.VERBOSE=1]="VERBOSE",ue[ue.INFO=2]="INFO",ue[ue.WARN=3]="WARN",ue[ue.ERROR=4]="ERROR",ue[ue.SILENT=5]="SILENT",be;var ue})();const Y={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},Oe=be.INFO,Ae={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},Ve=(ue,le,...Ce)=>{if(le<ue.logLevel)return;const Gt=(new Date).toISOString(),tt=Ae[le];if(!tt)throw new Error(`Attempted to log a message with an invalid logType (value: ${le})`);console[tt](`[${Gt}]  ${ue.name}:`,...Ce)};class Fe{constructor(le){this.name=le,this._logLevel=Oe,this._logHandler=Ve,this._userLogHandler=null,w.push(this)}get logLevel(){return this._logLevel}set logLevel(le){if(!(le in be))throw new TypeError(`Invalid value "${le}" assigned to \`logLevel\``);this._logLevel=le}setLogLevel(le){this._logLevel="string"==typeof le?Y[le]:le}get logHandler(){return this._logHandler}set logHandler(le){if("function"!=typeof le)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=le}get userLogHandler(){return this._userLogHandler}set userLogHandler(le){this._userLogHandler=le}debug(...le){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...le),this._logHandler(this,be.DEBUG,...le)}log(...le){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...le),this._logHandler(this,be.VERBOSE,...le)}info(...le){this._userLogHandler&&this._userLogHandler(this,be.INFO,...le),this._logHandler(this,be.INFO,...le)}warn(...le){this._userLogHandler&&this._userLogHandler(this,be.WARN,...le),this._logHandler(this,be.WARN,...le)}error(...le){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...le),this._logHandler(this,be.ERROR,...le)}}function Ne(ue){w.forEach(le=>{le.setLogLevel(ue)})}function Be(ue,le){for(const Ce of w){let Gt=null;le&&le.level&&(Gt=Y[le.level]),Ce.userLogHandler=null===ue?null:(tt,pt,...Ot)=>{const ze=Ot.map(at=>{if(null==at)return null;if("string"==typeof at)return at;if("number"==typeof at||"boolean"==typeof at)return at.toString();if(at instanceof Error)return at.message;try{return JSON.stringify(at)}catch(qt){return null}}).filter(at=>at).join(" ");pt>=(null!=Gt?Gt:tt.logLevel)&&ue({level:be[pt].toLowerCase(),message:ze,args:Ot,type:tt.name})}}}},8766:(hn,Ze,K)=>{"use strict";K.d(Ze,{Lj:()=>lt,X3:()=>nn});var w=K(5861);let Y,Oe;const Fe=new WeakMap,Ne=new WeakMap,Be=new WeakMap,ue=new WeakMap,le=new WeakMap;let tt={get(ce,Xe,ve){if(ce instanceof IDBTransaction){if("done"===Xe)return Ne.get(ce);if("objectStoreNames"===Xe)return ce.objectStoreNames||Be.get(ce);if("store"===Xe)return ve.objectStoreNames[1]?void 0:ve.objectStore(ve.objectStoreNames[0])}return at(ce[Xe])},set:(ce,Xe,ve)=>(ce[Xe]=ve,!0),has:(ce,Xe)=>ce instanceof IDBTransaction&&("done"===Xe||"store"===Xe)||Xe in ce};function ze(ce){return"function"==typeof ce?function Ot(ce){return ce!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function Ve(){return Oe||(Oe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(ce)?function(...Xe){return ce.apply(qt(this),Xe),at(Fe.get(this))}:function(...Xe){return at(ce.apply(qt(this),Xe))}:function(Xe,...ve){const Re=ce.call(qt(this),Xe,...ve);return Be.set(Re,Xe.sort?Xe.sort():[Xe]),at(Re)}}(ce):(ce instanceof IDBTransaction&&function Gt(ce){if(Ne.has(ce))return;const Xe=new Promise((ve,Re)=>{const Te=()=>{ce.removeEventListener("complete",We),ce.removeEventListener("error",ke),ce.removeEventListener("abort",ke)},We=()=>{ve(),Te()},ke=()=>{Re(ce.error||new DOMException("AbortError","AbortError")),Te()};ce.addEventListener("complete",We),ce.addEventListener("error",ke),ce.addEventListener("abort",ke)});Ne.set(ce,Xe)}(ce),((ce,Xe)=>Xe.some(ve=>ce instanceof ve))(ce,function Ae(){return Y||(Y=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(ce,tt):ce)}function at(ce){if(ce instanceof IDBRequest)return function Ce(ce){const Xe=new Promise((ve,Re)=>{const Te=()=>{ce.removeEventListener("success",We),ce.removeEventListener("error",ke)},We=()=>{ve(at(ce.result)),Te()},ke=()=>{Re(ce.error),Te()};ce.addEventListener("success",We),ce.addEventListener("error",ke)});return Xe.then(ve=>{ve instanceof IDBCursor&&Fe.set(ve,ce)}).catch(()=>{}),le.set(Xe,ce),Xe}(ce);if(ue.has(ce))return ue.get(ce);const Xe=ze(ce);return Xe!==ce&&(ue.set(ce,Xe),le.set(Xe,ce)),Xe}const qt=ce=>le.get(ce);function nn(ce,Xe,{blocked:ve,upgrade:Re,blocking:Te,terminated:We}={}){const ke=indexedDB.open(ce,Xe),It=at(ke);return Re&&ke.addEventListener("upgradeneeded",Pe=>{Re(at(ke.result),Pe.oldVersion,Pe.newVersion,at(ke.transaction))}),ve&&ke.addEventListener("blocked",()=>ve()),It.then(Pe=>{We&&Pe.addEventListener("close",()=>We()),Te&&Pe.addEventListener("versionchange",()=>Te())}).catch(()=>{}),It}function lt(ce,{blocked:Xe}={}){const ve=indexedDB.deleteDatabase(ce);return Xe&&ve.addEventListener("blocked",()=>Xe()),at(ve).then(()=>{})}const Ye=["get","getKey","getAll","getAllKeys","count"],st=["put","add","delete","clear"],Bt=new Map;function Ut(ce,Xe){if(!(ce instanceof IDBDatabase)||Xe in ce||"string"!=typeof Xe)return;if(Bt.get(Xe))return Bt.get(Xe);const ve=Xe.replace(/FromIndex$/,""),Re=Xe!==ve,Te=st.includes(ve);if(!(ve in(Re?IDBIndex:IDBObjectStore).prototype)||!Te&&!Ye.includes(ve))return;const We=function(){var ke=(0,w.Z)(function*(It,...Pe){const ni=this.transaction(It,Te?"readwrite":"readonly");let ii=ni.store;return Re&&(ii=ii.index(Pe.shift())),(yield Promise.all([ii[ve](...Pe),Te&&ni.done]))[0]});return function(Pe){return ke.apply(this,arguments)}}();return Bt.set(Xe,We),We}!function pt(ce){tt=ce(tt)}(ce=>ES(Si({},ce),{get:(Xe,ve,Re)=>Ut(Xe,ve)||ce.get(Xe,ve,Re),has:(Xe,ve)=>!!Ut(Xe,ve)||ce.has(Xe,ve)}))},5861:(hn,Ze,K)=>{"use strict";function w(Y,Oe,Ae,Ve,Fe,Ne,Be){try{var ue=Y[Ne](Be),le=ue.value}catch(Ce){return void Ae(Ce)}ue.done?Oe(le):Promise.resolve(le).then(Ve,Fe)}function be(Y){return function(){var Oe=this,Ae=arguments;return new Promise(function(Ve,Fe){var Ne=Y.apply(Oe,Ae);function Be(le){w(Ne,Ve,Fe,Be,ue,"next",le)}function ue(le){w(Ne,Ve,Fe,Be,ue,"throw",le)}Be(void 0)})}}K.d(Ze,{Z:()=>be})}},hn=>{hn(hn.s=5097)}]);